
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Hands-on labs for the K-Agent framework - Kubernetes-native MCP server">
      
      
        <meta name="author" content="CodeWizard-IL">
      
      
        <link rel="canonical" href="https://nirgeier.github.io/AI-K8S-MCP/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Print Site - K-Agent Labs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%202a7%207%200%200%200-7%207c0%202.38%201.19%204.47%203%205.74V17a1%201%200%200%200%201%201h6a1%201%200%200%200%201-1v-2.26c1.81-1.27%203-3.36%203-5.74a7%207%200%200%200-7-7M9%2021a1%201%200%200%200%201%201h4a1%201%200%200%200%201-1v-1H9z%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Mulish";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/codewizard.css?v=1766553928">
    
    <script>__md_scope=new URL("/AI-K8S-MCP/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#welcome" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->





<!-- Header -->
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">

    <!-- Link to home -->
    <a href=".." title="K-Agent Labs"
      class="md-header__button md-logo" aria-label="K-Agent Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            K-Agent Labs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
            Print Site
            
          </span>
        </div>
      </div>
    </div>

    <div class="m-social__top">
      <!-- Social links -->
      
      
<div class="md-social">
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP" target="_blank" rel="noopener" title="View on GitHub"
        class="md-social__link social-class__github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP/network/members" target="_blank" rel="noopener" title="Fork this repo"
        class="md-social__link social-class__fork">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0M5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0m6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5m-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0"/></svg>
    </a>
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP/stargazers" target="_blank" rel="noopener" title="Star this repo"
        class="md-social__link social-class__star">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25m0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://www.linkedin.com/in/nirgeier/" target="_blank" rel="noopener" title="Connect on LinkedIn"
        class="md-social__link social-class__linkedin">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://discord.gg/U6xW23Ss" target="_blank" rel="noopener" title="Follow me on Discord"
        class="md-social__link social-class__discord">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
    
    
    
    
    
    <a href="https://stackoverflow.com/users/1755598/codewizard" target="_blank" rel="noopener" title="Follow me on Stack Overflow"
        class="md-social__link social-class__stackoverflow">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M291 311 95.3 269.7 87.1 309l195.7 41zm51-87L188.5 95.7 163 126.5l153.5 128.3zm-31.2 39.7L129.5 179l-16.7 36.5L294 300zM262.3 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H43V320H3v160h359.5V320h-40z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://wa.me/972548122310" target="_blank" rel="noopener" title="Follow me on WhatsApp"
        class="md-social__link social-class__whatsapp">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157m-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1s56.2 81.2 56.1 130.5c0 101.8-84.9 184.6-186.6 184.6m101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7s-12.5-30.1-17.1-41.2c-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3s19.9 53.7 22.6 57.4c2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4s4.6-24.1 3.2-26.4c-1.3-2.5-5-3.9-10.5-6.6"/></svg>
    </a>
    
    
    
    
    
    <a href="mailto:nirg@codewizard.co.il" target="_blank" rel="noopener" title="Email me"
        class="md-social__link social-class__email">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg>
    </a>
    
</div>
      
    </div>

    <!-- Color palette toggle -->
    
    
    <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
    
    

    <!-- User preference: color palette -->
    
    <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
    

    <!-- Check if search is actually enabled - see https://t.ly/DT_0V -->
    
    <label class="md-header__button md-icon" for="__search">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
    </label>

    <!-- Search interface -->
    <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    

    <!-- Repository information -->
    
    <div class="md-header__source">
      <a href="https://github.com/nirgeier/AI-K8S-MCP.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    nirgeier/AI-K8S-MCP
  </div>
</a>
    </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
  
  
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../welcome/" class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../01-MCP-Workflow/" class="md-tabs__link">
        
  
  
    
  
  MCP Workflow

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../02-MCP-Ollama/" class="md-tabs__link">
        
  
  
    
  
  MCP Ollama

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Resources/resources/" class="md-tabs__link">
          
  
  
    
  
  Resources

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
  
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="K-Agent Labs" class="md-nav__button md-logo" aria-label="K-Agent Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    K-Agent Labs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nirgeier/AI-K8S-MCP.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    nirgeier/AI-K8S-MCP
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../welcome/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-MCP-Workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MCP Workflow
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-MCP-Ollama/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MCP Ollama
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../Resources/resources/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="welcome" heading-number="1"><h1 id="welcome-welcome-to-the-mcp-labs">Welcome to the MCP Labs<a class="headerlink" href="#welcome-welcome-to-the-mcp-labs" title="Permanent link">&para;</a></h1>
<p><strong>Here you&rsquo;ll Learn and Build Model Context Protocol (MCP) from Scratch</strong></p>
<p><img src="../assets/images/mcp-feature-image.jpg" alt="MCP Feature" class="center" style="max-width:800; border-radius:20px;"/></p>
<hr />
<h2 id="welcome-introduction">Introduction<a class="headerlink" href="#welcome-introduction" title="Permanent link">&para;</a></h2>
<p>Welcome to the MCP Labs - a comprehensive, hands-on guide to mastering the Model Context Protocol! </p>
<p>Whether you&rsquo;re new to MCP or looking to deepen your understanding, this learning series will take you from fundamentals to building production-ready MCP servers.</p>
<hr />
<h2 id="welcome-what-is-mcp">What is MCP?<a class="headerlink" href="#welcome-what-is-mcp" title="Permanent link">&para;</a></h2>
<p>The <strong>Model Context Protocol (MCP)</strong> is an open protocol that standardizes how applications provide context to Large Language Models (LLMs). </p>
<p>Think of it as a universal adapter that allows AI applications to connect to various data sources, tools, and services in a consistent and scalable way.</p>
<hr />
<h2 id="welcome-what-youll-learn">What You&rsquo;ll Learn<a class="headerlink" href="#welcome-what-youll-learn" title="Permanent link">&para;</a></h2>
<p>Through hands-on labs, you&rsquo;ll:</p>
<ul>
<li><strong>Understand MCP Architecture</strong> - Master the client-server model and protocol fundamentals</li>
<li><strong>Build MCP Servers</strong> - Create servers from scratch using TypeScript and the official SDK</li>
<li><strong>Implement Tools</strong> - Develop functions that LLMs can call to perform actions</li>
<li><strong>Expose Resources</strong> - Provide contextual data that LLMs can read and reference</li>
<li><strong>Create Prompts</strong> - Build reusable templates for common tasks</li>
<li><strong>Deploy to Production</strong> - Apply best practices for real-world applications</li>
</ul>
<hr />
<h2 id="welcome-learning-path">Learning Path<a class="headerlink" href="#welcome-learning-path" title="Permanent link">&para;</a></h2>
<p>This course consists of <strong>5 progressive labs</strong>, each building on the previous one:</p>
<h3 id="welcome-lab-1-mcp-fundamentals"><a href="#welcome-lab01-mcp-fundamentals-index.md">Lab 1: MCP Fundamentals</a><a class="headerlink" href="#welcome-lab-1-mcp-fundamentals" title="Permanent link">&para;</a></h3>
<p><strong>Duration:</strong> 30-45 minutes</p>
<p>Understand what MCP is, why it exists, and learn the core architecture and concepts.</p>
<p><br></p>
<h3 id="welcome-lab-2-building-your-first-mcp-server"><a href="#welcome-lab02-first-mcp-server-index.md">Lab 2: Building Your First MCP Server</a><a class="headerlink" href="#welcome-lab-2-building-your-first-mcp-server" title="Permanent link">&para;</a></h3>
<p><strong>Duration:</strong> 1-1.5 hours</p>
<p>Build a complete, working MCP server from the ground up with hands-on coding.</p>
<p><br></p>
<h3 id="welcome-lab-3-implementing-mcp-tools"><a href="#welcome-lab03-mcp-tools-index.md">Lab 3: Implementing MCP Tools</a><a class="headerlink" href="#welcome-lab-3-implementing-mcp-tools" title="Permanent link">&para;</a></h3>
<p><strong>Duration:</strong> 1.5-2 hours</p>
<p>Master creating sophisticated tools that interact with external systems like APIs, files, and databases.</p>
<p><br></p>
<h3 id="welcome-lab-4-implementing-mcp-resources"><a href="#welcome-lab04-mcp-resources-index.md">Lab 4: Implementing MCP Resources</a><a class="headerlink" href="#welcome-lab-4-implementing-mcp-resources" title="Permanent link">&para;</a></h3>
<p><strong>Duration:</strong> 1-1.5 hours</p>
<p>Learn to expose contextual data through resources and understand the difference between tools and resources.</p>
<p><br></p>
<h3 id="welcome-lab-5-mcp-prompts-and-complete-integration"><a href="#welcome-lab05-mcp-prompts-index.md">Lab 5: MCP Prompts and Complete Integration</a><a class="headerlink" href="#welcome-lab-5-mcp-prompts-and-complete-integration" title="Permanent link">&para;</a></h3>
<p><strong>Duration:</strong> 1.5-2 hours</p>
<p>Complete your MCP education with prompts, production best practices, and deployment strategies.</p>
<p><br></p>
<h3 id="welcome-lab-6-k-agent-integration"><a href="#welcome-lab06-k-agent-index.md">Lab 6: K-Agent Integration</a><a class="headerlink" href="#welcome-lab-6-k-agent-integration" title="Permanent link">&para;</a></h3>
<p><strong>Duration:</strong> 2-3 hours</p>
<p>Implement a specialized MCP server (K-Agent) that interacts with Kubernetes clusters to provide AI-driven log collection and analysis.</p>
<hr />
<h3 id="welcome-tasks"><a href="#welcome-lab01-mcp-fundamentals-lab1-tasks.md">Tasks</a><a class="headerlink" href="#welcome-tasks" title="Permanent link">&para;</a></h3>
<p><strong>Duration:</strong> Varies</p>
<p>A dedicated section with exercises and challenges to reinforce your learning from all labs.</p>
<hr />
<h2 id="welcome-who-is-this-for">Who Is This For?<a class="headerlink" href="#welcome-who-is-this-for" title="Permanent link">&para;</a></h2>
<p>This learning series is designed for:</p>
<ul>
<li><strong>Developers</strong> building AI-powered applications</li>
<li><strong>Engineers</strong> integrating LLMs with existing systems</li>
<li><strong>Technical Architects</strong> designing AI infrastructure</li>
<li><strong>DevOps Professionals</strong> deploying and maintaining MCP servers</li>
<li><strong>AI Enthusiasts</strong> wanting to understand standardized AI application development</li>
<li><strong>Anyone</strong> curious about standardized AI application development</li>
</ul>
<hr />
<h2 id="welcome-prerequisites">Prerequisites<a class="headerlink" href="#welcome-prerequisites" title="Permanent link">&para;</a></h2>
<p>To get the most out of these labs, you should have:</p>
<ul>
<li><strong>Basic Programming Knowledge</strong> - Familiarity with JavaScript/TypeScript</li>
<li><strong>Node.js Experience</strong> - Understanding of npm and basic Node.js concepts</li>
<li><strong>Command Line Skills</strong> - Comfortable with terminal/shell commands</li>
<li><strong>Code Editor</strong> - VS Code or similar IDEs (VS Code recommended)</li>
</ul>
<hr />
<h3 id="welcome-required-software">Required Software<a class="headerlink" href="#welcome-required-software" title="Permanent link">&para;</a></h3>
<p>Before starting, ensure you have installed:</p>
<ul>
<li><strong>Node.js</strong> v18 or later (<a href="https://nodejs.org/">download</a>)</li>
<li><strong>npm</strong> or <strong>yarn</strong> package manager</li>
<li><strong>Git</strong> for version control</li>
<li>A code editor (VS Code with TypeScript is support recommended)</li>
</ul>
<hr />
<h2 id="welcome-tools-youll-use">Tools You&rsquo;ll Use<a class="headerlink" href="#welcome-tools-youll-use" title="Permanent link">&para;</a></h2>
<p>Throughout the labs, you&rsquo;ll work with:</p>
<ul>
<li><strong><a href="https://github.com/modelcontextprotocol/typescript-sdk">@modelcontextprotocol/sdk</a></strong> - Official TypeScript SDK</li>
<li><strong><a href="https://github.com/modelcontextprotocol/inspector">MCP Inspector</a></strong> - Essential testing tool</li>
<li><strong>TypeScript</strong> - Type-safe server development</li>
<li><strong>JSON-RPC 2.0</strong> - Communication protocol</li>
</ul>
<hr />
<h2 id="welcome-learning-approach">Learning Approach<a class="headerlink" href="#welcome-learning-approach" title="Permanent link">&para;</a></h2>
<p>Each lab includes:</p>
<ul>
<li><strong>Clear Objectives</strong> - Know what you&rsquo;ll learn before you start</li>
<li><strong>Detailed Explanations</strong> - Understand the &ldquo;why&rdquo; behind the code</li>
<li><strong>Complete Code Examples</strong> - Working, tested code you can run</li>
<li><strong>Hands-on Exercises</strong> - Practice what you&rsquo;ve learned</li>
<li><strong>Key Takeaways</strong> - Reinforce important concepts</li>
<li><strong>Additional Resources</strong> - Dive deeper on specific topics</li>
</ul>
<p>In addition, you&rsquo;ll find a complete <a href="#welcome-lab01-mcp-fundamentals-lab1-tasks.md">Tasks</a> section dedicated just to exercises and challenges to solidify your understanding.</p>
<hr />
<h2 id="welcome-getting-started">Getting Started<a class="headerlink" href="#welcome-getting-started" title="Permanent link">&para;</a></h2>
<p>Ready to begin your MCP journey? </p>
<p>Here&rsquo;s how to start:</p>
<ol>
<li><strong><a href="#.">Browse the Labs</a></strong> - See an overview of all available labs</li>
<li><strong><a href="#welcome-lab01-mcp-fundamentals-index.md">Start with Lab 1</a></strong> - Begin with the fundamentals</li>
<li><strong>Complete the various labs in Order</strong> - Each lab builds on previous knowledge</li>
<li><strong>Practice &amp; Experiment</strong> - Try variations and explore beyond examples in the <strong><a href="#welcome-lab01-mcp-fundamentals-lab1-tasks.md">Tasks</a></strong> section</li>
</ol>
<hr />
<h2 id="welcome-community-support">Community &amp; Support<a class="headerlink" href="#welcome-community-support" title="Permanent link">&para;</a></h2>
<p>Join the growing MCP community:</p>
<ul>
<li><strong><a href="https://discord.gg/modelcontextprotocol">MCP Discord</a></strong> - Ask questions, share projects</li>
<li><strong><a href="https://github.com/modelcontextprotocol">GitHub Organization</a></strong> - Contribute to the ecosystem</li>
<li><strong><a href="https://modelcontextprotocol.io">Official Documentation</a></strong> - Comprehensive reference</li>
<li><strong><a href="https://spec.modelcontextprotocol.io">MCP Specification</a></strong> - Protocol details</li>
</ul>
<hr />
<h2 id="welcome-why-learn-mcp">Why Learn MCP?<a class="headerlink" href="#welcome-why-learn-mcp" title="Permanent link">&para;</a></h2>
<p>MCP is revolutionizing how we build AI applications:</p>
<ul>
<li><strong>Universal Connectivity</strong> - One integration works across all MCP-compatible apps</li>
<li><strong>Reusability</strong> - Build once, use everywhere</li>
<li><strong>Scalability</strong> - Add new capabilities without rebuilding integrations</li>
<li><strong>Standardization</strong> - Consistent patterns and best practices</li>
<li><strong>Growing Ecosystem</strong> - Join a vibrant, expanding community</li>
</ul>
<hr />
<h2 id="welcome-after-this-course">After This Course<a class="headerlink" href="#welcome-after-this-course" title="Permanent link">&para;</a></h2>
<p>Upon completion, you&rsquo;ll be able to:</p>
<ul>
<li>Build custom MCP servers for your specific needs</li>
<li>Integrate LLMs with your company&rsquo;s tools and data sources</li>
<li>Contribute to the MCP open source ecosystem</li>
<li>Create servers that others can use</li>
<li>Help others learn and adopt MCP</li>
</ul>
<hr />
<h2 id="welcome-next-steps">Next Steps<a class="headerlink" href="#welcome-next-steps" title="Permanent link">&para;</a></h2>
<p><strong><a href="#.">View All Labs →</a></strong> - See the complete learning path</p>
<p><strong><a href="#welcome-lab01-mcp-fundamentals-index.md">Start Lab 1 →</a></strong> - Begin your MCP journey!</p>
<hr />
<div style="text-align: center; padding: 2em 0;">
  <h2>Ready to Build the Future of AI Applications?</h2>
  <p style="font-size: 1.2em; margin: 1em 0;">Let's get started!</p>
</div></section><section class="print-page" id="01-mcp-workflow" heading-number="2"><h1 id="01-mcp-workflow-complete-mcp-server-hands-on-lab">Complete MCP Server - Hands-On Lab<a class="headerlink" href="#01-mcp-workflow-complete-mcp-server-hands-on-lab" title="Permanent link">&para;</a></h1>
<h2 id="01-mcp-workflow-mcp-server-structure-lab">MCP Server Structure Lab<a class="headerlink" href="#01-mcp-workflow-mcp-server-structure-lab" title="Permanent link">&para;</a></h2>
<h2 id="01-mcp-workflow-lab-objective">Lab Objective<a class="headerlink" href="#01-mcp-workflow-lab-objective" title="Permanent link">&para;</a></h2>
<ul>
<li>In this hands-on lab, you&rsquo;ll build a complete MCP (Model Context Protocol) server from scratch. </li>
<li>You&rsquo;ll learn how each component works by implementing it yourself, understanding why each piece is necessary, and seeing the complete architecture come together.</li>
</ul>
<h2 id="01-mcp-workflow-prerequisites">Prerequisites<a class="headerlink" href="#01-mcp-workflow-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Python 3.10 or higher installed</li>
<li>Basic understanding of Python programming</li>
<li>Terminal/command line access</li>
<li>Text editor or IDE</li>
</ul>
<hr />
<h2 id="01-mcp-workflow-getting-started">Getting Started<a class="headerlink" href="#01-mcp-workflow-getting-started" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-step-1-create-your-project-file">Step 1: Create Your Project File<a class="headerlink" href="#01-mcp-workflow-step-1-create-your-project-file" title="Permanent link">&para;</a></h3>
<ol>
<li>Create a new file called <code>my_mcp_server.py</code></li>
<li>Open it in your favorite text editor</li>
<li>We&rsquo;ll build this server step by step!</li>
</ol>
<hr />
<h2 id="01-mcp-workflow-step-01-adding-imports">Step 01: Adding Imports<a class="headerlink" href="#01-mcp-workflow-step-01-adding-imports" title="Permanent link">&para;</a></h2>
<ul>
<li>Before we write any code, we need to understand what libraries we&rsquo;re using and why.</li>
</ul>
<h3 id="01-mcp-workflow-asyncio-asynchronous-io"><code>asyncio</code> - Asynchronous I/O<a class="headerlink" href="#01-mcp-workflow-asyncio-asynchronous-io" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">asyncio</p>
<h4 id="01-mcp-workflow-definition">Definition:<a class="headerlink" href="#01-mcp-workflow-definition" title="Permanent link">&para;</a></h4>
<ul>
<li><code>asyncio</code> is a Python library for writing concurrent code using the async/await syntax.</li>
</ul>
<h4 id="01-mcp-workflow-why">Why:<a class="headerlink" href="#01-mcp-workflow-why" title="Permanent link">&para;</a></h4>
<ul>
<li>Enables asynchronous programming in Python</li>
<li>MCP servers handle multiple concurrent operations (I/O, requests) without blocking</li>
</ul>
<h4 id="01-mcp-workflow-usage">Usage:<a class="headerlink" href="#01-mcp-workflow-usage" title="Permanent link">&para;</a></h4>
<ul>
<li><code>async</code>/<code>await</code> keywords, event loops, concurrent task execution</li>
</ul>
</div>
<hr />
<h3 id="01-mcp-workflow-json-javascript-object-notation"><code>json</code> - JavaScript Object Notation<a class="headerlink" href="#01-mcp-workflow-json-javascript-object-notation" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">json</p>
<h4 id="01-mcp-workflow-definition_1">Definition:<a class="headerlink" href="#01-mcp-workflow-definition_1" title="Permanent link">&para;</a></h4>
<ul>
<li>JSON encoding/decoding for data serialization</li>
</ul>
<h4 id="01-mcp-workflow-why_1">Why:<a class="headerlink" href="#01-mcp-workflow-why_1" title="Permanent link">&para;</a></h4>
<ul>
<li>MCP uses JSON-RPC protocol; resources return JSON data</li>
</ul>
<h4 id="01-mcp-workflow-usage_1">Usage:<a class="headerlink" href="#01-mcp-workflow-usage_1" title="Permanent link">&para;</a></h4>
<ul>
<li><code>json.dumps()</code> to serialize Python dicts, <code>json.loads()</code> to parse</li>
</ul>
</div>
<hr />
<h3 id="01-mcp-workflow-typing-type-hints"><code>typing</code> - Type Hints<a class="headerlink" href="#01-mcp-workflow-typing-type-hints" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">typing</p>
<h4 id="01-mcp-workflow-definition_2">Definition:<a class="headerlink" href="#01-mcp-workflow-definition_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Type hints for better code documentation and IDE support</li>
</ul>
<h4 id="01-mcp-workflow-why_2">Why:<a class="headerlink" href="#01-mcp-workflow-why_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Makes code more maintainable and catches type errors early</li>
</ul>
<h4 id="01-mcp-workflow-usage_2">Usage:<a class="headerlink" href="#01-mcp-workflow-usage_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Function parameters, return types (Any = any type, Optional = can be None)</li>
</ul>
</div>
<hr />
<h3 id="01-mcp-workflow-mcpserver-core-mcp-server"><code>mcp.server</code> - Core MCP Server<a class="headerlink" href="#01-mcp-workflow-mcpserver-core-mcp-server" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.server</p>
<h4 id="01-mcp-workflow-definition_3">Definition:<a class="headerlink" href="#01-mcp-workflow-definition_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Core MCP Server class - the foundation of our server</li>
</ul>
<h4 id="01-mcp-workflow-why_3">Why:<a class="headerlink" href="#01-mcp-workflow-why_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Provides all MCP protocol implementation and lifecycle management</li>
</ul>
<h4 id="01-mcp-workflow-usage_3">Usage:<a class="headerlink" href="#01-mcp-workflow-usage_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Create server instance, register handlers, manage connections</li>
</ul>
</div>
<hr />
<h3 id="01-mcp-workflow-mcpserverstdio-standard-io-transport"><code>mcp.server.stdio</code> - Standard I/O Transport<a class="headerlink" href="#01-mcp-workflow-mcpserverstdio-standard-io-transport" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.server.stdio</p>
<h4 id="01-mcp-workflow-definition_4">Definition:<a class="headerlink" href="#01-mcp-workflow-definition_4" title="Permanent link">&para;</a></h4>
<ul>
<li>Standard Input/Output transport layer for MCP</li>
</ul>
<h4 id="01-mcp-workflow-why_4">Why:<a class="headerlink" href="#01-mcp-workflow-why_4" title="Permanent link">&para;</a></h4>
<ul>
<li>MCP servers communicate via stdio (standard in/out streams)</li>
</ul>
<h4 id="01-mcp-workflow-usage_4">Usage:<a class="headerlink" href="#01-mcp-workflow-usage_4" title="Permanent link">&para;</a></h4>
<ul>
<li>Connects server to clients through stdin/stdout pipes</li>
</ul>
</div>
<hr />
<h3 id="01-mcp-workflow-mcptypes-protocol-types"><code>mcp.types</code> - Protocol Types<a class="headerlink" href="#01-mcp-workflow-mcptypes-protocol-types" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.types</p>
<h4 id="01-mcp-workflow-definition_5">Definition:<a class="headerlink" href="#01-mcp-workflow-definition_5" title="Permanent link">&para;</a></h4>
<ul>
<li>MCP protocol type definitions for structured data</li>
</ul>
<h4 id="01-mcp-workflow-why_5">Why:<a class="headerlink" href="#01-mcp-workflow-why_5" title="Permanent link">&para;</a></h4>
<ul>
<li>Type-safe definitions for all MCP primitives (tools, resources, prompts)</li>
</ul>
<h4 id="01-mcp-workflow-usage_5">Usage:<a class="headerlink" href="#01-mcp-workflow-usage_5" title="Permanent link">&para;</a></h4>
<ul>
<li>Tool = executable functions, Resource = readable data, Prompt = templates, TextContent = text responses</li>
</ul>
</div>
<hr />
<h3 id="01-mcp-workflow-sys-system-functions"><code>sys</code> - System Functions<a class="headerlink" href="#01-mcp-workflow-sys-system-functions" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">sys</p>
<h4 id="01-mcp-workflow-definition_6">Definition:<a class="headerlink" href="#01-mcp-workflow-definition_6" title="Permanent link">&para;</a></h4>
<ul>
<li>System-specific parameters and functions</li>
</ul>
<h4 id="01-mcp-workflow-why_6">Why:<a class="headerlink" href="#01-mcp-workflow-why_6" title="Permanent link">&para;</a></h4>
<ul>
<li>Handle system exits, command-line arguments, and stdio streams</li>
</ul>
<h4 id="01-mcp-workflow-usage_6">Usage:<a class="headerlink" href="#01-mcp-workflow-usage_6" title="Permanent link">&para;</a></h4>
<ul>
<li><code>sys.exit()</code> for graceful shutdown, <code>sys.stdin</code>/<code>stdout</code> for I/O</li>
</ul>
</div>
<hr />
<h2 id="01-mcp-workflow-step-02-skeleton-code">Step 02: Skeleton Code<a class="headerlink" href="#01-mcp-workflow-step-02-skeleton-code" title="Permanent link">&para;</a></h2>
<h2 id="01-mcp-workflow-skeleton-01-imports">Skeleton 01: <code>Imports</code><a class="headerlink" href="#01-mcp-workflow-skeleton-01-imports" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Set thfollowing  imports inside the <code>my_mcp_server.py</code>:</p>
<p>```python</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
<span class="sd">Built step by step for learning purposes.</span>
<span class="sd">- Enables clients to get ready-to-use prompts</span>
<span class="sd">- Connects prompt templates to actual content</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</code></pre></div></td></tr></table></div>

</li>
<li>
<p>Defines the behavior of each prompt</p>
</li>
<li>
<p>Handlers make prompts functional</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</code></pre></div>

<p>from mcp.server.stdio import stdio_server
  from mcp.types import (
      Tool,
      Resource,
      Prompt,
      TextContent,
      ImageContent,
      EmbeddedResource,
  )
  import sys
  ```</p>
</li>
<li>
<p>Create the <code>requirements.txt</code> file with the following content:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#01-mcp-workflow-__codelineno-0-1"></a>mcp
</span></code></pre></div>
</li>
<li>
<p>Install the MCP library:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#01-mcp-workflow-__codelineno-1-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span></code></pre></div>
</li>
</ul>
<hr />
<h2 id="01-mcp-workflow-skeleton-02-class">Skeleton 02: <code>Class</code><a class="headerlink" href="#01-mcp-workflow-skeleton-02-class" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Add thislass definition after the imports in your <code>my_mcp_server.py</code> file:</p>
<p>```python
  class CompleteMCPServer:
      &ldquo;&rdquo;&rdquo;
      A comprehensive MCP Server implementation showcasing all 
      - Enables clients to get ready-to-use prompts
      - Connects prompt templates to actual content
      protocol features.</p>
<div class="codehilite"><pre><span></span><code><span class="n">This</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="nl">demonstrates:</span>

<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">initialization</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Tool</span><span class="w"> </span><span class="n">registration</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">execution</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Resource</span><span class="w"> </span><span class="n">management</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Prompt</span><span class="w"> </span><span class="n">templates</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">prompt</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Handlers</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">prompts</span><span class="w"> </span><span class="n">functional</span>

<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Request</span><span class="w"> </span><span class="n">handling</span>
<span class="s">&quot;&quot;&quot;</span>
</code></pre></div>

<p>``` </p>
</li>
</ul>
<hr />
<h2 id="01-mcp-workflow-skeleton-03-constructor">Skeleton 03: <code>Constructor</code><a class="headerlink" href="#01-mcp-workflow-skeleton-03-constructor" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-method__init__-constructor">Method<code>__init__</code> (Constructor)<a class="headerlink" href="#01-mcp-workflow-method__init__-constructor" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="nv">Initializes</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">MCP</span><span class="w"> </span><span class="nv">Server</span><span class="w"> </span><span class="nv">instance</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Creates</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">server</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">version</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Sets</span><span class="w"> </span><span class="nv">up</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">foundation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">MCP</span><span class="w"> </span><span class="nv">operations</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Enables</span><span class="w"> </span><span class="nv">clients</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">get</span><span class="w"> </span><span class="nv">ready</span><span class="o">-</span><span class="nv">to</span><span class="o">-</span><span class="nv">use</span><span class="w"> </span><span class="nv">prompts</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Connects</span><span class="w"> </span><span class="nv">prompt</span><span class="w"> </span><span class="nv">templates</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">actual</span><span class="w"> </span><span class="nv">content</span>
</code></pre></div>

<ul>
<li>Prepares data structures for tools, resources, and prompts</li>
</ul>
<p><strong>Why This Runs First:</strong></p>
<div class="codehilite"><pre><span></span><code>- Constructor must run before any other methods
- Creates the server object that all other methods will use
- Defines the behavior of each prompt
- Handlers make prompts functional
</code></pre></div>

<ul>
<li>No other operations can occur without this initialization</li>
<li>Sets up the basic state of the server</li>
</ul>
<hr />
<ul>
<li>Add this class definition after inside your <code>CompleteMCPServer</code> class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#01-mcp-workflow-__codelineno-2-1"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#01-mcp-workflow-__codelineno-2-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#01-mcp-workflow-__codelineno-2-3"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#01-mcp-workflow-__codelineno-2-4"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#01-mcp-workflow-__codelineno-2-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="01-mcp-workflow-code-break-down">Code break down:<a class="headerlink" href="#01-mcp-workflow-code-break-down" title="Permanent link">&para;</a></h3>
<ul>
<li><code>Server("complete-mcp-server")</code> creates the MCP server with a name</li>
<li><code>self.data_store = {}</code> creates an empty dictionary for storing data</li>
<li>This object will be used throughout all other methods</li>
</ul>
<hr />
<h2 id="01-mcp-workflow-skeleton-04-register-tools">Skeleton 04: Register Tools<a class="headerlink" href="#01-mcp-workflow-skeleton-04-register-tools" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-methodregister_tools">Method<code>register_tools</code><a class="headerlink" href="#01-mcp-workflow-methodregister_tools" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">Registers</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">MCP</span><span class="w"> </span><span class="n">server</span>
<span class="o">-</span><span class="w"> </span><span class="n">Defines</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="n">schemas</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Makes</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">discoverable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">clients</span>
<span class="o">-</span><span class="w"> </span><span class="n">Enables</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">ready</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">use</span><span class="w"> </span><span class="n">prompts</span>
<span class="o">-</span><span class="w"> </span><span class="n">Connects</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="n">templates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">content</span>
</code></pre></div>

<ul>
<li>Sets up the tool execution infrastructure</li>
</ul>
<p><strong>Why This Runs Second:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">initialization</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">available</span>
<span class="o">-</span><span class="w"> </span><span class="n">Defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">prompt</span>
<span class="o">-</span><span class="w"> </span><span class="n">Handlers</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">prompts</span><span class="w"> </span><span class="n">functional</span>
</code></pre></div>

<ul>
<li>Tools must be registered before they can be called</li>
<li>Defines the capabilities clients can invoke</li>
</ul>
<p><strong>What is a Tool?</strong></p>
<ul>
<li>A tool is an executable function that clients can invoke. </li>
<li>Think of it like an API endpoint that performs an action.</li>
<li>Tools have names, descriptions, and input parameters.</li>
<li>Clients can discover and call these tools to perform operations.</li>
<li>Examples: calculator, data storage, text processing</li>
<li>Tools are central to MCP&rsquo;s functionality.</li>
</ul>
<hr />
<ul>
<li>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#01-mcp-workflow-__codelineno-3-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#01-mcp-workflow-__codelineno-3-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#01-mcp-workflow-__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#01-mcp-workflow-__codelineno-3-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#01-mcp-workflow-__codelineno-3-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#01-mcp-workflow-__codelineno-3-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#01-mcp-workflow-__codelineno-3-7"></a><span class="sd">        Return the list of available tools.</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#01-mcp-workflow-__codelineno-3-8"></a><span class="sd">        This is called when clients want to discover what tools are available.</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#01-mcp-workflow-__codelineno-3-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#01-mcp-workflow-__codelineno-3-10"></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#01-mcp-workflow-__codelineno-3-11"></a>            <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#01-mcp-workflow-__codelineno-3-12"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#01-mcp-workflow-__codelineno-3-13"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#01-mcp-workflow-__codelineno-3-14"></a>                <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#01-mcp-workflow-__codelineno-3-15"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#01-mcp-workflow-__codelineno-3-16"></a>                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#01-mcp-workflow-__codelineno-3-17"></a>                        <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#01-mcp-workflow-__codelineno-3-18"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#01-mcp-workflow-__codelineno-3-19"></a>                            <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#01-mcp-workflow-__codelineno-3-20"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#01-mcp-workflow-__codelineno-3-21"></a>                        <span class="p">},</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#01-mcp-workflow-__codelineno-3-22"></a>                        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#01-mcp-workflow-__codelineno-3-23"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#01-mcp-workflow-__codelineno-3-24"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#01-mcp-workflow-__codelineno-3-25"></a>                        <span class="p">},</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#01-mcp-workflow-__codelineno-3-26"></a>                        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#01-mcp-workflow-__codelineno-3-27"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#01-mcp-workflow-__codelineno-3-28"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#01-mcp-workflow-__codelineno-3-29"></a>                        <span class="p">}</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#01-mcp-workflow-__codelineno-3-30"></a>                    <span class="p">},</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#01-mcp-workflow-__codelineno-3-31"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#01-mcp-workflow-__codelineno-3-32"></a>                <span class="p">}</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#01-mcp-workflow-__codelineno-3-33"></a>            <span class="p">),</span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#01-mcp-workflow-__codelineno-3-34"></a>            <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#01-mcp-workflow-__codelineno-3-35"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#01-mcp-workflow-__codelineno-3-36"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#01-mcp-workflow-__codelineno-3-37"></a>                <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#01-mcp-workflow-__codelineno-3-38"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#01-mcp-workflow-__codelineno-3-39"></a>                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#01-mcp-workflow-__codelineno-3-40"></a>                        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#01-mcp-workflow-__codelineno-3-41"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#01-mcp-workflow-__codelineno-3-42"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#01-mcp-workflow-__codelineno-3-43"></a>                        <span class="p">},</span>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#01-mcp-workflow-__codelineno-3-44"></a>                        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#01-mcp-workflow-__codelineno-3-45"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#01-mcp-workflow-__codelineno-3-46"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#01-mcp-workflow-__codelineno-3-47"></a>                        <span class="p">}</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#01-mcp-workflow-__codelineno-3-48"></a>                    <span class="p">},</span>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#01-mcp-workflow-__codelineno-3-49"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#01-mcp-workflow-__codelineno-3-50"></a>                <span class="p">}</span>
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#01-mcp-workflow-__codelineno-3-51"></a>            <span class="p">),</span>
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#01-mcp-workflow-__codelineno-3-52"></a>            <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#01-mcp-workflow-__codelineno-3-53"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#01-mcp-workflow-__codelineno-3-54"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#01-mcp-workflow-__codelineno-3-55"></a>                <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#01-mcp-workflow-__codelineno-3-56"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#01-mcp-workflow-__codelineno-3-57"></a>                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#01-mcp-workflow-__codelineno-3-58"></a>                        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#01-mcp-workflow-__codelineno-3-59"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#01-mcp-workflow-__codelineno-3-60"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#01-mcp-workflow-__codelineno-3-61"></a>                        <span class="p">}</span>
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#01-mcp-workflow-__codelineno-3-62"></a>                    <span class="p">},</span>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#01-mcp-workflow-__codelineno-3-63"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#01-mcp-workflow-__codelineno-3-64"></a>                <span class="p">}</span>
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#01-mcp-workflow-__codelineno-3-65"></a>            <span class="p">),</span>
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#01-mcp-workflow-__codelineno-3-66"></a>            <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67" href="#01-mcp-workflow-__codelineno-3-67"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68" href="#01-mcp-workflow-__codelineno-3-68"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69" href="#01-mcp-workflow-__codelineno-3-69"></a>                <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70" href="#01-mcp-workflow-__codelineno-3-70"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71" href="#01-mcp-workflow-__codelineno-3-71"></a>                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72" href="#01-mcp-workflow-__codelineno-3-72"></a>                        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73" href="#01-mcp-workflow-__codelineno-3-73"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74" href="#01-mcp-workflow-__codelineno-3-74"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75" href="#01-mcp-workflow-__codelineno-3-75"></a>                        <span class="p">}</span>
</span><span id="__span-3-76"><a id="__codelineno-3-76" name="__codelineno-3-76" href="#01-mcp-workflow-__codelineno-3-76"></a>                    <span class="p">},</span>
</span><span id="__span-3-77"><a id="__codelineno-3-77" name="__codelineno-3-77" href="#01-mcp-workflow-__codelineno-3-77"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-3-78"><a id="__codelineno-3-78" name="__codelineno-3-78" href="#01-mcp-workflow-__codelineno-3-78"></a>                <span class="p">}</span>
</span><span id="__span-3-79"><a id="__codelineno-3-79" name="__codelineno-3-79" href="#01-mcp-workflow-__codelineno-3-79"></a>            <span class="p">)</span>
</span><span id="__span-3-80"><a id="__codelineno-3-80" name="__codelineno-3-80" href="#01-mcp-workflow-__codelineno-3-80"></a>        <span class="p">]</span>
</span><span id="__span-3-81"><a id="__codelineno-3-81" name="__codelineno-3-81" href="#01-mcp-workflow-__codelineno-3-81"></a>
</span><span id="__span-3-82"><a id="__codelineno-3-82" name="__codelineno-3-82" href="#01-mcp-workflow-__codelineno-3-82"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.list_tools()</code> decorator registers a handler for tool listing</li>
<li>Each <code>Tool</code> object defines the tool&rsquo;s name, description, and input schema</li>
<li>The <code>inputSchema</code> uses JSON Schema format to validate inputs</li>
<li>When a client calls <code>list_tools()</code>, they get this list</li>
<li>This makes the tools discoverable and usable by clients</li>
</ul>
<h3 id="01-mcp-workflow-hands-on-exercise">Hands-On Exercise:<a class="headerlink" href="#01-mcp-workflow-hands-on-exercise" title="Permanent link">&para;</a></h3>
<ul>
<li>Add a new tool called <code>greeting</code> that takes a string input <code>name</code> and returns a greeting message.</li>
<li>Define its name, description, and input schema similar to the other tools.</li>
<li>Test it later when we implement tool handlers.</li>
<li>Hint: Use the existing tools as a reference for structure.</li>
<li>After adding, your <code>list_tools</code> method should include the new <code>greeting</code> tool.</li>
<li>This exercise helps you understand how to define and register new tools in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>💡 Solution for Greeting Tool</summary> 

  <div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#01-mcp-workflow-__codelineno-4-1"></a><span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#01-mcp-workflow-__codelineno-4-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;greeting&quot;</span><span class="p">,</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#01-mcp-workflow-__codelineno-4-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Return a greeting message for the given name&quot;</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#01-mcp-workflow-__codelineno-4-4"></a>    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#01-mcp-workflow-__codelineno-4-5"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#01-mcp-workflow-__codelineno-4-6"></a>        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#01-mcp-workflow-__codelineno-4-7"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#01-mcp-workflow-__codelineno-4-8"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#01-mcp-workflow-__codelineno-4-9"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The name to greet&quot;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#01-mcp-workflow-__codelineno-4-10"></a>            <span class="p">}</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#01-mcp-workflow-__codelineno-4-11"></a>        <span class="p">},</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#01-mcp-workflow-__codelineno-4-12"></a>        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#01-mcp-workflow-__codelineno-4-13"></a>    <span class="p">}</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#01-mcp-workflow-__codelineno-4-14"></a><span class="p">)</span>
</span></code></pre></div>
  </details>

<hr />
<h2 id="01-mcp-workflow-skeleton-05-tools-handlers">Skeleton 05: Tool(s) Handlers<a class="headerlink" href="#01-mcp-workflow-skeleton-05-tools-handlers" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-methodregister_tool_handlers">Method<code>register_tool_handlers</code><a class="headerlink" href="#01-mcp-workflow-methodregister_tool_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">Implements</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="k">tool</span>
<span class="o">-</span><span class="w"> </span><span class="n">Handles</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">clients</span>
<span class="o">-</span><span class="w"> </span><span class="n">Processes</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">results</span>
<span class="o">-</span><span class="w"> </span><span class="n">Enables</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">ready</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">use</span><span class="w"> </span><span class="n">prompts</span>
<span class="o">-</span><span class="w"> </span><span class="n">Connects</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="n">templates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">content</span>
</code></pre></div>

<ul>
<li>Provides error handling for tool execution</li>
<li>Enables dynamic tool functionality</li>
</ul>
<p><strong>Why This Runs Third:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">registered</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="n">when</span><span class="w"> </span>
<span class="o">-</span><span class="w"> </span><span class="n">Defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">prompt</span>
<span class="o">-</span><span class="w"> </span><span class="n">Handlers</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">prompts</span><span class="w"> </span><span class="n">functional</span>
<span class="n">each</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">called</span>
</code></pre></div>

<ul>
<li><strong>Without handlers, tools are just definitions with no action</strong></li>
<li>Tools need implementation before they can be executed</li>
<li>Connects tool schemas to actual functionality</li>
<li>Defines the behavior of each tool</li>
<li>Handlers make tools operational</li>
<li>Clients rely on these handlers to perform tasks</li>
<li>This is where the server&rsquo;s capabilities come to life</li>
<li>Handlers are essential for a functional MCP server</li>
<li>They bridge the gap between tool definition and execution</li>
</ul>
<hr />
<ul>
<li>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#01-mcp-workflow-__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#01-mcp-workflow-__codelineno-5-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#01-mcp-workflow-__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#01-mcp-workflow-__codelineno-5-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#01-mcp-workflow-__codelineno-5-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#01-mcp-workflow-__codelineno-5-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#01-mcp-workflow-__codelineno-5-7"></a><span class="sd">        Handle tool execution requests.</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#01-mcp-workflow-__codelineno-5-8"></a><span class="sd">        This is called when a client wants to execute a tool.</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#01-mcp-workflow-__codelineno-5-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#01-mcp-workflow-__codelineno-5-10"></a>        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#01-mcp-workflow-__codelineno-5-11"></a>            <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#01-mcp-workflow-__codelineno-5-12"></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#01-mcp-workflow-__codelineno-5-13"></a>            <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#01-mcp-workflow-__codelineno-5-14"></a>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#01-mcp-workflow-__codelineno-5-15"></a>            <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#01-mcp-workflow-__codelineno-5-16"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#01-mcp-workflow-__codelineno-5-17"></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#01-mcp-workflow-__codelineno-5-18"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#01-mcp-workflow-__codelineno-5-19"></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#01-mcp-workflow-__codelineno-5-20"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#01-mcp-workflow-__codelineno-5-21"></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#01-mcp-workflow-__codelineno-5-22"></a>                <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#01-mcp-workflow-__codelineno-5-23"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#01-mcp-workflow-__codelineno-5-24"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#01-mcp-workflow-__codelineno-5-25"></a>                        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#01-mcp-workflow-__codelineno-5-26"></a>                    <span class="p">)]</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#01-mcp-workflow-__codelineno-5-27"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#01-mcp-workflow-__codelineno-5-28"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#01-mcp-workflow-__codelineno-5-29"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#01-mcp-workflow-__codelineno-5-30"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#01-mcp-workflow-__codelineno-5-31"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#01-mcp-workflow-__codelineno-5-32"></a>                <span class="p">)]</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#01-mcp-workflow-__codelineno-5-33"></a>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#01-mcp-workflow-__codelineno-5-34"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#01-mcp-workflow-__codelineno-5-35"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#01-mcp-workflow-__codelineno-5-36"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#01-mcp-workflow-__codelineno-5-37"></a>            <span class="p">)]</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#01-mcp-workflow-__codelineno-5-38"></a>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#01-mcp-workflow-__codelineno-5-39"></a>        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#01-mcp-workflow-__codelineno-5-40"></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#01-mcp-workflow-__codelineno-5-41"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#01-mcp-workflow-__codelineno-5-42"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#01-mcp-workflow-__codelineno-5-43"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#01-mcp-workflow-__codelineno-5-44"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#01-mcp-workflow-__codelineno-5-45"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#01-mcp-workflow-__codelineno-5-46"></a>            <span class="p">)]</span>
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#01-mcp-workflow-__codelineno-5-47"></a>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#01-mcp-workflow-__codelineno-5-48"></a>        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#01-mcp-workflow-__codelineno-5-49"></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#01-mcp-workflow-__codelineno-5-50"></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#01-mcp-workflow-__codelineno-5-51"></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#01-mcp-workflow-__codelineno-5-52"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#01-mcp-workflow-__codelineno-5-53"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#01-mcp-workflow-__codelineno-5-54"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#01-mcp-workflow-__codelineno-5-55"></a>                <span class="p">)]</span>
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#01-mcp-workflow-__codelineno-5-56"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#01-mcp-workflow-__codelineno-5-57"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#01-mcp-workflow-__codelineno-5-58"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#01-mcp-workflow-__codelineno-5-59"></a>            <span class="p">)]</span>
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#01-mcp-workflow-__codelineno-5-60"></a>
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#01-mcp-workflow-__codelineno-5-61"></a>        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-5-62"><a id="__codelineno-5-62" name="__codelineno-5-62" href="#01-mcp-workflow-__codelineno-5-62"></a>            <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-5-63"><a id="__codelineno-5-63" name="__codelineno-5-63" href="#01-mcp-workflow-__codelineno-5-63"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-5-64"><a id="__codelineno-5-64" name="__codelineno-5-64" href="#01-mcp-workflow-__codelineno-5-64"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-65"><a id="__codelineno-5-65" name="__codelineno-5-65" href="#01-mcp-workflow-__codelineno-5-65"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-5-66"><a id="__codelineno-5-66" name="__codelineno-5-66" href="#01-mcp-workflow-__codelineno-5-66"></a>            <span class="p">)]</span>
</span><span id="__span-5-67"><a id="__codelineno-5-67" name="__codelineno-5-67" href="#01-mcp-workflow-__codelineno-5-67"></a>
</span><span id="__span-5-68"><a id="__codelineno-5-68" name="__codelineno-5-68" href="#01-mcp-workflow-__codelineno-5-68"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-5-69"><a id="__codelineno-5-69" name="__codelineno-5-69" href="#01-mcp-workflow-__codelineno-5-69"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-5-70"><a id="__codelineno-5-70" name="__codelineno-5-70" href="#01-mcp-workflow-__codelineno-5-70"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-71"><a id="__codelineno-5-71" name="__codelineno-5-71" href="#01-mcp-workflow-__codelineno-5-71"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-5-72"><a id="__codelineno-5-72" name="__codelineno-5-72" href="#01-mcp-workflow-__codelineno-5-72"></a>            <span class="p">)]</span>
</span><span id="__span-5-73"><a id="__codelineno-5-73" name="__codelineno-5-73" href="#01-mcp-workflow-__codelineno-5-73"></a>
</span><span id="__span-5-74"><a id="__codelineno-5-74" name="__codelineno-5-74" href="#01-mcp-workflow-__codelineno-5-74"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.call_tool()</code> decorator registers the execution handler</li>
<li>Each tool&rsquo;s logic is in an <code>if/elif</code> block</li>
<li>Results are wrapped in <code>TextContent</code> objects</li>
<li>Error handling is included for edge cases (like division by zero)</li>
<li>When a client calls a tool, this handler processes the request and returns the output</li>
<li>This makes the tools functional and usable by clients</li>
</ul>
<hr />
<h3 id="01-mcp-workflow-hands-on-exercise_1">Hands-On Exercise:<a class="headerlink" href="#01-mcp-workflow-hands-on-exercise_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Implement the handler logic for the <code>greeting</code> tool you added earlier.</li>
<li>The tool should take the <code>name</code> parameter and return a greeting message like &ldquo;Hello, {name}!&rdquo;.</li>
<li>Test it later when we run the server.</li>
<li>Hint: Follow the structure of the other tool handlers.</li>
<li>After adding, your <code>call_tool</code> method should include the new <code>greeting</code> tool logic.</li>
<li>This exercise helps you understand how to implement tool functionality in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Greeting Tool Handler</summary> 

  <div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#01-mcp-workflow-__codelineno-6-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;greeting&quot;</span><span class="p">:</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#01-mcp-workflow-__codelineno-6-2"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#01-mcp-workflow-__codelineno-6-3"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#01-mcp-workflow-__codelineno-6-4"></a>        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#01-mcp-workflow-__codelineno-6-5"></a>        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#01-mcp-workflow-__codelineno-6-6"></a>    <span class="p">)]</span>
</span></code></pre></div>
  </details>

<hr />
<h2 id="01-mcp-workflow-skeleton-06-register-resources">Skeleton 06: Register Resources<a class="headerlink" href="#01-mcp-workflow-skeleton-06-register-resources" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-methodregister_resources">Method<code>register_resources</code><a class="headerlink" href="#01-mcp-workflow-methodregister_resources" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code>- Registers resources that clients can access
- Defines resource URIs and metadata
- Makes static and dynamic content available
- Enables clients to get ready-to-use prompts
- Connects prompt templates to actual content
</code></pre></div>

<ul>
<li>Enables resource discovery and retrieval</li>
<li>
<p>Provides additional data for clients</p>
<ul>
<li>Supports richer interactions with the server</li>
<li>Expands server capabilities beyond tools</li>
<li>Facilitates data sharing and information access</li>
</ul>
</li>
<li>
<p>Defines the behavior of each prompt</p>
</li>
<li>Handlers make prompts functional</li>
</ul>
<p><strong>Why This Runs Fourth:</strong></p>
<ul>
<li>After tools are set up, we add resources which provide additional data</li>
<li>Resources are complementary to tools</li>
<li>Provides data that tools might reference</li>
</ul>
<p><strong>What is a Resource?</strong></p>
<ul>
<li>A resource is readable data or content. </li>
<li>Think of it like a file or endpoint you can read from (but not execute).</li>
<li>Resources have URIs (like URLs) and metadata (name, description, MIME type).</li>
<li>Clients can discover and read these resources.</li>
<li>Examples: server info, data store contents, welcome message</li>
<li>Resources enhance the server&rsquo;s functionality by providing static or dynamic data.</li>
</ul>
<hr />
<ul>
<li>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#01-mcp-workflow-__codelineno-7-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#01-mcp-workflow-__codelineno-7-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register resources that clients can access.&quot;&quot;&quot;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#01-mcp-workflow-__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#01-mcp-workflow-__codelineno-7-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#01-mcp-workflow-__codelineno-7-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#01-mcp-workflow-__codelineno-7-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#01-mcp-workflow-__codelineno-7-7"></a><span class="sd">        Return the list of available resources.</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#01-mcp-workflow-__codelineno-7-8"></a><span class="sd">        This is called when clients want to discover what resources are available.</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#01-mcp-workflow-__codelineno-7-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#01-mcp-workflow-__codelineno-7-10"></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#01-mcp-workflow-__codelineno-7-11"></a>            <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#01-mcp-workflow-__codelineno-7-12"></a>                <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#01-mcp-workflow-__codelineno-7-13"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#01-mcp-workflow-__codelineno-7-14"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#01-mcp-workflow-__codelineno-7-15"></a>                <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#01-mcp-workflow-__codelineno-7-16"></a>            <span class="p">),</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#01-mcp-workflow-__codelineno-7-17"></a>            <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#01-mcp-workflow-__codelineno-7-18"></a>                <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://data-store&quot;</span><span class="p">,</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#01-mcp-workflow-__codelineno-7-19"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Store&quot;</span><span class="p">,</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#01-mcp-workflow-__codelineno-7-20"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current contents of the data store&quot;</span><span class="p">,</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#01-mcp-workflow-__codelineno-7-21"></a>                <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#01-mcp-workflow-__codelineno-7-22"></a>            <span class="p">),</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#01-mcp-workflow-__codelineno-7-23"></a>            <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#01-mcp-workflow-__codelineno-7-24"></a>                <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://welcome&quot;</span><span class="p">,</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#01-mcp-workflow-__codelineno-7-25"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Welcome Message&quot;</span><span class="p">,</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#01-mcp-workflow-__codelineno-7-26"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Welcome message and server capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#01-mcp-workflow-__codelineno-7-27"></a>                <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#01-mcp-workflow-__codelineno-7-28"></a>            <span class="p">)</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#01-mcp-workflow-__codelineno-7-29"></a>        <span class="p">]</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#01-mcp-workflow-__codelineno-7-30"></a>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#01-mcp-workflow-__codelineno-7-31"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources registered: server-info, data-store, welcome&quot;</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.list_resources()</code> decorator registers the resource listing handler</li>
<li>Each <code>Resource</code> defines a URI (like a URL), name, description, and MIME type</li>
<li>URIs use the <code>resource://</code> scheme to identify resources</li>
<li>When a client calls <code>list_resources()</code>, they get this list</li>
<li>This makes the resources discoverable and accessible by clients</li>
<li>Resources provide additional data that clients can read </li>
<li>Enhances the server&rsquo;s capabilities beyond just tools</li>
</ul>
<hr />
<h3 id="01-mcp-workflow-hands-on-exercise_2">Hands-On Exercise:<a class="headerlink" href="#01-mcp-workflow-hands-on-exercise_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Add a new resource called <code>server-author</code> that return your name as the author of the server.</li>
<li>Define its URI, name, description, and MIME type similar to the other resources.</li>
<li>Test it later when we implement resource handlers.</li>
<li>Hint: Use the existing resources as a reference for structure.</li>
<li>After adding, your <code>list_resources</code> method should include the new <code>server-author</code> resource.</li>
<li>This exercise helps you understand how to define and register new resources in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Server Stats Resource</summary> 

  <div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#01-mcp-workflow-__codelineno-8-1"></a><span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#01-mcp-workflow-__codelineno-8-2"></a>    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-author&quot;</span><span class="p">,</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#01-mcp-workflow-__codelineno-8-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Author&quot;</span><span class="p">,</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#01-mcp-workflow-__codelineno-8-4"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Author of the MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#01-mcp-workflow-__codelineno-8-5"></a>    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#01-mcp-workflow-__codelineno-8-6"></a><span class="p">)</span>
</span></code></pre></div>
  </details>

<hr />
<h2 id="01-mcp-workflow-skeleton-07-resource-handlers">Skeleton 07: Resource Handlers<a class="headerlink" href="#01-mcp-workflow-skeleton-07-resource-handlers" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-methodregister_resource_handlers">Method<code>register_resource_handlers</code><a class="headerlink" href="#01-mcp-workflow-methodregister_resource_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="nv">Implements</span><span class="w"> </span><span class="nv">resource</span><span class="w"> </span><span class="nv">retrieval</span><span class="w"> </span><span class="nv">logic</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Returns</span><span class="w"> </span><span class="nv">actual</span><span class="w"> </span><span class="nv">content</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">each</span><span class="w"> </span><span class="nv">resource</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Handles</span><span class="w"> </span><span class="nv">dynamic</span><span class="w"> </span><span class="nv">resource</span><span class="w"> </span><span class="nv">generation</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Enables</span><span class="w"> </span><span class="nv">clients</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">get</span><span class="w"> </span><span class="nv">ready</span><span class="o">-</span><span class="nv">to</span><span class="o">-</span><span class="nv">use</span><span class="w"> </span><span class="nv">prompts</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Connects</span><span class="w"> </span><span class="nv">prompt</span><span class="w"> </span><span class="nv">templates</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">actual</span><span class="w"> </span><span class="nv">content</span>
</code></pre></div>

<ul>
<li>Provides resource access control</li>
<li>
<p>Enables clients to read server data</p>
<ul>
<li>Supports various content types (JSON, text)</li>
<li>Facilitates data sharing with clients</li>
<li>Connects resource definitions to actual data</li>
<li>Enhances server usability and information access</li>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
</ul>
</li>
</ul>
<p><strong>Why This Runs Fifth:</strong></p>
<ul>
<li>After resources are registered, we need to implement what content is returned</li>
<li>Resources need implementation to return actual data</li>
<li>Connects resource URIs to actual content</li>
<li>Defines the behavior of each resource</li>
<li>Handlers make resources accessible</li>
<li>Clients rely on these handlers to read data</li>
<li>This is where resource definitions become functional</li>
<li>Handlers are essential for a usable MCP server</li>
<li>They bridge the gap between resource definition and content delivery</li>
<li>Without handlers, resources are just placeholders with no data</li>
<li>Handlers bring resources to life</li>
</ul>
<hr />
<ul>
<li>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#01-mcp-workflow-__codelineno-9-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_resource_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#01-mcp-workflow-__codelineno-9-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement resource retrieval logic.&quot;&quot;&quot;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#01-mcp-workflow-__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#01-mcp-workflow-__codelineno-9-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#01-mcp-workflow-__codelineno-9-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#01-mcp-workflow-__codelineno-9-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#01-mcp-workflow-__codelineno-9-7"></a><span class="sd">        Handle resource read requests.</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#01-mcp-workflow-__codelineno-9-8"></a><span class="sd">        This is called when a client wants to read a resource.</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#01-mcp-workflow-__codelineno-9-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#01-mcp-workflow-__codelineno-9-10"></a>        <span class="k">if</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span><span class="p">:</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#01-mcp-workflow-__codelineno-9-11"></a>            <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#01-mcp-workflow-__codelineno-9-12"></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#01-mcp-workflow-__codelineno-9-13"></a>                <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#01-mcp-workflow-__codelineno-9-14"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A comprehensive MCP server implementation&quot;</span><span class="p">,</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#01-mcp-workflow-__codelineno-9-15"></a>                <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#01-mcp-workflow-__codelineno-9-16"></a>                    <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#01-mcp-workflow-__codelineno-9-17"></a>                    <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#01-mcp-workflow-__codelineno-9-18"></a>                    <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#01-mcp-workflow-__codelineno-9-19"></a>                <span class="p">}</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#01-mcp-workflow-__codelineno-9-20"></a>            <span class="p">}</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#01-mcp-workflow-__codelineno-9-21"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#01-mcp-workflow-__codelineno-9-22"></a>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#01-mcp-workflow-__codelineno-9-23"></a>        <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://data-store&quot;</span><span class="p">:</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#01-mcp-workflow-__codelineno-9-24"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#01-mcp-workflow-__codelineno-9-25"></a>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#01-mcp-workflow-__codelineno-9-26"></a>        <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://welcome&quot;</span><span class="p">:</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#01-mcp-workflow-__codelineno-9-27"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;&quot;Welcome to the Complete MCP Server!</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.read_resource()</code> decorator registers the read handler</li>
<li>Each resource URI returns appropriate content</li>
<li>JSON resources use <code>json.dumps()</code> to serialize data</li>
<li>Plain text resources return strings directly</li>
<li>When a client reads a resource, this handler processes the request and returns the content</li>
<li>This makes the resources functional and usable by clients</li>
</ul>
<hr />
<h3 id="01-mcp-workflow-hands-on-exercise_3">Hands-On Exercise:<a class="headerlink" href="#01-mcp-workflow-hands-on-exercise_3" title="Permanent link">&para;</a></h3>
<ul>
<li>Implement the handler logic for the <code>server-author</code> resource you added earlier.</li>
<li>The resource should return your name as plain text.</li>
<li>Test it later when we run the server.</li>
<li>Hint: Follow the structure of the other resource handlers.</li>
<li>After adding, your <code>read_resource</code> method should include the new <code>server-author</code> resource logic.</li>
<li>This exercise helps you understand how to implement resource functionality in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Server Author Resource Handler</summary> 

  <div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#01-mcp-workflow-__codelineno-10-1"></a><span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://server-author&quot;</span><span class="p">:</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#01-mcp-workflow-__codelineno-10-2"></a>    <span class="k">return</span> <span class="s2">&quot;Author: Your Name Here&quot;</span>
</span></code></pre></div>
  </details>

<hr />
<h3 id="01-mcp-workflow-handle-errors">Handle Errors<a class="headerlink" href="#01-mcp-workflow-handle-errors" title="Permanent link">&para;</a></h3>
<ul>
<li>Add Error Handling for Unknown Resources</li>
<li>
<p>Add this at the end of the <code>read_resource</code> method to handle unknown resources:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#01-mcp-workflow-__codelineno-11-1"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#01-mcp-workflow-__codelineno-11-2"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<h2 id="01-mcp-workflow-skeleton-08-register-prompts">Skeleton 08: Register Prompts<a class="headerlink" href="#01-mcp-workflow-skeleton-08-register-prompts" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-method-register_prompts">Method <code>register_prompts</code><a class="headerlink" href="#01-mcp-workflow-method-register_prompts" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Registers prompt templates for clients</li>
<li>Defines structured prompts with parameters</li>
<li>Enables prompt discovery</li>
<li>Enables clients to get ready-to-use prompts</li>
<li>Connects prompt templates to actual content</li>
<li>Provides reusable prompt patterns</li>
<li>Facilitates advanced AI interactions</li>
<li>Supports dynamic prompt generation</li>
</ul>
<p><strong>Why This Runs Sixth:</strong></p>
<ul>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
<li>After tools and resources, prompts add higher-level interaction patterns</li>
<li>Prompts build on available tools and resources</li>
<li>Provides templates for AI assistants</li>
</ul>
<p><strong>What is a Prompt?</strong></p>
<ul>
<li>A prompt is a template that guides AI assistants on how to use the server&rsquo;s tools and resources effectively.</li>
<li>Prompts have names, descriptions, and parameters.</li>
<li>Clients can discover and request prompts.</li>
<li>Examples: code review prompt, data analysis prompt</li>
<li>Prompts enhance the server&rsquo;s capabilities by providing structured interaction patterns.</li>
</ul>
<hr />
<ul>
<li>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#01-mcp-workflow-__codelineno-12-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_prompts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#01-mcp-workflow-__codelineno-12-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register prompt templates for clients.&quot;&quot;&quot;</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#01-mcp-workflow-__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#01-mcp-workflow-__codelineno-12-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_prompts</span><span class="p">()</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#01-mcp-workflow-__codelineno-12-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_prompts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Prompt</span><span class="p">]:</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#01-mcp-workflow-__codelineno-12-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#01-mcp-workflow-__codelineno-12-7"></a><span class="sd">        Return the list of available prompts.</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#01-mcp-workflow-__codelineno-12-8"></a><span class="sd">        This is called when clients want to discover what prompts are available.</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#01-mcp-workflow-__codelineno-12-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#01-mcp-workflow-__codelineno-12-10"></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#01-mcp-workflow-__codelineno-12-11"></a>            <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#01-mcp-workflow-__codelineno-12-12"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analyze-data&quot;</span><span class="p">,</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#01-mcp-workflow-__codelineno-12-13"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze data stored in the server&quot;</span><span class="p">,</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#01-mcp-workflow-__codelineno-12-14"></a>                <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#01-mcp-workflow-__codelineno-12-15"></a>                    <span class="p">{</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#01-mcp-workflow-__codelineno-12-16"></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#01-mcp-workflow-__codelineno-12-17"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key of the data to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#01-mcp-workflow-__codelineno-12-18"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#01-mcp-workflow-__codelineno-12-19"></a>                    <span class="p">}</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#01-mcp-workflow-__codelineno-12-20"></a>                <span class="p">]</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#01-mcp-workflow-__codelineno-12-21"></a>            <span class="p">),</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#01-mcp-workflow-__codelineno-12-22"></a>            <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#01-mcp-workflow-__codelineno-12-23"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate-scenario&quot;</span><span class="p">,</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#01-mcp-workflow-__codelineno-12-24"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Walk through a calculation scenario&quot;</span><span class="p">,</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#01-mcp-workflow-__codelineno-12-25"></a>                <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#01-mcp-workflow-__codelineno-12-26"></a>                    <span class="p">{</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#01-mcp-workflow-__codelineno-12-27"></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;operation&quot;</span><span class="p">,</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#01-mcp-workflow-__codelineno-12-28"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to demonstrate (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#01-mcp-workflow-__codelineno-12-29"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#01-mcp-workflow-__codelineno-12-30"></a>                    <span class="p">}</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#01-mcp-workflow-__codelineno-12-31"></a>                <span class="p">]</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#01-mcp-workflow-__codelineno-12-32"></a>            <span class="p">)</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#01-mcp-workflow-__codelineno-12-33"></a>        <span class="p">]</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#01-mcp-workflow-__codelineno-12-34"></a>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#01-mcp-workflow-__codelineno-12-35"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompts registered: analyze-data, calculate-scenario&quot;</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.list_prompts()</code> decorator registers the prompt listing handler</li>
<li>Each <code>Prompt</code> defines a name, description, and arguments</li>
<li>Arguments specify what parameters the prompt template needs</li>
<li>When a client calls <code>list_prompts()</code>, they get this list</li>
<li>This makes the prompts discoverable and usable by clients</li>
<li>Prompts provide structured templates for AI interactions</li>
</ul>
<hr />
<h3 id="01-mcp-workflow-hands-on-exercise_4">Hands-On Exercise:<a class="headerlink" href="#01-mcp-workflow-hands-on-exercise_4" title="Permanent link">&para;</a></h3>
<ul>
<li>Add a new prompt called <code>greet-user</code> that prompts the AI to greet a user by name.</li>
<li>Define its name, description, and arguments similar to the other prompts.</li>
<li>Test it later when we implement prompt handlers.</li>
<li>Hint: Use the existing prompts as a reference for structure.</li>
<li>After adding, your <code>list_prompts</code> method should include the new <code>greet-user</code> prompt.</li>
<li>This exercise helps you understand how to define and register new prompts in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Greet User Prompt</summary> 

  <div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#01-mcp-workflow-__codelineno-13-1"></a><span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#01-mcp-workflow-__codelineno-13-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;greet-user&quot;</span><span class="p">,</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#01-mcp-workflow-__codelineno-13-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Prompt the AI to greet a user by name&quot;</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#01-mcp-workflow-__codelineno-13-4"></a>    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#01-mcp-workflow-__codelineno-13-5"></a>        <span class="p">{</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#01-mcp-workflow-__codelineno-13-6"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#01-mcp-workflow-__codelineno-13-7"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of the user to greet&quot;</span><span class="p">,</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#01-mcp-workflow-__codelineno-13-8"></a>            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#01-mcp-workflow-__codelineno-13-9"></a>        <span class="p">}</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#01-mcp-workflow-__codelineno-13-10"></a>    <span class="p">]</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#01-mcp-workflow-__codelineno-13-11"></a><span class="p">)</span>
</span></code></pre></div>
  </details>

<hr />
<h2 id="01-mcp-workflow-skeleton-09-prompt-handlers">Skeleton 09: Prompt Handlers<a class="headerlink" href="#01-mcp-workflow-skeleton-09-prompt-handlers" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-method-register_prompt_handlers">Method: <code>register_prompt_handlers</code><a class="headerlink" href="#01-mcp-workflow-method-register_prompt_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Implements prompt generation logic</li>
<li>Returns formatted prompts with embedded context</li>
<li>Handles prompt parameters and customization</li>
<li>Provides dynamic prompt content</li>
<li>Enables clients to get ready-to-use prompts</li>
<li>Connects prompt templates to actual content</li>
</ul>
<p><strong>Why This Runs Seventh:</strong></p>
<ul>
<li>After prompts are registered, we implement the logic that generates prompt content</li>
<li>Prompts need implementation to generate actual text</li>
<li>Connects prompt templates to actual content</li>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
</ul>
<hr />
<ul>
<li>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#01-mcp-workflow-__codelineno-14-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_prompt_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#01-mcp-workflow-__codelineno-14-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement prompt generation logic.&quot;&quot;&quot;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#01-mcp-workflow-__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#01-mcp-workflow-__codelineno-14-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">get_prompt</span><span class="p">()</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#01-mcp-workflow-__codelineno-14-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prompt</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#01-mcp-workflow-__codelineno-14-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#01-mcp-workflow-__codelineno-14-7"></a><span class="sd">        Handle prompt generation requests.</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#01-mcp-workflow-__codelineno-14-8"></a><span class="sd">        This is called when a client wants to get a prompt.</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#01-mcp-workflow-__codelineno-14-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#01-mcp-workflow-__codelineno-14-10"></a>        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;analyze-data&quot;</span><span class="p">:</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#01-mcp-workflow-__codelineno-14-11"></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#01-mcp-workflow-__codelineno-14-12"></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;not found&quot;</span><span class="p">)</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#01-mcp-workflow-__codelineno-14-13"></a>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#01-mcp-workflow-__codelineno-14-14"></a>            <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Analyze the following data from the server:</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#01-mcp-workflow-__codelineno-14-15"></a>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#01-mcp-workflow-__codelineno-14-16"></a><span class="s2">Key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#01-mcp-workflow-__codelineno-14-17"></a><span class="s2">Value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#01-mcp-workflow-__codelineno-14-18"></a>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#01-mcp-workflow-__codelineno-14-19"></a><span class="s2">Please provide:</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#01-mcp-workflow-__codelineno-14-20"></a><span class="s2">1. A description of what this data represents</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#01-mcp-workflow-__codelineno-14-21"></a><span class="s2">2. Any patterns or insights you notice</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#01-mcp-workflow-__codelineno-14-22"></a><span class="s2">3. Suggestions for how this data could be used</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#01-mcp-workflow-__codelineno-14-23"></a>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#01-mcp-workflow-__codelineno-14-24"></a><span class="s2">Use the retrieve_data tool if you need to fetch additional context.&quot;&quot;&quot;</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#01-mcp-workflow-__codelineno-14-25"></a>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#01-mcp-workflow-__codelineno-14-26"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#01-mcp-workflow-__codelineno-14-27"></a>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#01-mcp-workflow-__codelineno-14-28"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate-scenario&quot;</span><span class="p">:</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#01-mcp-workflow-__codelineno-14-29"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;add&quot;</span><span class="p">)</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#01-mcp-workflow-__codelineno-14-30"></a>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#01-mcp-workflow-__codelineno-14-31"></a>                <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Let&#39;s work through a </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> calculation scenario.</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#01-mcp-workflow-__codelineno-14-32"></a>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#01-mcp-workflow-__codelineno-14-33"></a><span class="s2">Use the calculate tool with the operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;.</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#01-mcp-workflow-__codelineno-14-34"></a><span class="s2">For example:</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#01-mcp-workflow-__codelineno-14-35"></a><span class="s2">- Choose two numbers (a and b)</span>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#01-mcp-workflow-__codelineno-14-36"></a><span class="s2">- Execute: calculate(operation=&quot;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&quot;, a=10, b=5)</span>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#01-mcp-workflow-__codelineno-14-37"></a><span class="s2">- Explain the result</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#01-mcp-workflow-__codelineno-14-38"></a>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#01-mcp-workflow-__codelineno-14-39"></a><span class="s2">This demonstrates how to use computational tools in the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#01-mcp-workflow-__codelineno-14-40"></a>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41" href="#01-mcp-workflow-__codelineno-14-41"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42" href="#01-mcp-workflow-__codelineno-14-42"></a>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43" href="#01-mcp-workflow-__codelineno-14-43"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44" href="#01-mcp-workflow-__codelineno-14-44"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45" href="#01-mcp-workflow-__codelineno-14-45"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46" href="#01-mcp-workflow-__codelineno-14-46"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown prompt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47" href="#01-mcp-workflow-__codelineno-14-47"></a>                <span class="p">)]</span>
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48" href="#01-mcp-workflow-__codelineno-14-48"></a>
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49" href="#01-mcp-workflow-__codelineno-14-49"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompt handlers implemented&quot;</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.get_prompt()</code> decorator registers the prompt generation handler</li>
<li>Each prompt returns formatted text based on the parameters</li>
<li>Prompts can reference tools and resources</li>
<li>Dynamic content is generated based on current server state</li>
</ul>
<hr />
<h3 id="01-mcp-workflow-hands-on">Hands On:<a class="headerlink" href="#01-mcp-workflow-hands-on" title="Permanent link">&para;</a></h3>
<ul>
<li>Implement the handler logic for the <code>greet-user</code> prompt you added earlier.</li>
<li>The prompt should return a greeting message using the provided <code>name</code> parameter.</li>
<li>Test it later when we run the server.</li>
<li>Hint: Follow the structure of the other prompt handlers.</li>
<li>After adding, your <code>get_prompt</code> method should include the new <code>greet-user</code> prompt logic.</li>
<li>This exercise helps you understand how to implement prompt functionality in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Greet User Prompt Handler</summary> 

  <div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#01-mcp-workflow-__codelineno-15-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;greet-user&quot;</span><span class="p">:</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#01-mcp-workflow-__codelineno-15-2"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Guest&quot;</span><span class="p">)</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#01-mcp-workflow-__codelineno-15-3"></a>    <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">! Welcome to the Complete MCP Server. How can I assist you today?&quot;</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#01-mcp-workflow-__codelineno-15-4"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span></code></pre></div>
  </details>

<hr />
<h2 id="01-mcp-workflow-skeleton-10-lifecycle-handlers">Skeleton 10: Lifecycle Handlers<a class="headerlink" href="#01-mcp-workflow-skeleton-10-lifecycle-handlers" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-method-setup_lifecycle_handlers">Method: <code>setup_lifecycle_handlers</code><a class="headerlink" href="#01-mcp-workflow-method-setup_lifecycle_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Handles server initialization events</li>
<li>Manages server shutdown procedures</li>
<li>Logs server lifecycle events</li>
<li>Ensures clean startup and teardown</li>
<li>Enables clients to get ready-to-use prompts</li>
<li>Connects prompt templates to actual content</li>
<li>Maintains server stability and reliability</li>
</ul>
<p><strong>Why This Runs Eighth:</strong></p>
<ul>
<li>After all features are configured, we set up lifecycle management</li>
<li>Lifecycle handlers need complete server setup</li>
<li>Prepares server for actual runtime operations</li>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
<li>Ensures proper resource management during startup/shutdown</li>
<li>Critical for long-running server processes</li>
<li>Helps prevent resource leaks and data corruption</li>
</ul>
<p><strong>Why Servers Need Shutdown Procedures:</strong></p>
<ul>
<li>Release system resources (memory, file handles, connections)</li>
<li>Save any pending data or state to disk</li>
<li>Close network connections gracefully</li>
<li>Notify connected clients of server shutdown</li>
<li>Clean up temporary files and caches</li>
<li>Log final statistics and status</li>
<li>Prevent data corruption from abrupt termination</li>
<li>Allow pending operations to complete</li>
</ul>
<hr />
<ul>
<li>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#01-mcp-workflow-__codelineno-16-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">setup_lifecycle_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#01-mcp-workflow-__codelineno-16-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Setup lifecycle management (conceptual for MCP).&quot;&quot;&quot;</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#01-mcp-workflow-__codelineno-16-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lifecycle management configured&quot;</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>Note: MCP servers typically don&rsquo;t have explicit lifecycle hooks</li>
<li>This is a conceptual method showing where such logic would go</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul>
<li>You can implement custom startup/shutdown logic here if needed</li>
<li>Use this as a placeholder for lifecycle management        </li>
<li>The actual &ldquo;lifecycle&rdquo; of the server is managed implicitly by:</li>
<li><strong>Startup:</strong> When <code>asyncio.run(main())</code> is called and <code>server.run()</code> begins the event loop.</li>
<li><strong>Shutdown:</strong> When the process receives a signal (like <code>KeyboardInterrupt / Ctrl+C</code>), which is caught in the if <code>__name__ == "__main__":</code> block to exit gracefully.</li>
</ul>
</div>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>MCP servers use the standard Python lifecycle</li>
<li>Cleanup happens when the server process exits</li>
<li>You can use <code>try/except/finally</code> blocks in the main function for cleanup</li>
<li>This method is a placeholder for lifecycle logic</li>
<li>In real-world servers, you might add logging or resource management here</li>
<li>This prepares the server for stable operation</li>
<li>Enhances reliability during startup and shutdown</li>
<li>Critical for production-grade servers</li>
<li>Though MCP lacks explicit lifecycle hooks, this method indicates where such logic would be placed</li>
<li>It serves as a reminder to consider lifecycle management in server design</li>
<li>Helps maintain server health over long runtimes</li>
<li>Prepares for future enhancements that may introduce lifecycle events</li>
<li>Ensures the server is robust and reliable</li>
<li>Maintains server integrity during its lifecycle</li>
</ul>
<hr />
<h2 id="01-mcp-workflow-skeleton-11-run-the-server">Skeleton 11: Run the Server<a class="headerlink" href="#01-mcp-workflow-skeleton-11-run-the-server" title="Permanent link">&para;</a></h2>
<h3 id="01-mcp-workflow-method-run">Method: <code>run</code><a class="headerlink" href="#01-mcp-workflow-method-run" title="Permanent link">&para;</a></h3>
<ul>
<li>This is the final method to add to your class.</li>
<li>It starts the MCP server and begins listening for client requests.</li>
</ul>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Starts the MCP server</li>
<li>Connects to stdio transport</li>
<li>Begins listening for client requests</li>
<li>Runs the main event loop</li>
<li>Enables clients to get ready-to-use prompts</li>
<li>Connects prompt templates to actual content</li>
<li>Facilitates real-time client-server communication</li>
</ul>
<p><strong>Why This Runs Last:</strong></p>
<ul>
<li>All tools, resources, and prompts must be registered first</li>
<li>This starts the actual server operation</li>
<li>After this, the server is live and accepting requests</li>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
<li>This is the final step to make the server operational</li>
<li>Without this, the server would not run</li>
<li>This method initiates the event loop that processes requests</li>
<li>Critical for real-time interactions with clients</li>
</ul>
<hr />
<h4 id="01-mcp-workflow-how-does-mcp-server-start">How does MCP Server Start:<a class="headerlink" href="#01-mcp-workflow-how-does-mcp-server-start" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Create stdio transport:</strong> <code>stdio_server()</code></p>
<ul>
<li>Opens stdin (standard input) for receiving messages</li>
<li>Opens stdout (standard output) for sending responses</li>
</ul>
</li>
<li>
<p><strong>Run server with streams:</strong> <code>server.run(read_stream, write_stream)</code></p>
<ul>
<li>Listens on stdin for JSON-RPC messages from client</li>
<li>Sends JSON-RPC responses back on stdout</li>
</ul>
</li>
<li>
<p><strong>Event loop processes requests asynchronously</strong></p>
<ul>
<li>Handles multiple concurrent requests</li>
<li>Executes tools, returns resources, generates prompts</li>
</ul>
</li>
</ol>
<hr />
<h4 id="01-mcp-workflow-what-is-stdio-standard-inputoutput">What is STDIO (Standard Input/Output)?<a class="headerlink" href="#01-mcp-workflow-what-is-stdio-standard-inputoutput" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th style="text-align: left;">Component</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>stdio</strong></td>
<td style="text-align: left;">Standard Input/Output streams</td>
</tr>
<tr>
<td style="text-align: left;"><strong>stdin</strong></td>
<td style="text-align: left;">Channel for receiving data (keyboard, pipe)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>stdout</strong></td>
<td style="text-align: left;">Channel for sending data (screen, pipe)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Usage</strong></td>
<td style="text-align: left;">MCP uses stdio for client-server communication</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Flow</strong></td>
<td style="text-align: left;">Client stdin → Server stdout → Client</td>
</tr>
</tbody>
</table>
<h4 id="01-mcp-workflow-alternatives-to-stdio">Alternatives to STDIO:<a class="headerlink" href="#01-mcp-workflow-alternatives-to-stdio" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th style="text-align: left;">Component</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>HTTP/HTTPS</strong></td>
<td style="text-align: left;">Web-based API (REST or GraphQL)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>WebSockets</strong></td>
<td style="text-align: left;">Bidirectional real-time communication</td>
</tr>
<tr>
<td style="text-align: left;"><strong>gRPC</strong></td>
<td style="text-align: left;">High-performance RPC framework</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Unix Domain Sockets</strong></td>
<td style="text-align: left;">Local inter-process communication</td>
</tr>
<tr>
<td style="text-align: left;"><strong>TCP/IP Sockets</strong></td>
<td style="text-align: left;">Network communication</td>
</tr>
</tbody>
</table>
<p><strong>Why STDIO for MCP?</strong></p>
<ul>
<li>✓ Simple: No network configuration needed</li>
<li>✓ Secure: Stays within local process boundary</li>
<li>✓ Universal: Works on all operating systems</li>
<li>✓ Easy to integrate: Pipe to any process</li>
<li>✓ Lightweight: Minimal overhead for communication</li>
<li>✓ Ideal for local AI assistant integrations</li>
<li>✓ Fits well with command-line tools and scripts</li>
<li>✓ Perfect for development and testing</li>
<li>✓ Common in LSP (Language Server Protocol) implementations</li>
<li>✓ Easy to debug: View raw messages in terminal</li>
<li>✓ No firewall or network issues</li>
<li>✓ Works well with containerized environments</li>
</ul>
<p><strong>Async Event Loop Explained:</strong></p>
<ul>
<li>Event Loop: Central coordinator for async operations</li>
<li>Async/Await: Write concurrent code that looks sequential</li>
<li>Non-blocking: Server handles multiple requests simultaneously</li>
<li>Efficient: Uses single thread for many connections</li>
<li>Scalable: Easily handles growing workloads</li>
</ul>
<hr />
<p><strong>How It Works:</strong></p>
<ol>
<li>Event loop starts and waits for events (<code>messages</code>)</li>
<li>When message arrives, creates a Task to handle it</li>
<li>While waiting for I/O ( <code>tool execution</code>), processes other tasks</li>
<li>When task completes, <strong>sends response back to client</strong></li>
<li>Continues looping until server shuts down</li>
<li>This allows high concurrency with minimal threads</li>
</ol>
<p><strong>Benefits:</strong></p>
<ul>
<li>✓ Handle 1000s of connections with single thread</li>
<li>✓ No waiting: Process other requests during I/O</li>
<li>✓ Memory efficient: No thread per connection</li>
<li>✓ Scalable: Add more tasks without more threads</li>
<li>✓ Responsive: Quick handling of many clients</li>
<li>✓ Ideal for I/O-bound workloads (like MCP servers)</li>
<li>✓ Simplifies concurrency model</li>
<li>✓ Reduces complexity of multi-threaded code</li>
<li>✓ Easier to maintain and debug</li>
<li>✓ Leverages Python&rsquo;s async capabilities effectively</li>
</ul>
<hr />
<ul>
<li>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#01-mcp-workflow-__codelineno-17-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#01-mcp-workflow-__codelineno-17-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Start the MCP server and begin serving requests.&quot;&quot;&quot;</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#01-mcp-workflow-__codelineno-17-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting MCP server...&quot;</span><span class="p">)</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#01-mcp-workflow-__codelineno-17-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server is now running and ready to accept connections&quot;</span><span class="p">)</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#01-mcp-workflow-__codelineno-17-5"></a>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#01-mcp-workflow-__codelineno-17-6"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">stdio_server</span><span class="p">()</span> <span class="k">as</span> <span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">):</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#01-mcp-workflow-__codelineno-17-7"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#01-mcp-workflow-__codelineno-17-8"></a>            <span class="n">read_stream</span><span class="p">,</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#01-mcp-workflow-__codelineno-17-9"></a>            <span class="n">write_stream</span><span class="p">,</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#01-mcp-workflow-__codelineno-17-10"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">create_initialization_options</span><span class="p">()</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#01-mcp-workflow-__codelineno-17-11"></a>        <span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li><code>stdio_server()</code> creates the stdin/stdout transport</li>
<li><code>self.server.run()</code> starts the server event loop</li>
<li>The server now listens for JSON-RPC messages on stdin</li>
<li>Responses are sent back on stdout</li>
<li>The server can now handle tool calls, resource reads, and prompt requests</li>
<li>This is the final step to make the server operational</li>
<li>The server runs indefinitely until interrupted</li>
<li>Clients can now connect and interact with the server</li>
<li>This method is asynchronous, allowing concurrent request handling</li>
<li>The server is now live and ready for use</li>
</ul>
<hr />
<h2 id="01-mcp-workflow-skeleton-12-main-entry-point">Skeleton 12: Main / Entry Point<a class="headerlink" href="#01-mcp-workflow-skeleton-12-main-entry-point" title="Permanent link">&para;</a></h2>
<ul>
<li>Now we need to create the main function that orchestrates everything and the entry point that runs when the script is executed.</li>
<li>This is where we call all the setup methods in order and start the server.</li>
<li>This is the final piece to complete your MCP server implementation.</li>
<li>Let&rsquo;s add the main function and entry point.</li>
</ul>
<hr />
<ul>
<li>
<p>Add these functions at the end of your file (outside the class):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#01-mcp-workflow-__codelineno-18-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#01-mcp-workflow-__codelineno-18-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#01-mcp-workflow-__codelineno-18-3"></a><span class="sd">    Main entry point for the MCP server.</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#01-mcp-workflow-__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#01-mcp-workflow-__codelineno-18-5"></a><span class="sd">    This function orchestrates the complete server setup and execution:</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#01-mcp-workflow-__codelineno-18-6"></a><span class="sd">    1. Creates server instance (constructor)</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#01-mcp-workflow-__codelineno-18-7"></a><span class="sd">    2. Registers tools</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#01-mcp-workflow-__codelineno-18-8"></a><span class="sd">    3. Registers tool handlers</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#01-mcp-workflow-__codelineno-18-9"></a><span class="sd">    4. Registers resources</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#01-mcp-workflow-__codelineno-18-10"></a><span class="sd">    5. Registers resource handlers</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#01-mcp-workflow-__codelineno-18-11"></a><span class="sd">    6. Registers prompts</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#01-mcp-workflow-__codelineno-18-12"></a><span class="sd">    7. Registers prompt handlers</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#01-mcp-workflow-__codelineno-18-13"></a><span class="sd">    8. Sets up lifecycle handlers</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#01-mcp-workflow-__codelineno-18-14"></a><span class="sd">    9. Runs the server</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#01-mcp-workflow-__codelineno-18-15"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#01-mcp-workflow-__codelineno-18-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#01-mcp-workflow-__codelineno-18-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🌟 COMPLETE MCP SERVER - STARTING&quot;</span><span class="p">)</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#01-mcp-workflow-__codelineno-18-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#01-mcp-workflow-__codelineno-18-19"></a>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#01-mcp-workflow-__codelineno-18-20"></a>    <span class="c1"># Step 1: Create server instance</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#01-mcp-workflow-__codelineno-18-21"></a>    <span class="n">server</span> <span class="o">=</span> <span class="n">CompleteMCPServer</span><span class="p">()</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#01-mcp-workflow-__codelineno-18-22"></a>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#01-mcp-workflow-__codelineno-18-23"></a>    <span class="c1"># Step 2: Register tools</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#01-mcp-workflow-__codelineno-18-24"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_tools</span><span class="p">()</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#01-mcp-workflow-__codelineno-18-25"></a>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#01-mcp-workflow-__codelineno-18-26"></a>    <span class="c1"># Step 3: Register tool handlers</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#01-mcp-workflow-__codelineno-18-27"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_tool_handlers</span><span class="p">()</span>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28" href="#01-mcp-workflow-__codelineno-18-28"></a>
</span><span id="__span-18-29"><a id="__codelineno-18-29" name="__codelineno-18-29" href="#01-mcp-workflow-__codelineno-18-29"></a>    <span class="c1"># Step 4: Register resources</span>
</span><span id="__span-18-30"><a id="__codelineno-18-30" name="__codelineno-18-30" href="#01-mcp-workflow-__codelineno-18-30"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_resources</span><span class="p">()</span>
</span><span id="__span-18-31"><a id="__codelineno-18-31" name="__codelineno-18-31" href="#01-mcp-workflow-__codelineno-18-31"></a>
</span><span id="__span-18-32"><a id="__codelineno-18-32" name="__codelineno-18-32" href="#01-mcp-workflow-__codelineno-18-32"></a>    <span class="c1"># Step 5: Register resource handlers</span>
</span><span id="__span-18-33"><a id="__codelineno-18-33" name="__codelineno-18-33" href="#01-mcp-workflow-__codelineno-18-33"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_resource_handlers</span><span class="p">()</span>
</span><span id="__span-18-34"><a id="__codelineno-18-34" name="__codelineno-18-34" href="#01-mcp-workflow-__codelineno-18-34"></a>
</span><span id="__span-18-35"><a id="__codelineno-18-35" name="__codelineno-18-35" href="#01-mcp-workflow-__codelineno-18-35"></a>    <span class="c1"># Step 6: Register prompts</span>
</span><span id="__span-18-36"><a id="__codelineno-18-36" name="__codelineno-18-36" href="#01-mcp-workflow-__codelineno-18-36"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_prompts</span><span class="p">()</span>
</span><span id="__span-18-37"><a id="__codelineno-18-37" name="__codelineno-18-37" href="#01-mcp-workflow-__codelineno-18-37"></a>
</span><span id="__span-18-38"><a id="__codelineno-18-38" name="__codelineno-18-38" href="#01-mcp-workflow-__codelineno-18-38"></a>    <span class="c1"># Step 7: Register prompt handlers</span>
</span><span id="__span-18-39"><a id="__codelineno-18-39" name="__codelineno-18-39" href="#01-mcp-workflow-__codelineno-18-39"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_prompt_handlers</span><span class="p">()</span>
</span><span id="__span-18-40"><a id="__codelineno-18-40" name="__codelineno-18-40" href="#01-mcp-workflow-__codelineno-18-40"></a>
</span><span id="__span-18-41"><a id="__codelineno-18-41" name="__codelineno-18-41" href="#01-mcp-workflow-__codelineno-18-41"></a>    <span class="c1"># Step 8: Setup lifecycle handlers</span>
</span><span id="__span-18-42"><a id="__codelineno-18-42" name="__codelineno-18-42" href="#01-mcp-workflow-__codelineno-18-42"></a>    <span class="n">server</span><span class="o">.</span><span class="n">setup_lifecycle_handlers</span><span class="p">()</span>
</span><span id="__span-18-43"><a id="__codelineno-18-43" name="__codelineno-18-43" href="#01-mcp-workflow-__codelineno-18-43"></a>
</span><span id="__span-18-44"><a id="__codelineno-18-44" name="__codelineno-18-44" href="#01-mcp-workflow-__codelineno-18-44"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
</span><span id="__span-18-45"><a id="__codelineno-18-45" name="__codelineno-18-45" href="#01-mcp-workflow-__codelineno-18-45"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All components registered successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-18-46"><a id="__codelineno-18-46" name="__codelineno-18-46" href="#01-mcp-workflow-__codelineno-18-46"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
</span><span id="__span-18-47"><a id="__codelineno-18-47" name="__codelineno-18-47" href="#01-mcp-workflow-__codelineno-18-47"></a>
</span><span id="__span-18-48"><a id="__codelineno-18-48" name="__codelineno-18-48" href="#01-mcp-workflow-__codelineno-18-48"></a>    <span class="c1"># Step 9: Run the server</span>
</span><span id="__span-18-49"><a id="__codelineno-18-49" name="__codelineno-18-49" href="#01-mcp-workflow-__codelineno-18-49"></a>    <span class="k">await</span> <span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="__span-18-50"><a id="__codelineno-18-50" name="__codelineno-18-50" href="#01-mcp-workflow-__codelineno-18-50"></a>
</span><span id="__span-18-51"><a id="__codelineno-18-51" name="__codelineno-18-51" href="#01-mcp-workflow-__codelineno-18-51"></a>
</span><span id="__span-18-52"><a id="__codelineno-18-52" name="__codelineno-18-52" href="#01-mcp-workflow-__codelineno-18-52"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-18-53"><a id="__codelineno-18-53" name="__codelineno-18-53" href="#01-mcp-workflow-__codelineno-18-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-18-54"><a id="__codelineno-18-54" name="__codelineno-18-54" href="#01-mcp-workflow-__codelineno-18-54"></a><span class="sd">    Entry point when script is run directly.</span>
</span><span id="__span-18-55"><a id="__codelineno-18-55" name="__codelineno-18-55" href="#01-mcp-workflow-__codelineno-18-55"></a>
</span><span id="__span-18-56"><a id="__codelineno-18-56" name="__codelineno-18-56" href="#01-mcp-workflow-__codelineno-18-56"></a><span class="sd">    This runs when you execute: python my_mcp_server.py</span>
</span><span id="__span-18-57"><a id="__codelineno-18-57" name="__codelineno-18-57" href="#01-mcp-workflow-__codelineno-18-57"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-18-58"><a id="__codelineno-18-58" name="__codelineno-18-58" href="#01-mcp-workflow-__codelineno-18-58"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-18-59"><a id="__codelineno-18-59" name="__codelineno-18-59" href="#01-mcp-workflow-__codelineno-18-59"></a>        <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span><span id="__span-18-60"><a id="__codelineno-18-60" name="__codelineno-18-60" href="#01-mcp-workflow-__codelineno-18-60"></a>    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="__span-18-61"><a id="__codelineno-18-61" name="__codelineno-18-61" href="#01-mcp-workflow-__codelineno-18-61"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">👋 Server shutdown complete&quot;</span><span class="p">)</span>
</span><span id="__span-18-62"><a id="__codelineno-18-62" name="__codelineno-18-62" href="#01-mcp-workflow-__codelineno-18-62"></a>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>main()</code> function calls all setup methods in order</li>
<li>The <code>if __name__ == "__main__"</code> block runs when the script is executed</li>
<li><code>asyncio.run(main())</code> starts the async event loop</li>
<li><code>KeyboardInterrupt</code> handler allows graceful shutdown with Ctrl+C</li>
<li>This is the final orchestration of the MCP server</li>
</ul>
<hr />
<h4 id="01-mcp-workflow-code-review">Code Review<a class="headerlink" href="#01-mcp-workflow-code-review" title="Permanent link">&para;</a></h4>
<p>At this point, your <code>my_mcp_server.py</code> file should have:</p>
<ol>
<li>All imports at the top</li>
<li><code>CompleteMCPServer</code> class with all 9 methods</li>
<li><code>main()</code> function</li>
<li>Entry point with <code>if __name__ == "__main__"</code></li>
</ol>
<p>Your file structure should look like:
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#01-mcp-workflow-__codelineno-19-1"></a>#!/usr/bin/env python3
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#01-mcp-workflow-__codelineno-19-2"></a># Imports
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#01-mcp-workflow-__codelineno-19-3"></a># Class definition
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#01-mcp-workflow-__codelineno-19-4"></a>#   __init__
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#01-mcp-workflow-__codelineno-19-5"></a>#   register_tools
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#01-mcp-workflow-__codelineno-19-6"></a>#   register_tool_handlers
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#01-mcp-workflow-__codelineno-19-7"></a>#   register_resources
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#01-mcp-workflow-__codelineno-19-8"></a>#   register_resource_handlers
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#01-mcp-workflow-__codelineno-19-9"></a>#   register_prompts
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#01-mcp-workflow-__codelineno-19-10"></a>#   register_prompt_handlers
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#01-mcp-workflow-__codelineno-19-11"></a>#   setup_lifecycle_handlers
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#01-mcp-workflow-__codelineno-19-12"></a>#   run
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#01-mcp-workflow-__codelineno-19-13"></a># main() function
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#01-mcp-workflow-__codelineno-19-14"></a># if __name__ == &quot;__main__&quot; block
</span></code></pre></div></p>
<hr />
<h2 id="01-mcp-workflow-testing-with-mcp-inspector">Testing with MCP Inspector<a class="headerlink" href="#01-mcp-workflow-testing-with-mcp-inspector" title="Permanent link">&para;</a></h2>
<ul>
<li>Now that you&rsquo;ve built your complete MCP server, it&rsquo;s time to test it!</li>
<li>We&rsquo;ll use MCP Inspector, a web-based tool for debugging MCP servers.</li>
<li>Follow the steps below to install MCP Inspector, run your server, and test all the tools, resources, and prompts you implemented.</li>
</ul>
<h3 id="01-mcp-workflow-what-is-mcp-inspector">What is MCP Inspector?<a class="headerlink" href="#01-mcp-workflow-what-is-mcp-inspector" title="Permanent link">&para;</a></h3>
<p>MCP Inspector is a web-based debugging tool for MCP servers. Think of it like a browser developer console for your MCP server - it lets you:</p>
<ul>
<li>Connect to your server</li>
<li>See all available tools, resources, and prompts</li>
<li>Execute tools with custom parameters</li>
<li>Read resources</li>
<li>Generate prompts</li>
<li>View JSON-RPC messages</li>
<li>Debug server behavior</li>
</ul>
<h3 id="01-mcp-workflow-installing-mcp-inspector">Installing MCP Inspector<a class="headerlink" href="#01-mcp-workflow-installing-mcp-inspector" title="Permanent link">&para;</a></h3>
<p>Open a terminal and run:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#01-mcp-workflow-__codelineno-20-1"></a><span class="c1"># Install MCP Inspector globally</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#01-mcp-workflow-__codelineno-20-2"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@modelcontextprotocol/inspector
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#01-mcp-workflow-__codelineno-20-3"></a>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#01-mcp-workflow-__codelineno-20-4"></a><span class="c1"># Run the MCP Inspector</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#01-mcp-workflow-__codelineno-20-5"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>python3<span class="w"> </span><span class="s2">&quot;my_mcp_server.py&quot;</span>
</span></code></pre></div>
<hr />
<h3 id="01-mcp-workflow-testing-your-tools">Testing Your Tools<a class="headerlink" href="#01-mcp-workflow-testing-your-tools" title="Permanent link">&para;</a></h3>
<p>Follow these steps in the MCP Inspector:</p>
<h2 id="01-mcp-workflow-test-01-connect-to-the-server">Test 01: Connect to the Server<a class="headerlink" href="#01-mcp-workflow-test-01-connect-to-the-server" title="Permanent link">&para;</a></h2>
<ol>
<li>Click the <strong>&ldquo;Connect&rdquo;</strong> button at the bottom left of the interface</li>
<li>Wait for the connection status to show &ldquo;Connected&rdquo; (green indicator)</li>
<li>If not connected, set the following:</li>
<li>transport: <code>stdio</code></li>
<li>Command: <code>python3</code></li>
<li>Arguments: <code>my_mcp_server.py</code></li>
<li>Click <strong>&ldquo;Connect&rdquo;</strong> again</li>
<li>You should see the server name and version in the top right corner</li>
<li>Success! </li>
</ol>
<hr />
<h2 id="01-mcp-workflow-test-02-explore-tools">Test 02: Explore Tools<a class="headerlink" href="#01-mcp-workflow-test-02-explore-tools" title="Permanent link">&para;</a></h2>
<ol>
<li>Click the <strong>&ldquo;Tools&rdquo;</strong> tab in the upper menu</li>
<li>Click <strong>&ldquo;List tools&rdquo;</strong> to see all available tools</li>
<li>You should see: <code>calculate</code>, <code>store_data</code>, <code>retrieve_data</code>, <code>echo</code></li>
<li>If you added the <code>greeting</code> tool, you should see that too!</li>
</ol>
<hr />
<h2 id="01-mcp-workflow-test-03-test-the-calculate-tool">Test 03: Test the Calculate Tool<a class="headerlink" href="#01-mcp-workflow-test-03-test-the-calculate-tool" title="Permanent link">&para;</a></h2>
<ol>
<li>Click on <strong>&ldquo;calculate&rdquo;</strong> in the tools list</li>
<li>The tool interface opens on the right side</li>
<li>Fill in the parameters:<ul>
<li><strong>operation</strong>: Select &ldquo;add&rdquo; from the dropdown<ul>
<li><strong>a</strong>: Enter <code>10</code></li>
<li><strong>b</strong>: Enter <code>5</code></li>
</ul>
</li>
</ul>
</li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
<li>Scroll down to see the result: <code>"Result: 10 add 5 = 15"</code></li>
<li>Success! </li>
</ol>
<hr />
<h2 id="01-mcp-workflow-test-04-test-the-store-data-tool">Test 04: Test the Store Data Tool<a class="headerlink" href="#01-mcp-workflow-test-04-test-the-store-data-tool" title="Permanent link">&para;</a></h2>
<ol>
<li>Click on <strong>&ldquo;store_data&rdquo;</strong> in the tools list</li>
<li>Fill in the parameters:<ul>
<li><strong>key</strong>: Enter <code>username</code></li>
<li><strong>value</strong>: Enter <code>Alice</code></li>
</ul>
</li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
<li>Result: <code>"Stored: username = Alice"</code></li>
<li>Try storing another key-value pair to see it works!</li>
<li>Success!</li>
</ol>
<hr />
<h2 id="01-mcp-workflow-test-05-test-the-retrieve-data-tool">Test 05: Test the Retrieve Data Tool<a class="headerlink" href="#01-mcp-workflow-test-05-test-the-retrieve-data-tool" title="Permanent link">&para;</a></h2>
<ol>
<li>Click on <strong>&ldquo;retrieve_data&rdquo;</strong> in the tools list</li>
<li>Fill in the parameter:</li>
<li><strong>key</strong>: Enter <code>username</code></li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
<li>Result: <code>"Retrieved: username = Alice"</code></li>
<li>Try retrieving a non-existent key to see error handling!</li>
</ol>
<hr />
<h2 id="01-mcp-workflow-test-06-test-the-echo-tool">Test 06: Test the Echo Tool<a class="headerlink" href="#01-mcp-workflow-test-06-test-the-echo-tool" title="Permanent link">&para;</a></h2>
<ol>
<li>Click on <strong>&ldquo;echo&rdquo;</strong> in the tools list</li>
<li>Fill in the parameter:</li>
<li><strong>text</strong>: Enter <code>Hello, MCP World!</code></li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
<li>Result: <code>"Echo: Hello, MCP World!"</code></li>
</ol>
<hr />
<h2 id="01-mcp-workflow-test-07-test-resources">Test 07: Test Resources<a class="headerlink" href="#01-mcp-workflow-test-07-test-resources" title="Permanent link">&para;</a></h2>
<ol>
<li>Click the <strong>&ldquo;Resources&rdquo;</strong> tab in the upper menu</li>
<li>Click <strong>&ldquo;List resources&rdquo;</strong> to see all available resources</li>
<li>You should see: <code>server-info</code>, <code>data-store</code>, <code>welcome</code></li>
<li>If you added the <code>server-author</code> resource, you should see that too!</li>
</ol>
<h4 id="01-mcp-workflow-test-resource-server-info">Test Resource: server-info<a class="headerlink" href="#01-mcp-workflow-test-resource-server-info" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;resource://server-info&rdquo;</strong></li>
<li>View the JSON response showing server metadata</li>
<li>Notice it shows 4 tools, 3 resources, 2 prompts</li>
</ol>
<h4 id="01-mcp-workflow-test-resource-data-store">Test Resource: data-store<a class="headerlink" href="#01-mcp-workflow-test-resource-data-store" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;resource://data-store&rdquo;</strong></li>
<li>View the current contents of the data store</li>
<li>You should see the <code>username: Alice</code> you stored earlier!</li>
</ol>
<h4 id="01-mcp-workflow-test-resource-welcome">Test Resource: welcome<a class="headerlink" href="#01-mcp-workflow-test-resource-welcome" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;resource://welcome&rdquo;</strong></li>
<li>View the welcome message explaining server capabilities</li>
<li>If you added the <code>server-author</code> resource, click on it to see your name displayed</li>
<li>Success!</li>
</ol>
<hr />
<h2 id="01-mcp-workflow-test-08-testing-your-prompts">Test 08: Testing Your Prompts<a class="headerlink" href="#01-mcp-workflow-test-08-testing-your-prompts" title="Permanent link">&para;</a></h2>
<ol>
<li>Click the <strong>&ldquo;Prompts&rdquo;</strong> tab in the upper menu</li>
<li>Click <strong>&ldquo;List prompts&rdquo;</strong> to see all available prompts</li>
<li>You should see: <code>analyze-data</code>, <code>calculate-scenario</code></li>
</ol>
<h4 id="01-mcp-workflow-test-prompt-calculate-scenario">Test Prompt: calculate-scenario<a class="headerlink" href="#01-mcp-workflow-test-prompt-calculate-scenario" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;calculate-scenario&rdquo;</strong></li>
<li>Fill in the argument:<ul>
<li><strong>operation</strong>: Enter <code>multiply</code></li>
</ul>
</li>
<li>Click <strong>&ldquo;Get Prompt&rdquo;</strong></li>
<li>View the generated prompt that explains how to use the calculate tool</li>
</ol>
<h4 id="01-mcp-workflow-test-prompt-analyze-data">Test Prompt: analyze-data<a class="headerlink" href="#01-mcp-workflow-test-prompt-analyze-data" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;analyze-data&rdquo;</strong></li>
<li>Fill in the argument:<ul>
<li><strong>key</strong>: Enter <code>username</code></li>
</ul>
</li>
<li>Click <strong>&ldquo;Get Prompt&rdquo;</strong></li>
<li>View the generated prompt that analyzes the stored data</li>
</ol>
<hr />
<h3 id="01-mcp-workflow-understanding-the-inspector-interface">Understanding the Inspector Interface<a class="headerlink" href="#01-mcp-workflow-understanding-the-inspector-interface" title="Permanent link">&para;</a></h3>
<p><strong>Left Panel: Navigation</strong></p>
<ul>
<li>Tools, Resources, Prompts tabs</li>
<li>List and select items to test</li>
</ul>
<p><strong>Right Panel: Details</strong></p>
<ul>
<li>Shows selected item details</li>
<li>Input forms for parameters</li>
<li>Execute button</li>
<li>Results display</li>
</ul>
<p><strong>Bottom Panel: JSON-RPC Messages</strong></p>
<ul>
<li>Shows raw protocol messages</li>
<li>Useful for debugging</li>
<li>See requests and responses</li>
</ul>
<p><strong>Connection Status</strong></p>
<ul>
<li>Top right corner</li>
<li>Green = Connected</li>
<li>Red = Disconnected</li>
<li>Shows server name and version</li>
</ul>
<hr />
<h2 id="01-mcp-workflow-advanced-experiments">Advanced Experiments<a class="headerlink" href="#01-mcp-workflow-advanced-experiments" title="Permanent link">&para;</a></h2>
<ul>
<li>Now that you have a working server, try these challenges:</li>
</ul>
<h3 id="01-mcp-workflow-challenge-1-modify-the-calculate-tool">Challenge 1: Modify the Calculate Tool<a class="headerlink" href="#01-mcp-workflow-challenge-1-modify-the-calculate-tool" title="Permanent link">&para;</a></h3>
<p>Add support for:
- <code>power</code> operation (a^b)
- <code>modulus</code> operation (a % b)</p>
<h3 id="01-mcp-workflow-challenge-2-add-roots">Challenge 2: Add Roots<a class="headerlink" href="#01-mcp-workflow-challenge-2-add-roots" title="Permanent link">&para;</a></h3>
<p>Add support for:
- Listing files in a directory (referencing client roots)
- Reading file contents (referencing client roots)</p></section><section class="print-page" id="02-mcp-ollama" heading-number="3"><h1 id="02-mcp-ollama-implementing-live-mcp-server-with-ollama-integration">Implementing Live MCP Server (With Ollama Integration)<a class="headerlink" href="#02-mcp-ollama-implementing-live-mcp-server-with-ollama-integration" title="Permanent link">&para;</a></h1>
<h2 id="02-mcp-ollama-overview">Overview<a class="headerlink" href="#02-mcp-ollama-overview" title="Permanent link">&para;</a></h2>
<ul>
<li>In this lab, you&rsquo;ll master the art of creating sophisticated, production-ready <code>MCP</code> tools that can handle complex inputs, perform real-world operations, and return rich content types.</li>
</ul>
<hr />
<h2 id="02-mcp-ollama-learning-objectives">Learning Objectives<a class="headerlink" href="#02-mcp-ollama-learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lab, you will:</p>
<ul>
<li>Design robust tool schemas with advanced validation</li>
<li>Implement tools that interact with external systems (APIs, databases, file systems)</li>
<li>Return multiple content types (text, images, resources)</li>
<li>Handle errors gracefully with detailed feedback</li>
<li>Implement async operations and streaming responses</li>
<li>Apply best practices for tool composition</li>
<li>Test tools thoroughly with various edge cases</li>
</ul>
<hr />
<h2 id="02-mcp-ollama-prerequisites">Prerequisites<a class="headerlink" href="#02-mcp-ollama-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Completion of previous MCP labs or equivalent experience</li>
<li>Understanding of async/await in JavaScript/TypeScript</li>
<li>Basic knowledge of REST APIs and JSON</li>
<li>Node.js development environment set up</li>
</ul>
<hr />
<h3 id="02-mcp-ollama-weather-information-with-ollama">Weather Information with Ollama<a class="headerlink" href="#02-mcp-ollama-weather-information-with-ollama" title="Permanent link">&para;</a></h3>
<h4 id="02-mcp-ollama-goal">Goal<a class="headerlink" href="#02-mcp-ollama-goal" title="Permanent link">&para;</a></h4>
<ul>
<li>Create a production-ready weather tool that uses Ollama (local AI) to generate weather information, handles errors gracefully, and returns formatted information.</li>
</ul>
<h4 id="02-mcp-ollama-complete-weather-tool-implementation-with-ollama">Complete Weather Tool Implementation with Ollama<a class="headerlink" href="#02-mcp-ollama-complete-weather-tool-implementation-with-ollama" title="Permanent link">&para;</a></h4>
<ul>
<li>Here is the complete <code>src/index.ts</code> file with the Ollama-based weather tool added. </li>
</ul>
<details>
<summary>Click to expand code</summary>

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#02-mcp-ollama-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#02-mcp-ollama-__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#02-mcp-ollama-__codelineno-0-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#02-mcp-ollama-__codelineno-0-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#02-mcp-ollama-__codelineno-0-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#02-mcp-ollama-__codelineno-0-6"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#02-mcp-ollama-__codelineno-0-7"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#02-mcp-ollama-__codelineno-0-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#02-mcp-ollama-__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#02-mcp-ollama-__codelineno-0-10"></a><span class="cm">/**</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#02-mcp-ollama-__codelineno-0-11"></a><span class="cm">* Create an MCP server with core capabilities</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#02-mcp-ollama-__codelineno-0-12"></a><span class="cm">*/</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#02-mcp-ollama-__codelineno-0-13"></a><span class="kd">class</span><span class="w"> </span><span class="nx">MyFirstMCPServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#02-mcp-ollama-__codelineno-0-14"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#02-mcp-ollama-__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#02-mcp-ollama-__codelineno-0-16"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#02-mcp-ollama-__codelineno-0-17"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#02-mcp-ollama-__codelineno-0-18"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#02-mcp-ollama-__codelineno-0-19"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;my-first-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#02-mcp-ollama-__codelineno-0-20"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#02-mcp-ollama-__codelineno-0-21"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#02-mcp-ollama-__codelineno-0-22"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#02-mcp-ollama-__codelineno-0-23"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#02-mcp-ollama-__codelineno-0-24"></a><span class="w">          </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#02-mcp-ollama-__codelineno-0-25"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#02-mcp-ollama-__codelineno-0-26"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#02-mcp-ollama-__codelineno-0-27"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#02-mcp-ollama-__codelineno-0-28"></a>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#02-mcp-ollama-__codelineno-0-29"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#02-mcp-ollama-__codelineno-0-30"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#02-mcp-ollama-__codelineno-0-31"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#02-mcp-ollama-__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#02-mcp-ollama-__codelineno-0-33"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#02-mcp-ollama-__codelineno-0-34"></a><span class="cm">  * Set up request handlers</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#02-mcp-ollama-__codelineno-0-35"></a><span class="cm">  */</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#02-mcp-ollama-__codelineno-0-36"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#02-mcp-ollama-__codelineno-0-37"></a><span class="w">    </span><span class="c1">// Handler for listing available tools</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#02-mcp-ollama-__codelineno-0-38"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#02-mcp-ollama-__codelineno-0-39"></a><span class="w">      </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#02-mcp-ollama-__codelineno-0-40"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#02-mcp-ollama-__codelineno-0-41"></a><span class="w">        </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#02-mcp-ollama-__codelineno-0-42"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#02-mcp-ollama-__codelineno-0-43"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;get_weather&quot;</span><span class="p">,</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#02-mcp-ollama-__codelineno-0-44"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Get current weather information for a city using AI&quot;</span><span class="p">,</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#02-mcp-ollama-__codelineno-0-45"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#02-mcp-ollama-__codelineno-0-46"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#02-mcp-ollama-__codelineno-0-47"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#02-mcp-ollama-__codelineno-0-48"></a><span class="w">                </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#02-mcp-ollama-__codelineno-0-49"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#02-mcp-ollama-__codelineno-0-50"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;City name (e.g., &#39;London&#39;, &#39;New York&#39;)&quot;</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#02-mcp-ollama-__codelineno-0-51"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#02-mcp-ollama-__codelineno-0-52"></a><span class="w">                </span><span class="nx">units</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#02-mcp-ollama-__codelineno-0-53"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#02-mcp-ollama-__codelineno-0-54"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Temperature units&quot;</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#02-mcp-ollama-__codelineno-0-55"></a><span class="w">                  </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;celsius&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;fahrenheit&quot;</span><span class="p">],</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#02-mcp-ollama-__codelineno-0-56"></a><span class="w">                  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;celsius&quot;</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#02-mcp-ollama-__codelineno-0-57"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#02-mcp-ollama-__codelineno-0-58"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#02-mcp-ollama-__codelineno-0-59"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;city&quot;</span><span class="p">]</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#02-mcp-ollama-__codelineno-0-60"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#02-mcp-ollama-__codelineno-0-61"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#02-mcp-ollama-__codelineno-0-62"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#02-mcp-ollama-__codelineno-0-63"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hello_world&quot;</span><span class="p">,</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#02-mcp-ollama-__codelineno-0-64"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Returns a friendly greeting message&quot;</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#02-mcp-ollama-__codelineno-0-65"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#02-mcp-ollama-__codelineno-0-66"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#02-mcp-ollama-__codelineno-0-67"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#02-mcp-ollama-__codelineno-0-68"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#02-mcp-ollama-__codelineno-0-69"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#02-mcp-ollama-__codelineno-0-70"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The name to greet&quot;</span><span class="p">,</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#02-mcp-ollama-__codelineno-0-71"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#02-mcp-ollama-__codelineno-0-72"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#02-mcp-ollama-__codelineno-0-73"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#02-mcp-ollama-__codelineno-0-74"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#02-mcp-ollama-__codelineno-0-75"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#02-mcp-ollama-__codelineno-0-76"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#02-mcp-ollama-__codelineno-0-77"></a><span class="w">      </span><span class="p">})</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#02-mcp-ollama-__codelineno-0-78"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#02-mcp-ollama-__codelineno-0-79"></a>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#02-mcp-ollama-__codelineno-0-80"></a><span class="w">    </span><span class="c1">// Handler for calling tools</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#02-mcp-ollama-__codelineno-0-81"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#02-mcp-ollama-__codelineno-0-82"></a><span class="w">      </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#02-mcp-ollama-__codelineno-0-83"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#02-mcp-ollama-__codelineno-0-84"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#02-mcp-ollama-__codelineno-0-85"></a>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#02-mcp-ollama-__codelineno-0-86"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;get_weather&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#02-mcp-ollama-__codelineno-0-87"></a><span class="w">          </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#02-mcp-ollama-__codelineno-0-88"></a><span class="w">            </span><span class="c1">// Extract and validate parameters</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#02-mcp-ollama-__codelineno-0-89"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">city</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#02-mcp-ollama-__codelineno-0-90"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">units</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;celsius&quot;</span><span class="p">;</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#02-mcp-ollama-__codelineno-0-91"></a>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#02-mcp-ollama-__codelineno-0-92"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">city</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">city</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#02-mcp-ollama-__codelineno-0-93"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;City name cannot be empty&quot;</span><span class="p">);</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#02-mcp-ollama-__codelineno-0-94"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#02-mcp-ollama-__codelineno-0-95"></a>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#02-mcp-ollama-__codelineno-0-96"></a><span class="w">            </span><span class="c1">// Use Ollama to generate weather information</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#02-mcp-ollama-__codelineno-0-97"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`Generate realistic current weather information for </span><span class="si">${</span><span class="nx">city</span><span class="si">}</span><span class="sb">.</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#02-mcp-ollama-__codelineno-0-98"></a><span class="sb">            Return ONLY a JSON object with this exact structure:</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#02-mcp-ollama-__codelineno-0-99"></a><span class="sb">            {</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#02-mcp-ollama-__codelineno-0-100"></a><span class="sb">              &quot;name&quot;: &quot;</span><span class="si">${</span><span class="nx">city</span><span class="si">}</span><span class="sb">&quot;,</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#02-mcp-ollama-__codelineno-0-101"></a><span class="sb">              &quot;sys&quot;: {&quot;country&quot;: &quot;XX&quot;},</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#02-mcp-ollama-__codelineno-0-102"></a><span class="sb">              &quot;main&quot;: {&quot;temp&quot;: 20.5, &quot;feels_like&quot;: 22.1, &quot;humidity&quot;: 65},</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#02-mcp-ollama-__codelineno-0-103"></a><span class="sb">              &quot;weather&quot;: [{&quot;description&quot;: &quot;clear sky&quot;}],</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#02-mcp-ollama-__codelineno-0-104"></a><span class="sb">              &quot;wind&quot;: {&quot;speed&quot;: 3.2}</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#02-mcp-ollama-__codelineno-0-105"></a><span class="sb">            }</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#02-mcp-ollama-__codelineno-0-106"></a>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#02-mcp-ollama-__codelineno-0-107"></a><span class="sb">            Use realistic weather data appropriate for the location. Temperature should be in Celsius. Choose an appropriate 2-letter country code for the city. Make the weather description realistic for the location and season.`</span><span class="p">;</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#02-mcp-ollama-__codelineno-0-108"></a>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#02-mcp-ollama-__codelineno-0-109"></a><span class="w">            </span><span class="c1">// Call Ollama API</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#02-mcp-ollama-__codelineno-0-110"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://localhost:11434/api/generate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#02-mcp-ollama-__codelineno-0-111"></a><span class="w">              </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#02-mcp-ollama-__codelineno-0-112"></a><span class="w">              </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#02-mcp-ollama-__codelineno-0-113"></a><span class="w">                </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#02-mcp-ollama-__codelineno-0-114"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#02-mcp-ollama-__codelineno-0-115"></a><span class="w">              </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#02-mcp-ollama-__codelineno-0-116"></a><span class="w">                </span><span class="nx">model</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;gpt-oss:20b&#39;</span><span class="p">,</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#02-mcp-ollama-__codelineno-0-117"></a><span class="w">                </span><span class="nx">prompt</span><span class="o">:</span><span class="w"> </span><span class="kt">prompt</span><span class="p">,</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#02-mcp-ollama-__codelineno-0-118"></a><span class="w">                </span><span class="nx">stream</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#02-mcp-ollama-__codelineno-0-119"></a><span class="w">                </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;json&#39;</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#02-mcp-ollama-__codelineno-0-120"></a><span class="w">              </span><span class="p">}),</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#02-mcp-ollama-__codelineno-0-121"></a><span class="w">            </span><span class="p">});</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#02-mcp-ollama-__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#02-mcp-ollama-__codelineno-0-123"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#02-mcp-ollama-__codelineno-0-124"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Ollama API error: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb"> </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">. Make sure Ollama is running with &#39;ollama serve&#39;.`</span><span class="p">);</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#02-mcp-ollama-__codelineno-0-125"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#02-mcp-ollama-__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#02-mcp-ollama-__codelineno-0-127"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">ollamaResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#02-mcp-ollama-__codelineno-0-128"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">data</span><span class="p">;</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#02-mcp-ollama-__codelineno-0-129"></a>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#02-mcp-ollama-__codelineno-0-130"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#02-mcp-ollama-__codelineno-0-131"></a><span class="w">              </span><span class="c1">// Parse the JSON response from Ollama</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#02-mcp-ollama-__codelineno-0-132"></a><span class="w">              </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">ollamaResult</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#02-mcp-ollama-__codelineno-0-133"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">parseError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#02-mcp-ollama-__codelineno-0-134"></a><span class="w">              </span><span class="c1">// Fallback to mock data if parsing fails</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#02-mcp-ollama-__codelineno-0-135"></a><span class="w">              </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;Failed to parse Ollama response, using fallback data&#39;</span><span class="p">);</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#02-mcp-ollama-__codelineno-0-136"></a><span class="w">              </span><span class="kd">const</span><span class="w"> </span><span class="nx">fallbackData</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#02-mcp-ollama-__codelineno-0-137"></a><span class="w">                </span><span class="s2">&quot;london&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#02-mcp-ollama-__codelineno-0-138"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;London&quot;</span><span class="p">,</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#02-mcp-ollama-__codelineno-0-139"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;GB&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#02-mcp-ollama-__codelineno-0-140"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">15.2</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">14.8</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">82</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#02-mcp-ollama-__codelineno-0-141"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;light rain&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#02-mcp-ollama-__codelineno-0-142"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">3.6</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#02-mcp-ollama-__codelineno-0-143"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#02-mcp-ollama-__codelineno-0-144"></a><span class="w">                </span><span class="s2">&quot;new york&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#02-mcp-ollama-__codelineno-0-145"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;New York&quot;</span><span class="p">,</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#02-mcp-ollama-__codelineno-0-146"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;US&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#02-mcp-ollama-__codelineno-0-147"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">22.5</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">24.1</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">65</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#02-mcp-ollama-__codelineno-0-148"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;clear sky&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#02-mcp-ollama-__codelineno-0-149"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">2.1</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#02-mcp-ollama-__codelineno-0-150"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#02-mcp-ollama-__codelineno-0-151"></a><span class="w">                </span><span class="s2">&quot;tokyo&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#02-mcp-ollama-__codelineno-0-152"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#02-mcp-ollama-__codelineno-0-153"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;JP&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#02-mcp-ollama-__codelineno-0-154"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">18.7</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">18.2</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">78</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#02-mcp-ollama-__codelineno-0-155"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;few clouds&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#02-mcp-ollama-__codelineno-0-156"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">1.8</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#02-mcp-ollama-__codelineno-0-157"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#02-mcp-ollama-__codelineno-0-158"></a><span class="w">                </span><span class="s2">&quot;paris&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#02-mcp-ollama-__codelineno-0-159"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Paris&quot;</span><span class="p">,</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#02-mcp-ollama-__codelineno-0-160"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;FR&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#02-mcp-ollama-__codelineno-0-161"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">12.8</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">11.9</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">71</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#02-mcp-ollama-__codelineno-0-162"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;overcast clouds&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#02-mcp-ollama-__codelineno-0-163"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">4.2</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#02-mcp-ollama-__codelineno-0-164"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#02-mcp-ollama-__codelineno-0-165"></a><span class="w">                </span><span class="s2">&quot;sydney&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#02-mcp-ollama-__codelineno-0-166"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Sydney&quot;</span><span class="p">,</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#02-mcp-ollama-__codelineno-0-167"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;AU&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#02-mcp-ollama-__codelineno-0-168"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">24.3</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">25.1</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">73</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#02-mcp-ollama-__codelineno-0-169"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;sunny&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#02-mcp-ollama-__codelineno-0-170"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">2.8</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#02-mcp-ollama-__codelineno-0-171"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#02-mcp-ollama-__codelineno-0-172"></a><span class="w">              </span><span class="p">};</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#02-mcp-ollama-__codelineno-0-173"></a><span class="w">              </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fallbackData</span><span class="p">[</span><span class="nx">city</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">trim</span><span class="p">()]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">fallbackData</span><span class="p">[</span><span class="s2">&quot;london&quot;</span><span class="p">];</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#02-mcp-ollama-__codelineno-0-174"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#02-mcp-ollama-__codelineno-0-175"></a>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#02-mcp-ollama-__codelineno-0-176"></a><span class="w">            </span><span class="c1">// Format response</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#02-mcp-ollama-__codelineno-0-177"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">tempUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">units</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;fahrenheit&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">&quot;°F&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;°C&quot;</span><span class="p">;</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#02-mcp-ollama-__codelineno-0-178"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">weatherText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#02-mcp-ollama-__codelineno-0-179"></a><span class="sb">Weather in </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">sys</span><span class="p">.</span><span class="nx">country</span><span class="si">}</span><span class="sb">:</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#02-mcp-ollama-__codelineno-0-180"></a><span class="sb">- Temperature: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">temp</span><span class="si">}${</span><span class="nx">tempUnit</span><span class="si">}</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#02-mcp-ollama-__codelineno-0-181"></a><span class="sb">- Feels like: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">feels_like</span><span class="si">}${</span><span class="nx">tempUnit</span><span class="si">}</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#02-mcp-ollama-__codelineno-0-182"></a><span class="sb">- Conditions: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">weather</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">description</span><span class="si">}</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#02-mcp-ollama-__codelineno-0-183"></a><span class="sb">- Humidity: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">humidity</span><span class="si">}</span><span class="sb">%</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#02-mcp-ollama-__codelineno-0-184"></a><span class="sb">- Wind Speed: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">wind</span><span class="p">.</span><span class="nx">speed</span><span class="si">}</span><span class="sb"> m/s</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#02-mcp-ollama-__codelineno-0-185"></a>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#02-mcp-ollama-__codelineno-0-186"></a><span class="sb">*Generated by Ollama AI*</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#02-mcp-ollama-__codelineno-0-187"></a><span class="sb">`</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#02-mcp-ollama-__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#02-mcp-ollama-__codelineno-0-189"></a><span class="w">            </span><span class="c1">// Return MCP response</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#02-mcp-ollama-__codelineno-0-190"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#02-mcp-ollama-__codelineno-0-191"></a><span class="w">              </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#02-mcp-ollama-__codelineno-0-192"></a><span class="w">                </span><span class="p">{</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#02-mcp-ollama-__codelineno-0-193"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#02-mcp-ollama-__codelineno-0-194"></a><span class="w">                  </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">weatherText</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#02-mcp-ollama-__codelineno-0-195"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#02-mcp-ollama-__codelineno-0-196"></a><span class="w">              </span><span class="p">]</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#02-mcp-ollama-__codelineno-0-197"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#02-mcp-ollama-__codelineno-0-198"></a>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#02-mcp-ollama-__codelineno-0-199"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#02-mcp-ollama-__codelineno-0-200"></a><span class="w">            </span><span class="c1">// Handle errors</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#02-mcp-ollama-__codelineno-0-201"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#02-mcp-ollama-__codelineno-0-202"></a><span class="w">              </span><span class="sb">`Failed to get weather: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#02-mcp-ollama-__codelineno-0-203"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#02-mcp-ollama-__codelineno-0-204"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#02-mcp-ollama-__codelineno-0-205"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#02-mcp-ollama-__codelineno-0-206"></a>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#02-mcp-ollama-__codelineno-0-207"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;hello_world&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#02-mcp-ollama-__codelineno-0-208"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#02-mcp-ollama-__codelineno-0-209"></a>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#02-mcp-ollama-__codelineno-0-210"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">userName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#02-mcp-ollama-__codelineno-0-211"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Name parameter is required&quot;</span><span class="p">);</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#02-mcp-ollama-__codelineno-0-212"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#02-mcp-ollama-__codelineno-0-213"></a>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#02-mcp-ollama-__codelineno-0-214"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#02-mcp-ollama-__codelineno-0-215"></a><span class="w">            </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#02-mcp-ollama-__codelineno-0-216"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#02-mcp-ollama-__codelineno-0-217"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#02-mcp-ollama-__codelineno-0-218"></a><span class="w">                </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Hello, </span><span class="si">${</span><span class="nx">userName</span><span class="si">}</span><span class="sb">! Welcome to your first MCP server! 🎉`</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#02-mcp-ollama-__codelineno-0-219"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#02-mcp-ollama-__codelineno-0-220"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#02-mcp-ollama-__codelineno-0-221"></a><span class="w">          </span><span class="p">};</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#02-mcp-ollama-__codelineno-0-222"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#02-mcp-ollama-__codelineno-0-223"></a>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#02-mcp-ollama-__codelineno-0-224"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#02-mcp-ollama-__codelineno-0-225"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#02-mcp-ollama-__codelineno-0-226"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#02-mcp-ollama-__codelineno-0-227"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#02-mcp-ollama-__codelineno-0-228"></a>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#02-mcp-ollama-__codelineno-0-229"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#02-mcp-ollama-__codelineno-0-230"></a><span class="cm">  * Set up error handling</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#02-mcp-ollama-__codelineno-0-231"></a><span class="cm">  */</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#02-mcp-ollama-__codelineno-0-232"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#02-mcp-ollama-__codelineno-0-233"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#02-mcp-ollama-__codelineno-0-234"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#02-mcp-ollama-__codelineno-0-235"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#02-mcp-ollama-__codelineno-0-236"></a>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#02-mcp-ollama-__codelineno-0-237"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#02-mcp-ollama-__codelineno-0-238"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#02-mcp-ollama-__codelineno-0-239"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#02-mcp-ollama-__codelineno-0-240"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#02-mcp-ollama-__codelineno-0-241"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#02-mcp-ollama-__codelineno-0-242"></a>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#02-mcp-ollama-__codelineno-0-243"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#02-mcp-ollama-__codelineno-0-244"></a><span class="cm">  * Start the server</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#02-mcp-ollama-__codelineno-0-245"></a><span class="cm">  */</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#02-mcp-ollama-__codelineno-0-246"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#02-mcp-ollama-__codelineno-0-247"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#02-mcp-ollama-__codelineno-0-248"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#02-mcp-ollama-__codelineno-0-249"></a>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#02-mcp-ollama-__codelineno-0-250"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;My First MCP Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#02-mcp-ollama-__codelineno-0-251"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#02-mcp-ollama-__codelineno-0-252"></a><span class="p">}</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#02-mcp-ollama-__codelineno-0-253"></a>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#02-mcp-ollama-__codelineno-0-254"></a><span class="cm">/**</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#02-mcp-ollama-__codelineno-0-255"></a><span class="cm">* Main entry point</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#02-mcp-ollama-__codelineno-0-256"></a><span class="cm">*/</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#02-mcp-ollama-__codelineno-0-257"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#02-mcp-ollama-__codelineno-0-258"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MyFirstMCPServer</span><span class="p">();</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#02-mcp-ollama-__codelineno-0-259"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#02-mcp-ollama-__codelineno-0-260"></a><span class="p">}</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#02-mcp-ollama-__codelineno-0-261"></a>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#02-mcp-ollama-__codelineno-0-262"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#02-mcp-ollama-__codelineno-0-263"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#02-mcp-ollama-__codelineno-0-264"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#02-mcp-ollama-__codelineno-0-265"></a><span class="p">});</span>
</span></code></pre></div>

</details>

<hr />
<h4 id="02-mcp-ollama-test-the-weather-tool">Test the Weather Tool<a class="headerlink" href="#02-mcp-ollama-test-the-weather-tool" title="Permanent link">&para;</a></h4>
<ul>
<li>This MCP is wriitten in TypeScript. Make sure you have all dependencies installed with <code>npm install</code>.</li>
</ul>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#02-mcp-ollama-__codelineno-1-1"></a><span class="c1"># Install dependencies</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#02-mcp-ollama-__codelineno-1-2"></a>npm<span class="w"> </span>install<span class="w"> </span>@types/node<span class="w"> </span>tsx<span class="w"> </span>typescript
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#02-mcp-ollama-__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#02-mcp-ollama-__codelineno-1-4"></a><span class="c1"># Test the MCP server</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#02-mcp-ollama-__codelineno-1-5"></a><span class="c1"># Start the MCP Inspector** (in a new terminal):</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#02-mcp-ollama-__codelineno-1-6"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>mcp.ts
</span></code></pre></div>
<ol>
<li>
<p><strong>In the MCP Inspector interface</strong>:</p>
<ul>
<li>You should see both <code>get_weather</code> and <code>hello_world</code> tools listed</li>
<li>Click on <code>get_weather</code> tool</li>
<li>Enter a city name like &ldquo;London&rdquo;, &ldquo;New York&rdquo;, &ldquo;Tokyo&rdquo;, &ldquo;Paris&rdquo;, or &ldquo;Sydney&rdquo;</li>
<li>Optionally set units to &ldquo;fahrenheit&rdquo; for Fahrenheit temperatures</li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Test different scenarios</strong>:</p>
<ul>
<li>Valid cities: &ldquo;London&rdquo;, &ldquo;New York&rdquo;, &ldquo;Tokyo&rdquo;, &ldquo;Paris&rdquo;, &ldquo;Sydney&rdquo;</li>
<li>Invalid cities: &ldquo;InvalidCity123&rdquo; (will use fallback data)</li>
<li>Different units: Try both &ldquo;celsius&rdquo; and &ldquo;fahrenheit&rdquo;</li>
<li>Empty city: Try with empty string (should show validation error)</li>
</ul>
</li>
<li>
<p><strong>Test error cases</strong>:</p>
<ul>
<li>Stop Ollama server and try calling the tool (should show API error)</li>
<li>Try with invalid model name in the code (should show error)</li>
</ul>
</li>
<li>
<p>You should see AI-generated weather information formatted like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#02-mcp-ollama-__codelineno-2-1"></a>Weather in London, GB:
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#02-mcp-ollama-__codelineno-2-2"></a>- Temperature: 15.2°C
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#02-mcp-ollama-__codelineno-2-3"></a>- Feels like: 14.8°C
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#02-mcp-ollama-__codelineno-2-4"></a>- Conditions: light rain
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#02-mcp-ollama-__codelineno-2-5"></a>- Humidity: 82%
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#02-mcp-ollama-__codelineno-2-6"></a>- Wind Speed: 3.6 m/s
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#02-mcp-ollama-__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#02-mcp-ollama-__codelineno-2-8"></a>*Generated by Ollama AI*
</span></code></pre></div>
</li>
</ol>
<hr />
<h3 id="02-mcp-ollama-tool-2-file-operations">Tool 2: File Operations<a class="headerlink" href="#02-mcp-ollama-tool-2-file-operations" title="Permanent link">&para;</a></h3>
<h4 id="02-mcp-ollama-goal_1">Goal<a class="headerlink" href="#02-mcp-ollama-goal_1" title="Permanent link">&para;</a></h4>
<ul>
<li>Create a secure file reading tool that can handle various file types, validate paths, and return formatted content with metadata.</li>
</ul>
<h4 id="02-mcp-ollama-complete-file-operations-tool-implementation">Complete File Operations Tool Implementation<a class="headerlink" href="#02-mcp-ollama-complete-file-operations-tool-implementation" title="Permanent link">&para;</a></h4>
<div class="admonition danger">
<ul>
<li>Do NOT copy the entire code block below. </li>
<li>Instead, add the <code>read_file</code> tool to your existing <code>src/index.ts</code> file by following these specific steps:</li>
</ul>
</div>
<ol>
<li>
<p><strong>Add the import</strong> at the top of your file (after existing imports):
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#02-mcp-ollama-__codelineno-3-1"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs/promises&#39;</span><span class="p">;</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#02-mcp-ollama-__codelineno-3-2"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;path&#39;</span><span class="p">;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add the <code>read_file</code> tool to your tools array</strong> in the <code>ListToolsRequestSchema</code> handler:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#02-mcp-ollama-__codelineno-4-1"></a><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#02-mcp-ollama-__codelineno-4-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;read_file&quot;</span><span class="p">,</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#02-mcp-ollama-__codelineno-4-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Read contents of a text file with security validation&quot;</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#02-mcp-ollama-__codelineno-4-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#02-mcp-ollama-__codelineno-4-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#02-mcp-ollama-__codelineno-4-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#02-mcp-ollama-__codelineno-4-7"></a><span class="w">      </span><span class="nx">filepath</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#02-mcp-ollama-__codelineno-4-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#02-mcp-ollama-__codelineno-4-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Absolute path to the file&quot;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#02-mcp-ollama-__codelineno-4-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#02-mcp-ollama-__codelineno-4-11"></a><span class="w">      </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#02-mcp-ollama-__codelineno-4-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#02-mcp-ollama-__codelineno-4-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;File encoding&quot;</span><span class="p">,</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#02-mcp-ollama-__codelineno-4-14"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;utf8&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;base64&quot;</span><span class="p">],</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#02-mcp-ollama-__codelineno-4-15"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;utf8&quot;</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#02-mcp-ollama-__codelineno-4-16"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#02-mcp-ollama-__codelineno-4-17"></a><span class="w">      </span><span class="nx">maxSize</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#02-mcp-ollama-__codelineno-4-18"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#02-mcp-ollama-__codelineno-4-19"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum file size in bytes&quot;</span><span class="p">,</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#02-mcp-ollama-__codelineno-4-20"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#02-mcp-ollama-__codelineno-4-21"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">10485760</span><span class="p">,</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#02-mcp-ollama-__codelineno-4-22"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">1048576</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#02-mcp-ollama-__codelineno-4-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#02-mcp-ollama-__codelineno-4-24"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#02-mcp-ollama-__codelineno-4-25"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;filepath&quot;</span><span class="p">]</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#02-mcp-ollama-__codelineno-4-26"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#02-mcp-ollama-__codelineno-4-27"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add the <code>read_file</code> handler</strong> in the <code>CallToolRequestSchema</code> handler (before the final <code>throw new Error</code>):
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#02-mcp-ollama-__codelineno-5-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;read_file&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#02-mcp-ollama-__codelineno-5-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#02-mcp-ollama-__codelineno-5-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#02-mcp-ollama-__codelineno-5-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">encoding</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">BufferEncoding</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;utf8&quot;</span><span class="p">;</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#02-mcp-ollama-__codelineno-5-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">1048576</span><span class="p">;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#02-mcp-ollama-__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#02-mcp-ollama-__codelineno-5-7"></a><span class="w">    </span><span class="c1">// Security: Validate input</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#02-mcp-ollama-__codelineno-5-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">filepath</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">filepath</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#02-mcp-ollama-__codelineno-5-9"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;filepath must be a non-empty string&quot;</span><span class="p">);</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#02-mcp-ollama-__codelineno-5-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#02-mcp-ollama-__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#02-mcp-ollama-__codelineno-5-12"></a><span class="w">    </span><span class="c1">// Security: Resolve and validate path</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#02-mcp-ollama-__codelineno-5-13"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">resolvedPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">filepath</span><span class="p">);</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#02-mcp-ollama-__codelineno-5-14"></a>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#02-mcp-ollama-__codelineno-5-15"></a><span class="w">    </span><span class="c1">// Prevent directory traversal attacks</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#02-mcp-ollama-__codelineno-5-16"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">resolvedPath</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#02-mcp-ollama-__codelineno-5-17"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Access denied: file path outside allowed directory&quot;</span><span class="p">);</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#02-mcp-ollama-__codelineno-5-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#02-mcp-ollama-__codelineno-5-19"></a>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#02-mcp-ollama-__codelineno-5-20"></a><span class="w">    </span><span class="c1">// Check if file exists and is readable</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#02-mcp-ollama-__codelineno-5-21"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#02-mcp-ollama-__codelineno-5-22"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">,</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">R_OK</span><span class="p">);</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#02-mcp-ollama-__codelineno-5-23"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#02-mcp-ollama-__codelineno-5-24"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`File not found or not readable: </span><span class="si">${</span><span class="nx">filepath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#02-mcp-ollama-__codelineno-5-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#02-mcp-ollama-__codelineno-5-26"></a>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#02-mcp-ollama-__codelineno-5-27"></a><span class="w">    </span><span class="c1">// Get file stats</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#02-mcp-ollama-__codelineno-5-28"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">);</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#02-mcp-ollama-__codelineno-5-29"></a>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#02-mcp-ollama-__codelineno-5-30"></a><span class="w">    </span><span class="c1">// Check if it&#39;s actually a file (not a directory)</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#02-mcp-ollama-__codelineno-5-31"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">stats</span><span class="p">.</span><span class="nx">isFile</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#02-mcp-ollama-__codelineno-5-32"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Path is not a file: </span><span class="si">${</span><span class="nx">filepath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#02-mcp-ollama-__codelineno-5-33"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#02-mcp-ollama-__codelineno-5-34"></a>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#02-mcp-ollama-__codelineno-5-35"></a><span class="w">    </span><span class="c1">// Check file size</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#02-mcp-ollama-__codelineno-5-36"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">maxSize</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#02-mcp-ollama-__codelineno-5-37"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#02-mcp-ollama-__codelineno-5-38"></a><span class="w">        </span><span class="sb">`File too large: </span><span class="si">${</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="si">}</span><span class="sb"> bytes (max: </span><span class="si">${</span><span class="nx">maxSize</span><span class="si">}</span><span class="sb">)`</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#02-mcp-ollama-__codelineno-5-39"></a><span class="w">      </span><span class="p">);</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#02-mcp-ollama-__codelineno-5-40"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#02-mcp-ollama-__codelineno-5-41"></a>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#02-mcp-ollama-__codelineno-5-42"></a><span class="w">    </span><span class="c1">// Read file content</span>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#02-mcp-ollama-__codelineno-5-43"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">,</span><span class="w"> </span><span class="nx">encoding</span><span class="p">);</span>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#02-mcp-ollama-__codelineno-5-44"></a>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#02-mcp-ollama-__codelineno-5-45"></a><span class="w">    </span><span class="c1">// Format response with metadata</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#02-mcp-ollama-__codelineno-5-46"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">fileInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#02-mcp-ollama-__codelineno-5-47"></a><span class="w">      </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="kt">resolvedPath</span><span class="p">,</span>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#02-mcp-ollama-__codelineno-5-48"></a><span class="w">      </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="kt">stats.size</span><span class="p">,</span>
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#02-mcp-ollama-__codelineno-5-49"></a><span class="w">      </span><span class="nx">modified</span><span class="o">:</span><span class="w"> </span><span class="kt">stats.mtime.toISOString</span><span class="p">(),</span>
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#02-mcp-ollama-__codelineno-5-50"></a><span class="w">      </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="kt">encoding</span>
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#02-mcp-ollama-__codelineno-5-51"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#02-mcp-ollama-__codelineno-5-52"></a>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#02-mcp-ollama-__codelineno-5-53"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#02-mcp-ollama-__codelineno-5-54"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#02-mcp-ollama-__codelineno-5-55"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#02-mcp-ollama-__codelineno-5-56"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#02-mcp-ollama-__codelineno-5-57"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`File Information:\n</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">fileInfo</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">\n\nContent:\n</span><span class="si">${</span><span class="nx">content</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#02-mcp-ollama-__codelineno-5-58"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#02-mcp-ollama-__codelineno-5-59"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#02-mcp-ollama-__codelineno-5-60"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#02-mcp-ollama-__codelineno-5-61"></a>
</span><span id="__span-5-62"><a id="__codelineno-5-62" name="__codelineno-5-62" href="#02-mcp-ollama-__codelineno-5-62"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-63"><a id="__codelineno-5-63" name="__codelineno-5-63" href="#02-mcp-ollama-__codelineno-5-63"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-5-64"><a id="__codelineno-5-64" name="__codelineno-5-64" href="#02-mcp-ollama-__codelineno-5-64"></a><span class="w">      </span><span class="sb">`Failed to read file: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-5-65"><a id="__codelineno-5-65" name="__codelineno-5-65" href="#02-mcp-ollama-__codelineno-5-65"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-5-66"><a id="__codelineno-5-66" name="__codelineno-5-66" href="#02-mcp-ollama-__codelineno-5-66"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-67"><a id="__codelineno-5-67" name="__codelineno-5-67" href="#02-mcp-ollama-__codelineno-5-67"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
</ol>
<hr />
<h4 id="02-mcp-ollama-testing-the-file-operations-tool">Testing the File Operations Tool<a class="headerlink" href="#02-mcp-ollama-testing-the-file-operations-tool" title="Permanent link">&para;</a></h4>
<h2 id="02-mcp-ollama-step-1-create-test-file">Step 1: Create Test File<a class="headerlink" href="#02-mcp-ollama-step-1-create-test-file" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#02-mcp-ollama-__codelineno-6-1"></a><span class="c1"># Create a test directory and files</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#02-mcp-ollama-__codelineno-6-2"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>test-files
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#02-mcp-ollama-__codelineno-6-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hello, this is a test file\!&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test-files/hello.txt
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#02-mcp-ollama-__codelineno-6-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;test&quot;, &quot;value&quot;: 123}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>test-files/data.json
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#02-mcp-ollama-__codelineno-6-5"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Line 1\nLine 2\nLine 3&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test-files/lines.txt
</span></code></pre></div>
<hr />
<h2 id="02-mcp-ollama-step-2-start-the-mcp-inspector">Step 2: Start the MCP Inspector<a class="headerlink" href="#02-mcp-ollama-step-2-start-the-mcp-inspector" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#02-mcp-ollama-__codelineno-7-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>mcp.ts
</span></code></pre></div>
<hr />
<h2 id="02-mcp-ollama-step-3-test-file-reading">Step 3: Test File Reading<a class="headerlink" href="#02-mcp-ollama-step-3-test-file-reading" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Test with a simple text file</strong>:</p>
<ul>
<li>Tool: <code>read_file</code></li>
<li>filepath: <code>/absolute/path/to/test-files/hello.txt</code> (use the full absolute path)</li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Test with JSON file</strong>:</p>
<ul>
<li>Tool: <code>read_file</code></li>
<li>filepath: <code>/absolute/path/to/test-files/data.json</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Test with different encoding</strong>:</p>
<ul>
<li>Tool: <code>read_file</code></li>
<li>filepath: <code>/absolute/path/to/test-files/hello.txt</code></li>
<li>encoding: <code>base64</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Test file size limit</strong>:</p>
<ul>
<li>Create a large file: <code>dd if=/dev/zero of=test-files/large.txt bs=1M count=2</code></li>
<li>Try reading it with default maxSize (1MB)</li>
<li>Try with maxSize: <code>2097152</code> (2MB)</li>
</ul>
</li>
</ol>
<hr />
<h2 id="02-mcp-ollama-step-4-test-error-cases">Step 4: Test Error Cases<a class="headerlink" href="#02-mcp-ollama-step-4-test-error-cases" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Non-existent file</strong>:</p>
<ul>
<li>filepath: <code>/absolute/path/to/test-files/nonexistent.txt</code></li>
</ul>
</li>
<li>
<p><strong>Directory instead of file</strong>:</p>
<ul>
<li>filepath: <code>/absolute/path/to/test-files</code> (the directory itself)</li>
</ul>
</li>
<li>
<p><strong>Empty filepath</strong>:</p>
<ul>
<li>filepath: <code>""</code></li>
</ul>
</li>
<li>
<p><strong>Path traversal attempt</strong>:</p>
<ul>
<li>filepath: <code>/absolute/path/../../../etc/passwd</code></li>
</ul>
</li>
</ol>
<hr />
<h2 id="02-mcp-ollama-step-5-verify-output">Step 5: Verify Output<a class="headerlink" href="#02-mcp-ollama-step-5-verify-output" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>You should see output like:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#02-mcp-ollama-__codelineno-8-1"></a>File Information:
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#02-mcp-ollama-__codelineno-8-2"></a>{
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#02-mcp-ollama-__codelineno-8-3"></a>  &quot;path&quot;: &quot;/Users/username/project/test-files/hello.txt&quot;,
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#02-mcp-ollama-__codelineno-8-4"></a>  &quot;size&quot;: 27,
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#02-mcp-ollama-__codelineno-8-5"></a>  &quot;modified&quot;: &quot;2024-01-06T10:30:00.000Z&quot;,
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#02-mcp-ollama-__codelineno-8-6"></a>  &quot;encoding&quot;: &quot;utf8&quot;
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#02-mcp-ollama-__codelineno-8-7"></a>}
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#02-mcp-ollama-__codelineno-8-8"></a>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#02-mcp-ollama-__codelineno-8-9"></a>Content:
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#02-mcp-ollama-__codelineno-8-10"></a>Hello, this is a test file!
</span></code></pre></div>
</li>
</ul>
<h4 id="02-mcp-ollama-troubleshooting"><strong>Troubleshooting:</strong><a class="headerlink" href="#02-mcp-ollama-troubleshooting" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>&ldquo;File not found&rdquo;</strong>: Make sure you&rsquo;re using the absolute path</li>
<li><strong>&ldquo;Access denied&rdquo;</strong>: The file path is outside your project directory</li>
<li><strong>&ldquo;Path is not a file&rdquo;</strong>: You tried to read a directory</li>
<li><strong>&ldquo;File too large&rdquo;</strong>: Increase the maxSize parameter</li>
</ul>
<h4 id="02-mcp-ollama-key-learning-points">Key Learning Points:<a class="headerlink" href="#02-mcp-ollama-key-learning-points" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Path security</strong> and preventing directory traversal attacks</li>
<li><strong>File system operations</strong> with Node.js fs/promises</li>
<li><strong>Input validation</strong> beyond JSON Schema</li>
<li><strong>File metadata</strong> extraction and formatting</li>
<li><strong>Error handling</strong> for various file system scenarios</li>
<li><strong>Resource limits</strong> to prevent abuse</li>
</ul>
<hr />
<h3 id="02-mcp-ollama-tool-3-database-query">Tool 3: Database Query<a class="headerlink" href="#02-mcp-ollama-tool-3-database-query" title="Permanent link">&para;</a></h3>
<h4 id="02-mcp-ollama-goal_2">Goal<a class="headerlink" href="#02-mcp-ollama-goal_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Create a secure database query tool that can execute <code>SELECT</code> statements on a <code>SQLite</code> database with proper validation and safety measures.</li>
</ul>
<h4 id="02-mcp-ollama-complete-database-query-tool-implementation">Complete Database Query Tool Implementation<a class="headerlink" href="#02-mcp-ollama-complete-database-query-tool-implementation" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>First, install the SQLite dependency:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#02-mcp-ollama-__codelineno-9-1"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>better-sqlite3
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#02-mcp-ollama-__codelineno-9-2"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@types/better-sqlite3
</span></code></pre></div>
</li>
<li>
<p>Now add the <code>query_database</code> tool to your existing <code>src/index.ts</code> file by following these specific steps:</p>
</li>
<li>
<p><strong>Add the imports</strong> at the top of your file (after existing imports):
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#02-mcp-ollama-__codelineno-10-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">Database</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;better-sqlite3&#39;</span><span class="p">;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add the <code>query_database</code> tool to your tools array</strong> in the <code>ListToolsRequestSchema</code> handler:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#02-mcp-ollama-__codelineno-11-1"></a><span class="p">{</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#02-mcp-ollama-__codelineno-11-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;query_database&quot;</span><span class="p">,</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#02-mcp-ollama-__codelineno-11-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Execute SELECT queries on a SQLite database&quot;</span><span class="p">,</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#02-mcp-ollama-__codelineno-11-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#02-mcp-ollama-__codelineno-11-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#02-mcp-ollama-__codelineno-11-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#02-mcp-ollama-__codelineno-11-7"></a><span class="w">      </span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#02-mcp-ollama-__codelineno-11-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#02-mcp-ollama-__codelineno-11-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;SQL SELECT query to execute&quot;</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#02-mcp-ollama-__codelineno-11-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#02-mcp-ollama-__codelineno-11-11"></a><span class="w">      </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#02-mcp-ollama-__codelineno-11-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#02-mcp-ollama-__codelineno-11-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Query parameters for prepared statement&quot;</span><span class="p">,</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#02-mcp-ollama-__codelineno-11-14"></a><span class="w">        </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#02-mcp-ollama-__codelineno-11-15"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;null&quot;</span><span class="p">]</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#02-mcp-ollama-__codelineno-11-16"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#02-mcp-ollama-__codelineno-11-17"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#02-mcp-ollama-__codelineno-11-18"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#02-mcp-ollama-__codelineno-11-19"></a><span class="w">      </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#02-mcp-ollama-__codelineno-11-20"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#02-mcp-ollama-__codelineno-11-21"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum number of rows to return&quot;</span><span class="p">,</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#02-mcp-ollama-__codelineno-11-22"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#02-mcp-ollama-__codelineno-11-23"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="p">,</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#02-mcp-ollama-__codelineno-11-24"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#02-mcp-ollama-__codelineno-11-25"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#02-mcp-ollama-__codelineno-11-26"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#02-mcp-ollama-__codelineno-11-27"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#02-mcp-ollama-__codelineno-11-28"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#02-mcp-ollama-__codelineno-11-29"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add the <code>query_database</code> handler</strong> in the <code>CallToolRequestSchema</code> handler (before the final <code>throw new Error</code>):
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#02-mcp-ollama-__codelineno-12-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;query_database&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#02-mcp-ollama-__codelineno-12-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#02-mcp-ollama-__codelineno-12-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">query</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#02-mcp-ollama-__codelineno-12-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">parameters</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">[])</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#02-mcp-ollama-__codelineno-12-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">limit</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#02-mcp-ollama-__codelineno-12-6"></a>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#02-mcp-ollama-__codelineno-12-7"></a><span class="w">    </span><span class="c1">// Security: Validate input</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#02-mcp-ollama-__codelineno-12-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">query</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">query</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#02-mcp-ollama-__codelineno-12-9"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;query must be a non-empty string&quot;</span><span class="p">);</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#02-mcp-ollama-__codelineno-12-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#02-mcp-ollama-__codelineno-12-11"></a>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#02-mcp-ollama-__codelineno-12-12"></a><span class="w">    </span><span class="c1">// Security: Only allow SELECT queries</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#02-mcp-ollama-__codelineno-12-13"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">trimmedQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">query</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toUpperCase</span><span class="p">();</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#02-mcp-ollama-__codelineno-12-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">trimmedQuery</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;SELECT&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#02-mcp-ollama-__codelineno-12-15"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Only SELECT queries are allowed for security&quot;</span><span class="p">);</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#02-mcp-ollama-__codelineno-12-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#02-mcp-ollama-__codelineno-12-17"></a>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#02-mcp-ollama-__codelineno-12-18"></a><span class="w">    </span><span class="c1">// Check if database file exists</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#02-mcp-ollama-__codelineno-12-19"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">dbPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./data.db&#39;</span><span class="p">;</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#02-mcp-ollama-__codelineno-12-20"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#02-mcp-ollama-__codelineno-12-21"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="nx">dbPath</span><span class="p">,</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">R_OK</span><span class="p">);</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#02-mcp-ollama-__codelineno-12-22"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#02-mcp-ollama-__codelineno-12-23"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Database file &#39;data.db&#39; not found in project root&quot;</span><span class="p">);</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#02-mcp-ollama-__codelineno-12-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#02-mcp-ollama-__codelineno-12-25"></a>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#02-mcp-ollama-__codelineno-12-26"></a><span class="w">    </span><span class="c1">// Open database in read-only mode</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#02-mcp-ollama-__codelineno-12-27"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Database</span><span class="p">(</span><span class="nx">dbPath</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">readonly</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#02-mcp-ollama-__codelineno-12-28"></a>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#02-mcp-ollama-__codelineno-12-29"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#02-mcp-ollama-__codelineno-12-30"></a><span class="w">      </span><span class="c1">// Prepare statement</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#02-mcp-ollama-__codelineno-12-31"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="nx">query</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; LIMIT ?&#39;</span><span class="p">);</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#02-mcp-ollama-__codelineno-12-32"></a>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#02-mcp-ollama-__codelineno-12-33"></a><span class="w">      </span><span class="c1">// Execute query</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#02-mcp-ollama-__codelineno-12-34"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stmt</span><span class="p">.</span><span class="nx">all</span><span class="p">(...</span><span class="nx">parameters</span><span class="p">,</span><span class="w"> </span><span class="nx">limit</span><span class="p">);</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#02-mcp-ollama-__codelineno-12-35"></a>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#02-mcp-ollama-__codelineno-12-36"></a><span class="w">      </span><span class="c1">// Format results</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#02-mcp-ollama-__codelineno-12-37"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resultText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#02-mcp-ollama-__codelineno-12-38"></a><span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">rows</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#02-mcp-ollama-__codelineno-12-39"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;No results found&quot;</span><span class="p">;</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#02-mcp-ollama-__codelineno-12-40"></a>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41" href="#02-mcp-ollama-__codelineno-12-41"></a><span class="w">      </span><span class="c1">// Get query info</span>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42" href="#02-mcp-ollama-__codelineno-12-42"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stmt</span><span class="p">.</span><span class="nx">columns</span><span class="p">();</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43" href="#02-mcp-ollama-__codelineno-12-43"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">columnNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">info</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">col</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">col</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span><span id="__span-12-44"><a id="__codelineno-12-44" name="__codelineno-12-44" href="#02-mcp-ollama-__codelineno-12-44"></a>
</span><span id="__span-12-45"><a id="__codelineno-12-45" name="__codelineno-12-45" href="#02-mcp-ollama-__codelineno-12-45"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-46"><a id="__codelineno-12-46" name="__codelineno-12-46" href="#02-mcp-ollama-__codelineno-12-46"></a><span class="w">        </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-12-47"><a id="__codelineno-12-47" name="__codelineno-12-47" href="#02-mcp-ollama-__codelineno-12-47"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-12-48"><a id="__codelineno-12-48" name="__codelineno-12-48" href="#02-mcp-ollama-__codelineno-12-48"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-12-49"><a id="__codelineno-12-49" name="__codelineno-12-49" href="#02-mcp-ollama-__codelineno-12-49"></a><span class="w">            </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Query executed successfully.\nDatabase: </span><span class="si">${</span><span class="nx">dbPath</span><span class="si">}</span><span class="sb">\nColumns: </span><span class="si">${</span><span class="nx">columnNames</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">\nRows returned: </span><span class="si">${</span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb">\n\nResults:\n</span><span class="si">${</span><span class="nx">resultText</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-12-50"><a id="__codelineno-12-50" name="__codelineno-12-50" href="#02-mcp-ollama-__codelineno-12-50"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-12-51"><a id="__codelineno-12-51" name="__codelineno-12-51" href="#02-mcp-ollama-__codelineno-12-51"></a><span class="w">        </span><span class="p">]</span>
</span><span id="__span-12-52"><a id="__codelineno-12-52" name="__codelineno-12-52" href="#02-mcp-ollama-__codelineno-12-52"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-12-53"><a id="__codelineno-12-53" name="__codelineno-12-53" href="#02-mcp-ollama-__codelineno-12-53"></a>
</span><span id="__span-12-54"><a id="__codelineno-12-54" name="__codelineno-12-54" href="#02-mcp-ollama-__codelineno-12-54"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-55"><a id="__codelineno-12-55" name="__codelineno-12-55" href="#02-mcp-ollama-__codelineno-12-55"></a><span class="w">      </span><span class="nx">db</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-12-56"><a id="__codelineno-12-56" name="__codelineno-12-56" href="#02-mcp-ollama-__codelineno-12-56"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-57"><a id="__codelineno-12-57" name="__codelineno-12-57" href="#02-mcp-ollama-__codelineno-12-57"></a>
</span><span id="__span-12-58"><a id="__codelineno-12-58" name="__codelineno-12-58" href="#02-mcp-ollama-__codelineno-12-58"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-59"><a id="__codelineno-12-59" name="__codelineno-12-59" href="#02-mcp-ollama-__codelineno-12-59"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-12-60"><a id="__codelineno-12-60" name="__codelineno-12-60" href="#02-mcp-ollama-__codelineno-12-60"></a><span class="w">      </span><span class="sb">`Database query failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-12-61"><a id="__codelineno-12-61" name="__codelineno-12-61" href="#02-mcp-ollama-__codelineno-12-61"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-12-62"><a id="__codelineno-12-62" name="__codelineno-12-62" href="#02-mcp-ollama-__codelineno-12-62"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-63"><a id="__codelineno-12-63" name="__codelineno-12-63" href="#02-mcp-ollama-__codelineno-12-63"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
</ul>
<hr />
<h4 id="02-mcp-ollama-testing-the-database-query-tool">Testing the Database Query Tool<a class="headerlink" href="#02-mcp-ollama-testing-the-database-query-tool" title="Permanent link">&para;</a></h4>
<p><strong>Step 1: Install SQLite</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#02-mcp-ollama-__codelineno-13-1"></a><span class="c1"># Install sqlite3 command-line tool (if not already installed)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#02-mcp-ollama-__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#02-mcp-ollama-__codelineno-13-3"></a><span class="c1"># On macOS:</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#02-mcp-ollama-__codelineno-13-4"></a>brew<span class="w"> </span>install<span class="w"> </span>sqlite3
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#02-mcp-ollama-__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#02-mcp-ollama-__codelineno-13-6"></a><span class="c1"># On Linux (Ubuntu/Debian):</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#02-mcp-ollama-__codelineno-13-7"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>sqlite3
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#02-mcp-ollama-__codelineno-13-8"></a>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#02-mcp-ollama-__codelineno-13-9"></a><span class="c1"># On Linux (CentOS/RHEL/Fedora):</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#02-mcp-ollama-__codelineno-13-10"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>sqlite3<span class="w">    </span><span class="c1"># or sudo dnf install sqlite3</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#02-mcp-ollama-__codelineno-13-11"></a>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#02-mcp-ollama-__codelineno-13-12"></a><span class="c1"># On Windows (using Chocolatey):</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#02-mcp-ollama-__codelineno-13-13"></a>choco<span class="w"> </span>install<span class="w"> </span>sqlite
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#02-mcp-ollama-__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#02-mcp-ollama-__codelineno-13-15"></a><span class="c1"># On Windows (manual download):</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#02-mcp-ollama-__codelineno-13-16"></a><span class="c1"># Download from: https://www.sqlite.org/download.html</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#02-mcp-ollama-__codelineno-13-17"></a><span class="c1"># Extract sqlite3.exe to a folder in your PATH</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#02-mcp-ollama-__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#02-mcp-ollama-__codelineno-13-19"></a><span class="c1"># Verify installation:</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#02-mcp-ollama-__codelineno-13-20"></a>sqlite3<span class="w"> </span>--version
</span></code></pre></div>
<hr />
<p><strong>Step 2: Create a Sample Database</strong></p>
<p><strong>Navigate to your MCP server directory</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#02-mcp-ollama-__codelineno-14-1"></a><span class="nb">cd</span><span class="w"> </span>/Users/orni/Code-Wizard/MCP_Lab/MCP_Lab/lab_solution/my-first-mcp-server
</span></code></pre></div>
<p><strong>Run the database creation command</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#02-mcp-ollama-__codelineno-15-1"></a>sqlite3<span class="w"> </span>data.db<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#02-mcp-ollama-__codelineno-15-2"></a><span class="s">CREATE TABLE users (</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#02-mcp-ollama-__codelineno-15-3"></a><span class="s">  id INTEGER PRIMARY KEY,</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#02-mcp-ollama-__codelineno-15-4"></a><span class="s">  name TEXT NOT NULL,</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#02-mcp-ollama-__codelineno-15-5"></a><span class="s">  email TEXT UNIQUE,</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#02-mcp-ollama-__codelineno-15-6"></a><span class="s">  age INTEGER,</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#02-mcp-ollama-__codelineno-15-7"></a><span class="s">  created_at DATETIME DEFAULT CURRENT_TIMESTAMP</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#02-mcp-ollama-__codelineno-15-8"></a><span class="s">);</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#02-mcp-ollama-__codelineno-15-9"></a>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#02-mcp-ollama-__codelineno-15-10"></a><span class="s">CREATE TABLE products (</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#02-mcp-ollama-__codelineno-15-11"></a><span class="s">  id INTEGER PRIMARY KEY,</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#02-mcp-ollama-__codelineno-15-12"></a><span class="s">  name TEXT NOT NULL,</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#02-mcp-ollama-__codelineno-15-13"></a><span class="s">  price REAL,</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#02-mcp-ollama-__codelineno-15-14"></a><span class="s">  category TEXT,</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#02-mcp-ollama-__codelineno-15-15"></a><span class="s">  in_stock BOOLEAN DEFAULT 1</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#02-mcp-ollama-__codelineno-15-16"></a><span class="s">);</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#02-mcp-ollama-__codelineno-15-17"></a>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#02-mcp-ollama-__codelineno-15-18"></a><span class="s">INSERT INTO users (name, email, age) VALUES </span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#02-mcp-ollama-__codelineno-15-19"></a><span class="s">  (&#39;Alice Johnson&#39;, &#39;alice@example.com&#39;, 28),</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#02-mcp-ollama-__codelineno-15-20"></a><span class="s">  (&#39;Bob Smith&#39;, &#39;bob@example.com&#39;, 34),</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#02-mcp-ollama-__codelineno-15-21"></a><span class="s">  (&#39;Charlie Brown&#39;, &#39;charlie@example.com&#39;, 22);</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#02-mcp-ollama-__codelineno-15-22"></a>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#02-mcp-ollama-__codelineno-15-23"></a><span class="s">INSERT INTO products (name, price, category, in_stock) VALUES </span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#02-mcp-ollama-__codelineno-15-24"></a><span class="s">  (&#39;Laptop&#39;, 999.99, &#39;Electronics&#39;, 1),</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#02-mcp-ollama-__codelineno-15-25"></a><span class="s">  (&#39;Book&#39;, 19.99, &#39;Education&#39;, 1),</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#02-mcp-ollama-__codelineno-15-26"></a><span class="s">  (&#39;Coffee Mug&#39;, 12.50, &#39;Kitchen&#39;, 0);</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#02-mcp-ollama-__codelineno-15-27"></a>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#02-mcp-ollama-__codelineno-15-28"></a><span class="s">.quit</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#02-mcp-ollama-__codelineno-15-29"></a><span class="s">EOF</span>
</span></code></pre></div>
<p><strong>Verify the database was created</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#02-mcp-ollama-__codelineno-16-1"></a>sqlite3<span class="w"> </span>data.db<span class="w"> </span><span class="s2">&quot;SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;&quot;</span>
</span></code></pre></div>
<ul>
<li>
<p>You should see output like:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#02-mcp-ollama-__codelineno-17-1"></a>users
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#02-mcp-ollama-__codelineno-17-2"></a>products
</span></code></pre></div>
</li>
</ul>
<p><strong>What this does:</strong></p>
<ul>
<li>Creates a SQLite database file called <code>data.db</code> in your project directory</li>
<li>Creates two tables: <code>users</code> and <code>products</code></li>
<li>Inserts sample data into both tables</li>
<li>This gives you test data to query with your <code>query_database</code> tool</li>
</ul>
<hr />
<p><strong>Step 2: Start the MCP Inspector</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#02-mcp-ollama-__codelineno-18-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>mcp.ts
</span></code></pre></div>
<hr />
<p><strong>Step 3: Test Database Queries</strong></p>
<ol>
<li>
<p><strong>Simple SELECT query</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT * FROM users</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Query with WHERE clause</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT name, email FROM users WHERE age &gt; 25</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Query with parameters</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT * FROM products WHERE category = ?</code></li>
<li>parameters: <code>["Electronics"]</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Query with LIMIT</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT * FROM users</code></li>
<li>limit: <code>2</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>JOIN query</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT u.name, p.name as product FROM users u CROSS JOIN products p LIMIT 5</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
</ol>
<hr />
<p><strong>Step 4: Test Error Cases</strong></p>
<ol>
<li>
<p><strong>Non-SELECT query</strong>:</p>
<ul>
<li>query: <code>DELETE FROM users WHERE id = 1</code></li>
</ul>
</li>
<li>
<p><strong>Invalid SQL syntax</strong>:</p>
<ul>
<li>query: <code>SELECT * FROM nonexistent_table</code></li>
</ul>
</li>
<li>
<p><strong>Missing database file</strong>:</p>
<ul>
<li>Rename <code>data.db</code> to <code>data.db.backup</code> and try a query</li>
</ul>
</li>
<li>
<p><strong>Empty query</strong>:</p>
<ul>
<li>query: <code>""</code></li>
</ul>
</li>
</ol>
<hr />
<p><strong>Step 5: Verify Output</strong></p>
<ul>
<li>
<p>You should see output like:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#02-mcp-ollama-__codelineno-19-1"></a>Query executed successfully.
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#02-mcp-ollama-__codelineno-19-2"></a>Database: ./data.db
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#02-mcp-ollama-__codelineno-19-3"></a>Columns: id, name, email, age, created_at
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#02-mcp-ollama-__codelineno-19-4"></a>Rows returned: 3
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#02-mcp-ollama-__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#02-mcp-ollama-__codelineno-19-6"></a>Results:
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#02-mcp-ollama-__codelineno-19-7"></a>[
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#02-mcp-ollama-__codelineno-19-8"></a>  {
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#02-mcp-ollama-__codelineno-19-9"></a>    &quot;id&quot;: 1,
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#02-mcp-ollama-__codelineno-19-10"></a>    &quot;name&quot;: &quot;Alice Johnson&quot;,
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#02-mcp-ollama-__codelineno-19-11"></a>    &quot;email&quot;: &quot;alice@example.com&quot;,
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#02-mcp-ollama-__codelineno-19-12"></a>    &quot;age&quot;: 28,
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#02-mcp-ollama-__codelineno-19-13"></a>    &quot;created_at&quot;: &quot;2024-01-06 10:30:00&quot;
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#02-mcp-ollama-__codelineno-19-14"></a>  },
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#02-mcp-ollama-__codelineno-19-15"></a>  ...
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#02-mcp-ollama-__codelineno-19-16"></a>]
</span></code></pre></div>
</li>
</ul>
<p><strong>Troubleshooting:</strong></p>
<ul>
<li><strong>&ldquo;Database file not found&rdquo;</strong>: Make sure <code>data.db</code> exists in your project root</li>
<li><strong>&ldquo;Only SELECT queries are allowed&rdquo;</strong>: The tool only allows SELECT statements for security</li>
<li><strong>&ldquo;no such table&rdquo;</strong>: Check your table names in the database</li>
<li><strong>&ldquo;sqlite3: command not found&rdquo;</strong>: Install sqlite3 CLI tool</li>
</ul>
<h4 id="02-mcp-ollama-key-learning-points_1">Key Learning Points:<a class="headerlink" href="#02-mcp-ollama-key-learning-points_1" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>SQL injection prevention</strong> using prepared statements</li>
<li><strong>Database security</strong> with read-only access and query restrictions</li>
<li><strong>SQLite operations</strong> with better-sqlite3</li>
<li><strong>Query parameterization</strong> for safe dynamic queries</li>
<li><strong>Result formatting</strong> and metadata extraction</li>
<li><strong>Resource management</strong> with proper database connection handling</li>
</ul>
<hr />
<h2 id="02-mcp-ollama-returning-rich-content">Returning Rich Content<a class="headerlink" href="#02-mcp-ollama-returning-rich-content" title="Permanent link">&para;</a></h2>
<ul>
<li>MCP supports multiple content types in tool responses, allowing you to return not just text but also images, resources, and combinations of different content types. </li>
<li>This enables richer, more interactive responses that can include visual data, file references, and structured information.</li>
</ul>
<h3 id="02-mcp-ollama-1-text-content">1. Text Content<a class="headerlink" href="#02-mcp-ollama-1-text-content" title="Permanent link">&para;</a></h3>
<p><strong>Text content</strong> is the most common and basic type of response. <br />
Use it for any string-based information like analysis results, status messages, or formatted data.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#02-mcp-ollama-__codelineno-20-1"></a><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#02-mcp-ollama-__codelineno-20-2"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#02-mcp-ollama-__codelineno-20-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#02-mcp-ollama-__codelineno-20-4"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#02-mcp-ollama-__codelineno-20-5"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Simple text response&quot;</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#02-mcp-ollama-__codelineno-20-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#02-mcp-ollama-__codelineno-20-7"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#02-mcp-ollama-__codelineno-20-8"></a><span class="p">};</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Most tool responses will use text content. 
It&rsquo;s perfect for:</p>
<ul>
<li>Status messages and confirmations</li>
<li>Formatted data output (JSON, tables, lists)</li>
<li>Error messages and explanations</li>
<li>Analysis results and summaries</li>
</ul>
<h3 id="02-mcp-ollama-2-image-content">2. Image Content<a class="headerlink" href="#02-mcp-ollama-2-image-content" title="Permanent link">&para;</a></h3>
<p><strong>Image content</strong> allows you to return visual data directly in the response. The image data must be base64-encoded and include the appropriate MIME type.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#02-mcp-ollama-__codelineno-21-1"></a><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#02-mcp-ollama-__codelineno-21-2"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#02-mcp-ollama-__codelineno-21-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#02-mcp-ollama-__codelineno-21-4"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image&quot;</span><span class="p">,</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#02-mcp-ollama-__codelineno-21-5"></a><span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">base64ImageData</span><span class="p">,</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#02-mcp-ollama-__codelineno-21-6"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#02-mcp-ollama-__codelineno-21-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#02-mcp-ollama-__codelineno-21-8"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#02-mcp-ollama-__codelineno-21-9"></a><span class="p">};</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Ideal for tools that generate or process visual content:</p>
<ul>
<li>Charts and graphs from data analysis</li>
<li>Screenshots or visual captures</li>
<li>Generated diagrams or illustrations</li>
<li>Image processing results</li>
</ul>
<p><strong>Important:</strong> Always specify the correct MIME type (image/png, image/jpeg, image/svg+xml, etc.) and ensure the base64 data is properly encoded.</p>
<h3 id="02-mcp-ollama-3-resource-content">3. Resource Content<a class="headerlink" href="#02-mcp-ollama-3-resource-content" title="Permanent link">&para;</a></h3>
<p><strong>Resource content</strong> references external resources rather than including their data directly. This is useful for large files or when you want to provide access to resources without embedding them.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#02-mcp-ollama-__codelineno-22-1"></a><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#02-mcp-ollama-__codelineno-22-2"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#02-mcp-ollama-__codelineno-22-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#02-mcp-ollama-__codelineno-22-4"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;resource&quot;</span><span class="p">,</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#02-mcp-ollama-__codelineno-22-5"></a><span class="w">      </span><span class="nx">resource</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#02-mcp-ollama-__codelineno-22-6"></a><span class="w">        </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;file:///path/to/file.txt&quot;</span><span class="p">,</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#02-mcp-ollama-__codelineno-22-7"></a><span class="w">        </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text/plain&quot;</span><span class="p">,</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#02-mcp-ollama-__codelineno-22-8"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;File contents...&quot;</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#02-mcp-ollama-__codelineno-22-9"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#02-mcp-ollama-__codelineno-22-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#02-mcp-ollama-__codelineno-22-11"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#02-mcp-ollama-__codelineno-22-12"></a><span class="p">};</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Best for:</p>
<ul>
<li>Large files that would make responses too bulky</li>
<li>References to external files or URLs</li>
<li>When the client should handle the resource directly</li>
<li>Providing access to generated files</li>
</ul>
<p><strong>Note:</strong> The <code>text</code> field is optional - you can omit it if the resource content is too large or if you just want to provide a reference.</p>
<h3 id="02-mcp-ollama-4-multiple-content-items">4. Multiple Content Items<a class="headerlink" href="#02-mcp-ollama-4-multiple-content-items" title="Permanent link">&para;</a></h3>
<p><strong>Multiple content items</strong> allow you to combine different types of content in a single response. This creates rich, multi-part responses that can include text explanations alongside visual data.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#02-mcp-ollama-__codelineno-23-1"></a><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#02-mcp-ollama-__codelineno-23-2"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#02-mcp-ollama-__codelineno-23-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#02-mcp-ollama-__codelineno-23-4"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#02-mcp-ollama-__codelineno-23-5"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analysis complete:&quot;</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#02-mcp-ollama-__codelineno-23-6"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#02-mcp-ollama-__codelineno-23-7"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#02-mcp-ollama-__codelineno-23-8"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#02-mcp-ollama-__codelineno-23-9"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Details:\n- Item 1\n- Item 2&quot;</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#02-mcp-ollama-__codelineno-23-10"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#02-mcp-ollama-__codelineno-23-11"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#02-mcp-ollama-__codelineno-23-12"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image&quot;</span><span class="p">,</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#02-mcp-ollama-__codelineno-23-13"></a><span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">chartImage</span><span class="p">,</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#02-mcp-ollama-__codelineno-23-14"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#02-mcp-ollama-__codelineno-23-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#02-mcp-ollama-__codelineno-23-16"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#02-mcp-ollama-__codelineno-23-17"></a><span class="p">};</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Perfect for comprehensive responses that need multiple components:</p>
<ul>
<li>Analysis reports with both text summaries and visual charts</li>
<li>File processing results with metadata and content preview</li>
<li>Multi-step operations with status updates and final results</li>
<li>Complex data with both tabular and graphical representations</li>
</ul>
<p><strong>Tip:</strong> Order your content logically - start with text explanations, then show supporting images or resources.</p>
<hr />
<h2 id="02-mcp-ollama-error-handling-patterns">Error Handling Patterns<a class="headerlink" href="#02-mcp-ollama-error-handling-patterns" title="Permanent link">&para;</a></h2>
<p>Error handling is crucial for robust MCP tools. Different situations require different approaches to handle failures gracefully while providing useful feedback to users. Here are three essential patterns for handling errors effectively.</p>
<h3 id="02-mcp-ollama-pattern-1-input-validation">Pattern 1: Input Validation<a class="headerlink" href="#02-mcp-ollama-pattern-1-input-validation" title="Permanent link">&para;</a></h3>
<p><strong>Input validation</strong> ensures that tool arguments meet your requirements before processing begins. This prevents runtime errors and provides clear feedback when users provide invalid data.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#02-mcp-ollama-__codelineno-24-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">validateInput</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#02-mcp-ollama-__codelineno-24-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#02-mcp-ollama-__codelineno-24-3"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;filepath must be a non-empty string&quot;</span><span class="p">);</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#02-mcp-ollama-__codelineno-24-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#02-mcp-ollama-__codelineno-24-5"></a>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#02-mcp-ollama-__codelineno-24-6"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">10485760</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#02-mcp-ollama-__codelineno-24-7"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;maxSize must be between 1 and 10485760 bytes&quot;</span><span class="p">);</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#02-mcp-ollama-__codelineno-24-8"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#02-mcp-ollama-__codelineno-24-9"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Always validate inputs before processing, even when using JSON Schema validation. This pattern is essential for:</p>
<ul>
<li>Type checking beyond JSON Schema capabilities</li>
<li>Business logic validation (file size limits, path security)</li>
<li>Preventing runtime errors from malformed data</li>
<li>Providing specific, actionable error messages</li>
</ul>
<p><strong>Why it matters:</strong> Early validation fails fast and gives users clear guidance on how to fix their input.</p>
<h3 id="02-mcp-ollama-pattern-2-graceful-degradation">Pattern 2: Graceful Degradation<a class="headerlink" href="#02-mcp-ollama-pattern-2-graceful-degradation" title="Permanent link">&para;</a></h3>
<p><strong>Graceful degradation</strong> provides partial functionality when full operation isn&rsquo;t possible. Instead of failing completely, the tool returns useful information or falls back to alternative approaches.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#02-mcp-ollama-__codelineno-25-1"></a><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#02-mcp-ollama-__codelineno-25-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetchFromAPI</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#02-mcp-ollama-__codelineno-25-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">formatSuccess</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#02-mcp-ollama-__codelineno-25-4"></a><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#02-mcp-ollama-__codelineno-25-5"></a><span class="w">  </span><span class="c1">// Log error but return partial results if possible</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#02-mcp-ollama-__codelineno-25-6"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;API call failed:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#02-mcp-ollama-__codelineno-25-7"></a>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#02-mcp-ollama-__codelineno-25-8"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#02-mcp-ollama-__codelineno-25-9"></a><span class="w">    </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#02-mcp-ollama-__codelineno-25-10"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#02-mcp-ollama-__codelineno-25-11"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#02-mcp-ollama-__codelineno-25-12"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;⚠️ Could not fetch live data. Using cached results...&quot;</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#02-mcp-ollama-__codelineno-25-13"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#02-mcp-ollama-__codelineno-25-14"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#02-mcp-ollama-__codelineno-25-15"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#02-mcp-ollama-__codelineno-25-16"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For external dependencies that might be unreliable:</p>
<ul>
<li>API calls that could timeout or fail</li>
<li>Network-dependent operations</li>
<li>Services with occasional downtime</li>
<li>When partial results are better than no results</li>
</ul>
<p><strong>Why it matters:</strong> Users get some value even when systems are partially broken, improving overall reliability and user experience.</p>
<h3 id="02-mcp-ollama-pattern-3-detailed-error-context">Pattern 3: Detailed Error Context<a class="headerlink" href="#02-mcp-ollama-pattern-3-detailed-error-context" title="Permanent link">&para;</a></h3>
<p><strong>Detailed error context</strong> provides comprehensive information for debugging while keeping user-facing messages clean. Log full details internally but expose only safe, helpful information to users.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#02-mcp-ollama-__codelineno-26-1"></a><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#02-mcp-ollama-__codelineno-26-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="p">;</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#02-mcp-ollama-__codelineno-26-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#02-mcp-ollama-__codelineno-26-4"></a><span class="w">    </span><span class="nx">tool</span><span class="o">:</span><span class="w"> </span><span class="kt">name</span><span class="p">,</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#02-mcp-ollama-__codelineno-26-5"></a><span class="w">    </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="p">,</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#02-mcp-ollama-__codelineno-26-6"></a><span class="w">    </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#02-mcp-ollama-__codelineno-26-7"></a><span class="w">    </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">errorMessage</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#02-mcp-ollama-__codelineno-26-8"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#02-mcp-ollama-__codelineno-26-9"></a>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#02-mcp-ollama-__codelineno-26-10"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[Tool Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">errorContext</span><span class="p">));</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#02-mcp-ollama-__codelineno-26-11"></a>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#02-mcp-ollama-__codelineno-26-12"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#02-mcp-ollama-__codelineno-26-13"></a><span class="w">    </span><span class="sb">`Tool &#39;</span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">&#39; failed: </span><span class="si">${</span><span class="nx">errorMessage</span><span class="si">}</span><span class="sb">. Check server logs for details.`</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#02-mcp-ollama-__codelineno-26-14"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#02-mcp-ollama-__codelineno-26-15"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For complex operations where debugging might be needed:</p>
<ul>
<li>Multi-step processes with potential failure points</li>
<li>Operations involving external systems</li>
<li>When you need to track error patterns over time</li>
<li>Production environments where detailed logging is crucial</li>
</ul>
<p><strong>Why it matters:</strong> Developers can diagnose issues effectively while users get clear, non-technical error messages.</p>
<hr />
<h4 id="02-mcp-ollama-best-practices-for-error-handling"><strong>Best Practices for Error Handling:</strong><a class="headerlink" href="#02-mcp-ollama-best-practices-for-error-handling" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Fail Fast:</strong> Validate inputs early and stop processing on critical errors</li>
<li><strong>Log Internally:</strong> Use <code>console.error()</code> for detailed logging (goes to stderr, not stdout)</li>
<li><strong>User-Friendly Messages:</strong> Keep error messages clear and actionable</li>
<li><strong>Don&rsquo;t Leak Sensitive Data:</strong> Never expose file paths, credentials, or internal details</li>
<li><strong>Consistent Format:</strong> Use similar error message patterns across tools</li>
<li><strong>Recovery Options:</strong> When possible, suggest how users can resolve the issue</li>
</ul>
<hr />
<h2 id="02-mcp-ollama-async-operations-and-performance">Async Operations and Performance<a class="headerlink" href="#02-mcp-ollama-async-operations-and-performance" title="Permanent link">&para;</a></h2>
<p>MCP tools often need to handle asynchronous operations and optimize performance. Long-running tasks require special handling to prevent timeouts and provide feedback, while expensive operations benefit from caching to improve response times and reduce resource usage.</p>
<h3 id="02-mcp-ollama-long-running-operations">Long-Running Operations<a class="headerlink" href="#02-mcp-ollama-long-running-operations" title="Permanent link">&para;</a></h3>
<p><strong>Long-running operations</strong> need monitoring and progress feedback to prevent timeouts and keep users informed. Use logging and timing to track operation progress and provide completion status.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#02-mcp-ollama-__codelineno-27-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;analyze_large_file&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#02-mcp-ollama-__codelineno-27-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#02-mcp-ollama-__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#02-mcp-ollama-__codelineno-27-4"></a><span class="w">  </span><span class="c1">// For very long operations, consider streaming or progress updates</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#02-mcp-ollama-__codelineno-27-5"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[INFO] Starting analysis of </span><span class="si">${</span><span class="nx">filepath</span><span class="si">}</span><span class="sb">...`</span><span class="p">);</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#02-mcp-ollama-__codelineno-27-6"></a>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#02-mcp-ollama-__codelineno-27-7"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#02-mcp-ollama-__codelineno-27-8"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#02-mcp-ollama-__codelineno-27-9"></a>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#02-mcp-ollama-__codelineno-27-10"></a><span class="w">    </span><span class="c1">// Perform analysis</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#02-mcp-ollama-__codelineno-27-11"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">performLongAnalysis</span><span class="p">(</span><span class="nx">filepath</span><span class="p">);</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#02-mcp-ollama-__codelineno-27-12"></a>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#02-mcp-ollama-__codelineno-27-13"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="p">;</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#02-mcp-ollama-__codelineno-27-14"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[INFO] Analysis completed in </span><span class="si">${</span><span class="nx">duration</span><span class="si">}</span><span class="sb">ms`</span><span class="p">);</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#02-mcp-ollama-__codelineno-27-15"></a>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#02-mcp-ollama-__codelineno-27-16"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#02-mcp-ollama-__codelineno-27-17"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#02-mcp-ollama-__codelineno-27-18"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#02-mcp-ollama-__codelineno-27-19"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#02-mcp-ollama-__codelineno-27-20"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Analysis Results (completed in </span><span class="si">${</span><span class="nx">duration</span><span class="si">}</span><span class="sb">ms):\n\n</span><span class="si">${</span><span class="nx">result</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#02-mcp-ollama-__codelineno-27-21"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#02-mcp-ollama-__codelineno-27-22"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#02-mcp-ollama-__codelineno-27-23"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24" href="#02-mcp-ollama-__codelineno-27-24"></a>
</span><span id="__span-27-25"><a id="__codelineno-27-25" name="__codelineno-27-25" href="#02-mcp-ollama-__codelineno-27-25"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-26"><a id="__codelineno-27-26" name="__codelineno-27-26" href="#02-mcp-ollama-__codelineno-27-26"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[ERROR] Analysis failed after </span><span class="si">${</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="si">}</span><span class="sb">ms`</span><span class="p">);</span>
</span><span id="__span-27-27"><a id="__codelineno-27-27" name="__codelineno-27-27" href="#02-mcp-ollama-__codelineno-27-27"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="nx">error</span><span class="p">;</span>
</span><span id="__span-27-28"><a id="__codelineno-27-28" name="__codelineno-27-28" href="#02-mcp-ollama-__codelineno-27-28"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-29"><a id="__codelineno-27-29" name="__codelineno-27-29" href="#02-mcp-ollama-__codelineno-27-29"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For operations that take more than a few seconds:</p>
<ul>
<li>Large file processing or analysis</li>
<li>Complex computations</li>
<li>External API calls with potential delays</li>
<li>Batch operations on multiple items</li>
</ul>
<p><strong>Why it matters:</strong> Prevents timeouts, provides user feedback, enables monitoring and debugging of slow operations.</p>
<h3 id="02-mcp-ollama-caching-results">Caching Results<a class="headerlink" href="#02-mcp-ollama-caching-results" title="Permanent link">&para;</a></h3>
<p><strong>Caching results</strong> stores expensive operation results to avoid redundant computation. Use time-based expiration and proper cache keys for efficient reuse of results.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#02-mcp-ollama-__codelineno-28-1"></a><span class="kd">class</span><span class="w"> </span><span class="nx">CachedMCPServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#02-mcp-ollama-__codelineno-28-2"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cache</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span><span class="w"> </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#02-mcp-ollama-__codelineno-28-3"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cacheTTL</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">60000</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1 minute</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#02-mcp-ollama-__codelineno-28-4"></a>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#02-mcp-ollama-__codelineno-28-5"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#02-mcp-ollama-__codelineno-28-6"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#02-mcp-ollama-__codelineno-28-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#02-mcp-ollama-__codelineno-28-8"></a>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#02-mcp-ollama-__codelineno-28-9"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getCacheKey</span><span class="p">(</span><span class="nx">toolName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#02-mcp-ollama-__codelineno-28-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">toolName</span><span class="si">}</span><span class="sb">:</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#02-mcp-ollama-__codelineno-28-11"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#02-mcp-ollama-__codelineno-28-12"></a>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#02-mcp-ollama-__codelineno-28-13"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getCached</span><span class="p">(</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#02-mcp-ollama-__codelineno-28-14"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cached</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#02-mcp-ollama-__codelineno-28-15"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">cached</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#02-mcp-ollama-__codelineno-28-16"></a>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#02-mcp-ollama-__codelineno-28-17"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">cached</span><span class="p">.</span><span class="nx">timestamp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cacheTTL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#02-mcp-ollama-__codelineno-28-18"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#02-mcp-ollama-__codelineno-28-19"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#02-mcp-ollama-__codelineno-28-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#02-mcp-ollama-__codelineno-28-21"></a>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22" href="#02-mcp-ollama-__codelineno-28-22"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">cached</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23" href="#02-mcp-ollama-__codelineno-28-23"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24" href="#02-mcp-ollama-__codelineno-28-24"></a>
</span><span id="__span-28-25"><a id="__codelineno-28-25" name="__codelineno-28-25" href="#02-mcp-ollama-__codelineno-28-25"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setCache</span><span class="p">(</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-26"><a id="__codelineno-28-26" name="__codelineno-28-26" href="#02-mcp-ollama-__codelineno-28-26"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-27"><a id="__codelineno-28-27" name="__codelineno-28-27" href="#02-mcp-ollama-__codelineno-28-27"></a><span class="w">      </span><span class="nx">data</span><span class="p">,</span>
</span><span id="__span-28-28"><a id="__codelineno-28-28" name="__codelineno-28-28" href="#02-mcp-ollama-__codelineno-28-28"></a><span class="w">      </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">()</span>
</span><span id="__span-28-29"><a id="__codelineno-28-29" name="__codelineno-28-29" href="#02-mcp-ollama-__codelineno-28-29"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-28-30"><a id="__codelineno-28-30" name="__codelineno-28-30" href="#02-mcp-ollama-__codelineno-28-30"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-28-31"><a id="__codelineno-28-31" name="__codelineno-28-31" href="#02-mcp-ollama-__codelineno-28-31"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For expensive operations that return consistent results:</p>
<ul>
<li>API calls to external services</li>
<li>Complex calculations or data processing</li>
<li>Database queries with static data</li>
<li>File analysis that doesn&rsquo;t change frequently</li>
</ul>
<p><strong>Why it matters:</strong> Dramatically improves response times, reduces resource usage, and provides better user experience for repeated requests.</p>
<h4 id="02-mcp-ollama-best-practices-for-async-operations-and-performance"><strong>Best Practices for Async Operations and Performance:</strong><a class="headerlink" href="#02-mcp-ollama-best-practices-for-async-operations-and-performance" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Monitor Execution Time:</strong> Log start/end times for operations over 1 second</li>
<li><strong>Set Reasonable Timeouts:</strong> Use appropriate timeouts for external calls (5-30 seconds)</li>
<li><strong>Cache Strategically:</strong> Cache expensive operations but consider data freshness</li>
<li><strong>Use Streaming:</strong> For very large responses, consider streaming or pagination</li>
<li><strong>Resource Cleanup:</strong> Always clean up connections, file handles, and memory</li>
<li><strong>Progress Feedback:</strong> For long operations, provide progress updates via logging</li>
<li><strong>Memory Management:</strong> Be mindful of memory usage in long-running processes</li>
</ul>
<hr />
<h2 id="02-mcp-ollama-tool-composition">Tool Composition<a class="headerlink" href="#02-mcp-ollama-tool-composition" title="Permanent link">&para;</a></h2>
<p><strong>Tool composition</strong> is the art of designing MCP tools that work seamlessly together, allowing LLMs to chain multiple tools to accomplish complex tasks. Well-composed tools create a powerful ecosystem where each tool handles a specific responsibility while enabling sophisticated workflows through intelligent combination.</p>
<h3 id="02-mcp-ollama-example-multi-step-analysis">Example: Multi-Step Analysis<a class="headerlink" href="#02-mcp-ollama-example-multi-step-analysis" title="Permanent link">&para;</a></h3>
<p><strong>Multi-step analysis</strong> demonstrates how simple, focused tools can be combined to perform complex data processing workflows. Each tool has a clear responsibility and can be used independently or as part of larger operations.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#02-mcp-ollama-__codelineno-29-1"></a><span class="c1">// Tool 1: List files</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#02-mcp-ollama-__codelineno-29-2"></a><span class="p">{</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#02-mcp-ollama-__codelineno-29-3"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;list_files&quot;</span><span class="p">,</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#02-mcp-ollama-__codelineno-29-4"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;List files in a directory&quot;</span><span class="p">,</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#02-mcp-ollama-__codelineno-29-5"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#02-mcp-ollama-__codelineno-29-6"></a><span class="p">}</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#02-mcp-ollama-__codelineno-29-7"></a>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#02-mcp-ollama-__codelineno-29-8"></a><span class="c1">// Tool 2: Read file</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#02-mcp-ollama-__codelineno-29-9"></a><span class="p">{</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#02-mcp-ollama-__codelineno-29-10"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;read_file&quot;</span><span class="p">,</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#02-mcp-ollama-__codelineno-29-11"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Read a specific file&quot;</span><span class="p">,</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#02-mcp-ollama-__codelineno-29-12"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#02-mcp-ollama-__codelineno-29-13"></a><span class="p">}</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#02-mcp-ollama-__codelineno-29-14"></a>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#02-mcp-ollama-__codelineno-29-15"></a><span class="c1">// Tool 3: Analyze content</span>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#02-mcp-ollama-__codelineno-29-16"></a><span class="p">{</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#02-mcp-ollama-__codelineno-29-17"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;analyze_text&quot;</span><span class="p">,</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#02-mcp-ollama-__codelineno-29-18"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analyze text content&quot;</span><span class="p">,</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#02-mcp-ollama-__codelineno-29-19"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#02-mcp-ollama-__codelineno-29-20"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For workflows that require multiple processing steps:</p>
<ul>
<li>Data analysis pipelines</li>
<li>File processing workflows</li>
<li>Multi-stage computations</li>
<li>Complex research tasks</li>
</ul>
<p><strong>Why it matters:</strong> Breaks down complex problems into manageable, reusable components that can be combined in flexible ways.</p>
<h3 id="02-mcp-ollama-llm-tool-chaining">LLM Tool Chaining<a class="headerlink" href="#02-mcp-ollama-llm-tool-chaining" title="Permanent link">&para;</a></h3>
<p><strong>LLM tool chaining</strong> allows AI models to automatically sequence tool calls based on intermediate results. The LLM analyzes outputs from one tool and determines which tool to call next, creating intelligent workflows without explicit programming.</p>
<p>The LLM can chain these tools:</p>
<ol>
<li><strong>List files in directory</strong> - Discover available files</li>
<li><strong>Read interesting files</strong> - Access content based on filenames</li>
<li><strong>Analyze their content</strong> - Process and extract insights</li>
</ol>
<p><strong>When to use -</strong> When tasks naturally break down into sequential steps:</p>
<ul>
<li>Research and analysis workflows</li>
<li>Data processing pipelines</li>
<li>Content generation chains</li>
<li>Problem-solving sequences</li>
</ul>
<p><strong>Why it matters:</strong> Enables complex, multi-step reasoning and problem-solving that would be difficult to implement in single tools.</p>
<h3 id="02-mcp-ollama-testing-composed-tools">Testing Composed Tools<a class="headerlink" href="#02-mcp-ollama-testing-composed-tools" title="Permanent link">&para;</a></h3>
<p><strong>Testing composed tools</strong> ensures that individual tools work correctly both in isolation and when chained together. Use comprehensive test suites that cover single-tool usage and multi-tool workflows.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#02-mcp-ollama-__codelineno-30-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">describe</span><span class="p">,</span><span class="w"> </span><span class="nx">it</span><span class="p">,</span><span class="w"> </span><span class="nx">expect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;vitest&#39;</span><span class="p">;</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#02-mcp-ollama-__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#02-mcp-ollama-__codelineno-30-3"></a><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;Weather Tool&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#02-mcp-ollama-__codelineno-30-4"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should validate city name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#02-mcp-ollama-__codelineno-30-5"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">expect</span><span class="p">(</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#02-mcp-ollama-__codelineno-30-6"></a><span class="w">      </span><span class="nx">callTool</span><span class="p">(</span><span class="s1">&#39;get_weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="p">})</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#02-mcp-ollama-__codelineno-30-7"></a><span class="w">    </span><span class="p">).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="s1">&#39;City name cannot be empty&#39;</span><span class="p">);</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#02-mcp-ollama-__codelineno-30-8"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#02-mcp-ollama-__codelineno-30-9"></a>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#02-mcp-ollama-__codelineno-30-10"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should handle invalid city&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#02-mcp-ollama-__codelineno-30-11"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">expect</span><span class="p">(</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#02-mcp-ollama-__codelineno-30-12"></a><span class="w">      </span><span class="nx">callTool</span><span class="p">(</span><span class="s1">&#39;get_weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;InvalidCity12345&#39;</span><span class="w"> </span><span class="p">})</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#02-mcp-ollama-__codelineno-30-13"></a><span class="w">    </span><span class="p">).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="s1">&#39;not found&#39;</span><span class="p">);</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#02-mcp-ollama-__codelineno-30-14"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#02-mcp-ollama-__codelineno-30-15"></a>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#02-mcp-ollama-__codelineno-30-16"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return weather data&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#02-mcp-ollama-__codelineno-30-17"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">callTool</span><span class="p">(</span><span class="s1">&#39;get_weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#02-mcp-ollama-__codelineno-30-18"></a><span class="w">      </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;London&#39;</span><span class="p">,</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#02-mcp-ollama-__codelineno-30-19"></a><span class="w">      </span><span class="nx">units</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;celsius&#39;</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#02-mcp-ollama-__codelineno-30-20"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#02-mcp-ollama-__codelineno-30-21"></a>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#02-mcp-ollama-__codelineno-30-22"></a><span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">content</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#02-mcp-ollama-__codelineno-30-23"></a><span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">content</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">text</span><span class="p">).</span><span class="nx">toContain</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">);</span>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#02-mcp-ollama-__codelineno-30-24"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#02-mcp-ollama-__codelineno-30-25"></a><span class="p">});</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For validating tool behavior in different scenarios:</p>
<ul>
<li>Unit testing individual tools</li>
<li>Integration testing tool chains</li>
<li>Regression testing after changes</li>
<li>Edge case validation</li>
</ul>
<p><strong>Why it matters:</strong> Ensures reliability and predictability when tools are used individually or in combination.</p>
<h4 id="02-mcp-ollama-best-practices-for-tool-composition"><strong>Best Practices for Tool Composition:</strong><a class="headerlink" href="#02-mcp-ollama-best-practices-for-tool-composition" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Single Responsibility:</strong> Each tool should do one thing well</li>
<li><strong>Consistent Interfaces:</strong> Use similar parameter patterns across tools</li>
<li><strong>Clear Dependencies:</strong> Document which tools work well together</li>
<li><strong>Error Propagation:</strong> Handle failures gracefully in tool chains</li>
<li><strong>State Management:</strong> Avoid tools that require complex state between calls</li>
<li><strong>Flexible Outputs:</strong> Design tool outputs to be usable as inputs for other tools</li>
<li><strong>Documentation:</strong> Clearly explain how tools can be combined</li>
<li><strong>Version Compatibility:</strong> Ensure tool interfaces remain stable</li>
</ul>
<hr />
<h2 id="02-mcp-ollama-best-practices-checklist">Best Practices Checklist<a class="headerlink" href="#02-mcp-ollama-best-practices-checklist" title="Permanent link">&para;</a></h2>
<p><strong>Schema Design</strong></p>
<ul>
<li>Use descriptive names and descriptions</li>
<li>Add examples in descriptions</li>
<li>Set reasonable defaults</li>
<li>Use enums for constrained values</li>
<li>Add min/max for numbers</li>
</ul>
<p><strong>Implementation</strong></p>
<ul>
<li>Validate all inputs, even with schemas</li>
<li>Handle errors gracefully</li>
<li>Log to stderr, not stdout</li>
<li>Use async/await properly</li>
<li>Clean up resources (file handles, connections)</li>
</ul>
<p><strong>Security</strong></p>
<ul>
<li>Validate and sanitize file paths</li>
<li>Use prepared statements for SQL</li>
<li>Limit resource usage (file sizes, API calls)</li>
<li>Don&rsquo;t expose sensitive data in errors</li>
<li>Implement rate limiting</li>
</ul>
<p><strong>Performance</strong></p>
<ul>
<li>Cache expensive operations</li>
<li>Set reasonable timeouts</li>
<li>Limit result sizes</li>
<li>Use streaming for large data</li>
<li>Monitor execution time</li>
</ul>
<p><strong>User Experience</strong></p>
<ul>
<li>Provide clear error messages</li>
<li>Return structured data when possible</li>
<li>Include relevant context in responses</li>
<li>Handle edge cases gracefully</li>
<li>Document expected behavior</li>
</ul>
<hr />
<h2 id="02-mcp-ollama-hands-on-exercises">Hands-On Exercises<a class="headerlink" href="#02-mcp-ollama-hands-on-exercises" title="Permanent link">&para;</a></h2>
<h3 id="02-mcp-ollama-exercise-1-text-processing-tool">Exercise 1: Text Processing Tool<a class="headerlink" href="#02-mcp-ollama-exercise-1-text-processing-tool" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Counts words, characters, lines</li>
<li>Finds specific patterns</li>
<li>Calculates reading time</li>
<li>Detects language</li>
</ul>
<details>
<summary>💡 Solution: Text Processing Tool</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#02-mcp-ollama-__codelineno-31-1"></a><span class="p">{</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#02-mcp-ollama-__codelineno-31-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;process_text&quot;</span><span class="p">,</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#02-mcp-ollama-__codelineno-31-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analyze and process text content with various metrics and operations&quot;</span><span class="p">,</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#02-mcp-ollama-__codelineno-31-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#02-mcp-ollama-__codelineno-31-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#02-mcp-ollama-__codelineno-31-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#02-mcp-ollama-__codelineno-31-7"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#02-mcp-ollama-__codelineno-31-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#02-mcp-ollama-__codelineno-31-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The text content to process&quot;</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#02-mcp-ollama-__codelineno-31-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#02-mcp-ollama-__codelineno-31-11"></a><span class="w">      </span><span class="nx">operations</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#02-mcp-ollama-__codelineno-31-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#02-mcp-ollama-__codelineno-31-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Operations to perform&quot;</span><span class="p">,</span>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#02-mcp-ollama-__codelineno-31-14"></a><span class="w">        </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#02-mcp-ollama-__codelineno-31-15"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#02-mcp-ollama-__codelineno-31-16"></a><span class="w">          </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;find_pattern&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;reading_time&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;detect_language&quot;</span><span class="p">]</span>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#02-mcp-ollama-__codelineno-31-17"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#02-mcp-ollama-__codelineno-31-18"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span>
</span><span id="__span-31-19"><a id="__codelineno-31-19" name="__codelineno-31-19" href="#02-mcp-ollama-__codelineno-31-19"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-31-20"><a id="__codelineno-31-20" name="__codelineno-31-20" href="#02-mcp-ollama-__codelineno-31-20"></a><span class="w">      </span><span class="nx">pattern</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-21"><a id="__codelineno-31-21" name="__codelineno-31-21" href="#02-mcp-ollama-__codelineno-31-21"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-31-22"><a id="__codelineno-31-22" name="__codelineno-31-22" href="#02-mcp-ollama-__codelineno-31-22"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Regex pattern for find_pattern operation&quot;</span>
</span><span id="__span-31-23"><a id="__codelineno-31-23" name="__codelineno-31-23" href="#02-mcp-ollama-__codelineno-31-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-31-24"><a id="__codelineno-31-24" name="__codelineno-31-24" href="#02-mcp-ollama-__codelineno-31-24"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-31-25"><a id="__codelineno-31-25" name="__codelineno-31-25" href="#02-mcp-ollama-__codelineno-31-25"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-31-26"><a id="__codelineno-31-26" name="__codelineno-31-26" href="#02-mcp-ollama-__codelineno-31-26"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-31-27"><a id="__codelineno-31-27" name="__codelineno-31-27" href="#02-mcp-ollama-__codelineno-31-27"></a><span class="p">}</span>
</span></code></pre></div>

Implementation - Add this handler in your "CallToolRequestSchema" handler:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#02-mcp-ollama-__codelineno-32-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;process_text&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#02-mcp-ollama-__codelineno-32-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#02-mcp-ollama-__codelineno-32-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">text</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#02-mcp-ollama-__codelineno-32-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">operations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">operations</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">[])</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">];</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#02-mcp-ollama-__codelineno-32-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">pattern</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#02-mcp-ollama-__codelineno-32-6"></a>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#02-mcp-ollama-__codelineno-32-7"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">results</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#02-mcp-ollama-__codelineno-32-8"></a>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#02-mcp-ollama-__codelineno-32-9"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">op</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">operations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#02-mcp-ollama-__codelineno-32-10"></a><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">op</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#02-mcp-ollama-__codelineno-32-11"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;count&quot;</span><span class="o">:</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#02-mcp-ollama-__codelineno-32-12"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#02-mcp-ollama-__codelineno-32-13"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">w</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#02-mcp-ollama-__codelineno-32-14"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">chars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#02-mcp-ollama-__codelineno-32-15"></a><span class="w">          </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`📊 Text Statistics:\n- Lines: </span><span class="si">${</span><span class="nx">lines</span><span class="si">}</span><span class="sb">\n- Words: </span><span class="si">${</span><span class="nx">words</span><span class="si">}</span><span class="sb">\n- Characters: </span><span class="si">${</span><span class="nx">chars</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#02-mcp-ollama-__codelineno-32-16"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#02-mcp-ollama-__codelineno-32-17"></a>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#02-mcp-ollama-__codelineno-32-18"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;find_pattern&quot;</span><span class="o">:</span>
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#02-mcp-ollama-__codelineno-32-19"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">pattern</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#02-mcp-ollama-__codelineno-32-20"></a><span class="w">            </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;❌ Pattern required for find_pattern operation&quot;</span><span class="p">);</span>
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21" href="#02-mcp-ollama-__codelineno-32-21"></a><span class="w">            </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22" href="#02-mcp-ollama-__codelineno-32-22"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-32-23"><a id="__codelineno-32-23" name="__codelineno-32-23" href="#02-mcp-ollama-__codelineno-32-23"></a><span class="w">          </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-24"><a id="__codelineno-32-24" name="__codelineno-32-24" href="#02-mcp-ollama-__codelineno-32-24"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">RegExp</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;g&#39;</span><span class="p">);</span>
</span><span id="__span-32-25"><a id="__codelineno-32-25" name="__codelineno-32-25" href="#02-mcp-ollama-__codelineno-32-25"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">regex</span><span class="p">);</span>
</span><span id="__span-32-26"><a id="__codelineno-32-26" name="__codelineno-32-26" href="#02-mcp-ollama-__codelineno-32-26"></a><span class="w">            </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`🔍 Pattern Matches (</span><span class="si">${</span><span class="nx">pattern</span><span class="si">}</span><span class="sb">):\nFound </span><span class="si">${</span><span class="nx">matches</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">matches.length</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">0</span><span class="si">}</span><span class="sb"> matches:\n</span><span class="si">${</span><span class="nx">matches</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">matches</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-32-27"><a id="__codelineno-32-27" name="__codelineno-32-27" href="#02-mcp-ollama-__codelineno-32-27"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-28"><a id="__codelineno-32-28" name="__codelineno-32-28" href="#02-mcp-ollama-__codelineno-32-28"></a><span class="w">            </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`❌ Invalid regex pattern: </span><span class="si">${</span><span class="nx">pattern</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-32-29"><a id="__codelineno-32-29" name="__codelineno-32-29" href="#02-mcp-ollama-__codelineno-32-29"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-32-30"><a id="__codelineno-32-30" name="__codelineno-32-30" href="#02-mcp-ollama-__codelineno-32-30"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-32-31"><a id="__codelineno-32-31" name="__codelineno-32-31" href="#02-mcp-ollama-__codelineno-32-31"></a>
</span><span id="__span-32-32"><a id="__codelineno-32-32" name="__codelineno-32-32" href="#02-mcp-ollama-__codelineno-32-32"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;reading_time&quot;</span><span class="o">:</span>
</span><span id="__span-32-33"><a id="__codelineno-32-33" name="__codelineno-32-33" href="#02-mcp-ollama-__codelineno-32-33"></a><span class="w">          </span><span class="c1">// Average reading speed: 200 words per minute</span>
</span><span id="__span-32-34"><a id="__codelineno-32-34" name="__codelineno-32-34" href="#02-mcp-ollama-__codelineno-32-34"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">wordCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">w</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-32-35"><a id="__codelineno-32-35" name="__codelineno-32-35" href="#02-mcp-ollama-__codelineno-32-35"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">readingTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">wordCount</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">200</span><span class="p">);</span>
</span><span id="__span-32-36"><a id="__codelineno-32-36" name="__codelineno-32-36" href="#02-mcp-ollama-__codelineno-32-36"></a><span class="w">          </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`⏱️ Reading Time: Approximately </span><span class="si">${</span><span class="nx">readingTime</span><span class="si">}</span><span class="sb"> minute</span><span class="si">${</span><span class="nx">readingTime</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;s&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="sb"> (</span><span class="si">${</span><span class="nx">wordCount</span><span class="si">}</span><span class="sb"> words at 200 WPM)`</span><span class="p">);</span>
</span><span id="__span-32-37"><a id="__codelineno-32-37" name="__codelineno-32-37" href="#02-mcp-ollama-__codelineno-32-37"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-32-38"><a id="__codelineno-32-38" name="__codelineno-32-38" href="#02-mcp-ollama-__codelineno-32-38"></a>
</span><span id="__span-32-39"><a id="__codelineno-32-39" name="__codelineno-32-39" href="#02-mcp-ollama-__codelineno-32-39"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;detect_language&quot;</span><span class="o">:</span>
</span><span id="__span-32-40"><a id="__codelineno-32-40" name="__codelineno-32-40" href="#02-mcp-ollama-__codelineno-32-40"></a><span class="w">          </span><span class="c1">// Simple language detection based on common words</span>
</span><span id="__span-32-41"><a id="__codelineno-32-41" name="__codelineno-32-41" href="#02-mcp-ollama-__codelineno-32-41"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">englishWords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/\b(the|and|or|but|in|on|at|to|for|of|with|by)\b/gi</span><span class="p">;</span>
</span><span id="__span-32-42"><a id="__codelineno-32-42" name="__codelineno-32-42" href="#02-mcp-ollama-__codelineno-32-42"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">spanishWords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/\b(el|la|los|las|y|o|pero|en|sobre|a|para|de|con|por)\b/gi</span><span class="p">;</span>
</span><span id="__span-32-43"><a id="__codelineno-32-43" name="__codelineno-32-43" href="#02-mcp-ollama-__codelineno-32-43"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">frenchWords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/\b(le|la|les|et|ou|mais|dans|sur|à|pour|de|avec|par)\b/gi</span><span class="p">;</span>
</span><span id="__span-32-44"><a id="__codelineno-32-44" name="__codelineno-32-44" href="#02-mcp-ollama-__codelineno-32-44"></a>
</span><span id="__span-32-45"><a id="__codelineno-32-45" name="__codelineno-32-45" href="#02-mcp-ollama-__codelineno-32-45"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">englishMatches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">englishWords</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[]).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-32-46"><a id="__codelineno-32-46" name="__codelineno-32-46" href="#02-mcp-ollama-__codelineno-32-46"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">spanishMatches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">spanishWords</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[]).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-32-47"><a id="__codelineno-32-47" name="__codelineno-32-47" href="#02-mcp-ollama-__codelineno-32-47"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">frenchMatches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">frenchWords</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[]).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-32-48"><a id="__codelineno-32-48" name="__codelineno-32-48" href="#02-mcp-ollama-__codelineno-32-48"></a>
</span><span id="__span-32-49"><a id="__codelineno-32-49" name="__codelineno-32-49" href="#02-mcp-ollama-__codelineno-32-49"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxMatches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">englishMatches</span><span class="p">,</span><span class="w"> </span><span class="nx">spanishMatches</span><span class="p">,</span><span class="w"> </span><span class="nx">frenchMatches</span><span class="p">);</span>
</span><span id="__span-32-50"><a id="__codelineno-32-50" name="__codelineno-32-50" href="#02-mcp-ollama-__codelineno-32-50"></a><span class="w">          </span><span class="kd">let</span><span class="w"> </span><span class="nx">detectedLang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Unknown&quot;</span><span class="p">;</span>
</span><span id="__span-32-51"><a id="__codelineno-32-51" name="__codelineno-32-51" href="#02-mcp-ollama-__codelineno-32-51"></a>
</span><span id="__span-32-52"><a id="__codelineno-32-52" name="__codelineno-32-52" href="#02-mcp-ollama-__codelineno-32-52"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">maxMatches</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-53"><a id="__codelineno-32-53" name="__codelineno-32-53" href="#02-mcp-ollama-__codelineno-32-53"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">englishMatches</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">maxMatches</span><span class="p">)</span><span class="w"> </span><span class="nx">detectedLang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;English&quot;</span><span class="p">;</span>
</span><span id="__span-32-54"><a id="__codelineno-32-54" name="__codelineno-32-54" href="#02-mcp-ollama-__codelineno-32-54"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">spanishMatches</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">maxMatches</span><span class="p">)</span><span class="w"> </span><span class="nx">detectedLang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Spanish&quot;</span><span class="p">;</span>
</span><span id="__span-32-55"><a id="__codelineno-32-55" name="__codelineno-32-55" href="#02-mcp-ollama-__codelineno-32-55"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">frenchMatches</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">maxMatches</span><span class="p">)</span><span class="w"> </span><span class="nx">detectedLang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;French&quot;</span><span class="p">;</span>
</span><span id="__span-32-56"><a id="__codelineno-32-56" name="__codelineno-32-56" href="#02-mcp-ollama-__codelineno-32-56"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-32-57"><a id="__codelineno-32-57" name="__codelineno-32-57" href="#02-mcp-ollama-__codelineno-32-57"></a>
</span><span id="__span-32-58"><a id="__codelineno-32-58" name="__codelineno-32-58" href="#02-mcp-ollama-__codelineno-32-58"></a><span class="w">          </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`🌍 Detected Language: </span><span class="si">${</span><span class="nx">detectedLang</span><span class="si">}</span><span class="sb"> (confidence: </span><span class="si">${</span><span class="nx">maxMatches</span><span class="si">}</span><span class="sb"> common words)`</span><span class="p">);</span>
</span><span id="__span-32-59"><a id="__codelineno-32-59" name="__codelineno-32-59" href="#02-mcp-ollama-__codelineno-32-59"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-32-60"><a id="__codelineno-32-60" name="__codelineno-32-60" href="#02-mcp-ollama-__codelineno-32-60"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-61"><a id="__codelineno-32-61" name="__codelineno-32-61" href="#02-mcp-ollama-__codelineno-32-61"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-62"><a id="__codelineno-32-62" name="__codelineno-32-62" href="#02-mcp-ollama-__codelineno-32-62"></a>
</span><span id="__span-32-63"><a id="__codelineno-32-63" name="__codelineno-32-63" href="#02-mcp-ollama-__codelineno-32-63"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-64"><a id="__codelineno-32-64" name="__codelineno-32-64" href="#02-mcp-ollama-__codelineno-32-64"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-32-65"><a id="__codelineno-32-65" name="__codelineno-32-65" href="#02-mcp-ollama-__codelineno-32-65"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-32-66"><a id="__codelineno-32-66" name="__codelineno-32-66" href="#02-mcp-ollama-__codelineno-32-66"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-32-67"><a id="__codelineno-32-67" name="__codelineno-32-67" href="#02-mcp-ollama-__codelineno-32-67"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">results.join</span><span class="p">(</span><span class="s1">&#39;\n\n&#39;</span><span class="p">)</span>
</span><span id="__span-32-68"><a id="__codelineno-32-68" name="__codelineno-32-68" href="#02-mcp-ollama-__codelineno-32-68"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-32-69"><a id="__codelineno-32-69" name="__codelineno-32-69" href="#02-mcp-ollama-__codelineno-32-69"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-32-70"><a id="__codelineno-32-70" name="__codelineno-32-70" href="#02-mcp-ollama-__codelineno-32-70"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-32-71"><a id="__codelineno-32-71" name="__codelineno-32-71" href="#02-mcp-ollama-__codelineno-32-71"></a>
</span><span id="__span-32-72"><a id="__codelineno-32-72" name="__codelineno-32-72" href="#02-mcp-ollama-__codelineno-32-72"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-73"><a id="__codelineno-32-73" name="__codelineno-32-73" href="#02-mcp-ollama-__codelineno-32-73"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Text processing failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-32-74"><a id="__codelineno-32-74" name="__codelineno-32-74" href="#02-mcp-ollama-__codelineno-32-74"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-32-75"><a id="__codelineno-32-75" name="__codelineno-32-75" href="#02-mcp-ollama-__codelineno-32-75"></a><span class="p">}</span>
</span></code></pre></div>

Testing - Test with different inputs:

<div class="language-javascript highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#02-mcp-ollama-__codelineno-33-1"></a><span class="c1">// Basic counting</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#02-mcp-ollama-__codelineno-33-2"></a><span class="p">{</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Hello world\nThis is a test&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">operations</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#02-mcp-ollama-__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#02-mcp-ollama-__codelineno-33-4"></a><span class="c1">// Pattern matching</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#02-mcp-ollama-__codelineno-33-5"></a><span class="p">{</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The quick brown fox jumps over the lazy dog&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">operations</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;find_pattern&quot;</span><span class="p">],</span><span class="w"> </span><span class="nx">pattern</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;\\b\\w{4}\\b&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#02-mcp-ollama-__codelineno-33-6"></a>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#02-mcp-ollama-__codelineno-33-7"></a><span class="c1">// Multiple operations</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#02-mcp-ollama-__codelineno-33-8"></a><span class="p">{</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;This is a longer piece of text to analyze for various metrics and patterns.&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">operations</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;reading_time&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;detect_language&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>

</details>

<h3 id="02-mcp-ollama-exercise-2-json-validator-tool">Exercise 2: JSON Validator Tool<a class="headerlink" href="#02-mcp-ollama-exercise-2-json-validator-tool" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Validates JSON syntax</li>
<li>Validates against JSON Schema</li>
<li>Formats/pretty-prints JSON</li>
<li>Compares two JSON objects</li>
</ul>
<details>
<summary>💡 Solution: JSON Validator Tool</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#02-mcp-ollama-__codelineno-34-1"></a><span class="p">{</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#02-mcp-ollama-__codelineno-34-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;validate_json&quot;</span><span class="p">,</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#02-mcp-ollama-__codelineno-34-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Validate, format, and compare JSON data&quot;</span><span class="p">,</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#02-mcp-ollama-__codelineno-34-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#02-mcp-ollama-__codelineno-34-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#02-mcp-ollama-__codelineno-34-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#02-mcp-ollama-__codelineno-34-7"></a><span class="w">      </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#02-mcp-ollama-__codelineno-34-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#02-mcp-ollama-__codelineno-34-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;JSON string to validate or format&quot;</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#02-mcp-ollama-__codelineno-34-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#02-mcp-ollama-__codelineno-34-11"></a><span class="w">      </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#02-mcp-ollama-__codelineno-34-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#02-mcp-ollama-__codelineno-34-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Operation to perform&quot;</span><span class="p">,</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#02-mcp-ollama-__codelineno-34-14"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;validate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;format&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;schema_validate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;compare&quot;</span><span class="p">],</span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#02-mcp-ollama-__codelineno-34-15"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;validate&quot;</span>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#02-mcp-ollama-__codelineno-34-16"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#02-mcp-ollama-__codelineno-34-17"></a><span class="w">      </span><span class="nx">schema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#02-mcp-ollama-__codelineno-34-18"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#02-mcp-ollama-__codelineno-34-19"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;JSON Schema for schema validation (as JSON string)&quot;</span>
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#02-mcp-ollama-__codelineno-34-20"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#02-mcp-ollama-__codelineno-34-21"></a><span class="w">      </span><span class="nx">json2</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#02-mcp-ollama-__codelineno-34-22"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#02-mcp-ollama-__codelineno-34-23"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Second JSON string for comparison&quot;</span>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#02-mcp-ollama-__codelineno-34-24"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#02-mcp-ollama-__codelineno-34-25"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#02-mcp-ollama-__codelineno-34-26"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;operation&quot;</span><span class="p">]</span>
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#02-mcp-ollama-__codelineno-34-27"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28" href="#02-mcp-ollama-__codelineno-34-28"></a><span class="p">}</span>
</span></code></pre></div>

Implementation - First, install the required dependency:

<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#02-mcp-ollama-__codelineno-35-1"></a>npm<span class="w"> </span>install<span class="w"> </span>ajv
</span></code></pre></div>

Add the import:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#02-mcp-ollama-__codelineno-36-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">Ajv</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;ajv&#39;</span><span class="p">;</span>
</span></code></pre></div>

Add this handler in your "CallToolRequestSchema" handler:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#02-mcp-ollama-__codelineno-37-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;validate_json&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#02-mcp-ollama-__codelineno-37-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#02-mcp-ollama-__codelineno-37-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">json</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#02-mcp-ollama-__codelineno-37-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">operation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">operation</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#02-mcp-ollama-__codelineno-37-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">schema</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#02-mcp-ollama-__codelineno-37-6"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">json2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">json2</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#02-mcp-ollama-__codelineno-37-7"></a>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#02-mcp-ollama-__codelineno-37-8"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#02-mcp-ollama-__codelineno-37-9"></a>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#02-mcp-ollama-__codelineno-37-10"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">operation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#02-mcp-ollama-__codelineno-37-11"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;validate&quot;</span><span class="o">:</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#02-mcp-ollama-__codelineno-37-12"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#02-mcp-ollama-__codelineno-37-13"></a><span class="w">          </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#02-mcp-ollama-__codelineno-37-14"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;✅ Valid JSON syntax&quot;</span><span class="p">;</span>
</span><span id="__span-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#02-mcp-ollama-__codelineno-37-15"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#02-mcp-ollama-__codelineno-37-16"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Invalid JSON: </span><span class="si">${</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#02-mcp-ollama-__codelineno-37-17"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#02-mcp-ollama-__codelineno-37-18"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-37-19"><a id="__codelineno-37-19" name="__codelineno-37-19" href="#02-mcp-ollama-__codelineno-37-19"></a>
</span><span id="__span-37-20"><a id="__codelineno-37-20" name="__codelineno-37-20" href="#02-mcp-ollama-__codelineno-37-20"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;format&quot;</span><span class="o">:</span>
</span><span id="__span-37-21"><a id="__codelineno-37-21" name="__codelineno-37-21" href="#02-mcp-ollama-__codelineno-37-21"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-22"><a id="__codelineno-37-22" name="__codelineno-37-22" href="#02-mcp-ollama-__codelineno-37-22"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">parsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</span><span id="__span-37-23"><a id="__codelineno-37-23" name="__codelineno-37-23" href="#02-mcp-ollama-__codelineno-37-23"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`📄 Formatted JSON:\n\`\`\`json\n</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">parsed</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">\n\`\`\``</span><span class="p">;</span>
</span><span id="__span-37-24"><a id="__codelineno-37-24" name="__codelineno-37-24" href="#02-mcp-ollama-__codelineno-37-24"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-25"><a id="__codelineno-37-25" name="__codelineno-37-25" href="#02-mcp-ollama-__codelineno-37-25"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Cannot format invalid JSON: </span><span class="si">${</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-37-26"><a id="__codelineno-37-26" name="__codelineno-37-26" href="#02-mcp-ollama-__codelineno-37-26"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-27"><a id="__codelineno-37-27" name="__codelineno-37-27" href="#02-mcp-ollama-__codelineno-37-27"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-37-28"><a id="__codelineno-37-28" name="__codelineno-37-28" href="#02-mcp-ollama-__codelineno-37-28"></a>
</span><span id="__span-37-29"><a id="__codelineno-37-29" name="__codelineno-37-29" href="#02-mcp-ollama-__codelineno-37-29"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;schema_validate&quot;</span><span class="o">:</span>
</span><span id="__span-37-30"><a id="__codelineno-37-30" name="__codelineno-37-30" href="#02-mcp-ollama-__codelineno-37-30"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">schema</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-31"><a id="__codelineno-37-31" name="__codelineno-37-31" href="#02-mcp-ollama-__codelineno-37-31"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;❌ Schema required for schema validation&quot;</span><span class="p">;</span>
</span><span id="__span-37-32"><a id="__codelineno-37-32" name="__codelineno-37-32" href="#02-mcp-ollama-__codelineno-37-32"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-37-33"><a id="__codelineno-37-33" name="__codelineno-37-33" href="#02-mcp-ollama-__codelineno-37-33"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-34"><a id="__codelineno-37-34" name="__codelineno-37-34" href="#02-mcp-ollama-__codelineno-37-34"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-35"><a id="__codelineno-37-35" name="__codelineno-37-35" href="#02-mcp-ollama-__codelineno-37-35"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">ajv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Ajv</span><span class="p">();</span>
</span><span id="__span-37-36"><a id="__codelineno-37-36" name="__codelineno-37-36" href="#02-mcp-ollama-__codelineno-37-36"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">parsedJson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</span><span id="__span-37-37"><a id="__codelineno-37-37" name="__codelineno-37-37" href="#02-mcp-ollama-__codelineno-37-37"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">parsedSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">schema</span><span class="p">);</span>
</span><span id="__span-37-38"><a id="__codelineno-37-38" name="__codelineno-37-38" href="#02-mcp-ollama-__codelineno-37-38"></a>
</span><span id="__span-37-39"><a id="__codelineno-37-39" name="__codelineno-37-39" href="#02-mcp-ollama-__codelineno-37-39"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">validate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ajv</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">parsedSchema</span><span class="p">);</span>
</span><span id="__span-37-40"><a id="__codelineno-37-40" name="__codelineno-37-40" href="#02-mcp-ollama-__codelineno-37-40"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">validate</span><span class="p">(</span><span class="nx">parsedJson</span><span class="p">);</span>
</span><span id="__span-37-41"><a id="__codelineno-37-41" name="__codelineno-37-41" href="#02-mcp-ollama-__codelineno-37-41"></a>
</span><span id="__span-37-42"><a id="__codelineno-37-42" name="__codelineno-37-42" href="#02-mcp-ollama-__codelineno-37-42"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">valid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-43"><a id="__codelineno-37-43" name="__codelineno-37-43" href="#02-mcp-ollama-__codelineno-37-43"></a><span class="w">            </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;✅ JSON validates against schema&quot;</span><span class="p">;</span>
</span><span id="__span-37-44"><a id="__codelineno-37-44" name="__codelineno-37-44" href="#02-mcp-ollama-__codelineno-37-44"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-45"><a id="__codelineno-37-45" name="__codelineno-37-45" href="#02-mcp-ollama-__codelineno-37-45"></a><span class="w">            </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Schema validation failed:\n</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">validate</span><span class="p">.</span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-37-46"><a id="__codelineno-37-46" name="__codelineno-37-46" href="#02-mcp-ollama-__codelineno-37-46"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-37-47"><a id="__codelineno-37-47" name="__codelineno-37-47" href="#02-mcp-ollama-__codelineno-37-47"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-48"><a id="__codelineno-37-48" name="__codelineno-37-48" href="#02-mcp-ollama-__codelineno-37-48"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Schema validation error: </span><span class="si">${</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-37-49"><a id="__codelineno-37-49" name="__codelineno-37-49" href="#02-mcp-ollama-__codelineno-37-49"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-50"><a id="__codelineno-37-50" name="__codelineno-37-50" href="#02-mcp-ollama-__codelineno-37-50"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-37-51"><a id="__codelineno-37-51" name="__codelineno-37-51" href="#02-mcp-ollama-__codelineno-37-51"></a>
</span><span id="__span-37-52"><a id="__codelineno-37-52" name="__codelineno-37-52" href="#02-mcp-ollama-__codelineno-37-52"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;compare&quot;</span><span class="o">:</span>
</span><span id="__span-37-53"><a id="__codelineno-37-53" name="__codelineno-37-53" href="#02-mcp-ollama-__codelineno-37-53"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">json2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-54"><a id="__codelineno-37-54" name="__codelineno-37-54" href="#02-mcp-ollama-__codelineno-37-54"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;❌ Second JSON required for comparison&quot;</span><span class="p">;</span>
</span><span id="__span-37-55"><a id="__codelineno-37-55" name="__codelineno-37-55" href="#02-mcp-ollama-__codelineno-37-55"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-37-56"><a id="__codelineno-37-56" name="__codelineno-37-56" href="#02-mcp-ollama-__codelineno-37-56"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-57"><a id="__codelineno-37-57" name="__codelineno-37-57" href="#02-mcp-ollama-__codelineno-37-57"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-58"><a id="__codelineno-37-58" name="__codelineno-37-58" href="#02-mcp-ollama-__codelineno-37-58"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</span><span id="__span-37-59"><a id="__codelineno-37-59" name="__codelineno-37-59" href="#02-mcp-ollama-__codelineno-37-59"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">obj2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json2</span><span class="p">);</span>
</span><span id="__span-37-60"><a id="__codelineno-37-60" name="__codelineno-37-60" href="#02-mcp-ollama-__codelineno-37-60"></a>
</span><span id="__span-37-61"><a id="__codelineno-37-61" name="__codelineno-37-61" href="#02-mcp-ollama-__codelineno-37-61"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">differences</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-37-62"><a id="__codelineno-37-62" name="__codelineno-37-62" href="#02-mcp-ollama-__codelineno-37-62"></a>
</span><span id="__span-37-63"><a id="__codelineno-37-63" name="__codelineno-37-63" href="#02-mcp-ollama-__codelineno-37-63"></a><span class="w">          </span><span class="c1">// Simple comparison - check if objects are equal</span>
</span><span id="__span-37-64"><a id="__codelineno-37-64" name="__codelineno-37-64" href="#02-mcp-ollama-__codelineno-37-64"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj1</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj2</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-65"><a id="__codelineno-37-65" name="__codelineno-37-65" href="#02-mcp-ollama-__codelineno-37-65"></a><span class="w">            </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;✅ JSON objects are identical&quot;</span><span class="p">;</span>
</span><span id="__span-37-66"><a id="__codelineno-37-66" name="__codelineno-37-66" href="#02-mcp-ollama-__codelineno-37-66"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-67"><a id="__codelineno-37-67" name="__codelineno-37-67" href="#02-mcp-ollama-__codelineno-37-67"></a><span class="w">            </span><span class="c1">// Find differences</span>
</span><span id="__span-37-68"><a id="__codelineno-37-68" name="__codelineno-37-68" href="#02-mcp-ollama-__codelineno-37-68"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">keys1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj1</span><span class="p">);</span>
</span><span id="__span-37-69"><a id="__codelineno-37-69" name="__codelineno-37-69" href="#02-mcp-ollama-__codelineno-37-69"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">keys2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj2</span><span class="p">);</span>
</span><span id="__span-37-70"><a id="__codelineno-37-70" name="__codelineno-37-70" href="#02-mcp-ollama-__codelineno-37-70"></a>
</span><span id="__span-37-71"><a id="__codelineno-37-71" name="__codelineno-37-71" href="#02-mcp-ollama-__codelineno-37-71"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">added</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">keys2</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">k</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">!</span><span class="nx">keys1</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">k</span><span class="p">));</span>
</span><span id="__span-37-72"><a id="__codelineno-37-72" name="__codelineno-37-72" href="#02-mcp-ollama-__codelineno-37-72"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">removed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">keys1</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">k</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">!</span><span class="nx">keys2</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">k</span><span class="p">));</span>
</span><span id="__span-37-73"><a id="__codelineno-37-73" name="__codelineno-37-73" href="#02-mcp-ollama-__codelineno-37-73"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">keys1</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">k</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">keys2</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj1</span><span class="p">[</span><span class="nx">k</span><span class="p">])</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj2</span><span class="p">[</span><span class="nx">k</span><span class="p">]));</span>
</span><span id="__span-37-74"><a id="__codelineno-37-74" name="__codelineno-37-74" href="#02-mcp-ollama-__codelineno-37-74"></a>
</span><span id="__span-37-75"><a id="__codelineno-37-75" name="__codelineno-37-75" href="#02-mcp-ollama-__codelineno-37-75"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">added</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">differences</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`Added keys: </span><span class="si">${</span><span class="nx">added</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-37-76"><a id="__codelineno-37-76" name="__codelineno-37-76" href="#02-mcp-ollama-__codelineno-37-76"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">removed</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">differences</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`Removed keys: </span><span class="si">${</span><span class="nx">removed</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-37-77"><a id="__codelineno-37-77" name="__codelineno-37-77" href="#02-mcp-ollama-__codelineno-37-77"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">modified</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">differences</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`Modified keys: </span><span class="si">${</span><span class="nx">modified</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-37-78"><a id="__codelineno-37-78" name="__codelineno-37-78" href="#02-mcp-ollama-__codelineno-37-78"></a>
</span><span id="__span-37-79"><a id="__codelineno-37-79" name="__codelineno-37-79" href="#02-mcp-ollama-__codelineno-37-79"></a><span class="w">            </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`⚠️ JSON objects differ:\n</span><span class="si">${</span><span class="nx">differences</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-37-80"><a id="__codelineno-37-80" name="__codelineno-37-80" href="#02-mcp-ollama-__codelineno-37-80"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-37-81"><a id="__codelineno-37-81" name="__codelineno-37-81" href="#02-mcp-ollama-__codelineno-37-81"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-82"><a id="__codelineno-37-82" name="__codelineno-37-82" href="#02-mcp-ollama-__codelineno-37-82"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Comparison error: </span><span class="si">${</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-37-83"><a id="__codelineno-37-83" name="__codelineno-37-83" href="#02-mcp-ollama-__codelineno-37-83"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-84"><a id="__codelineno-37-84" name="__codelineno-37-84" href="#02-mcp-ollama-__codelineno-37-84"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-37-85"><a id="__codelineno-37-85" name="__codelineno-37-85" href="#02-mcp-ollama-__codelineno-37-85"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-86"><a id="__codelineno-37-86" name="__codelineno-37-86" href="#02-mcp-ollama-__codelineno-37-86"></a>
</span><span id="__span-37-87"><a id="__codelineno-37-87" name="__codelineno-37-87" href="#02-mcp-ollama-__codelineno-37-87"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-88"><a id="__codelineno-37-88" name="__codelineno-37-88" href="#02-mcp-ollama-__codelineno-37-88"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-37-89"><a id="__codelineno-37-89" name="__codelineno-37-89" href="#02-mcp-ollama-__codelineno-37-89"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-37-90"><a id="__codelineno-37-90" name="__codelineno-37-90" href="#02-mcp-ollama-__codelineno-37-90"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-37-91"><a id="__codelineno-37-91" name="__codelineno-37-91" href="#02-mcp-ollama-__codelineno-37-91"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">result</span>
</span><span id="__span-37-92"><a id="__codelineno-37-92" name="__codelineno-37-92" href="#02-mcp-ollama-__codelineno-37-92"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-93"><a id="__codelineno-37-93" name="__codelineno-37-93" href="#02-mcp-ollama-__codelineno-37-93"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-37-94"><a id="__codelineno-37-94" name="__codelineno-37-94" href="#02-mcp-ollama-__codelineno-37-94"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-37-95"><a id="__codelineno-37-95" name="__codelineno-37-95" href="#02-mcp-ollama-__codelineno-37-95"></a>
</span><span id="__span-37-96"><a id="__codelineno-37-96" name="__codelineno-37-96" href="#02-mcp-ollama-__codelineno-37-96"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-97"><a id="__codelineno-37-97" name="__codelineno-37-97" href="#02-mcp-ollama-__codelineno-37-97"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`JSON validation failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-37-98"><a id="__codelineno-37-98" name="__codelineno-37-98" href="#02-mcp-ollama-__codelineno-37-98"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-37-99"><a id="__codelineno-37-99" name="__codelineno-37-99" href="#02-mcp-ollama-__codelineno-37-99"></a><span class="p">}</span>
</span></code></pre></div>

Testing - Test different operations:

<div class="language-javascript highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#02-mcp-ollama-__codelineno-38-1"></a><span class="c1">// Validate syntax</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#02-mcp-ollama-__codelineno-38-2"></a><span class="p">{</span><span class="w"> </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;test&quot;, &quot;value&quot;: 123}&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;validate&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#02-mcp-ollama-__codelineno-38-3"></a>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#02-mcp-ollama-__codelineno-38-4"></a><span class="c1">// Format JSON</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#02-mcp-ollama-__codelineno-38-5"></a><span class="p">{</span><span class="w"> </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;:&quot;test&quot;,&quot;value&quot;:123}&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;format&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#02-mcp-ollama-__codelineno-38-6"></a>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#02-mcp-ollama-__codelineno-38-7"></a><span class="c1">// Schema validation</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#02-mcp-ollama-__codelineno-38-8"></a><span class="p">{</span><span class="w"> </span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#02-mcp-ollama-__codelineno-38-9"></a><span class="w">  </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;John&quot;, &quot;age&quot;: 30}&#39;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#02-mcp-ollama-__codelineno-38-10"></a><span class="w">  </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;schema_validate&quot;</span><span class="p">,</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#02-mcp-ollama-__codelineno-38-11"></a><span class="w">  </span><span class="nx">schema</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;type&quot;: &quot;object&quot;, &quot;properties&quot;: {&quot;name&quot;: {&quot;type&quot;: &quot;string&quot;}, &quot;age&quot;: {&quot;type&quot;: &quot;number&quot;}}}&#39;</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#02-mcp-ollama-__codelineno-38-12"></a><span class="p">}</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#02-mcp-ollama-__codelineno-38-13"></a>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#02-mcp-ollama-__codelineno-38-14"></a><span class="c1">// Compare JSON</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#02-mcp-ollama-__codelineno-38-15"></a><span class="p">{</span>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#02-mcp-ollama-__codelineno-38-16"></a><span class="w">  </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;a&quot;: 1, &quot;b&quot;: 2}&#39;</span><span class="p">,</span>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#02-mcp-ollama-__codelineno-38-17"></a><span class="w">  </span><span class="nx">json2</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;a&quot;: 1, &quot;c&quot;: 3}&#39;</span><span class="p">,</span>
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18" href="#02-mcp-ollama-__codelineno-38-18"></a><span class="w">  </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;compare&quot;</span>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19" href="#02-mcp-ollama-__codelineno-38-19"></a><span class="p">}</span>
</span></code></pre></div>

</details>

<h3 id="02-mcp-ollama-exercise-3-web-scraper-tool">Exercise 3: Web Scraper Tool<a class="headerlink" href="#02-mcp-ollama-exercise-3-web-scraper-tool" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Fetches web page content</li>
<li>Extracts specific elements</li>
<li>Returns clean text</li>
<li>Handles errors gracefully</li>
</ul>
<details>
<summary>💡 Solution: Web Scraper Tool</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#02-mcp-ollama-__codelineno-39-1"></a><span class="p">{</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#02-mcp-ollama-__codelineno-39-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;scrape_web&quot;</span><span class="p">,</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#02-mcp-ollama-__codelineno-39-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Fetch and extract content from web pages&quot;</span><span class="p">,</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#02-mcp-ollama-__codelineno-39-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#02-mcp-ollama-__codelineno-39-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#02-mcp-ollama-__codelineno-39-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#02-mcp-ollama-__codelineno-39-7"></a><span class="w">      </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#02-mcp-ollama-__codelineno-39-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#02-mcp-ollama-__codelineno-39-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;URL to scrape&quot;</span><span class="p">,</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#02-mcp-ollama-__codelineno-39-10"></a><span class="w">        </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;uri&quot;</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#02-mcp-ollama-__codelineno-39-11"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#02-mcp-ollama-__codelineno-39-12"></a><span class="w">      </span><span class="nx">selector</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#02-mcp-ollama-__codelineno-39-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#02-mcp-ollama-__codelineno-39-14"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;CSS selector to extract specific elements (optional)&quot;</span><span class="p">,</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#02-mcp-ollama-__codelineno-39-15"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;body&quot;</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#02-mcp-ollama-__codelineno-39-16"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#02-mcp-ollama-__codelineno-39-17"></a><span class="w">      </span><span class="nx">includeText</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18" href="#02-mcp-ollama-__codelineno-39-18"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19" href="#02-mcp-ollama-__codelineno-39-19"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Extract only text content (remove HTML)&quot;</span><span class="p">,</span>
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20" href="#02-mcp-ollama-__codelineno-39-20"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span>
</span><span id="__span-39-21"><a id="__codelineno-39-21" name="__codelineno-39-21" href="#02-mcp-ollama-__codelineno-39-21"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-39-22"><a id="__codelineno-39-22" name="__codelineno-39-22" href="#02-mcp-ollama-__codelineno-39-22"></a><span class="w">      </span><span class="nx">maxLength</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-23"><a id="__codelineno-39-23" name="__codelineno-39-23" href="#02-mcp-ollama-__codelineno-39-23"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-39-24"><a id="__codelineno-39-24" name="__codelineno-39-24" href="#02-mcp-ollama-__codelineno-39-24"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum length of extracted content&quot;</span><span class="p">,</span>
</span><span id="__span-39-25"><a id="__codelineno-39-25" name="__codelineno-39-25" href="#02-mcp-ollama-__codelineno-39-25"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span>
</span><span id="__span-39-26"><a id="__codelineno-39-26" name="__codelineno-39-26" href="#02-mcp-ollama-__codelineno-39-26"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">10000</span><span class="p">,</span>
</span><span id="__span-39-27"><a id="__codelineno-39-27" name="__codelineno-39-27" href="#02-mcp-ollama-__codelineno-39-27"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">2000</span>
</span><span id="__span-39-28"><a id="__codelineno-39-28" name="__codelineno-39-28" href="#02-mcp-ollama-__codelineno-39-28"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-39-29"><a id="__codelineno-39-29" name="__codelineno-39-29" href="#02-mcp-ollama-__codelineno-39-29"></a><span class="w">      </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-30"><a id="__codelineno-39-30" name="__codelineno-39-30" href="#02-mcp-ollama-__codelineno-39-30"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-39-31"><a id="__codelineno-39-31" name="__codelineno-39-31" href="#02-mcp-ollama-__codelineno-39-31"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Request timeout in milliseconds&quot;</span><span class="p">,</span>
</span><span id="__span-39-32"><a id="__codelineno-39-32" name="__codelineno-39-32" href="#02-mcp-ollama-__codelineno-39-32"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="p">,</span>
</span><span id="__span-39-33"><a id="__codelineno-39-33" name="__codelineno-39-33" href="#02-mcp-ollama-__codelineno-39-33"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">30000</span><span class="p">,</span>
</span><span id="__span-39-34"><a id="__codelineno-39-34" name="__codelineno-39-34" href="#02-mcp-ollama-__codelineno-39-34"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">10000</span>
</span><span id="__span-39-35"><a id="__codelineno-39-35" name="__codelineno-39-35" href="#02-mcp-ollama-__codelineno-39-35"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-39-36"><a id="__codelineno-39-36" name="__codelineno-39-36" href="#02-mcp-ollama-__codelineno-39-36"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-39-37"><a id="__codelineno-39-37" name="__codelineno-39-37" href="#02-mcp-ollama-__codelineno-39-37"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
</span><span id="__span-39-38"><a id="__codelineno-39-38" name="__codelineno-39-38" href="#02-mcp-ollama-__codelineno-39-38"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-39-39"><a id="__codelineno-39-39" name="__codelineno-39-39" href="#02-mcp-ollama-__codelineno-39-39"></a><span class="p">}</span>
</span></code></pre></div>

Implementation - First, install the required dependencies:

<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#02-mcp-ollama-__codelineno-40-1"></a>npm<span class="w"> </span>install<span class="w"> </span>axios<span class="w"> </span>cheerio
</span></code></pre></div>

Add the imports:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#02-mcp-ollama-__codelineno-41-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">axios</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;axios&#39;</span><span class="p">;</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#02-mcp-ollama-__codelineno-41-2"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">cheerio</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;cheerio&#39;</span><span class="p">;</span>
</span></code></pre></div>

Add this handler in your `CallToolRequestSchema` handler:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#02-mcp-ollama-__codelineno-42-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;scrape_web&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#02-mcp-ollama-__codelineno-42-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#02-mcp-ollama-__codelineno-42-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">url</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#02-mcp-ollama-__codelineno-42-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">selector</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;body&quot;</span><span class="p">;</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#02-mcp-ollama-__codelineno-42-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">includeText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">includeText</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w"> </span><span class="c1">// default true</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#02-mcp-ollama-__codelineno-42-6"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxLength</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">2000</span><span class="p">;</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#02-mcp-ollama-__codelineno-42-7"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">timeout</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">10000</span><span class="p">;</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#02-mcp-ollama-__codelineno-42-8"></a>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#02-mcp-ollama-__codelineno-42-9"></a><span class="w">    </span><span class="c1">// Validate URL</span>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#02-mcp-ollama-__codelineno-42-10"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#02-mcp-ollama-__codelineno-42-11"></a><span class="w">      </span><span class="ow">new</span><span class="w"> </span><span class="nx">URL</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#02-mcp-ollama-__codelineno-42-12"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#02-mcp-ollama-__codelineno-42-13"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Invalid URL format&quot;</span><span class="p">);</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#02-mcp-ollama-__codelineno-42-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#02-mcp-ollama-__codelineno-42-15"></a>
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16" href="#02-mcp-ollama-__codelineno-42-16"></a><span class="w">    </span><span class="c1">// Fetch the webpage</span>
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17" href="#02-mcp-ollama-__codelineno-42-17"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18" href="#02-mcp-ollama-__codelineno-42-18"></a><span class="w">      </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="kt">timeout</span><span class="p">,</span>
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19" href="#02-mcp-ollama-__codelineno-42-19"></a><span class="w">      </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-20"><a id="__codelineno-42-20" name="__codelineno-42-20" href="#02-mcp-ollama-__codelineno-42-20"></a><span class="w">        </span><span class="s1">&#39;User-Agent&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MCP-Web-Scraper/1.0 (Educational Tool)&#39;</span>
</span><span id="__span-42-21"><a id="__codelineno-42-21" name="__codelineno-42-21" href="#02-mcp-ollama-__codelineno-42-21"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-42-22"><a id="__codelineno-42-22" name="__codelineno-42-22" href="#02-mcp-ollama-__codelineno-42-22"></a><span class="w">      </span><span class="nx">maxContentLength</span><span class="o">:</span><span class="w"> </span><span class="kt">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1024</span><span class="p">,</span><span class="w"> </span><span class="c1">// 5MB limit</span>
</span><span id="__span-42-23"><a id="__codelineno-42-23" name="__codelineno-42-23" href="#02-mcp-ollama-__codelineno-42-23"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-42-24"><a id="__codelineno-42-24" name="__codelineno-42-24" href="#02-mcp-ollama-__codelineno-42-24"></a>
</span><span id="__span-42-25"><a id="__codelineno-42-25" name="__codelineno-42-25" href="#02-mcp-ollama-__codelineno-42-25"></a><span class="w">    </span><span class="c1">// Load HTML into cheerio</span>
</span><span id="__span-42-26"><a id="__codelineno-42-26" name="__codelineno-42-26" href="#02-mcp-ollama-__codelineno-42-26"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">$</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cheerio</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-42-27"><a id="__codelineno-42-27" name="__codelineno-42-27" href="#02-mcp-ollama-__codelineno-42-27"></a>
</span><span id="__span-42-28"><a id="__codelineno-42-28" name="__codelineno-42-28" href="#02-mcp-ollama-__codelineno-42-28"></a><span class="w">    </span><span class="c1">// Extract content based on selector</span>
</span><span id="__span-42-29"><a id="__codelineno-42-29" name="__codelineno-42-29" href="#02-mcp-ollama-__codelineno-42-29"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="__span-42-30"><a id="__codelineno-42-30" name="__codelineno-42-30" href="#02-mcp-ollama-__codelineno-42-30"></a>
</span><span id="__span-42-31"><a id="__codelineno-42-31" name="__codelineno-42-31" href="#02-mcp-ollama-__codelineno-42-31"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selector</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;body&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-32"><a id="__codelineno-42-32" name="__codelineno-42-32" href="#02-mcp-ollama-__codelineno-42-32"></a><span class="w">      </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">includeText</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="__span-42-33"><a id="__codelineno-42-33" name="__codelineno-42-33" href="#02-mcp-ollama-__codelineno-42-33"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-34"><a id="__codelineno-42-34" name="__codelineno-42-34" href="#02-mcp-ollama-__codelineno-42-34"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
</span><span id="__span-42-35"><a id="__codelineno-42-35" name="__codelineno-42-35" href="#02-mcp-ollama-__codelineno-42-35"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-36"><a id="__codelineno-42-36" name="__codelineno-42-36" href="#02-mcp-ollama-__codelineno-42-36"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`No elements found matching selector: </span><span class="si">${</span><span class="nx">selector</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-42-37"><a id="__codelineno-42-37" name="__codelineno-42-37" href="#02-mcp-ollama-__codelineno-42-37"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-42-38"><a id="__codelineno-42-38" name="__codelineno-42-38" href="#02-mcp-ollama-__codelineno-42-38"></a>
</span><span id="__span-42-39"><a id="__codelineno-42-39" name="__codelineno-42-39" href="#02-mcp-ollama-__codelineno-42-39"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">includeText</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-40"><a id="__codelineno-42-40" name="__codelineno-42-40" href="#02-mcp-ollama-__codelineno-42-40"></a><span class="w">        </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">elements</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">el</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">get</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n\n&#39;</span><span class="p">);</span>
</span><span id="__span-42-41"><a id="__codelineno-42-41" name="__codelineno-42-41" href="#02-mcp-ollama-__codelineno-42-41"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-42"><a id="__codelineno-42-42" name="__codelineno-42-42" href="#02-mcp-ollama-__codelineno-42-42"></a><span class="w">        </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">elements</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">el</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">$</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">el</span><span class="p">)).</span><span class="nx">get</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n\n&#39;</span><span class="p">);</span>
</span><span id="__span-42-43"><a id="__codelineno-42-43" name="__codelineno-42-43" href="#02-mcp-ollama-__codelineno-42-43"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-42-44"><a id="__codelineno-42-44" name="__codelineno-42-44" href="#02-mcp-ollama-__codelineno-42-44"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-45"><a id="__codelineno-42-45" name="__codelineno-42-45" href="#02-mcp-ollama-__codelineno-42-45"></a>
</span><span id="__span-42-46"><a id="__codelineno-42-46" name="__codelineno-42-46" href="#02-mcp-ollama-__codelineno-42-46"></a><span class="w">    </span><span class="c1">// Clean up the content</span>
</span><span id="__span-42-47"><a id="__codelineno-42-47" name="__codelineno-42-47" href="#02-mcp-ollama-__codelineno-42-47"></a><span class="w">    </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">extractedContent</span>
</span><span id="__span-42-48"><a id="__codelineno-42-48" name="__codelineno-42-48" href="#02-mcp-ollama-__codelineno-42-48"></a><span class="w">      </span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s+/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Replace multiple whitespace with single space</span>
</span><span id="__span-42-49"><a id="__codelineno-42-49" name="__codelineno-42-49" href="#02-mcp-ollama-__codelineno-42-49"></a><span class="w">      </span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n\s*\n/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Remove empty lines</span>
</span><span id="__span-42-50"><a id="__codelineno-42-50" name="__codelineno-42-50" href="#02-mcp-ollama-__codelineno-42-50"></a><span class="w">      </span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
</span><span id="__span-42-51"><a id="__codelineno-42-51" name="__codelineno-42-51" href="#02-mcp-ollama-__codelineno-42-51"></a>
</span><span id="__span-42-52"><a id="__codelineno-42-52" name="__codelineno-42-52" href="#02-mcp-ollama-__codelineno-42-52"></a><span class="w">    </span><span class="c1">// Truncate if too long</span>
</span><span id="__span-42-53"><a id="__codelineno-42-53" name="__codelineno-42-53" href="#02-mcp-ollama-__codelineno-42-53"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">extractedContent</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">maxLength</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-54"><a id="__codelineno-42-54" name="__codelineno-42-54" href="#02-mcp-ollama-__codelineno-42-54"></a><span class="w">      </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">extractedContent</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">maxLength</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">;</span>
</span><span id="__span-42-55"><a id="__codelineno-42-55" name="__codelineno-42-55" href="#02-mcp-ollama-__codelineno-42-55"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-56"><a id="__codelineno-42-56" name="__codelineno-42-56" href="#02-mcp-ollama-__codelineno-42-56"></a>
</span><span id="__span-42-57"><a id="__codelineno-42-57" name="__codelineno-42-57" href="#02-mcp-ollama-__codelineno-42-57"></a><span class="w">    </span><span class="c1">// Prepare metadata</span>
</span><span id="__span-42-58"><a id="__codelineno-42-58" name="__codelineno-42-58" href="#02-mcp-ollama-__codelineno-42-58"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-59"><a id="__codelineno-42-59" name="__codelineno-42-59" href="#02-mcp-ollama-__codelineno-42-59"></a><span class="w">      </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="kt">url</span><span class="p">,</span>
</span><span id="__span-42-60"><a id="__codelineno-42-60" name="__codelineno-42-60" href="#02-mcp-ollama-__codelineno-42-60"></a><span class="w">      </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="kt">response.status</span><span class="p">,</span>
</span><span id="__span-42-61"><a id="__codelineno-42-61" name="__codelineno-42-61" href="#02-mcp-ollama-__codelineno-42-61"></a><span class="w">      </span><span class="nx">contentType</span><span class="o">:</span><span class="w"> </span><span class="kt">response.headers</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">],</span>
</span><span id="__span-42-62"><a id="__codelineno-42-62" name="__codelineno-42-62" href="#02-mcp-ollama-__codelineno-42-62"></a><span class="w">      </span><span class="nx">contentLength</span><span class="o">:</span><span class="w"> </span><span class="kt">response.data.length</span><span class="p">,</span>
</span><span id="__span-42-63"><a id="__codelineno-42-63" name="__codelineno-42-63" href="#02-mcp-ollama-__codelineno-42-63"></a><span class="w">      </span><span class="nx">extractedLength</span><span class="o">:</span><span class="w"> </span><span class="kt">extractedContent.length</span><span class="p">,</span>
</span><span id="__span-42-64"><a id="__codelineno-42-64" name="__codelineno-42-64" href="#02-mcp-ollama-__codelineno-42-64"></a><span class="w">      </span><span class="nx">selector</span><span class="o">:</span><span class="w"> </span><span class="kt">selector</span><span class="p">,</span>
</span><span id="__span-42-65"><a id="__codelineno-42-65" name="__codelineno-42-65" href="#02-mcp-ollama-__codelineno-42-65"></a><span class="w">      </span><span class="nx">elementsFound</span><span class="o">:</span><span class="w"> </span><span class="kt">selector</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;body&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">length</span>
</span><span id="__span-42-66"><a id="__codelineno-42-66" name="__codelineno-42-66" href="#02-mcp-ollama-__codelineno-42-66"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-42-67"><a id="__codelineno-42-67" name="__codelineno-42-67" href="#02-mcp-ollama-__codelineno-42-67"></a>
</span><span id="__span-42-68"><a id="__codelineno-42-68" name="__codelineno-42-68" href="#02-mcp-ollama-__codelineno-42-68"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-69"><a id="__codelineno-42-69" name="__codelineno-42-69" href="#02-mcp-ollama-__codelineno-42-69"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-42-70"><a id="__codelineno-42-70" name="__codelineno-42-70" href="#02-mcp-ollama-__codelineno-42-70"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-42-71"><a id="__codelineno-42-71" name="__codelineno-42-71" href="#02-mcp-ollama-__codelineno-42-71"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-42-72"><a id="__codelineno-42-72" name="__codelineno-42-72" href="#02-mcp-ollama-__codelineno-42-72"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`🌐 Web Scraping Results\n\n📊 Metadata:\n</span><span class="si">${</span><span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">metadata</span><span class="p">).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">k</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="sb">`- </span><span class="si">${</span><span class="nx">k</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">v</span><span class="si">}</span><span class="sb">`</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">\n\n📄 Extracted Content:\n</span><span class="si">${</span><span class="nx">extractedContent</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-42-73"><a id="__codelineno-42-73" name="__codelineno-42-73" href="#02-mcp-ollama-__codelineno-42-73"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-42-74"><a id="__codelineno-42-74" name="__codelineno-42-74" href="#02-mcp-ollama-__codelineno-42-74"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-42-75"><a id="__codelineno-42-75" name="__codelineno-42-75" href="#02-mcp-ollama-__codelineno-42-75"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-42-76"><a id="__codelineno-42-76" name="__codelineno-42-76" href="#02-mcp-ollama-__codelineno-42-76"></a>
</span><span id="__span-42-77"><a id="__codelineno-42-77" name="__codelineno-42-77" href="#02-mcp-ollama-__codelineno-42-77"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-78"><a id="__codelineno-42-78" name="__codelineno-42-78" href="#02-mcp-ollama-__codelineno-42-78"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">axios</span><span class="p">.</span><span class="nx">isAxiosError</span><span class="p">(</span><span class="nx">error</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-79"><a id="__codelineno-42-79" name="__codelineno-42-79" href="#02-mcp-ollama-__codelineno-42-79"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ENOTFOUND&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-80"><a id="__codelineno-42-80" name="__codelineno-42-80" href="#02-mcp-ollama-__codelineno-42-80"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Could not resolve hostname: </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-42-81"><a id="__codelineno-42-81" name="__codelineno-42-81" href="#02-mcp-ollama-__codelineno-42-81"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ECONNREFUSED&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-82"><a id="__codelineno-42-82" name="__codelineno-42-82" href="#02-mcp-ollama-__codelineno-42-82"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Connection refused: </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-42-83"><a id="__codelineno-42-83" name="__codelineno-42-83" href="#02-mcp-ollama-__codelineno-42-83"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-84"><a id="__codelineno-42-84" name="__codelineno-42-84" href="#02-mcp-ollama-__codelineno-42-84"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`HTTP </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-42-85"><a id="__codelineno-42-85" name="__codelineno-42-85" href="#02-mcp-ollama-__codelineno-42-85"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ETIMEDOUT&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-86"><a id="__codelineno-42-86" name="__codelineno-42-86" href="#02-mcp-ollama-__codelineno-42-86"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Request timeout after </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">timeout</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">10000</span><span class="si">}</span><span class="sb">ms`</span><span class="p">);</span>
</span><span id="__span-42-87"><a id="__codelineno-42-87" name="__codelineno-42-87" href="#02-mcp-ollama-__codelineno-42-87"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-88"><a id="__codelineno-42-88" name="__codelineno-42-88" href="#02-mcp-ollama-__codelineno-42-88"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Network error: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-42-89"><a id="__codelineno-42-89" name="__codelineno-42-89" href="#02-mcp-ollama-__codelineno-42-89"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-42-90"><a id="__codelineno-42-90" name="__codelineno-42-90" href="#02-mcp-ollama-__codelineno-42-90"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-91"><a id="__codelineno-42-91" name="__codelineno-42-91" href="#02-mcp-ollama-__codelineno-42-91"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Web scraping failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-42-92"><a id="__codelineno-42-92" name="__codelineno-42-92" href="#02-mcp-ollama-__codelineno-42-92"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-93"><a id="__codelineno-42-93" name="__codelineno-42-93" href="#02-mcp-ollama-__codelineno-42-93"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-42-94"><a id="__codelineno-42-94" name="__codelineno-42-94" href="#02-mcp-ollama-__codelineno-42-94"></a><span class="p">}</span>
</span></code></pre></div>

Testing - Test with different websites and selectors:

<div class="language-javascript highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#02-mcp-ollama-__codelineno-43-1"></a><span class="c1">// Basic page scraping</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#02-mcp-ollama-__codelineno-43-2"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://httpbin.org/html&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#02-mcp-ollama-__codelineno-43-3"></a>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#02-mcp-ollama-__codelineno-43-4"></a><span class="c1">// Extract specific elements</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#02-mcp-ollama-__codelineno-43-5"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://httpbin.org/html&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">selector</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;h1&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#02-mcp-ollama-__codelineno-43-6"></a>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#02-mcp-ollama-__codelineno-43-7"></a><span class="c1">// Get HTML instead of text</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#02-mcp-ollama-__codelineno-43-8"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://httpbin.org/html&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">selector</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;p&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">includeText</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#02-mcp-ollama-__codelineno-43-9"></a>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#02-mcp-ollama-__codelineno-43-10"></a><span class="c1">// Test error handling</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#02-mcp-ollama-__codelineno-43-11"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://nonexistent-domain-12345.com&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#02-mcp-ollama-__codelineno-43-12"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://httpbin.org/status/404&quot;</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>

#### Security Notes

- This tool includes basic security measures but should not be used for production scraping
- Always respect robots.txt and terms of service
- Consider rate limiting to avoid being blocked
- Some websites may block requests without proper headers

</details></section>
                    <section class='print-page md-section' id='section-4' heading-number='4'>
                        <h1>Resources<a class='headerlink' href='#section-4' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="resources-resources" heading-number="4.1"><h1 id="resources-resources-resources">Resources<a class="headerlink" href="#resources-resources-resources" title="Permanent link">&para;</a></h1></section><section class="print-page" id="resources-01-mcp-workflow-step01-imports" heading-number="4.2"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-5"></a><span class="sd">Step 1: Imports</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step01-imports-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step02-ctor" heading-number="4.3"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-5"></a><span class="sd">Step 1: Imports</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-26"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-28"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-29"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-30"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-31"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-32"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-33"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step02-ctor-__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step03-init" heading-number="4.4"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-5"></a><span class="sd">Step 1: Imports</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-26"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-28"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-29"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-30"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-31"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-32"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-33"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-36"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-37"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step03-init-__codelineno-0-40"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step04-tools" heading-number="4.5"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-5"></a><span class="sd">Step 4: Register Tools</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-26"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-28"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-29"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-30"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-31"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-32"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-33"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-36"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-37"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-40"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-41"></a>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-43"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-45"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-46"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-47"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-48"></a><span class="sd">            Return the list of available tools.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-49"></a><span class="sd">            This is called when clients want to discover what tools are available.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-50"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-51"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-52"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-53"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-54"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-55"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-56"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-57"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-58"></a>                            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-59"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-60"></a>                                <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-61"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-62"></a>                            <span class="p">},</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-63"></a>                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-64"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-65"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-66"></a>                            <span class="p">},</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-67"></a>                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-68"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-69"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-70"></a>                            <span class="p">}</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-71"></a>                        <span class="p">},</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-72"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-73"></a>                    <span class="p">}</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-74"></a>                <span class="p">),</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-75"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-76"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-77"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-78"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-79"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-80"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-81"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-82"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-83"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-84"></a>                            <span class="p">},</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-85"></a>                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-86"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-87"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-88"></a>                            <span class="p">}</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-89"></a>                        <span class="p">},</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-90"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-91"></a>                    <span class="p">}</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-92"></a>                <span class="p">),</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-93"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-94"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-95"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-96"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-97"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-98"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-99"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-100"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-101"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-102"></a>                            <span class="p">}</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-103"></a>                        <span class="p">},</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-104"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-105"></a>                    <span class="p">}</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-106"></a>                <span class="p">),</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-107"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-108"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-109"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-110"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-111"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-112"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-113"></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-114"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-115"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-116"></a>                            <span class="p">}</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-117"></a>                        <span class="p">},</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-118"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-119"></a>                    <span class="p">}</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-120"></a>                <span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-121"></a>            <span class="p">]</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-01-mcp-workflow-step04-tools-__codelineno-0-123"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step05-tool-handlers" heading-number="4.6"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-5"></a><span class="sd">Step 5: Register Tool Handlers</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-26"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-28"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-29"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-30"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-31"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-32"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-33"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-36"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-37"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-40"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-41"></a>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-43"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-45"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-46"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-47"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-48"></a><span class="sd">            Return the list of available tools.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-49"></a><span class="sd">            This is called when clients want to discover what tools are available.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-50"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-51"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-52"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-53"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-54"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-55"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-56"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-57"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-58"></a>                            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-59"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-60"></a>                                <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-61"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-62"></a>                            <span class="p">},</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-63"></a>                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-64"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-65"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-66"></a>                            <span class="p">},</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-67"></a>                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-68"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-69"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-70"></a>                            <span class="p">}</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-71"></a>                        <span class="p">},</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-72"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-73"></a>                    <span class="p">}</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-74"></a>                <span class="p">),</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-75"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-76"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-77"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-78"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-79"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-80"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-81"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-82"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-83"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-84"></a>                            <span class="p">},</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-85"></a>                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-86"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-87"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-88"></a>                            <span class="p">}</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-89"></a>                        <span class="p">},</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-90"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-91"></a>                    <span class="p">}</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-92"></a>                <span class="p">),</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-93"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-94"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-95"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-96"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-97"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-98"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-99"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-100"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-101"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-102"></a>                            <span class="p">}</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-103"></a>                        <span class="p">},</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-104"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-105"></a>                    <span class="p">}</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-106"></a>                <span class="p">),</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-107"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-108"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-109"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-110"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-111"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-112"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-113"></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-114"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-115"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-116"></a>                            <span class="p">}</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-117"></a>                        <span class="p">},</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-118"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-119"></a>                    <span class="p">}</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-120"></a>                <span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-121"></a>            <span class="p">]</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-123"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-124"></a>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-125"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-126"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-127"></a>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-128"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-129"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-130"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-131"></a><span class="sd">            Handle tool execution requests.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-132"></a><span class="sd">            This is called when a client wants to execute a tool.</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-133"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-134"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-135"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-136"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-137"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-139"></a>                <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-140"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-141"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-142"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-143"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-144"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-145"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-146"></a>                    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-147"></a>                        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-148"></a>                            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-149"></a>                            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-150"></a>                        <span class="p">)]</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-151"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-152"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-153"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-154"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-155"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-156"></a>                    <span class="p">)]</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-158"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-159"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-160"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-161"></a>                <span class="p">)]</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-163"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-164"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-165"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-166"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-167"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-168"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-169"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-170"></a>                <span class="p">)]</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-171"></a>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-172"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-173"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-174"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-175"></a>                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-176"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-177"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-178"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-179"></a>                    <span class="p">)]</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-180"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-181"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-182"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-183"></a>                <span class="p">)]</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-184"></a>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-185"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-186"></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-187"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-188"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-189"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-190"></a>                <span class="p">)]</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-191"></a>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-192"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-193"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-194"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-195"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-196"></a>                <span class="p">)]</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-197"></a>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#resources-01-mcp-workflow-step05-tool-handlers-__codelineno-0-198"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step06-resources" heading-number="4.7"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-5"></a><span class="sd">Step 6: Register Resources</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-26"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-28"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-29"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-30"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-31"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-32"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-33"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-36"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-37"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-40"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-41"></a>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-43"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-45"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-46"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-47"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-48"></a><span class="sd">            Return the list of available tools.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-49"></a><span class="sd">            This is called when clients want to discover what tools are available.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-50"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-51"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-52"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-53"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-54"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-55"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-56"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-57"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-58"></a>                            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-59"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-60"></a>                                <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-61"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-62"></a>                            <span class="p">},</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-63"></a>                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-64"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-65"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-66"></a>                            <span class="p">},</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-67"></a>                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-68"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-69"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-70"></a>                            <span class="p">}</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-71"></a>                        <span class="p">},</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-72"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-73"></a>                    <span class="p">}</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-74"></a>                <span class="p">),</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-75"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-76"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-77"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-78"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-79"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-80"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-81"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-82"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-83"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-84"></a>                            <span class="p">},</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-85"></a>                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-86"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-87"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-88"></a>                            <span class="p">}</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-89"></a>                        <span class="p">},</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-90"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-91"></a>                    <span class="p">}</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-92"></a>                <span class="p">),</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-93"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-94"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-95"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-96"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-97"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-98"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-99"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-100"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-101"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-102"></a>                            <span class="p">}</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-103"></a>                        <span class="p">},</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-104"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-105"></a>                    <span class="p">}</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-106"></a>                <span class="p">),</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-107"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-108"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-109"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-110"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-111"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-112"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-113"></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-114"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-115"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-116"></a>                            <span class="p">}</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-117"></a>                        <span class="p">},</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-118"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-119"></a>                    <span class="p">}</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-120"></a>                <span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-121"></a>            <span class="p">]</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-123"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-124"></a>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-125"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-126"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-127"></a>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-128"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-129"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-130"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-131"></a><span class="sd">            Handle tool execution requests.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-132"></a><span class="sd">            This is called when a client wants to execute a tool.</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-133"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-134"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-135"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-136"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-137"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-139"></a>                <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-140"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-141"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-142"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-143"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-144"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-145"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-146"></a>                    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-147"></a>                        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-148"></a>                            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-149"></a>                            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-150"></a>                        <span class="p">)]</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-151"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-152"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-153"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-154"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-155"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-156"></a>                    <span class="p">)]</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-158"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-159"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-160"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-161"></a>                <span class="p">)]</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-163"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-164"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-165"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-166"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-167"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-168"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-169"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-170"></a>                <span class="p">)]</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-171"></a>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-172"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-173"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-174"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-175"></a>                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-176"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-177"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-178"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-179"></a>                    <span class="p">)]</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-180"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-181"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-182"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-183"></a>                <span class="p">)]</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-184"></a>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-185"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-186"></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-187"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-188"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-189"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-190"></a>                <span class="p">)]</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-191"></a>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-192"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-193"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-194"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-195"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-196"></a>                <span class="p">)]</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-197"></a>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-198"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-199"></a>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-200"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-201"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register resources that clients can access.&quot;&quot;&quot;</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-202"></a>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-203"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-204"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-205"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-206"></a><span class="sd">            Return the list of available resources.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-207"></a><span class="sd">            This is called when clients want to discover what resources are available.</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-208"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-209"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-210"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-211"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-212"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-213"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-214"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-215"></a>                <span class="p">),</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-216"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-217"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://data-store&quot;</span><span class="p">,</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-218"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Store&quot;</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-219"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current contents of the data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-220"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-221"></a>                <span class="p">),</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-222"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-223"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://welcome&quot;</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-224"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Welcome Message&quot;</span><span class="p">,</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-225"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Welcome message and server capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-226"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-227"></a>                <span class="p">)</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-228"></a>            <span class="p">]</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-229"></a>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#resources-01-mcp-workflow-step06-resources-__codelineno-0-230"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources registered: server-info, data-store, welcome&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step07-resource-handlers" heading-number="4.8"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-5"></a><span class="sd">Step 7: Register Resource Handlers</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-26"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-28"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-29"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-30"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-31"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-32"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-33"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-36"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-37"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-40"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-41"></a>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-43"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-45"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-46"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-47"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-48"></a><span class="sd">            Return the list of available tools.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-49"></a><span class="sd">            This is called when clients want to discover what tools are available.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-50"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-51"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-52"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-53"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-54"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-55"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-56"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-57"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-58"></a>                            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-59"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-60"></a>                                <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-61"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-62"></a>                            <span class="p">},</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-63"></a>                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-64"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-65"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-66"></a>                            <span class="p">},</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-67"></a>                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-68"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-69"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-70"></a>                            <span class="p">}</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-71"></a>                        <span class="p">},</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-72"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-73"></a>                    <span class="p">}</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-74"></a>                <span class="p">),</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-75"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-76"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-77"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-78"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-79"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-80"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-81"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-82"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-83"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-84"></a>                            <span class="p">},</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-85"></a>                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-86"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-87"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-88"></a>                            <span class="p">}</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-89"></a>                        <span class="p">},</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-90"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-91"></a>                    <span class="p">}</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-92"></a>                <span class="p">),</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-93"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-94"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-95"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-96"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-97"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-98"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-99"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-100"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-101"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-102"></a>                            <span class="p">}</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-103"></a>                        <span class="p">},</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-104"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-105"></a>                    <span class="p">}</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-106"></a>                <span class="p">),</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-107"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-108"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-109"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-110"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-111"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-112"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-113"></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-114"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-115"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-116"></a>                            <span class="p">}</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-117"></a>                        <span class="p">},</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-118"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-119"></a>                    <span class="p">}</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-120"></a>                <span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-121"></a>            <span class="p">]</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-123"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-124"></a>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-125"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-126"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-127"></a>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-128"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-129"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-130"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-131"></a><span class="sd">            Handle tool execution requests.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-132"></a><span class="sd">            This is called when a client wants to execute a tool.</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-133"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-134"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-135"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-136"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-137"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-139"></a>                <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-140"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-141"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-142"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-143"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-144"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-145"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-146"></a>                    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-147"></a>                        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-148"></a>                            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-149"></a>                            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-150"></a>                        <span class="p">)]</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-151"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-152"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-153"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-154"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-155"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-156"></a>                    <span class="p">)]</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-158"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-159"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-160"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-161"></a>                <span class="p">)]</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-163"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-164"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-165"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-166"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-167"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-168"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-169"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-170"></a>                <span class="p">)]</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-171"></a>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-172"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-173"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-174"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-175"></a>                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-176"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-177"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-178"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-179"></a>                    <span class="p">)]</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-180"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-181"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-182"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-183"></a>                <span class="p">)]</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-184"></a>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-185"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-186"></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-187"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-188"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-189"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-190"></a>                <span class="p">)]</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-191"></a>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-192"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-193"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-194"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-195"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-196"></a>                <span class="p">)]</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-197"></a>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-198"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-199"></a>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-200"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-201"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register resources that clients can access.&quot;&quot;&quot;</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-202"></a>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-203"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-204"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-205"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-206"></a><span class="sd">            Return the list of available resources.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-207"></a><span class="sd">            This is called when clients want to discover what resources are available.</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-208"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-209"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-210"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-211"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-212"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-213"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-214"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-215"></a>                <span class="p">),</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-216"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-217"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://data-store&quot;</span><span class="p">,</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-218"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Store&quot;</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-219"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current contents of the data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-220"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-221"></a>                <span class="p">),</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-222"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-223"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://welcome&quot;</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-224"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Welcome Message&quot;</span><span class="p">,</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-225"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Welcome message and server capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-226"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-227"></a>                <span class="p">)</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-228"></a>            <span class="p">]</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-229"></a>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-230"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources registered: server-info, data-store, welcome&quot;</span><span class="p">)</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-231"></a>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-232"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resource_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-233"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement resource retrieval logic.&quot;&quot;&quot;</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-234"></a>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-235"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-236"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-237"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-238"></a><span class="sd">            Handle resource read requests.</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-239"></a><span class="sd">            This is called when a client wants to read a resource.</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-240"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-241"></a>            <span class="k">if</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span><span class="p">:</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-242"></a>                <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-243"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-244"></a>                    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-245"></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A comprehensive MCP server implementation&quot;</span><span class="p">,</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-246"></a>                    <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-247"></a>                        <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-248"></a>                        <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-249"></a>                        <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-250"></a>                    <span class="p">}</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-251"></a>                <span class="p">}</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-252"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-253"></a>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-254"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://data-store&quot;</span><span class="p">:</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-255"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-256"></a>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-257"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://welcome&quot;</span><span class="p">:</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-258"></a>                <span class="k">return</span> <span class="s2">&quot;&quot;&quot;Welcome to the Complete MCP Server!</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-259"></a>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-260"></a><span class="s2">This server demonstrates all MCP protocol capabilities:</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-261"></a><span class="s2">- Tools: Execute operations and computations</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-262"></a><span class="s2">- Resources: Access data and information</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-263"></a><span class="s2">- Prompts: Get structured prompt templates</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-264"></a>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-265"></a><span class="s2">Explore the available tools and resources to see what this server can do.&quot;&quot;&quot;</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-266"></a>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-267"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-268"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-269"></a>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#resources-01-mcp-workflow-step07-resource-handlers-__codelineno-0-270"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resource handlers implemented&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step08-prompts" heading-number="4.9"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-5"></a><span class="sd">Step 8: Register Prompts</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-19"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-20"></a><span class="p">)</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-21"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-22"></a>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-23"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-25"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-26"></a>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-27"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-28"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-29"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-30"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-31"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-32"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-33"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-34"></a>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-35"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-36"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-39"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-40"></a>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-41"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-42"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-43"></a>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-44"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-45"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-46"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-47"></a><span class="sd">            Return the list of available tools.</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-48"></a><span class="sd">            This is called when clients want to discover what tools are available.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-49"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-50"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-51"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-52"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-53"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-54"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-55"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-56"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-57"></a>                            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-58"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-59"></a>                                <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-60"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-61"></a>                            <span class="p">},</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-62"></a>                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-63"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-64"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-65"></a>                            <span class="p">},</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-66"></a>                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-67"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-68"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-69"></a>                            <span class="p">}</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-70"></a>                        <span class="p">},</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-71"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-72"></a>                    <span class="p">}</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-73"></a>                <span class="p">),</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-74"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-75"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-76"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-77"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-78"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-79"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-80"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-81"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-82"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-83"></a>                            <span class="p">},</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-84"></a>                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-85"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-86"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-87"></a>                            <span class="p">}</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-88"></a>                        <span class="p">},</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-89"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-90"></a>                    <span class="p">}</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-91"></a>                <span class="p">),</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-92"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-93"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-94"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-95"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-96"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-97"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-98"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-99"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-100"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-101"></a>                            <span class="p">}</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-102"></a>                        <span class="p">},</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-103"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-104"></a>                    <span class="p">}</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-105"></a>                <span class="p">),</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-106"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-107"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-108"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-109"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-110"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-111"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-112"></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-113"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-114"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-115"></a>                            <span class="p">}</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-116"></a>                        <span class="p">},</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-117"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-118"></a>                    <span class="p">}</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-119"></a>                <span class="p">)</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-120"></a>            <span class="p">]</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-121"></a>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-122"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-123"></a>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-124"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-125"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-127"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-128"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-129"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-130"></a><span class="sd">            Handle tool execution requests.</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-131"></a><span class="sd">            This is called when a client wants to execute a tool.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-132"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-133"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-134"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-135"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-136"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-137"></a>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-138"></a>                <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-139"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-140"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-141"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-142"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-143"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-144"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-145"></a>                    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-146"></a>                        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-147"></a>                            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-148"></a>                            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-149"></a>                        <span class="p">)]</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-150"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-151"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-152"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-153"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-154"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-155"></a>                    <span class="p">)]</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-156"></a>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-157"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-158"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-159"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-160"></a>                <span class="p">)]</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-161"></a>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-162"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-163"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-164"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-165"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-166"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-167"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-168"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-169"></a>                <span class="p">)]</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-171"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-172"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-173"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-174"></a>                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-175"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-176"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-177"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-178"></a>                    <span class="p">)]</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-179"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-180"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-181"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-182"></a>                <span class="p">)]</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-183"></a>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-184"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-185"></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-186"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-187"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-188"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-189"></a>                <span class="p">)]</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-190"></a>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-191"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-192"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-193"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-194"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-195"></a>                <span class="p">)]</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-196"></a>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-197"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-198"></a>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-199"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-200"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register resources that clients can access.&quot;&quot;&quot;</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-201"></a>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-202"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-203"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-204"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-205"></a><span class="sd">            Return the list of available resources.</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-206"></a><span class="sd">            This is called when clients want to discover what resources are available.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-207"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-208"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-209"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-210"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-211"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-212"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-213"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-214"></a>                <span class="p">),</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-215"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-216"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://data-store&quot;</span><span class="p">,</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-217"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Store&quot;</span><span class="p">,</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-218"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current contents of the data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-219"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-220"></a>                <span class="p">),</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-221"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-222"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://welcome&quot;</span><span class="p">,</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-223"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Welcome Message&quot;</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-224"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Welcome message and server capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-225"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-226"></a>                <span class="p">)</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-227"></a>            <span class="p">]</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-228"></a>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-229"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources registered: server-info, data-store, welcome&quot;</span><span class="p">)</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-230"></a>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-231"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resource_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-232"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement resource retrieval logic.&quot;&quot;&quot;</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-233"></a>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-234"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-235"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-236"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-237"></a><span class="sd">            Handle resource read requests.</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-238"></a><span class="sd">            This is called when a client wants to read a resource.</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-239"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-240"></a>            <span class="k">if</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span><span class="p">:</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-241"></a>                <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-242"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-243"></a>                    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-244"></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A comprehensive MCP server implementation&quot;</span><span class="p">,</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-245"></a>                    <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-246"></a>                        <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-247"></a>                        <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-248"></a>                        <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-249"></a>                    <span class="p">}</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-250"></a>                <span class="p">}</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-251"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-252"></a>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-253"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://data-store&quot;</span><span class="p">:</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-254"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-255"></a>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-256"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://welcome&quot;</span><span class="p">:</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-257"></a>                <span class="k">return</span> <span class="s2">&quot;&quot;&quot;Welcome to the Complete MCP Server!</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-258"></a>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-259"></a><span class="s2">This server demonstrates all MCP protocol capabilities:</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-260"></a><span class="s2">- Tools: Execute operations and computations</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-261"></a><span class="s2">- Resources: Access data and information</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-262"></a><span class="s2">- Prompts: Get structured prompt templates</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-263"></a>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-264"></a><span class="s2">Explore the available tools and resources to see what this server can do.&quot;&quot;&quot;</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-265"></a>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-266"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-267"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-268"></a>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-269"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resource handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-270"></a>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-271"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_prompts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-272"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register prompt templates for clients.&quot;&quot;&quot;</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-273"></a>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-274"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_prompts</span><span class="p">()</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-275"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_prompts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Prompt</span><span class="p">]:</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-276"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-277"></a><span class="sd">            Return the list of available prompts.</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-278"></a><span class="sd">            This is called when clients want to discover what prompts are available.</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-279"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-280"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-281"></a>                <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-282"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analyze-data&quot;</span><span class="p">,</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-283"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze data stored in the server&quot;</span><span class="p">,</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-284"></a>                    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-285"></a>                        <span class="p">{</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-286"></a>                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-287"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key of the data to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-288"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-289"></a>                        <span class="p">}</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-290"></a>                    <span class="p">]</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-291"></a>                <span class="p">),</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-292"></a>                <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-293"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate-scenario&quot;</span><span class="p">,</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-294"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Walk through a calculation scenario&quot;</span><span class="p">,</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-295"></a>                    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-296"></a>                        <span class="p">{</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-297"></a>                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;operation&quot;</span><span class="p">,</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-298"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to demonstrate (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-299"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-300"></a>                        <span class="p">}</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-301"></a>                    <span class="p">]</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-302"></a>                <span class="p">)</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-303"></a>            <span class="p">]</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-304"></a>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#resources-01-mcp-workflow-step08-prompts-__codelineno-0-305"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompts registered: analyze-data, calculate-scenario&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step09-prompt-handlers" heading-number="4.10"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-5"></a><span class="sd">Step 9: Register Prompt Handlers</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-26"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-28"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-29"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-30"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-31"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-32"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-33"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-36"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-37"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-40"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-41"></a>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-43"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-45"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-46"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-47"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-48"></a><span class="sd">            Return the list of available tools.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-49"></a><span class="sd">            This is called when clients want to discover what tools are available.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-50"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-51"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-52"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-53"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-54"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-55"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-56"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-57"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-58"></a>                            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-59"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-60"></a>                                <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-61"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-62"></a>                            <span class="p">},</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-63"></a>                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-64"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-65"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-66"></a>                            <span class="p">},</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-67"></a>                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-68"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-69"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-70"></a>                            <span class="p">}</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-71"></a>                        <span class="p">},</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-72"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-73"></a>                    <span class="p">}</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-74"></a>                <span class="p">),</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-75"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-76"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-77"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-78"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-79"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-80"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-81"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-82"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-83"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-84"></a>                            <span class="p">},</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-85"></a>                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-86"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-87"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-88"></a>                            <span class="p">}</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-89"></a>                        <span class="p">},</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-90"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-91"></a>                    <span class="p">}</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-92"></a>                <span class="p">),</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-93"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-94"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-95"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-96"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-97"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-98"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-99"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-100"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-101"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-102"></a>                            <span class="p">}</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-103"></a>                        <span class="p">},</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-104"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-105"></a>                    <span class="p">}</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-106"></a>                <span class="p">),</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-107"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-108"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-109"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-110"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-111"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-112"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-113"></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-114"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-115"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-116"></a>                            <span class="p">}</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-117"></a>                        <span class="p">},</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-118"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-119"></a>                    <span class="p">}</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-120"></a>                <span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-121"></a>            <span class="p">]</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-123"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-124"></a>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-125"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-126"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-127"></a>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-128"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-129"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-130"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-131"></a><span class="sd">            Handle tool execution requests.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-132"></a><span class="sd">            This is called when a client wants to execute a tool.</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-133"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-134"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-135"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-136"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-137"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-139"></a>                <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-140"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-141"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-142"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-143"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-144"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-145"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-146"></a>                    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-147"></a>                        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-148"></a>                            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-149"></a>                            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-150"></a>                        <span class="p">)]</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-151"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-152"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-153"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-154"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-155"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-156"></a>                    <span class="p">)]</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-158"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-159"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-160"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-161"></a>                <span class="p">)]</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-163"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-164"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-165"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-166"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-167"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-168"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-169"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-170"></a>                <span class="p">)]</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-171"></a>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-172"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-173"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-174"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-175"></a>                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-176"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-177"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-178"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-179"></a>                    <span class="p">)]</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-180"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-181"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-182"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-183"></a>                <span class="p">)]</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-184"></a>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-185"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-186"></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-187"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-188"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-189"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-190"></a>                <span class="p">)]</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-191"></a>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-192"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-193"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-194"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-195"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-196"></a>                <span class="p">)]</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-197"></a>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-198"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-199"></a>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-200"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-201"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register resources that clients can access.&quot;&quot;&quot;</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-202"></a>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-203"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-204"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-205"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-206"></a><span class="sd">            Return the list of available resources.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-207"></a><span class="sd">            This is called when clients want to discover what resources are available.</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-208"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-209"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-210"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-211"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-212"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-213"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-214"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-215"></a>                <span class="p">),</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-216"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-217"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://data-store&quot;</span><span class="p">,</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-218"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Store&quot;</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-219"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current contents of the data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-220"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-221"></a>                <span class="p">),</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-222"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-223"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://welcome&quot;</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-224"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Welcome Message&quot;</span><span class="p">,</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-225"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Welcome message and server capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-226"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-227"></a>                <span class="p">)</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-228"></a>            <span class="p">]</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-229"></a>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-230"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources registered: server-info, data-store, welcome&quot;</span><span class="p">)</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-231"></a>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-232"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resource_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-233"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement resource retrieval logic.&quot;&quot;&quot;</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-234"></a>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-235"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-236"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-237"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-238"></a><span class="sd">            Handle resource read requests.</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-239"></a><span class="sd">            This is called when a client wants to read a resource.</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-240"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-241"></a>            <span class="k">if</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span><span class="p">:</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-242"></a>                <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-243"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-244"></a>                    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-245"></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A comprehensive MCP server implementation&quot;</span><span class="p">,</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-246"></a>                    <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-247"></a>                        <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-248"></a>                        <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-249"></a>                        <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-250"></a>                    <span class="p">}</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-251"></a>                <span class="p">}</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-252"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-253"></a>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-254"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://data-store&quot;</span><span class="p">:</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-255"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-256"></a>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-257"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://welcome&quot;</span><span class="p">:</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-258"></a>                <span class="k">return</span> <span class="s2">&quot;&quot;&quot;Welcome to the Complete MCP Server!</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-259"></a>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-260"></a><span class="s2">This server demonstrates all MCP protocol capabilities:</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-261"></a><span class="s2">- Tools: Execute operations and computations</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-262"></a><span class="s2">- Resources: Access data and information</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-263"></a><span class="s2">- Prompts: Get structured prompt templates</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-264"></a>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-265"></a><span class="s2">Explore the available tools and resources to see what this server can do.&quot;&quot;&quot;</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-266"></a>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-267"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-268"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-269"></a>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-270"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resource handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-271"></a>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-272"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_prompts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-273"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register prompt templates for clients.&quot;&quot;&quot;</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-274"></a>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-275"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_prompts</span><span class="p">()</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-276"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_prompts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Prompt</span><span class="p">]:</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-277"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-278"></a><span class="sd">            Return the list of available prompts.</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-279"></a><span class="sd">            This is called when clients want to discover what prompts are available.</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-280"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-281"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-282"></a>                <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-283"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analyze-data&quot;</span><span class="p">,</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-284"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze data stored in the server&quot;</span><span class="p">,</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-285"></a>                    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-286"></a>                        <span class="p">{</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-287"></a>                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-288"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key of the data to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-289"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-290"></a>                        <span class="p">}</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-291"></a>                    <span class="p">]</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-292"></a>                <span class="p">),</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-293"></a>                <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-294"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate-scenario&quot;</span><span class="p">,</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-295"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Walk through a calculation scenario&quot;</span><span class="p">,</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-296"></a>                    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-297"></a>                        <span class="p">{</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-298"></a>                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;operation&quot;</span><span class="p">,</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-299"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to demonstrate (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-300"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-301"></a>                        <span class="p">}</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-302"></a>                    <span class="p">]</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-303"></a>                <span class="p">)</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-304"></a>            <span class="p">]</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-305"></a>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-306"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompts registered: analyze-data, calculate-scenario&quot;</span><span class="p">)</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-307"></a>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-308"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_prompt_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-309"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement prompt generation logic.&quot;&quot;&quot;</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-311"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">get_prompt</span><span class="p">()</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-312"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prompt</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-313"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-314"></a><span class="sd">            Handle prompt generation requests.</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-315"></a><span class="sd">            This is called when a client wants to get a prompt.</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-316"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-317"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;analyze-data&quot;</span><span class="p">:</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-318"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-319"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;not found&quot;</span><span class="p">)</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-320"></a>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-321"></a>                <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Analyze the following data from the server:</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-322"></a>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-323"></a><span class="s2">Key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-324"></a><span class="s2">Value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-325"></a>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-326"></a><span class="s2">Please provide:</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-327"></a><span class="s2">1. A description of what this data represents</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-328"></a><span class="s2">2. Any patterns or insights you notice</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-329"></a><span class="s2">3. Suggestions for how this data could be used</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-330"></a>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-331"></a><span class="s2">Use the retrieve_data tool if you need to fetch additional context.&quot;&quot;&quot;</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-332"></a>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-333"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-334"></a>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-335"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate-scenario&quot;</span><span class="p">:</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-336"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;add&quot;</span><span class="p">)</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-337"></a>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-338"></a>                <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Let&#39;s work through a </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> calculation scenario.</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-339"></a>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-340"></a><span class="s2">Use the calculate tool with the operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;.</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-341"></a><span class="s2">For example:</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-342"></a><span class="s2">- Choose two numbers (a and b)</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-343"></a><span class="s2">- Execute: calculate(operation=&quot;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&quot;, a=10, b=5)</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-344"></a><span class="s2">- Explain the result</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-345"></a>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-346"></a><span class="s2">This demonstrates how to use computational tools in the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-347"></a>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-348"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-349"></a>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-350"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-351"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-352"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-353"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown prompt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-354"></a>                <span class="p">)]</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-355"></a>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356" href="#resources-01-mcp-workflow-step09-prompt-handlers-__codelineno-0-356"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompt handlers implemented&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step10-lifecycle" heading-number="4.11"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-5"></a><span class="sd">Step 10: Lifecycle Handlers</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-21"></a><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-26"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-28"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-29"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-30"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-31"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-32"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-33"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-36"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-37"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-40"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-41"></a>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-43"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-45"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-46"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-47"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-48"></a><span class="sd">            Return the list of available tools.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-49"></a><span class="sd">            This is called when clients want to discover what tools are available.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-50"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-51"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-52"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-53"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-54"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-55"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-56"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-57"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-58"></a>                            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-59"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-60"></a>                                <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-61"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-62"></a>                            <span class="p">},</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-63"></a>                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-64"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-65"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-66"></a>                            <span class="p">},</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-67"></a>                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-68"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-69"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-70"></a>                            <span class="p">}</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-71"></a>                        <span class="p">},</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-72"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-73"></a>                    <span class="p">}</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-74"></a>                <span class="p">),</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-75"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-76"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-77"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-78"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-79"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-80"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-81"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-82"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-83"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-84"></a>                            <span class="p">},</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-85"></a>                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-86"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-87"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-88"></a>                            <span class="p">}</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-89"></a>                        <span class="p">},</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-90"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-91"></a>                    <span class="p">}</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-92"></a>                <span class="p">),</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-93"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-94"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-95"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-96"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-97"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-98"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-99"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-100"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-101"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-102"></a>                            <span class="p">}</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-103"></a>                        <span class="p">},</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-104"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-105"></a>                    <span class="p">}</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-106"></a>                <span class="p">),</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-107"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-108"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-109"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-110"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-111"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-112"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-113"></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-114"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-115"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-116"></a>                            <span class="p">}</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-117"></a>                        <span class="p">},</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-118"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-119"></a>                    <span class="p">}</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-120"></a>                <span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-121"></a>            <span class="p">]</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-123"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-124"></a>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-125"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-126"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-127"></a>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-128"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-129"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-130"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-131"></a><span class="sd">            Handle tool execution requests.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-132"></a><span class="sd">            This is called when a client wants to execute a tool.</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-133"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-134"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-135"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-136"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-137"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-139"></a>                <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-140"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-141"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-142"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-143"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-144"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-145"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-146"></a>                    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-147"></a>                        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-148"></a>                            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-149"></a>                            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-150"></a>                        <span class="p">)]</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-151"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-152"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-153"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-154"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-155"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-156"></a>                    <span class="p">)]</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-158"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-159"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-160"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-161"></a>                <span class="p">)]</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-163"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-164"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-165"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-166"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-167"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-168"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-169"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-170"></a>                <span class="p">)]</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-171"></a>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-172"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-173"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-174"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-175"></a>                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-176"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-177"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-178"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-179"></a>                    <span class="p">)]</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-180"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-181"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-182"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-183"></a>                <span class="p">)]</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-184"></a>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-185"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-186"></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-187"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-188"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-189"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-190"></a>                <span class="p">)]</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-191"></a>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-192"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-193"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-194"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-195"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-196"></a>                <span class="p">)]</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-197"></a>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-198"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-199"></a>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-200"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-201"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register resources that clients can access.&quot;&quot;&quot;</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-202"></a>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-203"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-204"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-205"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-206"></a><span class="sd">            Return the list of available resources.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-207"></a><span class="sd">            This is called when clients want to discover what resources are available.</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-208"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-209"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-210"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-211"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-212"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-213"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-214"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-215"></a>                <span class="p">),</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-216"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-217"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://data-store&quot;</span><span class="p">,</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-218"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Store&quot;</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-219"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current contents of the data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-220"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-221"></a>                <span class="p">),</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-222"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-223"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://welcome&quot;</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-224"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Welcome Message&quot;</span><span class="p">,</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-225"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Welcome message and server capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-226"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-227"></a>                <span class="p">)</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-228"></a>            <span class="p">]</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-229"></a>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-230"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources registered: server-info, data-store, welcome&quot;</span><span class="p">)</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-231"></a>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-232"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resource_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-233"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement resource retrieval logic.&quot;&quot;&quot;</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-234"></a>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-235"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-236"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-237"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-238"></a><span class="sd">            Handle resource read requests.</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-239"></a><span class="sd">            This is called when a client wants to read a resource.</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-240"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-241"></a>            <span class="k">if</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span><span class="p">:</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-242"></a>                <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-243"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-244"></a>                    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-245"></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A comprehensive MCP server implementation&quot;</span><span class="p">,</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-246"></a>                    <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-247"></a>                        <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-248"></a>                        <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-249"></a>                        <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-250"></a>                    <span class="p">}</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-251"></a>                <span class="p">}</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-252"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-253"></a>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-254"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://data-store&quot;</span><span class="p">:</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-255"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-256"></a>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-257"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://welcome&quot;</span><span class="p">:</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-258"></a>                <span class="k">return</span> <span class="s2">&quot;&quot;&quot;Welcome to the Complete MCP Server!</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-259"></a>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-260"></a><span class="s2">This server demonstrates all MCP protocol capabilities:</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-261"></a><span class="s2">- Tools: Execute operations and computations</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-262"></a><span class="s2">- Resources: Access data and information</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-263"></a><span class="s2">- Prompts: Get structured prompt templates</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-264"></a>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-265"></a><span class="s2">Explore the available tools and resources to see what this server can do.&quot;&quot;&quot;</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-266"></a>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-267"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-268"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-269"></a>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-270"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resource handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-271"></a>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-272"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_prompts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-273"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register prompt templates for clients.&quot;&quot;&quot;</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-274"></a>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-275"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_prompts</span><span class="p">()</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-276"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_prompts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Prompt</span><span class="p">]:</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-277"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-278"></a><span class="sd">            Return the list of available prompts.</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-279"></a><span class="sd">            This is called when clients want to discover what prompts are available.</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-280"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-281"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-282"></a>                <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-283"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analyze-data&quot;</span><span class="p">,</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-284"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze data stored in the server&quot;</span><span class="p">,</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-285"></a>                    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-286"></a>                        <span class="p">{</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-287"></a>                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-288"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key of the data to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-289"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-290"></a>                        <span class="p">}</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-291"></a>                    <span class="p">]</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-292"></a>                <span class="p">),</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-293"></a>                <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-294"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate-scenario&quot;</span><span class="p">,</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-295"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Walk through a calculation scenario&quot;</span><span class="p">,</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-296"></a>                    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-297"></a>                        <span class="p">{</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-298"></a>                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;operation&quot;</span><span class="p">,</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-299"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to demonstrate (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-300"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-301"></a>                        <span class="p">}</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-302"></a>                    <span class="p">]</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-303"></a>                <span class="p">)</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-304"></a>            <span class="p">]</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-305"></a>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-306"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompts registered: analyze-data, calculate-scenario&quot;</span><span class="p">)</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-307"></a>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-308"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_prompt_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-309"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement prompt generation logic.&quot;&quot;&quot;</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-311"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">get_prompt</span><span class="p">()</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-312"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prompt</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-313"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-314"></a><span class="sd">            Handle prompt generation requests.</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-315"></a><span class="sd">            This is called when a client wants to get a prompt.</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-316"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-317"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;analyze-data&quot;</span><span class="p">:</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-318"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-319"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;not found&quot;</span><span class="p">)</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-320"></a>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-321"></a>                <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Analyze the following data from the server:</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-322"></a>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-323"></a><span class="s2">Key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-324"></a><span class="s2">Value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-325"></a>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-326"></a><span class="s2">Please provide:</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-327"></a><span class="s2">1. A description of what this data represents</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-328"></a><span class="s2">2. Any patterns or insights you notice</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-329"></a><span class="s2">3. Suggestions for how this data could be used</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-330"></a>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-331"></a><span class="s2">Use the retrieve_data tool if you need to fetch additional context.&quot;&quot;&quot;</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-332"></a>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-333"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-334"></a>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-335"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate-scenario&quot;</span><span class="p">:</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-336"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;add&quot;</span><span class="p">)</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-337"></a>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-338"></a>                <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Let&#39;s work through a </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> calculation scenario.</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-339"></a>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-340"></a><span class="s2">Use the calculate tool with the operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;.</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-341"></a><span class="s2">For example:</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-342"></a><span class="s2">- Choose two numbers (a and b)</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-343"></a><span class="s2">- Execute: calculate(operation=&quot;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&quot;, a=10, b=5)</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-344"></a><span class="s2">- Explain the result</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-345"></a>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-346"></a><span class="s2">This demonstrates how to use computational tools in the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-347"></a>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-348"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-349"></a>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-350"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-351"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-352"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-353"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown prompt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-354"></a>                <span class="p">)]</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-355"></a>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-356"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompt handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-357"></a>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-358"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_lifecycle_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-359"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup lifecycle management (conceptual for MCP).&quot;&quot;&quot;</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-360"></a>        <span class="c1"># Note: MCP servers typically don&#39;t have explicit lifecycle hooks</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-361"></a>        <span class="c1"># This is a conceptual method showing where such logic would go</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362" href="#resources-01-mcp-workflow-step10-lifecycle-__codelineno-0-362"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lifecycle management configured&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-step11-main" heading-number="4.12"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-5"></a><span class="sd">Step 11: Main Execution</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-6"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-15"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-16"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-17"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-18"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-19"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-20"></a>    <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-21"></a>    <span class="n">GetPromptResult</span><span class="p">,</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-22"></a>    <span class="n">PromptMessage</span><span class="p">,</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-23"></a><span class="p">)</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-24"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-26"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-27"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-28"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all protocol features.</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-29"></a>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-30"></a><span class="sd">    This class demonstrates:</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-31"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-32"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-33"></a><span class="sd">    - Resource management</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-34"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-35"></a><span class="sd">    - Request handling</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-36"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-37"></a>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-38"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-39"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-42"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-43"></a>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-44"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-45"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-46"></a>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-47"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-48"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-49"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-50"></a><span class="sd">            Return the list of available tools.</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-51"></a><span class="sd">            This is called when clients want to discover what tools are available.</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-52"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-53"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-54"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-55"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-56"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-57"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-58"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-59"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-60"></a>                            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-61"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-62"></a>                                <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-63"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-64"></a>                            <span class="p">},</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-65"></a>                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-66"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-67"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-68"></a>                            <span class="p">},</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-69"></a>                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-70"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-71"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-72"></a>                            <span class="p">}</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-73"></a>                        <span class="p">},</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-74"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-75"></a>                    <span class="p">}</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-76"></a>                <span class="p">),</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-77"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-78"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-79"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-80"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-81"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-82"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-83"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-84"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-85"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-86"></a>                            <span class="p">},</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-87"></a>                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-88"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-89"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-90"></a>                            <span class="p">}</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-91"></a>                        <span class="p">},</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-92"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-93"></a>                    <span class="p">}</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-94"></a>                <span class="p">),</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-95"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-96"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-97"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-98"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-99"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-100"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-101"></a>                            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-102"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-103"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-104"></a>                            <span class="p">}</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-105"></a>                        <span class="p">},</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-106"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-107"></a>                    <span class="p">}</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-108"></a>                <span class="p">),</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-109"></a>                <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-110"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-111"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-112"></a>                    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-113"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-114"></a>                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-115"></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-116"></a>                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-117"></a>                                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-118"></a>                            <span class="p">}</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-119"></a>                        <span class="p">},</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-120"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-121"></a>                    <span class="p">}</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-122"></a>                <span class="p">)</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-123"></a>            <span class="p">]</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-124"></a>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-125"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-127"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-128"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-129"></a>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-130"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-131"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-132"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-133"></a><span class="sd">            Handle tool execution requests.</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-134"></a><span class="sd">            This is called when a client wants to execute a tool.</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-135"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-136"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-137"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-138"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-139"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-140"></a>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-141"></a>                <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-142"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-143"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-144"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-145"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-146"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-147"></a>                <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-148"></a>                    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-149"></a>                        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-150"></a>                            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-151"></a>                            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-152"></a>                        <span class="p">)]</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-153"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-154"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-155"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-156"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-157"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-158"></a>                    <span class="p">)]</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-159"></a>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-160"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-161"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-162"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-163"></a>                <span class="p">)]</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-164"></a>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-165"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-166"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-167"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-168"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-169"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-170"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-171"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-172"></a>                <span class="p">)]</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-173"></a>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-174"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-175"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-176"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-177"></a>                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-178"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-179"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-180"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-181"></a>                    <span class="p">)]</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-182"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-183"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-184"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-185"></a>                <span class="p">)]</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-186"></a>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-187"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-188"></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-189"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-190"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-191"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-192"></a>                <span class="p">)]</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-193"></a>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-194"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-195"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-196"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-197"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-198"></a>                <span class="p">)]</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-199"></a>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-200"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-201"></a>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-202"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-203"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register resources that clients can access.&quot;&quot;&quot;</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-204"></a>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-205"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-206"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-207"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-208"></a><span class="sd">            Return the list of available resources.</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-209"></a><span class="sd">            This is called when clients want to discover what resources are available.</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-210"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-211"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-212"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-213"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-214"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-215"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-216"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-217"></a>                <span class="p">),</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-218"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-219"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://data-store&quot;</span><span class="p">,</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-220"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Store&quot;</span><span class="p">,</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-221"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current contents of the data store&quot;</span><span class="p">,</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-222"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-223"></a>                <span class="p">),</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-224"></a>                <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-225"></a>                    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://welcome&quot;</span><span class="p">,</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-226"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Welcome Message&quot;</span><span class="p">,</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-227"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Welcome message and server capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-228"></a>                    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-229"></a>                <span class="p">)</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-230"></a>            <span class="p">]</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-231"></a>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-232"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources registered: server-info, data-store, welcome&quot;</span><span class="p">)</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-233"></a>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-234"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_resource_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-235"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement resource retrieval logic.&quot;&quot;&quot;</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-236"></a>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-237"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-238"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-239"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-240"></a><span class="sd">            Handle resource read requests.</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-241"></a><span class="sd">            This is called when a client wants to read a resource.</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-242"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-243"></a>            <span class="n">uri</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>  <span class="c1"># Ensure uri is a string</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-244"></a>            <span class="k">if</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span><span class="p">:</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-245"></a>                <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-246"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-247"></a>                    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-248"></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A comprehensive MCP server implementation&quot;</span><span class="p">,</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-249"></a>                    <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-250"></a>                        <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-251"></a>                        <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-252"></a>                        <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-253"></a>                    <span class="p">}</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-254"></a>                <span class="p">}</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-255"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-256"></a>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-257"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://data-store&quot;</span><span class="p">:</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-258"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-259"></a>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-260"></a>            <span class="k">elif</span> <span class="n">uri</span> <span class="o">==</span> <span class="s2">&quot;resource://welcome&quot;</span><span class="p">:</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-261"></a>                <span class="k">return</span> <span class="s2">&quot;&quot;&quot;Welcome to the Complete MCP Server!</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-262"></a>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-263"></a><span class="s2">This server demonstrates all MCP protocol capabilities:</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-264"></a><span class="s2">- Tools: Execute operations and computations</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-265"></a><span class="s2">- Resources: Access data and information</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-266"></a><span class="s2">- Prompts: Get structured prompt templates</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-267"></a>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-268"></a><span class="s2">Explore the available tools and resources to see what this server can do.&quot;&quot;&quot;</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-269"></a>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-270"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-271"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-272"></a>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-273"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resource handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-274"></a>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-275"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_prompts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-276"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register prompt templates for clients.&quot;&quot;&quot;</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-277"></a>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-278"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_prompts</span><span class="p">()</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-279"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_prompts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Prompt</span><span class="p">]:</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-280"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-281"></a><span class="sd">            Return the list of available prompts.</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-282"></a><span class="sd">            This is called when clients want to discover what prompts are available.</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-283"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-284"></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-285"></a>                <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-286"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analyze-data&quot;</span><span class="p">,</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-287"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze data stored in the server&quot;</span><span class="p">,</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-288"></a>                    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-289"></a>                        <span class="p">{</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-290"></a>                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-291"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key of the data to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-292"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-293"></a>                        <span class="p">}</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-294"></a>                    <span class="p">]</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-295"></a>                <span class="p">),</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-296"></a>                <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-297"></a>                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate-scenario&quot;</span><span class="p">,</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-298"></a>                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Walk through a calculation scenario&quot;</span><span class="p">,</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-299"></a>                    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-300"></a>                        <span class="p">{</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-301"></a>                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;operation&quot;</span><span class="p">,</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-302"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to demonstrate (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-303"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-304"></a>                        <span class="p">}</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-305"></a>                    <span class="p">]</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-306"></a>                <span class="p">)</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-307"></a>            <span class="p">]</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-308"></a>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-309"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompts registered: analyze-data, calculate-scenario&quot;</span><span class="p">)</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-311"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_prompt_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-312"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Implement prompt generation logic.&quot;&quot;&quot;</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-313"></a>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-314"></a>        <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">get_prompt</span><span class="p">()</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-315"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prompt</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GetPromptResult</span><span class="p">:</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-316"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-317"></a><span class="sd">            Handle prompt generation requests.</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-318"></a><span class="sd">            This is called when a client wants to get a prompt.</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-319"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-320"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;analyze-data&quot;</span><span class="p">:</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-321"></a>                <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-322"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;not found&quot;</span><span class="p">)</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-323"></a>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-324"></a>                <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Analyze the following data from the server:</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-325"></a>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-326"></a><span class="s2">Key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-327"></a><span class="s2">Value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-328"></a>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-329"></a><span class="s2">Please provide:</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-330"></a><span class="s2">1. A description of what this data represents</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-331"></a><span class="s2">2. Any patterns or insights you notice</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-332"></a><span class="s2">3. Suggestions for how this data could be used</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-333"></a>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-334"></a><span class="s2">Use the retrieve_data tool if you need to fetch additional context.&quot;&quot;&quot;</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-335"></a>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-336"></a>                <span class="k">return</span> <span class="n">GetPromptResult</span><span class="p">(</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-337"></a>                    <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-338"></a>                        <span class="n">PromptMessage</span><span class="p">(</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-339"></a>                            <span class="n">role</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-340"></a>                            <span class="n">content</span><span class="o">=</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-341"></a>                        <span class="p">)</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-342"></a>                    <span class="p">]</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-343"></a>                <span class="p">)</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-344"></a>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-345"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate-scenario&quot;</span><span class="p">:</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-346"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;add&quot;</span><span class="p">)</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-347"></a>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-348"></a>                <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Let&#39;s work through a </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> calculation scenario.</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-349"></a>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-350"></a><span class="s2">Use the calculate tool with the operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;.</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-351"></a><span class="s2">For example:</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-352"></a><span class="s2">- Choose two numbers (a and b)</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-353"></a><span class="s2">- Execute: calculate(operation=&quot;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&quot;, a=10, b=5)</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-354"></a><span class="s2">- Explain the result</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-355"></a>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-356"></a><span class="s2">This demonstrates how to use computational tools in the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-357"></a>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-358"></a>                <span class="k">return</span> <span class="n">GetPromptResult</span><span class="p">(</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-359"></a>                    <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-360"></a>                        <span class="n">PromptMessage</span><span class="p">(</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-361"></a>                            <span class="n">role</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-362"></a>                            <span class="n">content</span><span class="o">=</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-363"></a>                        <span class="p">)</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-364"></a>                    <span class="p">]</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-365"></a>                <span class="p">)</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-366"></a>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-367"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-368"></a>                <span class="c1"># Helper to create error message in correct format</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-369"></a>                <span class="k">return</span> <span class="n">GetPromptResult</span><span class="p">(</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-370"></a>                    <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-371"></a>                        <span class="n">PromptMessage</span><span class="p">(</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-372"></a>                            <span class="n">role</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-373"></a>                            <span class="n">content</span><span class="o">=</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-374"></a>                                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-375"></a>                                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown prompt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-376"></a>                            <span class="p">)</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-377"></a>                        <span class="p">)</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-378"></a>                    <span class="p">]</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-379"></a>                <span class="p">)</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-380"></a>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-381"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompt handlers implemented&quot;</span><span class="p">)</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-382"></a>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-383"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_lifecycle_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-384"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup lifecycle management (conceptual for MCP).&quot;&quot;&quot;</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-385"></a>        <span class="c1"># Note: MCP servers typically don&#39;t have explicit lifecycle hooks</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-386"></a>        <span class="c1"># This is a conceptual method showing where such logic would go</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-387"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lifecycle management configured&quot;</span><span class="p">)</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-388"></a>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-389"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-390"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-391"></a>        <span class="c1"># Initialize everything</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-392"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">register_tools</span><span class="p">()</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-393"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">register_tool_handlers</span><span class="p">()</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-394"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">register_resources</span><span class="p">()</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-395"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">register_resource_handlers</span><span class="p">()</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-396"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">register_prompts</span><span class="p">()</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-397"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">register_prompt_handlers</span><span class="p">()</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-398"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_lifecycle_handlers</span><span class="p">()</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-399"></a>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-400"></a>        <span class="c1"># Connect to stdio</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-401"></a>        <span class="k">async</span> <span class="k">with</span> <span class="n">stdio_server</span><span class="p">()</span> <span class="k">as</span> <span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">):</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-402"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server running on stdio...&quot;</span><span class="p">)</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-403"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-404"></a>                <span class="n">read_stream</span><span class="p">,</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-405"></a>                <span class="n">write_stream</span><span class="p">,</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-406"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">create_initialization_options</span><span class="p">()</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-407"></a>            <span class="p">)</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-408"></a>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-409"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-410"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point.&quot;&quot;&quot;</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-411"></a>    <span class="n">server</span> <span class="o">=</span> <span class="n">CompleteMCPServer</span><span class="p">()</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-412"></a>    <span class="k">await</span> <span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-413"></a>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-414"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-415"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-416"></a>        <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-417"></a>    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-418"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server stopped by user&quot;</span><span class="p">)</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-419"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-420"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421" href="#resources-01-mcp-workflow-step11-main-__codelineno-0-421"></a>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-01-mcp-workflow-test_client" heading-number="4.13"><div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-01-mcp-workflow-test_client-__codelineno-0-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-01-mcp-workflow-test_client-__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-01-mcp-workflow-test_client-__codelineno-0-3"></a><span class="c1"># Determine the directory where this script is located</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-01-mcp-workflow-test_client-__codelineno-0-4"></a><span class="nv">SCRIPT_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>dirname<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-01-mcp-workflow-test_client-__codelineno-0-5"></a><span class="nv">PROJECT_ROOT</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$SCRIPT_DIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="c1"># Run from the same directory</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-01-mcp-workflow-test_client-__codelineno-0-6"></a><span class="c1"># Define the server script path</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-01-mcp-workflow-test_client-__codelineno-0-7"></a><span class="nv">SERVER_SCRIPT</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SCRIPT_DIR</span><span class="si">}</span><span class="s2">/step11-main.md&quot;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-01-mcp-workflow-test_client-__codelineno-0-8"></a><span class="nv">TEMP_PY</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SCRIPT_DIR</span><span class="si">}</span><span class="s2">/temp_server.py&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-01-mcp-workflow-test_client-__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-01-mcp-workflow-test_client-__codelineno-0-10"></a><span class="c1"># Navigate to the project root directory</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-01-mcp-workflow-test_client-__codelineno-0-11"></a><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_ROOT</span><span class="s2">&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-01-mcp-workflow-test_client-__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-01-mcp-workflow-test_client-__codelineno-0-13"></a><span class="c1"># Check if the virtual environment exists</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-01-mcp-workflow-test_client-__codelineno-0-14"></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;.venv&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-01-mcp-workflow-test_client-__codelineno-0-15"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Activating virtual environment...&quot;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-01-mcp-workflow-test_client-__codelineno-0-16"></a><span class="w">  </span><span class="nb">source</span><span class="w"> </span>.venv/bin/activate
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-01-mcp-workflow-test_client-__codelineno-0-17"></a><span class="k">else</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-01-mcp-workflow-test_client-__codelineno-0-18"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Creating virtual environment...&quot;</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-01-mcp-workflow-test_client-__codelineno-0-19"></a><span class="w">  </span>python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>.venv
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-01-mcp-workflow-test_client-__codelineno-0-20"></a><span class="w">  </span><span class="nb">source</span><span class="w"> </span>.venv/bin/activate
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-01-mcp-workflow-test_client-__codelineno-0-21"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installing requirements...&quot;</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-01-mcp-workflow-test_client-__codelineno-0-22"></a><span class="w">  </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-01-mcp-workflow-test_client-__codelineno-0-23"></a><span class="k">fi</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-01-mcp-workflow-test_client-__codelineno-0-24"></a>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-01-mcp-workflow-test_client-__codelineno-0-25"></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SERVER_SCRIPT</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-01-mcp-workflow-test_client-__codelineno-0-26"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Error: Server file </span><span class="nv">$SERVER_SCRIPT</span><span class="s2"> not found&quot;</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-01-mcp-workflow-test_client-__codelineno-0-27"></a><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-01-mcp-workflow-test_client-__codelineno-0-28"></a><span class="k">fi</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-01-mcp-workflow-test_client-__codelineno-0-29"></a>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-01-mcp-workflow-test_client-__codelineno-0-30"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Extracting server code from Markdown...&quot;</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-01-mcp-workflow-test_client-__codelineno-0-31"></a>python3<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;import sys; c=sys.stdin.read(); s=c.find(&quot;```python&quot;); e=c.rfind(&quot;```&quot;); print(c[s+9:e] if s!=-1 and e!=-1 else c)&#39;</span><span class="w"> </span>&lt;<span class="s2">&quot;</span><span class="nv">$SERVER_SCRIPT</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="s2">&quot;</span><span class="nv">$TEMP_PY</span><span class="s2">&quot;</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-01-mcp-workflow-test_client-__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-01-mcp-workflow-test_client-__codelineno-0-33"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting MCP Inspector with server...&quot;</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-01-mcp-workflow-test_client-__codelineno-0-34"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;URL should open in your browser shortly...&quot;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-01-mcp-workflow-test_client-__codelineno-0-35"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Press Ctrl+C to stop.&quot;</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-01-mcp-workflow-test_client-__codelineno-0-36"></a>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-01-mcp-workflow-test_client-__codelineno-0-37"></a><span class="c1"># Use the python executable from the virtual environment</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-01-mcp-workflow-test_client-__codelineno-0-38"></a><span class="nv">PYTHON_EXEC</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PROJECT_ROOT</span><span class="s2">/.venv/bin/python3&quot;</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-01-mcp-workflow-test_client-__codelineno-0-39"></a>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-01-mcp-workflow-test_client-__codelineno-0-40"></a><span class="c1"># Run the MCP Inspector with the temp file</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-01-mcp-workflow-test_client-__codelineno-0-41"></a><span class="c1"># Clean up temp file on exit</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-01-mcp-workflow-test_client-__codelineno-0-42"></a><span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;rm -f &quot;$TEMP_PY&quot;&#39;</span><span class="w"> </span>EXIT
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-01-mcp-workflow-test_client-__codelineno-0-43"></a>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-01-mcp-workflow-test_client-__codelineno-0-44"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PYTHON_EXEC</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TEMP_PY</span><span class="s2">&quot;</span>
</span></code></pre></div></section></section></div><style>.print-site-enumerate-headings #welcome > h1:before { content: '1 ' }

                .print-site-enumerate-headings #welcome h2:before { content: '1.' counter(counter-welcome-2) ' ' }
                .print-site-enumerate-headings #welcome h2 {  counter-reset: counter-welcome-3 ;  counter-increment: counter-welcome-2 }
            
                .print-site-enumerate-headings #welcome h3:before { content: '1.' counter(counter-welcome-2) '.' counter(counter-welcome-3) ' ' }
                .print-site-enumerate-headings #welcome h3 {  counter-increment: counter-welcome-3 }
            
.print-site-enumerate-headings #01-mcp-workflow > h1:before { content: '2 ' }

                .print-site-enumerate-headings #01-mcp-workflow h2:before { content: '2.' counter(counter-01-mcp-workflow-2) ' ' }
                .print-site-enumerate-headings #01-mcp-workflow h2 {  counter-reset: counter-01-mcp-workflow-3 ;  counter-increment: counter-01-mcp-workflow-2 }
            
                .print-site-enumerate-headings #01-mcp-workflow h3:before { content: '2.' counter(counter-01-mcp-workflow-2) '.' counter(counter-01-mcp-workflow-3) ' ' }
                .print-site-enumerate-headings #01-mcp-workflow h3 {  counter-increment: counter-01-mcp-workflow-3 }
            
.print-site-enumerate-headings #02-mcp-ollama > h1:before { content: '3 ' }

                .print-site-enumerate-headings #02-mcp-ollama h2:before { content: '3.' counter(counter-02-mcp-ollama-2) ' ' }
                .print-site-enumerate-headings #02-mcp-ollama h2 {  counter-reset: counter-02-mcp-ollama-3 ;  counter-increment: counter-02-mcp-ollama-2 }
            
                .print-site-enumerate-headings #02-mcp-ollama h3:before { content: '3.' counter(counter-02-mcp-ollama-2) '.' counter(counter-02-mcp-ollama-3) ' ' }
                .print-site-enumerate-headings #02-mcp-ollama h3 {  counter-increment: counter-02-mcp-ollama-3 }
            
.print-site-enumerate-headings #section-4 > h1:before { content: '4 ' }
.print-site-enumerate-headings #resources-resources > h1:before { content: '4.1 ' }

                .print-site-enumerate-headings #resources-resources h2:before { content: '4.1.' counter(counter-resources-resources-2) ' ' }
                .print-site-enumerate-headings #resources-resources h2 {  counter-increment: counter-resources-resources-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step01-imports > h1:before { content: '4.2 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step01-imports h2:before { content: '4.2.' counter(counter-resources-01-mcp-workflow-step01-imports-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step01-imports h2 {  counter-increment: counter-resources-01-mcp-workflow-step01-imports-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step02-ctor > h1:before { content: '4.3 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step02-ctor h2:before { content: '4.3.' counter(counter-resources-01-mcp-workflow-step02-ctor-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step02-ctor h2 {  counter-increment: counter-resources-01-mcp-workflow-step02-ctor-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step03-init > h1:before { content: '4.4 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step03-init h2:before { content: '4.4.' counter(counter-resources-01-mcp-workflow-step03-init-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step03-init h2 {  counter-increment: counter-resources-01-mcp-workflow-step03-init-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step04-tools > h1:before { content: '4.5 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step04-tools h2:before { content: '4.5.' counter(counter-resources-01-mcp-workflow-step04-tools-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step04-tools h2 {  counter-increment: counter-resources-01-mcp-workflow-step04-tools-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step05-tool-handlers > h1:before { content: '4.6 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step05-tool-handlers h2:before { content: '4.6.' counter(counter-resources-01-mcp-workflow-step05-tool-handlers-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step05-tool-handlers h2 {  counter-increment: counter-resources-01-mcp-workflow-step05-tool-handlers-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step06-resources > h1:before { content: '4.7 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step06-resources h2:before { content: '4.7.' counter(counter-resources-01-mcp-workflow-step06-resources-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step06-resources h2 {  counter-increment: counter-resources-01-mcp-workflow-step06-resources-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step07-resource-handlers > h1:before { content: '4.8 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step07-resource-handlers h2:before { content: '4.8.' counter(counter-resources-01-mcp-workflow-step07-resource-handlers-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step07-resource-handlers h2 {  counter-increment: counter-resources-01-mcp-workflow-step07-resource-handlers-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step08-prompts > h1:before { content: '4.9 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step08-prompts h2:before { content: '4.9.' counter(counter-resources-01-mcp-workflow-step08-prompts-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step08-prompts h2 {  counter-increment: counter-resources-01-mcp-workflow-step08-prompts-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step09-prompt-handlers > h1:before { content: '4.10 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step09-prompt-handlers h2:before { content: '4.10.' counter(counter-resources-01-mcp-workflow-step09-prompt-handlers-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step09-prompt-handlers h2 {  counter-increment: counter-resources-01-mcp-workflow-step09-prompt-handlers-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step10-lifecycle > h1:before { content: '4.11 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step10-lifecycle h2:before { content: '4.11.' counter(counter-resources-01-mcp-workflow-step10-lifecycle-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step10-lifecycle h2 {  counter-increment: counter-resources-01-mcp-workflow-step10-lifecycle-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-step11-main > h1:before { content: '4.12 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-step11-main h2:before { content: '4.12.' counter(counter-resources-01-mcp-workflow-step11-main-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-step11-main h2 {  counter-increment: counter-resources-01-mcp-workflow-step11-main-2 }
            
.print-site-enumerate-headings #resources-01-mcp-workflow-test_client > h1:before { content: '4.13 ' }

                .print-site-enumerate-headings #resources-01-mcp-workflow-test_client h2:before { content: '4.13.' counter(counter-resources-01-mcp-workflow-test_client-2) ' ' }
                .print-site-enumerate-headings #resources-01-mcp-workflow-test_client h2 {  counter-increment: counter-resources-01-mcp-workflow-test_client-2 }
            </style>
<!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Render date of last update -->


<!-- Render date of creation -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render authors -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render committers from GitHub -->


<!-- Render committers from GitLab -->


<!-- Render committers -->


<!-- ---------------------------------------------------------------------- -->

<!-- Determine date of last update -->


<!-- Source file information -->





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Footer -->
<footer class="md-footer">
  <div class="logo1"></div>
  <div class="logo2"></div>

  <!-- Link to previous and/or next page -->
  
    
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ©2021-2025 Nir Geier<br/><a href="https://visitor-badge.laobi.icu/badge?page_id=nirgeier" target="_blank" rel="noopener"><img src="https://visitor-badge.laobi.icu/badge?page_id=nirgeier" alt="Visitor Badge"></a>
    </div>
  
  
</div>

      <!-- Social links -->
      
        
<div class="md-social">
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP" target="_blank" rel="noopener" title="View on GitHub"
        class="md-social__link social-class__github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP/network/members" target="_blank" rel="noopener" title="Fork this repo"
        class="md-social__link social-class__fork">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0M5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0m6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5m-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0"/></svg>
    </a>
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP/stargazers" target="_blank" rel="noopener" title="Star this repo"
        class="md-social__link social-class__star">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25m0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://www.linkedin.com/in/nirgeier/" target="_blank" rel="noopener" title="Connect on LinkedIn"
        class="md-social__link social-class__linkedin">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://discord.gg/U6xW23Ss" target="_blank" rel="noopener" title="Follow me on Discord"
        class="md-social__link social-class__discord">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
    
    
    
    
    
    <a href="https://stackoverflow.com/users/1755598/codewizard" target="_blank" rel="noopener" title="Follow me on Stack Overflow"
        class="md-social__link social-class__stackoverflow">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M291 311 95.3 269.7 87.1 309l195.7 41zm51-87L188.5 95.7 163 126.5l153.5 128.3zm-31.2 39.7L129.5 179l-16.7 36.5L294 300zM262.3 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H43V320H3v160h359.5V320h-40z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://wa.me/972548122310" target="_blank" rel="noopener" title="Follow me on WhatsApp"
        class="md-social__link social-class__whatsapp">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157m-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1s56.2 81.2 56.1 130.5c0 101.8-84.9 184.6-186.6 184.6m101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7s-12.5-30.1-17.1-41.2c-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3s19.9 53.7 22.6 57.4c2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4s4.6-24.1 3.2-26.4c-1.3-2.5-5-3.9-10.5-6.6"/></svg>
    </a>
    
    
    
    
    
    <a href="mailto:nirg@codewizard.co.il" target="_blank" rel="noopener" title="Email me"
        class="md-social__link social-class__email">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg>
    </a>
    
</div>
      
    </div>
  </div>
</footer>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "/AI-K8S-MCP/", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "content.footer.last-updated", "content.footer.contributors", {"navigation.expand": false}, "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", {"navigation.top": true}, "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate", "toc.sticky", "mermaid"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="https://buttons.github.io/buttons.js?v=1766553928"></script>
      
    
  </body>
</html>