
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Hands-on labs for the K-Agent framework - Kubernetes-native MCP server">
      
      
        <meta name="author" content="CodeWizard-IL">
      
      
        <link rel="canonical" href="https://nirgeier.github.io/AI-K8S-MCP/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Print Site - K-Agent Labs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%202a7%207%200%200%200-7%207c0%202.38%201.19%204.47%203%205.74V17a1%201%200%200%200%201%201h6a1%201%200%200%200%201-1v-2.26c1.81-1.27%203-3.36%203-5.74a7%207%200%200%200-7-7M9%2021a1%201%200%200%200%201%201h4a1%201%200%200%200%201-1v-1H9z%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Mulish";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/codewizard.css?v=1766553928">
    
    <script>__md_scope=new URL("/AI-K8S-MCP/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#welcome" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->





<!-- Header -->
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">

    <!-- Link to home -->
    <a href=".." title="K-Agent Labs"
      class="md-header__button md-logo" aria-label="K-Agent Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            K-Agent Labs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
            Print Site
            
          </span>
        </div>
      </div>
    </div>

    <div class="m-social__top">
      <!-- Social links -->
      
      
<div class="md-social">
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP" target="_blank" rel="noopener" title="View on GitHub"
        class="md-social__link social-class__github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP/network/members" target="_blank" rel="noopener" title="Fork this repo"
        class="md-social__link social-class__fork">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0M5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0m6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5m-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0"/></svg>
    </a>
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP/stargazers" target="_blank" rel="noopener" title="Star this repo"
        class="md-social__link social-class__star">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25m0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://www.linkedin.com/in/nirgeier/" target="_blank" rel="noopener" title="Connect on LinkedIn"
        class="md-social__link social-class__linkedin">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://discord.gg/U6xW23Ss" target="_blank" rel="noopener" title="Follow me on Discord"
        class="md-social__link social-class__discord">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
    
    
    
    
    
    <a href="https://stackoverflow.com/users/1755598/codewizard" target="_blank" rel="noopener" title="Follow me on Stack Overflow"
        class="md-social__link social-class__stackoverflow">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M291 311 95.3 269.7 87.1 309l195.7 41zm51-87L188.5 95.7 163 126.5l153.5 128.3zm-31.2 39.7L129.5 179l-16.7 36.5L294 300zM262.3 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H43V320H3v160h359.5V320h-40z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://wa.me/972548122310" target="_blank" rel="noopener" title="Follow me on WhatsApp"
        class="md-social__link social-class__whatsapp">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157m-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1s56.2 81.2 56.1 130.5c0 101.8-84.9 184.6-186.6 184.6m101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7s-12.5-30.1-17.1-41.2c-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3s19.9 53.7 22.6 57.4c2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4s4.6-24.1 3.2-26.4c-1.3-2.5-5-3.9-10.5-6.6"/></svg>
    </a>
    
    
    
    
    
    <a href="mailto:nirg@codewizard.co.il" target="_blank" rel="noopener" title="Email me"
        class="md-social__link social-class__email">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg>
    </a>
    
</div>
      
    </div>

    <!-- Color palette toggle -->
    
    
    <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
    
    

    <!-- User preference: color palette -->
    
    <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
    

    <!-- Check if search is actually enabled - see https://t.ly/DT_0V -->
    
    <label class="md-header__button md-icon" for="__search">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
    </label>

    <!-- Search interface -->
    <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    

    <!-- Repository information -->
    
    <div class="md-header__source">
      <a href="https://github.com/nirgeier/AI-K8S-MCP.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    nirgeier/AI-K8S-MCP
  </div>
</a>
    </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
  
  
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../welcome/" class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../labs/" class="md-tabs__link">
          
  
  
    
  
  Labs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  
    
  
  Resources

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
  
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="K-Agent Labs" class="md-nav__button md-logo" aria-label="K-Agent Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    K-Agent Labs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nirgeier/AI-K8S-MCP.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    nirgeier/AI-K8S-MCP
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../welcome/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../labs/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href=".." class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="welcome" heading-number="1"><h1 id="welcome-welcome-to-the-mcp-labs">Welcome to the MCP Labs<a class="headerlink" href="#welcome-welcome-to-the-mcp-labs" title="Permanent link">&para;</a></h1>
<p><strong>Here you&rsquo;ll Learn and Build Model Context Protocol (MCP) from Scratch</strong></p>
<p><img src="../assets/images/mcp-feature-image.jpg" alt="MCP Feature" class="center" style="max-width:800; border-radius:20px;"/></p>
<hr />
<h2 id="welcome-introduction">Introduction<a class="headerlink" href="#welcome-introduction" title="Permanent link">&para;</a></h2>
<ul>
<li>Welcome to the MCP Labs - a comprehensive, hands-on guide to mastering the Model Context Protocol! </li>
<li>Whether you&rsquo;re new to MCP or looking to deepen your understanding, this learning series will take you from fundamentals to building production-ready MCP servers.</li>
</ul>
<hr />
<h2 id="welcome-what-is-mcp">What is MCP?<a class="headerlink" href="#welcome-what-is-mcp" title="Permanent link">&para;</a></h2>
<ul>
<li>The <strong>Model Context Protocol (MCP)</strong> is an open protocol that standardizes how applications provide context to Large Language Models (LLMs). </li>
<li>Think of it as a universal adapter that allows AI applications to connect to various data sources, tools, and services in a consistent and scalable way.</li>
</ul>
<hr />
<h2 id="welcome-what-youll-learn">What You&rsquo;ll Learn<a class="headerlink" href="#welcome-what-youll-learn" title="Permanent link">&para;</a></h2>
<p>Through hands-on labs, you&rsquo;ll:</p>
<ul>
<li><strong>Understand MCP Architecture</strong> - Master the client-server model and protocol fundamentals</li>
<li><strong>Build MCP Servers</strong> - Create servers from scratch using TypeScript and the official SDK</li>
<li><strong>Implement Tools</strong> - Develop functions that LLMs can call to perform actions</li>
<li><strong>Expose Resources</strong> - Provide contextual data that LLMs can read and reference</li>
<li><strong>Create Prompts</strong> - Build reusable templates for common tasks</li>
<li><strong>Deploy to Production</strong> - Apply best practices for real-world applications</li>
</ul>
<hr />
<h2 id="welcome-learning-path">Learning Path<a class="headerlink" href="#welcome-learning-path" title="Permanent link">&para;</a></h2>
<hr />
<h2 id="welcome-who-is-this-for">Who Is This For?<a class="headerlink" href="#welcome-who-is-this-for" title="Permanent link">&para;</a></h2>
<p>This learning series is designed for:</p>
<ul>
<li><strong>Developers</strong> building AI-powered applications</li>
<li><strong>Engineers</strong> integrating LLMs with existing systems</li>
<li><strong>Technical Architects</strong> designing AI infrastructure</li>
<li><strong>DevOps Professionals</strong> deploying and maintaining MCP servers</li>
<li><strong>AI Enthusiasts</strong> wanting to understand standardized AI application development</li>
<li><strong>Anyone</strong> curious about standardized AI application development</li>
</ul>
<hr />
<h2 id="welcome-prerequisites">Prerequisites<a class="headerlink" href="#welcome-prerequisites" title="Permanent link">&para;</a></h2>
<p>To get the most out of these labs, you should have:</p>
<ul>
<li><strong>Basic Programming Knowledge</strong> - Familiarity with JavaScript/TypeScript</li>
<li><strong>Node.js Experience</strong> - Understanding of npm and basic Node.js concepts</li>
<li><strong>Command Line Skills</strong> - Comfortable with terminal/shell commands</li>
<li><strong>Code Editor</strong> - VS Code or similar IDEs (VS Code recommended)</li>
</ul>
<hr />
<h3 id="welcome-required-software">Required Software<a class="headerlink" href="#welcome-required-software" title="Permanent link">&para;</a></h3>
<p>Before starting, ensure you have installed:</p>
<ul>
<li><strong>Node.js</strong> v18 or later (<a href="https://nodejs.org/">download</a>)</li>
<li><strong>npm</strong> or <strong>yarn</strong> package manager</li>
<li><strong>Git</strong> for version control</li>
<li>A code editor (VS Code with TypeScript is support recommended)</li>
</ul>
<hr />
<h2 id="welcome-tools-youll-use">Tools You&rsquo;ll Use<a class="headerlink" href="#welcome-tools-youll-use" title="Permanent link">&para;</a></h2>
<p>Throughout the labs, you&rsquo;ll work with:</p>
<ul>
<li><strong><a href="https://github.com/modelcontextprotocol/typescript-sdk">@modelcontextprotocol/sdk</a></strong> - Official TypeScript SDK</li>
<li><strong><a href="https://github.com/modelcontextprotocol/inspector">MCP Inspector</a></strong> - Essential testing tool</li>
<li><strong>TypeScript</strong> - Type-safe server development</li>
<li><strong>JSON-RPC 2.0</strong> - Communication protocol</li>
</ul>
<hr />
<h2 id="welcome-learning-approach">Learning Approach<a class="headerlink" href="#welcome-learning-approach" title="Permanent link">&para;</a></h2>
<p>Each lab includes:</p>
<ul>
<li><strong>Clear Objectives</strong> - Know what you&rsquo;ll learn before you start</li>
<li><strong>Detailed Explanations</strong> - Understand the &ldquo;why&rdquo; behind the code</li>
<li><strong>Complete Code Examples</strong> - Working, tested code you can run</li>
<li><strong>Hands-on Exercises</strong> - Practice what you&rsquo;ve learned</li>
<li><strong>Key Takeaways</strong> - Reinforce important concepts</li>
<li><strong>Additional Resources</strong> - Dive deeper on specific topics</li>
</ul>
<p>In addition, you&rsquo;ll find a complete <a href="#lab01-mcp-fundamentals-lab1-tasks">Tasks</a> section dedicated just to exercises and challenges to solidify your understanding.</p>
<hr />
<h2 id="welcome-getting-started">Getting Started<a class="headerlink" href="#welcome-getting-started" title="Permanent link">&para;</a></h2>
<p>Ready to begin your MCP journey? </p>
<p>Here&rsquo;s how to start:</p>
<ol>
<li><strong><a href="#.">Browse the Labs</a></strong> - See an overview of all available labs</li>
<li><strong><a href="#welcome-lab01-mcp-fundamentals-index.md">Start with Lab 1</a></strong> - Begin with the fundamentals</li>
<li><strong>Complete the various labs in Order</strong> - Each lab builds on previous knowledge</li>
<li><strong>Practice &amp; Experiment</strong> - Try variations and explore beyond examples in the <strong><a href="#lab01-mcp-fundamentals-lab1-tasks">Tasks</a></strong> section</li>
</ol>
<hr />
<h2 id="welcome-community-support">Community &amp; Support<a class="headerlink" href="#welcome-community-support" title="Permanent link">&para;</a></h2>
<p>Join the growing MCP community:</p>
<ul>
<li><strong><a href="https://discord.gg/modelcontextprotocol">MCP Discord</a></strong> - Ask questions, share projects</li>
<li><strong><a href="https://github.com/modelcontextprotocol">GitHub Organization</a></strong> - Contribute to the ecosystem</li>
<li><strong><a href="https://modelcontextprotocol.io">Official Documentation</a></strong> - Comprehensive reference</li>
<li><strong><a href="https://spec.modelcontextprotocol.io">MCP Specification</a></strong> - Protocol details</li>
</ul>
<hr />
<h2 id="welcome-why-learn-mcp">Why Learn MCP?<a class="headerlink" href="#welcome-why-learn-mcp" title="Permanent link">&para;</a></h2>
<p>MCP is revolutionizing how we build AI applications:</p>
<ul>
<li><strong>Universal Connectivity</strong> - One integration works across all MCP-compatible apps</li>
<li><strong>Reusability</strong> - Build once, use everywhere</li>
<li><strong>Scalability</strong> - Add new capabilities without rebuilding integrations</li>
<li><strong>Standardization</strong> - Consistent patterns and best practices</li>
<li><strong>Growing Ecosystem</strong> - Join a vibrant, expanding community</li>
</ul>
<hr />
<h2 id="welcome-after-this-course">After This Course<a class="headerlink" href="#welcome-after-this-course" title="Permanent link">&para;</a></h2>
<p>Upon completion, you&rsquo;ll be able to:</p>
<ul>
<li>Build custom MCP servers for your specific needs</li>
<li>Integrate LLMs with your company&rsquo;s tools and data sources</li>
<li>Contribute to the MCP open source ecosystem</li>
<li>Create servers that others can use</li>
<li>Help others learn and adopt MCP</li>
</ul>
<hr />
<h1 id="welcome-explanations">Explanations<a class="headerlink" href="#welcome-explanations" title="Permanent link">&para;</a></h1>
<p>This document provides detailed explanations of key concepts in the MCP (Model Context Protocol) server implementation, including endpoints, function calls, and RAGs (Retrieval-Augmented Generation).</p>
<hr />
<h2 id="welcome-endpoints">Endpoints<a class="headerlink" href="#welcome-endpoints" title="Permanent link">&para;</a></h2>
<h3 id="welcome-general-meaning-of-endpoints-in-this-mcp-server">General Meaning of Endpoints in This MCP Server<a class="headerlink" href="#welcome-general-meaning-of-endpoints-in-this-mcp-server" title="Permanent link">&para;</a></h3>
<p>In the context of this MCP (Model Context Protocol) server, the &ldquo;endpoints&rdquo; refer to the API routes (URLs) that the server exposes for clients (like MCP inspectors, AI assistants, or other tools) to interact with it. </p>
<p>These endpoints are part of the server&rsquo;s manifest, which is a metadata document that describes the server&rsquo;s capabilities, transport method (e.g., &ldquo;streamable-http&rdquo;), and available routes. </p>
<p>The manifest is served at <code>/.well-known/mcp</code> and helps clients discover and connect to the server.</p>
<p>The endpoints follow RESTful conventions and support HTTP methods like GET, POST, and OPTIONS (for CORS preflight). They enable core MCP functionalities such as tool execution, resource access, prompt management, and server health checks. The server uses FastMCP (a framework for building MCP servers) and runs on port 8889 by default. </p>
<p>Each endpoint is implemented as a custom route in the code, often with CORS headers for browser-based clients.</p>
<p>Below, you&rsquo;ll find explanations for each endpoint from the manifest, including its purpose, typical HTTP methods, and what it does based on the code implementation. </p>
<p>They are grouped logically for clarity.</p>
<hr />
<h3 id="welcome-core-server-and-discovery-endpoints">Core Server and Discovery Endpoints<a class="headerlink" href="#welcome-core-server-and-discovery-endpoints" title="Permanent link">&para;</a></h3>
<p>These handle basic server operations, discovery, and connection setup.</p>
<ul>
<li>
<p><strong>manifest</strong> (<code>/.well-known/mcp</code>):<br />
  Serves the MCP manifest (metadata about the server, including capabilities and all endpoints). Clients use this to understand what the server supports. Handled by <code>mcp_manifest()</code> – returns JSON with server info, base URL, and endpoint list.</p>
</li>
<li>
<p><strong>health</strong> (<code>/health</code>):<br />
  Simple health check to confirm the server is running. Returns a plain text response like &ldquo;MCP Server Running&rdquo;. Handled by <code>health_check()</code>.</p>
</li>
<li>
<p><strong>ping</strong> (<code>/ping</code>):<br />
  Connection health check with more details. Returns JSON with status (&ldquo;ok&rdquo;), timestamp, and server name. Handled by <code>ping()</code>.</p>
</li>
<li>
<p><strong>root</strong> (<code>/</code>):<br />
  Root endpoint for basic server status. Similar to health, returns &ldquo;MCP Server Running&rdquo;. Handled by <code>root_health_check()</code>.</p>
</li>
<li>
<p><strong>negotiate</strong> (<code>/negotiate</code>):<br />
  Used for connection negotiation (e.g., transport setup and optional authentication via tokens). Clients send tokens here; the server responds with connection details. Handled by <code>negotiate()</code> – supports proxy tokens from headers or query params.</p>
</li>
<li>
<p><strong>metadata</strong> (<code>/metadata</code>):<br />
  Provides detailed server metadata, including protocol version and capabilities (e.g., support for tools, prompts). Handled by <code>metadata()</code> – returns JSON with server info and feature flags.</p>
</li>
<li>
<p><strong>events</strong> (<code>/mcp</code>):<br />
  The main MCP event stream endpoint for streamable HTTP transport. This is where real-time communication happens (e.g., tool calls, responses). It&rsquo;s the core mount path for the FastMCP server. Handled by the FastMCP framework&rsquo;s run method.</p>
</li>
</ul>
<hr />
<h3 id="welcome-tool-related-endpoints">Tool-Related Endpoints<a class="headerlink" href="#welcome-tool-related-endpoints" title="Permanent link">&para;</a></h3>
<p>These manage MCP tools (functions the server exposes, like &ldquo;hello&rdquo; or &ldquo;add&rdquo;).</p>
<ul>
<li>
<p><strong>tools</strong> (<code>/tools</code>):<br />
  Lists all available tools with metadata (names, descriptions, arguments). Clients use this to discover tools. Handled by <code>tools_list()</code> – returns JSON with tool details from the server&rsquo;s <code>list_tools()</code> method.</p>
</li>
<li>
<p><strong>tools_execute</strong> (<code>/tools/execute</code>):<br />
  Executes a single tool synchronously. Clients send the tool name and arguments; the server runs it and returns the result. Handled by <code>tool_execute()</code> – validates args, executes via <code>execute_tool()</code>, and tracks executions.</p>
</li>
<li>
<p><strong>tools_batch</strong> (<code>/tools/batch</code>):<br />
  Executes multiple tools in a batch (array of calls). Useful for efficiency. Handled by <code>tool_batch_execute()</code> – processes each call and returns results.</p>
</li>
<li>
<p><strong>tools_stream</strong> (<code>/tools/stream</code>):<br />
  Executes a tool with streaming responses (e.g., for long-running tasks). Returns NDJSON (newline-delimited JSON) events like &ldquo;start&rdquo;, &ldquo;result&rdquo;, and &ldquo;end&rdquo;. Handled by <code>tool_stream_execute()</code>.</p>
</li>
<li>
<p><strong>tools_history</strong> (<code>/tools/history</code>):<br />
  Retrieves execution history for tools (recent runs, with optional limit). Handled by <code>tool_history()</code> – returns JSON with past executions from <code>TOOL_EXECUTIONS</code>.</p>
</li>
</ul>
<hr />
<h3 id="welcome-prompt-and-resource-endpoints">Prompt and Resource Endpoints<a class="headerlink" href="#welcome-prompt-and-resource-endpoints" title="Permanent link">&para;</a></h3>
<p>These handle reusable prompts and static resources.</p>
<ul>
<li>
<p><strong>prompts</strong> (<code>/prompts</code>):<br />
  Lists available prompt templates (e.g., &ldquo;code_review_prompt&rdquo;). Clients can use these for structured interactions. Handled by <code>prompts_list()</code> – returns JSON with prompt metadata.</p>
</li>
<li>
<p><strong>resources</strong> (<code>/resources</code>):<br />
  Lists available resources (e.g., server source code or info). Handled by <code>resources_list()</code> – returns JSON with resource URIs and descriptions.</p>
</li>
</ul>
<hr />
<h3 id="welcome-sampling-and-roots-endpoints">Sampling and Roots Endpoints<a class="headerlink" href="#welcome-sampling-and-roots-endpoints" title="Permanent link">&para;</a></h3>
<p>These support advanced MCP features like LLM sampling and file system access.</p>
<ul>
<li>
<p><strong>sampling</strong> (<code>/sampling</code>):<br />
  Provides LLM sampling (text generation) using Ollama. Clients send a prompt; the server generates a response. Handled by <code>sampling()</code> – integrates with Ollama API for completions.</p>
</li>
<li>
<p><strong>roots</strong> (<code>/roots</code>):<br />
  Lists file system roots (e.g., the current working directory). Used for file-based operations. Handled by <code>roots_list()</code> – returns JSON with root URIs.</p>
</li>
</ul>
<hr />
<h3 id="welcome-customollama-specific-endpoint">Custom/Ollama-Specific Endpoint<a class="headerlink" href="#welcome-customollama-specific-endpoint" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ollama_status</strong> (<code>/ollama/status</code>):<br />
  Checks the status of the connected Ollama instance (local LLM server). Returns model info, connection status, and available models. Handled by <code>ollama_status()</code> – queries Ollama&rsquo;s <code>/api/tags</code> endpoint.</li>
</ul>
<p>All endpoints include CORS headers for cross-origin requests and handle OPTIONS preflights. The server tracks tool executions globally for history/debugging.</p>
<hr />
<h2 id="welcome-function-calls">Function Calls<a class="headerlink" href="#welcome-function-calls" title="Permanent link">&para;</a></h2>
<h3 id="welcome-what-are-function-calls">What Are Function Calls?<a class="headerlink" href="#welcome-what-are-function-calls" title="Permanent link">&para;</a></h3>
<p>In the context of MCP (Model Context Protocol) and AI systems, function calls (often referred to as &ldquo;tools&rdquo; in MCP terminology) are mechanisms that allow AI models or clients to invoke external functions or services dynamically. </p>
<p>Instead of generating plain text responses, the AI can decide to call a predefined function with specific arguments, execute it on the server, and incorporate the results into its response. </p>
<p>This enables more interactive, tool-augmented AI behaviors, such as performing calculations, querying databases, or interacting with APIs.</p>
<p>In this MCP server, tools are essentially function calls exposed via the <code>/tools</code> endpoints. For example, the <code>hello</code> tool is a function that takes a <code>name</code> argument and returns a greeting string.</p>
<hr />
<h3 id="welcome-what-do-they-do">What Do They Do?<a class="headerlink" href="#welcome-what-do-they-do" title="Permanent link">&para;</a></h3>
<p>Function calls allow the AI to extend its capabilities beyond static knowledge. </p>
<p>They enable:</p>
<ul>
<li><strong>Dynamic Execution</strong>: The AI can perform real-time actions, like adding numbers or generating text via Ollama.</li>
<li><strong>Structured Interactions</strong>: Clients (e.g., an AI assistant) can call functions to retrieve data or perform tasks, then use the output in conversations.</li>
<li><strong>Modularity</strong>: Developers can add new functions without retraining the AI model.</li>
<li><strong>Safety and Control</strong>: Arguments are validated, and executions are tracked for auditing.</li>
</ul>
<p>In MCP, tools are registered with decorators like <code>@mcp.tool()</code>, and clients discover them via the <code>/tools</code> endpoint.</p>
<hr />
<h3 id="welcome-how-to-set-them-up">How to Set Them Up<a class="headerlink" href="#welcome-how-to-set-them-up" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Define the Function</strong>: Write a Python function with type hints and a docstring. For example:
   <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#welcome-__codelineno-0-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#welcome-__codelineno-0-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_tool</span><span class="p">(</span><span class="n">arg1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arg2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#welcome-__codelineno-0-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Description of what the tool does.&quot;&quot;&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#welcome-__codelineno-0-4"></a>    <span class="c1"># Implementation here</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#welcome-__codelineno-0-5"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">arg1</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">&quot;</span>
</span></code></pre></div></p>
<ul>
<li>Use <code>@mcp.tool()</code> to register it with FastMCP.</li>
<li>Arguments should have types; defaults are optional.</li>
</ul>
</li>
<li>
<p><strong>Validation and Execution</strong>: The server automatically validates arguments against the function signature (via <code>validate_tool_arguments</code>) and executes it (via <code>execute_tool</code>). Results are tracked in <code>TOOL_EXECUTIONS</code>.</p>
</li>
<li>
<p><strong>Expose via Endpoints</strong>: Tools are listed at <code>/tools</code>, executed at <code>/tools/execute</code>, etc. No additional setup needed beyond registration.</p>
</li>
<li>
<p><strong>Testing</strong>: Use the <code>/tools/history</code> endpoint to debug executions. Ensure the function handles errors gracefully.</p>
</li>
<li>
<p><strong>Integration with AI</strong>: Clients (e.g., via MCP inspectors) can call these functions. For LLM integration, the AI might be prompted to output function call JSON, which the client then executes.</p>
</li>
</ol>
<p>Function calls are asynchronous if the function is a coroutine (<code>async def</code>).</p>
<hr />
<h2 id="welcome-rags-retrieval-augmented-generation">RAGs (Retrieval-Augmented Generation)<a class="headerlink" href="#welcome-rags-retrieval-augmented-generation" title="Permanent link">&para;</a></h2>
<h3 id="welcome-what-are-rags">What Are RAGs?<a class="headerlink" href="#welcome-what-are-rags" title="Permanent link">&para;</a></h3>
<p>RAGs stand for Retrieval-Augmented Generation, a technique in AI where an LLM (Large Language Model) retrieves relevant information from external data sources before generating a response. </p>
<p>This improves accuracy, reduces hallucinations, and allows the model to access up-to-date or domain-specific knowledge not in its training data. </p>
<p>Instead of relying solely on pre-trained knowledge, RAGs &ldquo;augment&rdquo; generation with retrieved context.</p>
<p>In this MCP server context, RAGs can be implemented using resources (static data) or sampling (dynamic retrieval via Ollama). </p>
<p>For example, retrieving code snippets or server info to inform responses.</p>
<hr />
<h3 id="welcome-how-do-they-work">How Do They Work?<a class="headerlink" href="#welcome-how-do-they-work" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Retrieval Phase</strong>: When a query is made, the system searches a knowledge base (e.g., documents, databases) for relevant chunks of data.</li>
<li><strong>Augmentation</strong>: Retrieved data is fed into the LLM&rsquo;s prompt as context.</li>
<li><strong>Generation</strong>: The LLM generates a response based on both the query and retrieved data.</li>
</ol>
<p><br></p>
<ul>
<li>
<p>Key components:</p>
<ul>
<li><strong>Data Sources</strong>: Could be files, APIs, or databases.</li>
<li><strong>Retriever</strong>: Searches and ranks relevant data (e.g., via embeddings or keywords).</li>
<li><strong>Generator</strong>: The LLM that produces the final output.</li>
</ul>
</li>
</ul>
<p>In MCP, resources at <code>/resources</code> can serve as static data sources, while sampling at <code>/sampling</code> can generate augmented responses.</p>
<hr />
<h3 id="welcome-how-to-set-them-up_1">How to Set Them Up<a class="headerlink" href="#welcome-how-to-set-them-up_1" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Define Data Sources</strong>: Use MCP resources for static data. For example:
   <div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#welcome-__codelineno-1-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;mcp://my-data&quot;</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#welcome-__codelineno-1-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#welcome-__codelineno-1-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns relevant data.&quot;&quot;&quot;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#welcome-__codelineno-1-4"></a>    <span class="k">return</span> <span class="s2">&quot;Retrieved information here.&quot;</span>
</span></code></pre></div></p>
<ul>
<li>Resources are listed at <code>/resources</code> and can be queried by URI.</li>
</ul>
</li>
<li>
<p><strong>Implement Retrieval</strong>: For dynamic retrieval, integrate with tools or sampling. For instance, use a tool to query a database or API, then pass results to Ollama via <code>/sampling</code>.</p>
</li>
<li>
<p><strong>Augment with Sampling</strong>: At <code>/sampling</code>, send a prompt that includes retrieved context:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#welcome-__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#welcome-__codelineno-2-2"></a><span class="w">  </span><span class="nt">&quot;prompt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Using this data: [retrieved info]. Answer: [query]&quot;</span><span class="p">,</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#welcome-__codelineno-2-3"></a><span class="w">  </span><span class="nt">&quot;model&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;llama3.2:latest&quot;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#welcome-__codelineno-2-4"></a><span class="p">}</span>
</span></code></pre></div></p>
<ul>
<li>Ollama generates the response with augmentation.</li>
</ul>
</li>
<li>
<p><strong>Full RAG Pipeline</strong>:</p>
<ul>
<li>Client queries the server.</li>
<li>Server retrieves data (e.g., via a tool or resource).</li>
<li>Data is injected into a prompt.</li>
<li>Sampling generates the augmented response.</li>
</ul>
</li>
<li>
<p><strong>Tools for RAG</strong>: Add tools like <code>search_documents</code> that retrieve data. Combine with prompts for structured queries.</p>
</li>
<li>
<p><strong>Best Practices</strong>: Use embeddings (e.g., via Ollama or external services) for semantic search. Cache retrieved data for efficiency. Ensure data sources are secure and up-to-date.</p>
</li>
</ol>
<p>RAGs enhance MCP servers by making them knowledge-aware, useful for applications like chatbots with custom data or code assistants.</p>
<hr />
<h2 id="welcome-additional-mcp-inspector-tabs-and-configuration">Additional MCP Inspector Tabs and Configuration<a class="headerlink" href="#welcome-additional-mcp-inspector-tabs-and-configuration" title="Permanent link">&para;</a></h2>
<p>The MCP Inspector provides various tabs that correspond to different capabilities and endpoints in your MCP server. </p>
<p>These tabs allow you to test and interact with the server&rsquo;s features. Below, you&rsquo;ll find explanations for each tab mentioned (resources, prompts, tools, ping, sampling, elicitations, roots, auth, metadata) and how to configure them in the JSON manifest within <code>mcp02.py</code>.</p>
<p>The manifest is defined in the <code>mcp_manifest()</code> function. It includes a <code>"capabilities"</code> object (boolean flags indicating support) and an <code>"endpoints"</code> object (URL paths). To enable or configure a feature, update these sections accordingly.</p>
<hr />
<h3 id="welcome-resources-tab">Resources Tab<a class="headerlink" href="#welcome-resources-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Displays static data sources (e.g., files, server info) that clients can access.</li>
<li><strong>Configuration</strong>: <ul>
<li>Set <code>"resources": true</code> in <code>"capabilities"</code>.</li>
<li>Add <code>"resources": "/resources"</code> in <code>"endpoints"</code>.</li>
<li>Implement the <code>/resources</code> endpoint to list available resources (e.g., URIs like <code>mcp://code</code>).</li>
<li>Register resources with <code>@mcp.resource("uri")</code> decorators.</li>
</ul>
</li>
<li><strong>Example</strong>: In <code>mcp02.py</code>, resources like <code>get_code()</code> and <code>get_server_info()</code> are registered and listed via <code>/resources</code>.</li>
</ul>
<hr />
<h3 id="welcome-prompts-tab">Prompts Tab<a class="headerlink" href="#welcome-prompts-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Shows reusable prompt templates for structured interactions (e.g., code review prompts).</li>
<li><strong>Configuration</strong>:<ul>
<li>Set <code>"prompts": true</code> in <code>"capabilities"</code>.</li>
<li>Add <code>"prompts": "/prompts"</code> in <code>"endpoints"</code>.</li>
<li>Implement the <code>/prompts</code> endpoint to return a list of prompt metadata.</li>
<li>Register prompts with <code>@mcp.prompt()</code> decorators.</li>
</ul>
</li>
<li><strong>Example</strong>: Prompts like <code>code_review_prompt()</code> are defined and exposed via <code>/prompts</code>.</li>
</ul>
<hr />
<h3 id="welcome-tools-tab">Tools Tab<a class="headerlink" href="#welcome-tools-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Lists executable functions (tools) that clients can invoke (e.g., <code>hello</code>, <code>add</code>).</li>
<li><strong>Configuration</strong>:<ul>
<li>Set <code>"tools": true</code> in <code>"capabilities"</code>.</li>
<li>Add <code>"tools": "/tools"</code> in <code>"endpoints"</code>.</li>
<li>Implement <code>/tools</code> to return tool metadata from <code>mcp.list_tools()</code>.</li>
<li>Register tools with <code>@mcp.tool()</code> decorators.</li>
</ul>
</li>
<li><strong>Example</strong>: Tools like <code>hello()</code> and <code>add()</code> are registered and discoverable via <code>/tools</code>.</li>
</ul>
<hr />
<h3 id="welcome-ping-tab">Ping Tab<a class="headerlink" href="#welcome-ping-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Tests server connectivity and health with a simple ping.</li>
<li><strong>Configuration</strong>:<ul>
<li>Add <code>"ping": "/ping"</code> in <code>"endpoints"</code>.</li>
<li>Implement the <code>/ping</code> endpoint to return JSON with status, timestamp, and server name.</li>
</ul>
</li>
<li><strong>Example</strong>: The <code>ping()</code> function returns <code>{"status": "ok", ...}</code>.</li>
</ul>
<hr />
<h3 id="welcome-sampling-tab">Sampling Tab<a class="headerlink" href="#welcome-sampling-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Allows LLM text generation (e.g., via Ollama) for completions.</li>
<li><strong>Configuration</strong>:<ul>
<li>Set <code>"sampling": true</code> in <code>"capabilities"</code>.</li>
<li>Add <code>"sampling": "/sampling"</code> in <code>"endpoints"</code>.</li>
<li>Implement <code>/sampling</code> to accept prompts and return generated text.</li>
</ul>
</li>
<li><strong>Example</strong>: Uses Ollama API to generate responses based on input prompts.</li>
</ul>
<hr />
<h3 id="welcome-elicitations-tab">Elicitations Tab<a class="headerlink" href="#welcome-elicitations-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Likely refers to logging or event elicitation (capturing server events/logs). In MCP, this may map to <code>"logging"</code> capability for debugging.</li>
<li><strong>Configuration</strong>:<ul>
<li>Set <code>"logging": true</code> in <code>"capabilities"</code>.</li>
<li>No specific endpoint needed, but ensure logging is enabled in the server framework.</li>
</ul>
</li>
<li><strong>Note</strong>: If this refers to &ldquo;events,&rdquo; use the <code>/mcp</code> endpoint for streamable HTTP events.</li>
</ul>
<hr />
<h3 id="welcome-roots-tab">Roots Tab<a class="headerlink" href="#welcome-roots-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Lists file system roots for file-based operations.</li>
<li><strong>Configuration</strong>:<ul>
<li>Set <code>"roots": true</code> in <code>"capabilities"</code>.</li>
<li>Add <code>"roots": "/roots"</code> in <code>"endpoints"</code>.</li>
<li>Implement <code>/roots</code> to return root URIs (e.g., current directory).</li>
</ul>
</li>
<li><strong>Example</strong>: Returns <code>[{"uri": "file://current/dir", "name": "Current Directory"}]</code>.</li>
</ul>
<hr />
<h3 id="welcome-auth-tab">Auth Tab<a class="headerlink" href="#welcome-auth-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Handles authentication (e.g., token-based access).</li>
<li><strong>Configuration</strong>:<ul>
<li>Use the <code>/negotiate</code> endpoint for auth negotiation.</li>
<li>Accept tokens via headers (e.g., <code>Authorization: Bearer &lt;token&gt;</code>).</li>
<li>In the manifest, no direct flag, but ensure <code>/negotiate</code> supports auth.</li>
</ul>
</li>
<li><strong>Example</strong>: The <code>negotiate()</code> function checks for tokens and includes them in responses.</li>
</ul>
<hr />
<h3 id="welcome-metadata-tab">Metadata Tab<a class="headerlink" href="#welcome-metadata-tab" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Provides server metadata (version, capabilities, protocol info).</li>
<li><strong>Configuration</strong>:<ul>
<li>Add <code>"metadata": "/metadata"</code> in <code>"endpoints"</code>.</li>
<li>Implement <code>/metadata</code> to return detailed server info.</li>
</ul>
</li>
<li><strong>Example</strong>: Returns JSON with <code>serverInfo</code> and <code>capabilities</code>.</li>
</ul>
<p>To update the manifest in <code>mcp02.py</code>, edit the <code>manifest</code> dictionary in <code>mcp_manifest()</code>. For instance, to add a new capability, include it in <code>"capabilities"</code> and its endpoint in <code>"endpoints"</code>. Restart the server after changes.</p>
<hr />
<h2 id="welcome-creating-a-personal-custom-rag">Creating a Personal Custom RAG<a class="headerlink" href="#welcome-creating-a-personal-custom-rag" title="Permanent link">&para;</a></h2>
<p>Retrieval-Augmented Generation (RAG) allows you to build a custom knowledge system by combining data retrieval with LLM generation. </p>
<p>Here&rsquo;s how to create one in your MCP server context:</p>
<h3 id="welcome-step-1-define-data-sources">Step 1: Define Data Sources<a class="headerlink" href="#welcome-step-1-define-data-sources" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Static Data</strong>: Use MCP resources for fixed content (e.g., documents, code).<ul>
<li>Register with <code>@mcp.resource("mcp://my-data")</code>.</li>
<li>Store data in files, databases, or variables.</li>
</ul>
</li>
<li><strong>Dynamic Data</strong>: Integrate APIs or databases for real-time retrieval.<ul>
<li>Create tools to query external sources (e.g., a tool that searches a vector database).</li>
</ul>
</li>
</ul>
<h3 id="welcome-step-2-implement-retrieval">Step 2: Implement Retrieval<a class="headerlink" href="#welcome-step-2-implement-retrieval" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Simple Retrieval</strong>: Use keyword search or basic queries.<ul>
<li>Example: A tool that reads from a JSON file or API.</li>
</ul>
</li>
<li><strong>Advanced Retrieval</strong>: Use embeddings for semantic search.<ul>
<li>Install libraries like <code>sentence-transformers</code> or <code>faiss</code>.</li>
<li>Embed your data and queries, then find similar vectors.</li>
<li>Example: Store document chunks in a vector DB, retrieve top matches for a query.</li>
</ul>
</li>
</ul>
<h3 id="welcome-step-3-augment-with-llm">Step 3: Augment with LLM<a class="headerlink" href="#welcome-step-3-augment-with-llm" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Integration</strong>: Pass retrieved data into prompts.<ul>
<li>Use the <code>/sampling</code> endpoint or a tool like <code>ollama_generate()</code>.</li>
<li>Example Prompt: <code>"Using this data: {retrieved_info}. Answer: {user_query}"</code>.</li>
</ul>
</li>
<li><strong>Pipeline</strong>:<ol>
<li>User queries the server.</li>
<li>Retrieve relevant data (via tool or resource).</li>
<li>Inject data into LLM prompt.</li>
<li>Generate response via sampling.</li>
</ol>
</li>
</ul>
<h3 id="welcome-step-4-set-up-in-mcp-server">Step 4: Set Up in MCP Server<a class="headerlink" href="#welcome-step-4-set-up-in-mcp-server" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Add Tools/Resources</strong>: Register retrieval functions as tools (e.g., <code>@mcp.tool() def search_docs(query: str)</code>).</li>
<li><strong>Configure Endpoints</strong>: Ensure <code>/resources</code>, <code>/tools</code>, and <code>/sampling</code> are enabled.</li>
<li><strong>Testing</strong>: Use the Inspector to test retrieval and generation.</li>
</ul>
<hr />
<h3 id="welcome-best-practices">Best Practices<a class="headerlink" href="#welcome-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Data Management</strong>: Keep data secure and up-to-date.</li>
<li><strong>Performance</strong>: Cache embeddings; use efficient search.</li>
<li><strong>Scalability</strong>: For large datasets, use external vector DBs like Pinecone or Weaviate.</li>
<li>
<p><strong>Example Code Snippet</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#welcome-__codelineno-3-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#welcome-__codelineno-3-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">rag_query</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#welcome-__codelineno-3-3"></a>    <span class="c1"># Retrieve data (simplified)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#welcome-__codelineno-3-4"></a>    <span class="n">retrieved</span> <span class="o">=</span> <span class="s2">&quot;Relevant info from your data source.&quot;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#welcome-__codelineno-3-5"></a>    <span class="c1"># Augment and generate</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#welcome-__codelineno-3-6"></a>    <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Data: </span><span class="si">{</span><span class="n">retrieved</span><span class="si">}</span><span class="s2">. Query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#welcome-__codelineno-3-7"></a>    <span class="k">return</span> <span class="n">ollama_generate</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<p>This creates a personal RAG tailored to your data, enhancing AI responses with custom knowledge.</p>
<hr />
<h2 id="welcome-adding-clients-internal-llm">Adding Clients (Internal LLM)<a class="headerlink" href="#welcome-adding-clients-internal-llm" title="Permanent link">&para;</a></h2>
<p>To integrate an internal Large Language Model (LLM) as a client with your MCP server, you need to set up a client that can connect to the MCP server, discover its capabilities, and invoke tools, resources, or prompts. </p>
<p>This allows the LLM to augment its responses using the server&rsquo;s functionalities, such as executing custom tools or retrieving data.</p>
<h3 id="welcome-prerequisites_1">Prerequisites<a class="headerlink" href="#welcome-prerequisites_1" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>MCP Server Running</strong>: Ensure your MCP server is running and accessible (e.g., at <code>http://localhost:8889</code>).</p>
</li>
<li>
<p><strong>Client Library</strong>: Use an MCP-compatible client library. For Python, you can use libraries like <code>mcp-client</code> or integrate with frameworks like LangChain or LlamaIndex that support MCP. For other languages, check for MCP SDKs (e.g., Node.js MCP clients).</p>
</li>
<li>
<p><strong>LLM Setup</strong>: Have an internal LLM ready, such as Ollama running locally, or another model that supports tool calling (e.g., via function calling APIs).</p>
</li>
<li>
<p><strong>Information Needed</strong>:</p>
<ul>
<li><strong>Server Base URL</strong>: The full URL where the MCP server is hosted (e.g., <code>http://localhost:8889</code>).</li>
<li><strong>Manifest URL</strong>: The URL to the manifest endpoint (e.g., <code>http://localhost:8889/.well-known/mcp</code>). This provides metadata about the server&rsquo;s capabilities and endpoints.</li>
<li><strong>Authentication Token</strong> (optional): If the server requires authentication, obtain a token (e.g., via the <code>/negotiate</code> endpoint). Pass it in headers like <code>Authorization: Bearer &lt;token&gt;</code>.</li>
<li><strong>Transport Method</strong>: Confirm the server uses &ldquo;streamable-http&rdquo; transport, as indicated in the manifest.</li>
</ul>
</li>
</ul>
<hr />
<h3 id="welcome-step-by-step-instructions">Step-by-Step Instructions<a class="headerlink" href="#welcome-step-by-step-instructions" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Install Required Libraries</strong>:</p>
<ul>
<li>For Python: Install the MCP client library if available (e.g., <code>pip install mcp-client</code> or similar). If using LangChain, install <code>langchain</code> and MCP integrations.</li>
<li>For other setups: Ensure your LLM framework supports MCP (e.g., LlamaIndex has MCP connectors).</li>
</ul>
</li>
<li>
<p><strong>Fetch the Server Manifest</strong>:</p>
<ul>
<li>Make a GET request to the manifest URL to retrieve the server&rsquo;s metadata.</li>
<li>Example (using curl): <code>curl http://localhost:8889/.well-known/mcp</code></li>
<li>Parse the JSON response to understand available endpoints (e.g., <code>/tools</code>, <code>/resources</code>, <code>/sampling</code>) and capabilities (e.g., <code>tools: true</code>).</li>
</ul>
</li>
<li>
<p><strong>Initialize the MCP Client</strong>:</p>
<ul>
<li>In your client code, create an MCP client instance and connect to the server.</li>
<li>Provide the base URL and any authentication details.</li>
<li>
<p>Example in Python (pseudo-code):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#welcome-__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">MCPClient</span>  <span class="c1"># Assuming a library exists</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#welcome-__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#welcome-__codelineno-4-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">MCPClient</span><span class="p">(</span><span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;http://localhost:8889&quot;</span><span class="p">,</span> <span class="n">auth_token</span><span class="o">=</span><span class="s2">&quot;your_token_if_needed&quot;</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#welcome-__codelineno-4-4"></a><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p><strong>Discover Capabilities</strong>:</p>
<ul>
<li>Use the client to list available tools, resources, or prompts.</li>
<li>Example: Call <code>client.list_tools()</code> to get tool metadata, which includes names, descriptions, and argument schemas.</li>
</ul>
</li>
<li>
<p><strong>Integrate with the Internal LLM</strong>:</p>
<ul>
<li>Configure the LLM to use the MCP client for tool calling.</li>
<li>For LLMs that support function calling (e.g., GPT models or local models via libraries), map MCP tools to callable functions.</li>
<li>Example workflow:<ul>
<li>When the LLM generates a response, check if it needs to call a tool (e.g., based on a prompt or decision).</li>
<li>Use the MCP client to execute the tool: <code>result = client.call_tool("tool_name", args={"arg1": "value"})</code>.</li>
<li>Feed the result back into the LLM&rsquo;s context for the final response.</li>
</ul>
</li>
<li>For Ollama or similar local LLMs, you may need a wrapper script that handles the tool calling logic.</li>
</ul>
</li>
<li>
<p><strong>Handle Sampling or Generation</strong>:</p>
<ul>
<li>If the LLM needs to generate text augmented by the server, use the <code>/sampling</code> endpoint via the client.</li>
<li>Example: <code>response = client.sample(prompt="Your prompt here", model="llama3.2:latest")</code>.</li>
</ul>
</li>
<li>
<p><strong>Test the Integration</strong>:</p>
<ul>
<li>Run a test query where the LLM invokes a tool (e.g., the &ldquo;hello&rdquo; tool).</li>
<li>Verify that the client connects, executes the tool, and the LLM incorporates the result.</li>
<li>Check logs on the server side (e.g., via <code>/tools/history</code>) for executions.</li>
</ul>
</li>
<li>
<p><strong>Handle Errors and Authentication</strong>:</p>
<ul>
<li>Implement error handling for failed connections or tool executions.</li>
<li>If authentication fails, renegotiate tokens via <code>/negotiate</code>.</li>
<li>Ensure CORS and security settings allow the client to connect.</li>
</ul>
</li>
<li>
<p><strong>Advanced Setup</strong>:</p>
<ul>
<li>For streaming: Use the <code>/tools/stream</code> endpoint for real-time tool execution.</li>
<li>For batch operations: Call multiple tools at once via <code>/tools/batch</code>.</li>
<li>Integrate with prompts: Use <code>/prompts</code> to retrieve structured prompts for the LLM.</li>
</ul>
</li>
</ol>
<p>By following these steps, your internal LLM can act as an MCP client, leveraging the server&rsquo;s tools and resources to provide more capable and context-aware responses. </p>
<p>If using a specific LLM framework, refer to its documentation for MCP integration details.</p>
<h2 id="welcome-next-steps">Next Steps<a class="headerlink" href="#welcome-next-steps" title="Permanent link">&para;</a></h2>
<p><strong><a href="#.">View All Labs →</a></strong> - See the complete learning path</p>
<p><strong><a href="#welcome-lab01-mcp-fundamentals-index.md">Start Lab 1 →</a></strong> - Begin your MCP journey!</p>
<hr />
<div style="text-align: center; padding: 2em 0;">
  <h2>Ready to Build the Future of AI Applications?</h2>
  <p style="font-size: 1.2em; margin: 1em 0;">Let's get started!</p>
</div></section>
                    <section class='print-page md-section' id='section-2' heading-number='2'>
                        <h1>Labs<a class='headerlink' href='#section-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="labs" heading-number="2.1"><h1 id="labs-mcp-labs-learning-series">MCP Labs - Learning Series<a class="headerlink" href="#labs-mcp-labs-learning-series" title="Permanent link">&para;</a></h1>
<p><img src="../assets/images/mcp-feature-image.jpg" alt="MCP Feature" class="center" style="max-width:800; border-radius:20px;"/></p>
<hr />
<ul>
<li>Welcome to the Model Context Protocol (MCP) hands-on learning series!</li>
<li>This comprehensive set of labs will take you from MCP fundamentals to building production-ready MCP servers.</li>
<li><strong>Here you&rsquo;ll learn and build the Model Context Protocol (MCP) from scratch</strong></li>
<li>Whether you&rsquo;re new to MCP or looking to deepen your understanding, this learning series will take you from fundamentals to building production-ready MCP servers.</li>
</ul>
<hr />
<h2 id="labs-what-youll-learn">What You&rsquo;ll Learn<a class="headerlink" href="#labs-what-youll-learn" title="Permanent link">&para;</a></h2>
<p>Through these 8 progressive labs, you&rsquo;ll master:</p>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MCP Architecture</td>
<td>Understanding and mastering the client-server model and core concepts</td>
</tr>
<tr>
<td>Server Development</td>
<td>Building MCP servers from scratch with TypeScript using the official SDK</td>
</tr>
<tr>
<td>Tools Implementation</td>
<td>Creating sophisticated tools that interact with external systems and developing functions that LLMs can call to perform actions</td>
</tr>
<tr>
<td>Resource Management</td>
<td>Exposing contextual data through MCP resources that LLMs can read and reference</td>
</tr>
<tr>
<td>Prompt Engineering</td>
<td>Building reusable prompt templates for common tasks</td>
</tr>
<tr>
<td>Production Deployment</td>
<td>Applying best practices for real-world applications</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="labs-labs-overview">Labs Overview<a class="headerlink" href="#labs-labs-overview" title="Permanent link">&para;</a></h2>
<h3 id="labs-lab-0-environment-setup"><a href="#lab00-setup-lab">Lab 0: Environment Setup</a><a class="headerlink" href="#labs-lab-0-environment-setup" title="Permanent link">&para;</a></h3>
<p>Get your development environment ready for MCP server development.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Install and configure required tools (Docker, kubectl, Helm, Ollama, MCP Inspector, K-Agent etc.)</li>
<li>Build and run the K-Agent labs environment (Docker container or locally)</li>
<li>Verify Kubernetes cluster connectivity</li>
<li>Prepare the MCP server setup</li>
</ul>
<hr />
<h3 id="labs-lab-1-mcp-fundamentals"><a href="#lab01-mcp-fundamentals-lab">Lab 1: MCP Fundamentals</a><a class="headerlink" href="#labs-lab-1-mcp-fundamentals" title="Permanent link">&para;</a></h3>
<p>Get started with the basics! Learn what MCP is, why it exists, and understand its architecture and core components.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>What is MCP and the problem it solves</li>
<li>Client-server architecture</li>
<li>Core capabilities: Tools, Resources, and Prompts</li>
<li>MCP communication model and lifecycle</li>
<li>Common use cases</li>
</ul>
<hr />
<h3 id="labs-lab-2-building-your-first-mcp-server"><a href="#lab02-first-mcp-server-lab">Lab 2: Building Your First MCP Server</a><a class="headerlink" href="#labs-lab-2-building-your-first-mcp-server" title="Permanent link">&para;</a></h3>
<p>Build a complete, working MCP server from the ground up.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Project setup with Node.js and TypeScript</li>
<li>Implementing the MCP protocol</li>
<li>Creating your first tool</li>
<li>Testing with MCP Inspector</li>
<li>Connecting to Claude Desktop</li>
</ul>
<hr />
<h3 id="labs-lab-3-implementing-mcp-tools"><a href="#lab03-mcp-tools-lab">Lab 3: Implementing MCP Tools</a><a class="headerlink" href="#labs-lab-3-implementing-mcp-tools" title="Permanent link">&para;</a></h3>
<p>Master the art of creating sophisticated, production-ready tools.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Advanced input validation with JSON Schema</li>
<li>Real-world tool examples (Weather API, File operations, Database queries)</li>
<li>Returning rich content types</li>
<li>Error handling patterns</li>
<li>Performance optimization and caching</li>
</ul>
<hr />
<h3 id="labs-lab-4-working-with-mcp-resources"><a href="#lab04-mcp-resources-lab">Lab 4: Working with MCP Resources</a><a class="headerlink" href="#labs-lab-4-working-with-mcp-resources" title="Permanent link">&para;</a></h3>
<p>Learn to expose contextual data that LLMs can read and reference.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Understanding tools vs. resources</li>
<li>Implementing different resource types</li>
<li>Resource URI schemes and templates</li>
<li>Resource subscriptions for live updates</li>
<li>Combining tools and resources</li>
</ul>
<hr />
<h3 id="labs-lab-5-mcp-prompts-and-complete-integration"><a href="#lab05-mcp-prompts-lab">Lab 5: MCP Prompts and Complete Integration</a><a class="headerlink" href="#labs-lab-5-mcp-prompts-and-complete-integration" title="Permanent link">&para;</a></h3>
<p>Complete your MCP education with prompts and production best practices.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Creating reusable prompt templates</li>
<li>Embedding resources in prompts</li>
<li>Building a complete server with all capabilities</li>
<li>Production deployment and configuration</li>
<li>Debugging and troubleshooting</li>
</ul>
<hr />
<h3 id="labs-lab-6-complete-mcp-server-implementation"><a href="#lab06-mcp-workflow-lab">Lab 6: Complete MCP Server Implementation</a><a class="headerlink" href="#labs-lab-6-complete-mcp-server-implementation" title="Permanent link">&para;</a></h3>
<p>Build a complete MCP server from scratch, learning each component.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Project setup with Python</li>
<li>Implementing the MCP protocol</li>
<li>Creating tools, resources, and prompts</li>
<li>Testing and debugging</li>
</ul>
<hr />
<h3 id="labs-lab-7-mcp-tools-with-ollama-integration"><a href="#lab07-mcp-ollama-lab">Lab 7: MCP Tools with Ollama Integration</a><a class="headerlink" href="#labs-lab-7-mcp-tools-with-ollama-integration" title="Permanent link">&para;</a></h3>
<p>Master creating sophisticated MCP tools with Ollama integration.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Design robust tool schemas with advanced validation</li>
<li>Implement tools that interact with external systems</li>
<li>Return multiple content types</li>
<li>Handle errors gracefully</li>
<li>Apply best practices for tool composition</li>
</ul>
<hr />
<h3 id="labs-lab-8-k-agent-integration"><a href="#lab08-kagent-lab">Lab 8: K-Agent Integration</a><a class="headerlink" href="#labs-lab-8-k-agent-integration" title="Permanent link">&para;</a></h3>
<p>Implement a specialized MCP server (K-Agent) that interacts with Kubernetes clusters to provide AI-driven log collection and analysis.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>MCP server architecture for Kubernetes</li>
<li>Secure communication with Kubernetes API</li>
<li>Implementing tools for pod discovery and log retrieval</li>
<li>Collecting and structuring logs for LLM consumption</li>
<li>Containerizing and deploying the K-Agent server</li>
</ul>
<hr />
<h3 id="labs-lab-9-k8s-event-log-monitor"><a href="#lab09-k8s-event-monitor-lab">Lab 9: K8s Event &amp; Log Monitor</a><a class="headerlink" href="#labs-lab-9-k8s-event-log-monitor" title="Permanent link">&para;</a></h3>
<p>Build a complete observability stack with a custom Python MCP server, Kagent, Prometheus, and Grafana.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Minimal Kagent installation</li>
<li>Building Python-based MCP servers</li>
<li>Registering custom tools with Kagent</li>
<li>Deploying Prometheus and Grafana via Helm</li>
<li>Connecting Log/Event collection to visualization dashboards</li>
</ul>
<hr />
<h2 id="labs-ready-to-begin">Ready to Begin?<a class="headerlink" href="#labs-ready-to-begin" title="Permanent link">&para;</a></h2>
<p><strong><a href="#labs-lab01-mcp-fundamentals-index.md">Start with Lab 1: MCP Fundamentals →</a></strong></p>
<p>Let&rsquo;s build something amazing with MCP!</p></section><section class="print-page" id="lab00-setup-lab" heading-number="2.2"><h1 id="lab00-setup-lab-lab-000-environment-setup">Lab 000 - Environment Setup<a class="headerlink" href="#lab00-setup-lab-lab-000-environment-setup" title="Permanent link">&para;</a></h1>
<ul>
<li>Welcome to <code>K-Agent</code> Labs! </li>
<li>In this first lab, you&rsquo;ll set up your development environment with all the tools needed for the <code>K-Agent</code> infrastructure. </li>
<li>This lab covers <code>Docker</code>, <code>Kubernetes</code>, and the <code>K-Agent</code> labs environment container.</li>
</ul>
<hr />
<h4 id="lab00-setup-lab-what-youll-learn-in-this-workshop">What you&rsquo;ll learn in this workshop:<a class="headerlink" href="#lab00-setup-lab-what-youll-learn-in-this-workshop" title="Permanent link">&para;</a></h4>
<ul>
<li>Install and configure required tools (Docker, kubectl, Helm, Ollama, MCP Inspector, K-Agent etc.)</li>
<li>Build and run the K-Agent labs environment (Docker container or locally)</li>
<li>Verify Kubernetes cluster connectivity </li>
<li>Prepare the MCP server setup</li>
</ul>
<hr />
<h2 id="lab00-setup-lab-01-prerequisites-installation">01. Prerequisites Installation<a class="headerlink" href="#lab00-setup-lab-01-prerequisites-installation" title="Permanent link">&para;</a></h2>
<h3 id="lab00-setup-lab-docker-installation">🐳 Docker Installation<a class="headerlink" href="#lab00-setup-lab-docker-installation" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="lab00-setup-lab-__tabbed_1_1" name="lab00-setup-lab-__tabbed_1" type="radio" /><input id="lab00-setup-lab-__tabbed_1_2" name="lab00-setup-lab-__tabbed_1" type="radio" /><input id="lab00-setup-lab-__tabbed_1_3" name="lab00-setup-lab-__tabbed_1" type="radio" /><input id="lab00-setup-lab-__tabbed_1_4" name="lab00-setup-lab-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_1_1"> macOS</label><label for="lab00-setup-lab-__tabbed_1_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_1_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_1_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab00-setup-lab-__codelineno-0-1"></a><span class="c1"># Install Docker Desktop</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab00-setup-lab-__codelineno-0-2"></a>brew<span class="w"> </span>install<span class="w"> </span>--cask<span class="w"> </span>docker
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab00-setup-lab-__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab00-setup-lab-__codelineno-0-4"></a><span class="c1"># Start Docker Desktop from Applications</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#lab00-setup-lab-__codelineno-0-5"></a><span class="c1"># Or use command line:</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#lab00-setup-lab-__codelineno-0-6"></a>open<span class="w"> </span>/Applications/Docker.app
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab00-setup-lab-__codelineno-1-1"></a><span class="c1"># Update package index</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#lab00-setup-lab-__codelineno-1-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#lab00-setup-lab-__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#lab00-setup-lab-__codelineno-1-4"></a><span class="c1"># Install Docker</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#lab00-setup-lab-__codelineno-1-5"></a>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://get.docker.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#lab00-setup-lab-__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#lab00-setup-lab-__codelineno-1-7"></a><span class="c1"># Add user to docker group</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#lab00-setup-lab-__codelineno-1-8"></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#lab00-setup-lab-__codelineno-1-9"></a>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#lab00-setup-lab-__codelineno-1-10"></a><span class="c1"># Restart session or run:</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#lab00-setup-lab-__codelineno-1-11"></a>newgrp<span class="w"> </span>docker
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab00-setup-lab-__codelineno-2-1"></a><span class="c1"># Set up the repository</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#lab00-setup-lab-__codelineno-2-2"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>yum-utils
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#lab00-setup-lab-__codelineno-2-3"></a>sudo<span class="w"> </span>yum-config-manager<span class="w"> </span>--add-repo<span class="w"> </span>https://download.docker.com/linux/centos/docker-ce.repo
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#lab00-setup-lab-__codelineno-2-4"></a><span class="c1"># Install Docker</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#lab00-setup-lab-__codelineno-2-5"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>docker-ce<span class="w"> </span>docker-ce-cli<span class="w"> </span>containerd.io
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#lab00-setup-lab-__codelineno-2-6"></a><span class="c1"># Start Docker</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#lab00-setup-lab-__codelineno-2-7"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>docker
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#lab00-setup-lab-__codelineno-2-8"></a><span class="c1"># Add user to docker group</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#lab00-setup-lab-__codelineno-2-9"></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#lab00-setup-lab-__codelineno-2-10"></a><span class="c1"># Restart session or run:</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#lab00-setup-lab-__codelineno-2-11"></a>newgrp<span class="w"> </span>docker
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab00-setup-lab-__codelineno-3-1"></a><span class="c1"># Docker is pre-installed in Cloud Shell</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#lab00-setup-lab-__codelineno-3-2"></a>docker<span class="w"> </span>--version
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-kubectl-installation">☸️ kubectl Installation<a class="headerlink" href="#lab00-setup-lab-kubectl-installation" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="2:4"><input checked="checked" id="lab00-setup-lab-__tabbed_2_1" name="lab00-setup-lab-__tabbed_2" type="radio" /><input id="lab00-setup-lab-__tabbed_2_2" name="lab00-setup-lab-__tabbed_2" type="radio" /><input id="lab00-setup-lab-__tabbed_2_3" name="lab00-setup-lab-__tabbed_2" type="radio" /><input id="lab00-setup-lab-__tabbed_2_4" name="lab00-setup-lab-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_2_1"> macOS</label><label for="lab00-setup-lab-__tabbed_2_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_2_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_2_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab00-setup-lab-__codelineno-4-1"></a>brew<span class="w"> </span>install<span class="w"> </span>kubectl
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab00-setup-lab-__codelineno-5-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span><span class="s2">&quot;https://dl.k8s.io/release/</span><span class="k">$(</span>curl<span class="w"> </span>-L<span class="w"> </span>-s<span class="w"> </span>https://dl.k8s.io/release/stable.txt<span class="k">)</span><span class="s2">/bin/linux/amd64/kubectl&quot;</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#lab00-setup-lab-__codelineno-5-2"></a>sudo<span class="w"> </span>install<span class="w"> </span>-o<span class="w"> </span>root<span class="w"> </span>-g<span class="w"> </span>root<span class="w"> </span>-m<span class="w"> </span><span class="m">0755</span><span class="w"> </span>kubectl<span class="w"> </span>/usr/local/bin/kubectl
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab00-setup-lab-__codelineno-6-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span><span class="s2">&quot;https://dl.k8s.io/release/</span><span class="k">$(</span>curl<span class="w"> </span>-L<span class="w"> </span>-s<span class="w"> </span>https://dl.k8s.io/release/stable.txt<span class="k">)</span><span class="s2">/bin/linux/amd64/kubectl&quot;</span><span class="w"> </span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab00-setup-lab-__codelineno-6-2"></a>sudo<span class="w"> </span>install<span class="w"> </span>-o<span class="w"> </span>root<span class="w"> </span>-g<span class="w"> </span>root<span class="w"> </span>-m<span class="w"> </span><span class="m">0755</span><span class="w"> </span>kubectl<span class="w"> </span>/usr/local/bin/kubectl
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab00-setup-lab-__codelineno-7-1"></a><span class="c1"># kubectl is pre-installed</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#lab00-setup-lab-__codelineno-7-2"></a>kubectl<span class="w"> </span>version<span class="w"> </span>--client
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-helm-installation">⚓ Helm Installation<a class="headerlink" href="#lab00-setup-lab-helm-installation" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="3:4"><input checked="checked" id="lab00-setup-lab-__tabbed_3_1" name="lab00-setup-lab-__tabbed_3" type="radio" /><input id="lab00-setup-lab-__tabbed_3_2" name="lab00-setup-lab-__tabbed_3" type="radio" /><input id="lab00-setup-lab-__tabbed_3_3" name="lab00-setup-lab-__tabbed_3" type="radio" /><input id="lab00-setup-lab-__tabbed_3_4" name="lab00-setup-lab-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_3_1"> macOS</label><label for="lab00-setup-lab-__tabbed_3_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_3_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_3_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab00-setup-lab-__codelineno-8-1"></a>brew<span class="w"> </span>install<span class="w"> </span>helm
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab00-setup-lab-__codelineno-9-1"></a>curl<span class="w"> </span>https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab00-setup-lab-__codelineno-10-1"></a>curl<span class="w"> </span>https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#lab00-setup-lab-__codelineno-11-1"></a><span class="c1"># Helm is pre-installed</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#lab00-setup-lab-__codelineno-11-2"></a>helm<span class="w"> </span>version
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-git-installation">🐙 Git Installation<a class="headerlink" href="#lab00-setup-lab-git-installation" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="4:4"><input checked="checked" id="lab00-setup-lab-__tabbed_4_1" name="lab00-setup-lab-__tabbed_4" type="radio" /><input id="lab00-setup-lab-__tabbed_4_2" name="lab00-setup-lab-__tabbed_4" type="radio" /><input id="lab00-setup-lab-__tabbed_4_3" name="lab00-setup-lab-__tabbed_4" type="radio" /><input id="lab00-setup-lab-__tabbed_4_4" name="lab00-setup-lab-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_4_1"> macOS</label><label for="lab00-setup-lab-__tabbed_4_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_4_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_4_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab00-setup-lab-__codelineno-12-1"></a>brew<span class="w"> </span>install<span class="w"> </span>git
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab00-setup-lab-__codelineno-13-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>git
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab00-setup-lab-__codelineno-14-1"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>git
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab00-setup-lab-__codelineno-15-1"></a><span class="c1"># Git is pre-installed</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab00-setup-lab-__codelineno-15-2"></a>git<span class="w"> </span>--version
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-python3-installation">🐍 Python3 Installation<a class="headerlink" href="#lab00-setup-lab-python3-installation" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="5:4"><input checked="checked" id="lab00-setup-lab-__tabbed_5_1" name="lab00-setup-lab-__tabbed_5" type="radio" /><input id="lab00-setup-lab-__tabbed_5_2" name="lab00-setup-lab-__tabbed_5" type="radio" /><input id="lab00-setup-lab-__tabbed_5_3" name="lab00-setup-lab-__tabbed_5" type="radio" /><input id="lab00-setup-lab-__tabbed_5_4" name="lab00-setup-lab-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_5_1"> macOS</label><label for="lab00-setup-lab-__tabbed_5_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_5_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_5_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#lab00-setup-lab-__codelineno-16-1"></a>brew<span class="w"> </span>install<span class="w"> </span>python
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab00-setup-lab-__codelineno-17-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3<span class="w"> </span>python3-pip
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab00-setup-lab-__codelineno-18-1"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3<span class="w"> </span>python3-pip
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#lab00-setup-lab-__codelineno-19-1"></a><span class="c1"># Python3 is pre-installed</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#lab00-setup-lab-__codelineno-19-2"></a>python3<span class="w"> </span>--version
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-nodejs-installation">📦 Node.js Installation<a class="headerlink" href="#lab00-setup-lab-nodejs-installation" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="6:4"><input checked="checked" id="lab00-setup-lab-__tabbed_6_1" name="lab00-setup-lab-__tabbed_6" type="radio" /><input id="lab00-setup-lab-__tabbed_6_2" name="lab00-setup-lab-__tabbed_6" type="radio" /><input id="lab00-setup-lab-__tabbed_6_3" name="lab00-setup-lab-__tabbed_6" type="radio" /><input id="lab00-setup-lab-__tabbed_6_4" name="lab00-setup-lab-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_6_1"> macOS</label><label for="lab00-setup-lab-__tabbed_6_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_6_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_6_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#lab00-setup-lab-__codelineno-20-1"></a>brew<span class="w"> </span>install<span class="w"> </span>node
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#lab00-setup-lab-__codelineno-21-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>nodejs<span class="w"> </span>npm
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#lab00-setup-lab-__codelineno-22-1"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>nodejs<span class="w"> </span>npm
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#lab00-setup-lab-__codelineno-23-1"></a><span class="c1"># Node.js is pre-installed</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#lab00-setup-lab-__codelineno-23-2"></a>node<span class="w"> </span>--version
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-ollama-installation">🤖 Ollama Installation<a class="headerlink" href="#lab00-setup-lab-ollama-installation" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="7:4"><input checked="checked" id="lab00-setup-lab-__tabbed_7_1" name="lab00-setup-lab-__tabbed_7" type="radio" /><input id="lab00-setup-lab-__tabbed_7_2" name="lab00-setup-lab-__tabbed_7" type="radio" /><input id="lab00-setup-lab-__tabbed_7_3" name="lab00-setup-lab-__tabbed_7" type="radio" /><input id="lab00-setup-lab-__tabbed_7_4" name="lab00-setup-lab-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_7_1"> macOS</label><label for="lab00-setup-lab-__tabbed_7_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_7_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_7_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#lab00-setup-lab-__codelineno-24-1"></a>brew<span class="w"> </span>install<span class="w"> </span>ollama
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#lab00-setup-lab-__codelineno-24-2"></a>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#lab00-setup-lab-__codelineno-24-3"></a><span class="c1"># Start Ollama service</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#lab00-setup-lab-__codelineno-24-4"></a>ollama<span class="w"> </span>serve
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#lab00-setup-lab-__codelineno-25-1"></a>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://ollama.ai/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#lab00-setup-lab-__codelineno-25-2"></a>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#lab00-setup-lab-__codelineno-25-3"></a><span class="c1"># Start Ollama service</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#lab00-setup-lab-__codelineno-25-4"></a>ollama<span class="w"> </span>serve
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#lab00-setup-lab-__codelineno-26-1"></a>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://ollama.ai/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#lab00-setup-lab-__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#lab00-setup-lab-__codelineno-26-3"></a><span class="c1"># Start Ollama service</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#lab00-setup-lab-__codelineno-26-4"></a>ollama<span class="w"> </span>serve
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#lab00-setup-lab-__codelineno-27-1"></a><span class="c1"># Ollama is not supported in Cloud Shell</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#lab00-setup-lab-__codelineno-27-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Ollama is not supported in Cloud Shell&quot;</span>
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-mcp-inspector-installation">🔍 MCP Inspector Installation<a class="headerlink" href="#lab00-setup-lab-mcp-inspector-installation" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="8:4"><input checked="checked" id="lab00-setup-lab-__tabbed_8_1" name="lab00-setup-lab-__tabbed_8" type="radio" /><input id="lab00-setup-lab-__tabbed_8_2" name="lab00-setup-lab-__tabbed_8" type="radio" /><input id="lab00-setup-lab-__tabbed_8_3" name="lab00-setup-lab-__tabbed_8" type="radio" /><input id="lab00-setup-lab-__tabbed_8_4" name="lab00-setup-lab-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_8_1"> macOS</label><label for="lab00-setup-lab-__tabbed_8_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_8_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_8_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#lab00-setup-lab-__codelineno-28-1"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@modelcontextprotocol/inspector
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#lab00-setup-lab-__codelineno-29-1"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@modelcontextprotocol/inspector
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#lab00-setup-lab-__codelineno-30-1"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@modelcontextprotocol/inspector
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#lab00-setup-lab-__codelineno-31-1"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@modelcontextprotocol/inspector
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-kubernetes-cluster-setup-minikube">Kubernetes Cluster Setup (minikube)<a class="headerlink" href="#lab00-setup-lab-kubernetes-cluster-setup-minikube" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="9:4"><input checked="checked" id="lab00-setup-lab-__tabbed_9_1" name="lab00-setup-lab-__tabbed_9" type="radio" /><input id="lab00-setup-lab-__tabbed_9_2" name="lab00-setup-lab-__tabbed_9" type="radio" /><input id="lab00-setup-lab-__tabbed_9_3" name="lab00-setup-lab-__tabbed_9" type="radio" /><input id="lab00-setup-lab-__tabbed_9_4" name="lab00-setup-lab-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_9_1"> macOS</label><label for="lab00-setup-lab-__tabbed_9_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_9_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_9_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#lab00-setup-lab-__codelineno-32-1"></a>brew<span class="w"> </span>install<span class="w"> </span>minikube
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#lab00-setup-lab-__codelineno-33-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span>https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#lab00-setup-lab-__codelineno-33-2"></a>sudo<span class="w"> </span>install<span class="w"> </span>minikube-linux-amd64<span class="w"> </span>/usr/local/bin/minikube
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#lab00-setup-lab-__codelineno-34-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span>https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#lab00-setup-lab-__codelineno-34-2"></a>sudo<span class="w"> </span>install<span class="w"> </span>minikube-linux-amd64<span class="w"> </span>/usr/local/bin/minikube
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#lab00-setup-lab-__codelineno-35-1"></a><span class="c1"># Minikube is already installed in Cloud Shell</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#lab00-setup-lab-__codelineno-35-2"></a>minikube<span class="w"> </span>version
</span></code></pre></div>
</div>
</div>
</div>
<h3 id="lab00-setup-lab-kubernetes-cluster-setup-kind">Kubernetes Cluster Setup (kind)<a class="headerlink" href="#lab00-setup-lab-kubernetes-cluster-setup-kind" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="10:4"><input checked="checked" id="lab00-setup-lab-__tabbed_10_1" name="lab00-setup-lab-__tabbed_10" type="radio" /><input id="lab00-setup-lab-__tabbed_10_2" name="lab00-setup-lab-__tabbed_10" type="radio" /><input id="lab00-setup-lab-__tabbed_10_3" name="lab00-setup-lab-__tabbed_10" type="radio" /><input id="lab00-setup-lab-__tabbed_10_4" name="lab00-setup-lab-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_10_1"> macOS</label><label for="lab00-setup-lab-__tabbed_10_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_10_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_10_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#lab00-setup-lab-__codelineno-36-1"></a>brew<span class="w"> </span>install<span class="w"> </span>kind
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#lab00-setup-lab-__codelineno-37-1"></a>curl<span class="w"> </span>-Lo<span class="w"> </span>./kind<span class="w"> </span>https://kind.sigs.k8s.io/dl/v0.20.0/kind-linux-amd64
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#lab00-setup-lab-__codelineno-37-2"></a>chmod<span class="w"> </span>+x<span class="w"> </span>./kind
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#lab00-setup-lab-__codelineno-37-3"></a>sudo<span class="w"> </span>mv<span class="w"> </span>./kind<span class="w"> </span>/usr/local/bin/kind
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#lab00-setup-lab-__codelineno-38-1"></a>curl<span class="w"> </span>-Lo<span class="w"> </span>./kind<span class="w"> </span>https://kind.sigs.k8s.io/dl/v0.20.0/kind-linux-amd64
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#lab00-setup-lab-__codelineno-38-2"></a>chmod<span class="w"> </span>+x<span class="w"> </span>./kind
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#lab00-setup-lab-__codelineno-38-3"></a>sudo<span class="w"> </span>mv<span class="w"> </span>./kind<span class="w"> </span>/usr/local/bin/kind
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#lab00-setup-lab-__codelineno-39-1"></a>Kind<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>supported<span class="w"> </span><span class="k">in</span><span class="w"> </span>Cloud<span class="w"> </span>Shell<span class="w"> </span>-<span class="w"> </span>Use<span class="w"> </span>minikube<span class="w"> </span>instead
</span></code></pre></div>
</div>
</div>
</div>
<hr />
<h2 id="lab00-setup-lab-02-verify-tools-installation">02. Verify Tools Installation<a class="headerlink" href="#lab00-setup-lab-02-verify-tools-installation" title="Permanent link">&para;</a></h2>
<ul>
<li>Verify that all the tools are installed
<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#lab00-setup-lab-__codelineno-40-1"></a><span class="c1"># Verify Docker</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#lab00-setup-lab-__codelineno-40-2"></a>docker<span class="w"> </span>--version
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#lab00-setup-lab-__codelineno-40-3"></a><span class="c1"># Verify kubectl</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#lab00-setup-lab-__codelineno-40-4"></a>kubectl<span class="w"> </span>version<span class="w"> </span>--client
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#lab00-setup-lab-__codelineno-40-5"></a><span class="c1"># Verify Helm</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#lab00-setup-lab-__codelineno-40-6"></a>helm<span class="w"> </span>version
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#lab00-setup-lab-__codelineno-40-7"></a><span class="c1"># Verify Git</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#lab00-setup-lab-__codelineno-40-8"></a>git<span class="w"> </span>--version
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#lab00-setup-lab-__codelineno-40-9"></a><span class="c1"># Verify Python3</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#lab00-setup-lab-__codelineno-40-10"></a>python3<span class="w"> </span>--version
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#lab00-setup-lab-__codelineno-40-11"></a><span class="c1"># Verify Node.js</span>
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#lab00-setup-lab-__codelineno-40-12"></a>node<span class="w"> </span>--version
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#lab00-setup-lab-__codelineno-40-13"></a><span class="c1"># Verify Ollama (if installed)</span>
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#lab00-setup-lab-__codelineno-40-14"></a>ollama<span class="w"> </span>--version
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#lab00-setup-lab-__codelineno-40-15"></a><span class="c1"># Verify MCP Inspector</span>
</span><span id="__span-40-16"><a id="__codelineno-40-16" name="__codelineno-40-16" href="#lab00-setup-lab-__codelineno-40-16"></a>mcp-inspector<span class="w"> </span>--version<span class="w"> </span>
</span><span id="__span-40-17"><a id="__codelineno-40-17" name="__codelineno-40-17" href="#lab00-setup-lab-__codelineno-40-17"></a><span class="c1"># Verify Kind (if installed)</span>
</span><span id="__span-40-18"><a id="__codelineno-40-18" name="__codelineno-40-18" href="#lab00-setup-lab-__codelineno-40-18"></a>kind<span class="w"> </span>--version
</span><span id="__span-40-19"><a id="__codelineno-40-19" name="__codelineno-40-19" href="#lab00-setup-lab-__codelineno-40-19"></a><span class="c1"># Verify Minikube (if installed)</span>
</span><span id="__span-40-20"><a id="__codelineno-40-20" name="__codelineno-40-20" href="#lab00-setup-lab-__codelineno-40-20"></a>minikube<span class="w"> </span>version
</span><span id="__span-40-21"><a id="__codelineno-40-21" name="__codelineno-40-21" href="#lab00-setup-lab-__codelineno-40-21"></a><span class="c1"># Verify Cluster Info (if cluster is running)</span>
</span><span id="__span-40-22"><a id="__codelineno-40-22" name="__codelineno-40-22" href="#lab00-setup-lab-__codelineno-40-22"></a>kubectl<span class="w"> </span>cluster-info
</span></code></pre></div></li>
</ul>
<hr />
<h2 id="lab00-setup-lab-03-install-the-k-agent">03. Install the K-Agent<a class="headerlink" href="#lab00-setup-lab-03-install-the-k-agent" title="Permanent link">&para;</a></h2>
<ul>
<li>The <code>K-Agent</code> labs environment is the fundamental building block for all labs.</li>
<li>Its an Open Source framework to write MCP tools and interact with Kubernetes clusters.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="11:4"><input checked="checked" id="lab00-setup-lab-__tabbed_11_1" name="lab00-setup-lab-__tabbed_11" type="radio" /><input id="lab00-setup-lab-__tabbed_11_2" name="lab00-setup-lab-__tabbed_11" type="radio" /><input id="lab00-setup-lab-__tabbed_11_3" name="lab00-setup-lab-__tabbed_11" type="radio" /><input id="lab00-setup-lab-__tabbed_11_4" name="lab00-setup-lab-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="lab00-setup-lab-__tabbed_11_1"> macOS</label><label for="lab00-setup-lab-__tabbed_11_2">🐧 Linux (Ubuntu/Debian)</label><label for="lab00-setup-lab-__tabbed_11_3">🐧 Linux (CentOS)</label><label for="lab00-setup-lab-__tabbed_11_4">☁️ GCP Cloud Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#lab00-setup-lab-__codelineno-41-1"></a>brew<span class="w"> </span>install<span class="w"> </span>kagent
</span></code></pre></div>
</div>
<div class="tabbed-block">
<p>```bash
curl https://raw.githubusercontent.com/kagent-dev/kagent/refs/heads/main/scripts/get-kagent | bash</p>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#lab00-setup-lab-__codelineno-42-1"></a>curl<span class="w"> </span>https://raw.githubusercontent.com/kagent-dev/kagent/refs/heads/main/scripts/get-kagent<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#lab00-setup-lab-__codelineno-43-1"></a>curl<span class="w"> </span>https://raw.githubusercontent.com/kagent-dev/kagent/refs/heads/main/scripts/get-kagent<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
</span></code></pre></div>
</div>
</div>
</div>
<h4 id="lab00-setup-lab-verifty-k-agent-installation">Verifty K-Agent Installation<a class="headerlink" href="#lab00-setup-lab-verifty-k-agent-installation" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#lab00-setup-lab-__codelineno-44-1"></a>kagent<span class="w"> </span>version
</span></code></pre></div>
<hr />
<h2 id="lab00-setup-lab-04-ollama-setup">04. Ollama Setup<a class="headerlink" href="#lab00-setup-lab-04-ollama-setup" title="Permanent link">&para;</a></h2>
<ul>
<li>Ollama will be used as our LLLM model for the labs.</li>
<li>Ollama is a local LLM server that allows you to run large language models on your machine.</li>
<li>Ollama supports various models, for example: Qwen and Llama.</li>
<li>We will ise the <code>qwen3-coder</code> model which is optimized for coding tasks or the <code>gpt-oos</code> model.  </li>
</ul>
<div class="admonition info">
<p class="admonition-title">Pulling Models (Ollama)</p>
<ul>
<li>Pulling models can take a while depending on your internet speed and system performance.</li>
<li>You can skip this step and return to it later when needed.</li>
</ul>
</div>
<h4 id="lab00-setup-lab-setup-ollama-models">Setup Ollama models<a class="headerlink" href="#lab00-setup-lab-setup-ollama-models" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#lab00-setup-lab-__codelineno-45-1"></a><span class="c1"># Start Ollama service</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#lab00-setup-lab-__codelineno-45-2"></a>ollama<span class="w"> </span>serve
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#lab00-setup-lab-__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#lab00-setup-lab-__codelineno-45-4"></a><span class="c1"># In a new terminal, pull the qwen3-coder model (optimized for coding tasks)</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#lab00-setup-lab-__codelineno-45-5"></a>ollama<span class="w"> </span>pull<span class="w"> </span>qwen3-coder:30b
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#lab00-setup-lab-__codelineno-45-6"></a>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#lab00-setup-lab-__codelineno-45-7"></a><span class="c1"># Alternatively, pull the gpt-oos model</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#lab00-setup-lab-__codelineno-45-8"></a>ollama<span class="w"> </span>pull<span class="w"> </span>gpt-oos:7b
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#lab00-setup-lab-__codelineno-45-9"></a>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#lab00-setup-lab-__codelineno-45-10"></a><span class="c1"># Verify</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#lab00-setup-lab-__codelineno-45-11"></a>ollama<span class="w"> </span>list
</span></code></pre></div>
<h3 id="lab00-setup-lab-pull-a-model">Pull a Model<a class="headerlink" href="#lab00-setup-lab-pull-a-model" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#lab00-setup-lab-__codelineno-46-1"></a><span class="c1"># In a new terminal, pull the qwen3-coder model (optimized for coding tasks)</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#lab00-setup-lab-__codelineno-46-2"></a>ollama<span class="w"> </span>pull<span class="w"> </span>qwen3-coder:30b
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#lab00-setup-lab-__codelineno-46-3"></a>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#lab00-setup-lab-__codelineno-46-4"></a><span class="c1"># Verify</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#lab00-setup-lab-__codelineno-46-5"></a>ollama<span class="w"> </span>list
</span></code></pre></div>
<hr />
<h2 id="lab00-setup-lab-07-verify-setup">07. Verify Setup<a class="headerlink" href="#lab00-setup-lab-07-verify-setup" title="Permanent link">&para;</a></h2>
<ul>
<li>Let&rsquo;s verify your setup by running a simple test.</li>
</ul>
<h4 id="lab00-setup-lab-task-01-check-cluster-information">Task 01: Check Cluster Information<a class="headerlink" href="#lab00-setup-lab-task-01-check-cluster-information" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#lab00-setup-lab-__codelineno-47-1"></a><span class="c1"># Check cluster info</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#lab00-setup-lab-__codelineno-47-2"></a>kubectl<span class="w"> </span>cluster-info
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#lab00-setup-lab-__codelineno-47-3"></a>kubectl<span class="w"> </span>get<span class="w"> </span>nodes
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#lab00-setup-lab-__codelineno-47-4"></a>kubectl<span class="w"> </span>get<span class="w"> </span>namespaces
</span></code></pre></div>
<p><strong>Exercise 2: Test Container Environment</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#lab00-setup-lab-__codelineno-48-1"></a><span class="c1"># Start labs environment if not running</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#lab00-setup-lab-__codelineno-48-2"></a><span class="nb">cd</span><span class="w"> </span>labs-environment
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#lab00-setup-lab-__codelineno-48-3"></a>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#lab00-setup-lab-__codelineno-48-4"></a>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#lab00-setup-lab-__codelineno-48-5"></a><span class="c1"># Execute commands in container</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#lab00-setup-lab-__codelineno-48-6"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>kagent-controller<span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#lab00-setup-lab-__codelineno-48-7"></a><span class="s2">echo &#39;=== Environment Check ===&#39;</span>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#lab00-setup-lab-__codelineno-48-8"></a><span class="s2">echo &#39;Node.js:&#39; \$(node --version)</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#lab00-setup-lab-__codelineno-48-9"></a><span class="s2">echo &#39;Python:&#39; \$(python --version)</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#lab00-setup-lab-__codelineno-48-10"></a><span class="s2">echo &#39;kubectl:&#39; \$(kubectl version --client --short)</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#lab00-setup-lab-__codelineno-48-11"></a><span class="s2">echo &#39;Helm:&#39; \$(helm version --short)</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#lab00-setup-lab-__codelineno-48-12"></a><span class="s2">echo &#39;=========================&#39;</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#lab00-setup-lab-__codelineno-48-13"></a><span class="s2">&quot;</span>
</span></code></pre></div>
<p><strong>Expected Output:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#lab00-setup-lab-__codelineno-49-1"></a>=== Environment Check ===
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#lab00-setup-lab-__codelineno-49-2"></a>Node.js: v18.x.x
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#lab00-setup-lab-__codelineno-49-3"></a>Python: Python 3.10.x
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#lab00-setup-lab-__codelineno-49-4"></a>kubectl: Client Version: v1.28.x
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#lab00-setup-lab-__codelineno-49-5"></a>Helm: v3.13.x
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#lab00-setup-lab-__codelineno-49-6"></a>=========================
</span></code></pre></div></p>
<hr />
<h2 id="lab00-setup-lab-08-troubleshooting">08. Troubleshooting<a class="headerlink" href="#lab00-setup-lab-08-troubleshooting" title="Permanent link">&para;</a></h2>
<div class="admonition warning">
<p class="admonition-title">Container Won&rsquo;t Start</p>
<p>If the container fails to start, check:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#lab00-setup-lab-__codelineno-50-1"></a>docker<span class="w"> </span>compose<span class="w"> </span>logs
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#lab00-setup-lab-__codelineno-50-2"></a>docker<span class="w"> </span>images<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>kagent
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#lab00-setup-lab-__codelineno-50-3"></a>docker<span class="w"> </span>ps<span class="w"> </span>-a
</span></code></pre></div></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Kubectl Not Working in Container</p>
<p>If kubectl commands fail in the container:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#lab00-setup-lab-__codelineno-51-1"></a><span class="c1"># Verify kubeconfig is mounted correctly</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#lab00-setup-lab-__codelineno-51-2"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>kagent-controller<span class="w"> </span>ls<span class="w"> </span>-la<span class="w"> </span>/root/.kube/
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#lab00-setup-lab-__codelineno-51-3"></a>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#lab00-setup-lab-__codelineno-51-4"></a><span class="c1"># Try copying kubeconfig again</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#lab00-setup-lab-__codelineno-51-5"></a>cp<span class="w"> </span>~/.kube/config<span class="w"> </span><span class="k">$(</span>git<span class="w"> </span>rev-parse<span class="w"> </span>--show-toplevel<span class="k">)</span>//runtime/.kube/config
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#lab00-setup-lab-__codelineno-51-6"></a>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#lab00-setup-lab-__codelineno-51-7"></a><span class="c1"># Restart container</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#lab00-setup-lab-__codelineno-51-8"></a><span class="nb">cd</span><span class="w"> </span>labs-environment
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#lab00-setup-lab-__codelineno-51-9"></a>docker<span class="w"> </span>compose<span class="w"> </span>restart
</span></code></pre></div></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Platform Issues (M1/M2 Mac)</p>
<p>If you encounter platform errors:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#lab00-setup-lab-__codelineno-52-1"></a><span class="c1"># Verify platform in .env file</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#lab00-setup-lab-__codelineno-52-2"></a>cat<span class="w"> </span>labs-environment/.env
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#lab00-setup-lab-__codelineno-52-3"></a>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#lab00-setup-lab-__codelineno-52-4"></a><span class="c1"># Should show: TARGET_PLATFORM=linux/arm64</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#lab00-setup-lab-__codelineno-52-5"></a><span class="c1"># If not, update it manually</span>
</span></code></pre></div></p>
</div></section><section class="print-page" id="lab01-mcp-fundamentals-lab" heading-number="2.3"><h1 id="lab01-mcp-fundamentals-lab-lab-1-mcp-fundamentals">Lab 1 - MCP Fundamentals<a class="headerlink" href="#lab01-mcp-fundamentals-lab-lab-1-mcp-fundamentals" title="Permanent link">&para;</a></h1>
<h2 id="lab01-mcp-fundamentals-lab-overview">Overview<a class="headerlink" href="#lab01-mcp-fundamentals-lab-overview" title="Permanent link">&para;</a></h2>
<ul>
<li><code>MCP</code> is a game-changer for AI application development .</li>
<li>In this lab, you&rsquo;ll learn about the Model Context Protocol (<code>MCP</code>), the communication standard that enables AI assistants to interact with external tools and services. </li>
<li>You&rsquo;ll explore MCP concepts, test simple tools, and understand the protocol structure.</li>
<li>
<p>This lab uses the MCP server included in the K-Agent labs environment.</p>
<div class="admonition danger">
<p class="admonition-title">Prerequisites</p>
<ul>
<li>Make sure you have completed <a href="#lab01-mcp-fundamentals-000-setup">Lab 000 - Environment Setup</a> before starting this lab.</li>
</ul>
</div>
</li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-learning-objectives">Learning Objectives<a class="headerlink" href="#lab01-mcp-fundamentals-lab-learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lab, you will:</p>
<ul>
<li>Understand what <code>MCP</code> is and why it was created</li>
<li>Learn the core architecture and components of <code>MCP</code></li>
<li>Identify the key capabilities <code>MCP</code> provides</li>
<li>Understand the client-server model in <code>MCP</code></li>
<li>Recognize common use cases for <code>MCP</code></li>
<li>Learn MCP server and client communication</li>
<li>Testing MCP tools with stdio transport</li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-what-is-mcp">What is MCP?<a class="headerlink" href="#lab01-mcp-fundamentals-lab-what-is-mcp" title="Permanent link">&para;</a></h2>
<ul>
<li>The <strong>Model Context Protocol (MCP)</strong> is an open protocol that standardizes how AI applications interact with external data sources and tools. </li>
<li>It defines a structured way for AI assistants (clients) to discover, call, and receive responses from tools (servers) using JSON-RPC over various transport layers.</li>
<li>MCP is designed to be flexible and extensible, allowing developers to create custom tools that can be easily integrated with different AI models.</li>
</ul>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-what-does-mcp-offer">What does MCP offer?<a class="headerlink" href="#lab01-mcp-fundamentals-lab-what-does-mcp-offer" title="Permanent link">&para;</a></h3>
<div class="grid cards">
<ul>
<li>
<h4 id="lab01-mcp-fundamentals-lab-standardized-communication">Standardized Communication<a class="headerlink" href="#lab01-mcp-fundamentals-lab-standardized-communication" title="Permanent link">&para;</a></h4>
<p>AI assistants can work with any MCP-compatible tool</p>
</li>
<li>
<h4 id="lab01-mcp-fundamentals-lab-tool-discovery">Tool Discovery<a class="headerlink" href="#lab01-mcp-fundamentals-lab-tool-discovery" title="Permanent link">&para;</a></h4>
<p>Clients can discover available tools from servers</p>
</li>
<li>
<h4 id="lab01-mcp-fundamentals-lab-structured-interaction">Structured Interaction<a class="headerlink" href="#lab01-mcp-fundamentals-lab-structured-interaction" title="Permanent link">&para;</a></h4>
<p>Well-defined input/output schemas using JSON</p>
</li>
<li>
<h4 id="lab01-mcp-fundamentals-lab-standardized-communication_1">Standardized Communication<a class="headerlink" href="#lab01-mcp-fundamentals-lab-standardized-communication_1" title="Permanent link">&para;</a></h4>
<p>AI assistants can work with any MCP-compatible tool</p>
</li>
<li>
<h4 id="lab01-mcp-fundamentals-lab-tool-discovery_1">Tool Discovery<a class="headerlink" href="#lab01-mcp-fundamentals-lab-tool-discovery_1" title="Permanent link">&para;</a></h4>
<p>Clients can discover available tools from servers</p>
</li>
<li>
<h4 id="lab01-mcp-fundamentals-lab-structured-interaction_1">Structured Interaction<a class="headerlink" href="#lab01-mcp-fundamentals-lab-structured-interaction_1" title="Permanent link">&para;</a></h4>
<p>Well-defined input/output schemas using JSON</p>
</li>
<li>
<h4 id="lab01-mcp-fundamentals-lab-multiple-transports">Multiple Transports<a class="headerlink" href="#lab01-mcp-fundamentals-lab-multiple-transports" title="Permanent link">&para;</a></h4>
<p>Supports stdio, HTTP, WebSocket</p>
</li>
</ul>
</div>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-the-problem-mcp-solves">The Problem MCP Solves<a class="headerlink" href="#lab01-mcp-fundamentals-lab-the-problem-mcp-solves" title="Permanent link">&para;</a></h3>
<p>Before <code>MCP</code>, every AI application had to build custom integrations for each data source or tool it wanted to use. This led to:</p>
<ul>
<li><strong>Fragmentation</strong>: Each app using different methods to connect to the same services</li>
<li><strong>Duplication</strong>: Developers rebuilding the same integrations repeatedly</li>
<li><strong>Limited scalability</strong>: Adding new integrations was time-consuming and error-prone</li>
<li><strong>Inconsistent experiences</strong>: No standard way for LLMs to interact with external systems</li>
</ul>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-the-mcp-solution">The MCP Solution<a class="headerlink" href="#lab01-mcp-fundamentals-lab-the-mcp-solution" title="Permanent link">&para;</a></h3>
<p><code>MCP</code> provides a <strong>standardized protocol</strong> that:</p>
<ul>
<li>Enables <strong>universal connectivity</strong> between LLMs and data sources</li>
<li>Allows <strong>one integration to work across all MCP-compatible applications</strong></li>
<li>Provides a <strong>consistent interface</strong> for accessing tools, resources, and prompts</li>
<li>Supports <strong>secure, controlled access</strong> to external systems</li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-mcp-architecture-overview">MCP Architecture Overview<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-architecture-overview" title="Permanent link">&para;</a></h2>
<p><code>MCP</code> follows a <strong>client-server architecture</strong> with clear separation of concerns:</p>
<pre class="mermaid"><code>graph TD
    A[MCP Client] --&gt; B[Ollama Module]
    A --&gt; C[IDEs &amp; Apps]
    A --&gt; D[AI Tools]
    B --&gt; E[MCP Protocol]
    C --&gt; E
    D --&gt; E
    E --&gt; F[MCP Server]
    F --&gt; G[Exposes: Tools, Resources &amp; Prompts]
    F --&gt; H[Connects to: APIs, Databases, Files, etc.]</code></pre>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-k-agent-architecture-flow">K-Agent Architecture Flow<a class="headerlink" href="#lab01-mcp-fundamentals-lab-k-agent-architecture-flow" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>flowchart TD
    assistant[AI Assistant] --&gt;|MCP tool request| kagent[K-Agent MCP Server]
    kagent --&gt; toolRouter[K-Agent Tool Router]
    toolRouter --&gt;|kubeclient| k8s[Kubernetes API]
    toolRouter --&gt;|cloud sdk| clouds[Cloud Providers]
    kagent --&gt;|context updates| datastore[State &amp; Context Store]
    datastore --&gt;|observability| observ[Logs &amp; Metrics]
    k8s --&gt;|responses| kagent
    clouds --&gt;|responses| kagent
    kagent --&gt;|MCP response| assistant
    subgraph cluster [Kubernetes Cluster]
        direction LR
        k8s
        datastore
        observ
    end</code></pre>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-mcp-components">MCP Components<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-components" title="Permanent link">&para;</a></h2>
<p><img src="../Lab01-MCP-Fundamentals/assets/images/MCP.svg" alt="MCP Components Diagram" class="center" style="max-width:800; border-radius:20px;"/></p>
<h3 id="lab01-mcp-fundamentals-lab-mcp-server">MCP Server<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-server" title="Permanent link">&para;</a></h3>
<div class="cards grid single-column">
<ul>
<li>
<h4 id="lab01-mcp-fundamentals-lab-exposes-toolsresources-to-clients">Exposes tools/resources to clients<a class="headerlink" href="#lab01-mcp-fundamentals-lab-exposes-toolsresources-to-clients" title="Permanent link">&para;</a></h4>
<ul>
<li>Provides a standardized interface for tool interaction</li>
<li>Allows AI assistants to discover and call tools</li>
<li>Manages tool lifecycle and execution</li>
<li>Handles tool errors and retries</li>
</ul>
</li>
</ul>
</div>
<div class="cards grid single-column">
<ul>
<li>
<h4 id="lab01-mcp-fundamentals-lab-implements-the-mcp-protocol">Implements the MCP protocol<a class="headerlink" href="#lab01-mcp-fundamentals-lab-implements-the-mcp-protocol" title="Permanent link">&para;</a></h4>
<ul>
<li>Follows JSON-RPC 2.0 specification</li>
<li>Supports multiple transport layers (stdio, HTTP, WebSocket)</li>
<li>Manages tool schemas and validation</li>
<li>Supports tool discovery and listing</li>
<li>Provides structured responses</li>
</ul>
</li>
</ul>
</div>
<div class="cards grid single-column">
<ul>
<li>
<h4 id="lab01-mcp-fundamentals-lab-typical-mcp-server-features">Typical MCP Server Features<a class="headerlink" href="#lab01-mcp-fundamentals-lab-typical-mcp-server-features" title="Permanent link">&para;</a></h4>
<ul>
<li>Runs as a standalone process or service</li>
<li>Can be deployed locally or in the cloud</li>
<li>Can run in containers or serverless environments</li>
<li>Scales based on demand</li>
<li>Monitors tool usage and performance</li>
<li>Logs tool interactions for auditing</li>
<li>Supports authentication and authorization</li>
<li>Integrates with AI assistants and applications</li>
<li>Defines tool schemas (inputs/outputs)</li>
<li>Handles tool execution</li>
</ul>
</li>
</ul>
</div>
<div class="cards grid single-column">
<ul>
<li>
<h4 id="lab01-mcp-fundamentals-lab-mcp-server-notes">MCP Server Notes<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-server-notes" title="Permanent link">&para;</a></h4>
<ul>
<li>Communicates via transport layer (stdio, HTTP, WebSocket)</li>
<li>Typically runs as a local process or container</li>
<li>In K-Agent, the MCP server exposes Kubernetes and cloud management tools.</li>
<li>The server listens for incoming MCP requests from AI assistants and executes the requested tools.</li>
<li>In our lab The server translates MCP tool calls into Kubernetes API calls or cloud service operations.</li>
<li>The server returns structured responses back to the AI assistant.</li>
<li>The server can also update context/state in a datastore for persistent information.</li>
<li>The server is implemented using the MCP SDK, which simplifies tool definition and communication handling.</li>
<li>The server supports multiple transport layers, allowing it to communicate with different types of AI assistants.</li>
</ul>
</li>
</ul>
</div>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-mcp-client">MCP Client<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-client" title="Permanent link">&para;</a></h3>
<div class="cards grid single-column">
<ul>
<li>
<h3 id="lab01-mcp-fundamentals-lab-general-mcp-client-features">General MCP Client Features<a class="headerlink" href="#lab01-mcp-fundamentals-lab-general-mcp-client-features" title="Permanent link">&para;</a></h3>
<ul>
<li>The application that hosts the LLM (e.g., Roo Code, VS Code, Visual Studio, etc.)</li>
<li>Discovers available tools from MCP servers</li>
<li>Sends tool call requests with parameters</li>
<li>Receives and processes tool responses</li>
<li>Manages tool invocation lifecycle</li>
<li>Handles errors and retries</li>
<li>Typically embedded in remote AI assistants (Claude, ChatGPT, etc.) or local models (Ollama, etc.)</li>
<li>Presents server capabilities to the user/LLM</li>
</ul>
</li>
</ul>
</div>
<div class="cards grid single-column">
<ul>
<li>
<h3 id="lab01-mcp-fundamentals-lab-the-host-application">The Host Application<a class="headerlink" href="#lab01-mcp-fundamentals-lab-the-host-application" title="Permanent link">&para;</a></h3>
<ul>
<li>The <code>Client</code> is often part of a <strong>Host Application</strong> (like VS Code, Claude Desktop, or a CLI).</li>
<li>The Host manages the connection to the MCP Server.</li>
<li>It provides the user interface for interacting with the AI.</li>
<li>It handles permissions (asking the user before running a tool).</li>
</ul>
</li>
</ul>
</div>
<h3 id="lab01-mcp-fundamentals-lab-client-capabilities">Client Capabilities<a class="headerlink" href="#lab01-mcp-fundamentals-lab-client-capabilities" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Capability</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Sampling</strong></td>
<td>The server can request the client to sample an LLM (generate text).</td>
</tr>
<tr>
<td><strong>Roots</strong></td>
<td>The client can tell the server which files/folders are accessible.</td>
</tr>
<tr>
<td><strong>Notifications</strong></td>
<td>The client can receive notifications from the server (e.g. logs, progress).</td>
</tr>
<tr>
<td><strong>Context Updates</strong></td>
<td>The client can send context/state updates to the server.</td>
</tr>
<tr>
<td><strong>Authentication</strong></td>
<td>The client can provide authentication tokens/credentials to the server.</td>
</tr>
<tr>
<td><strong>Transport</strong></td>
<td>The client supports multiple transport layers (stdio, HTTP, WebSocket).</td>
</tr>
<tr>
<td><strong>Error Handling</strong></td>
<td>The client manages errors and retries for tool calls.</td>
</tr>
<tr>
<td><strong>Tool Discovery</strong></td>
<td>The client can list available tools from the server.</td>
</tr>
<tr>
<td><strong>Tool Invocation</strong></td>
<td>The client can call tools with parameters and receive structured responses.</td>
</tr>
<tr>
<td><strong>Logging</strong></td>
<td>The client can log tool interactions for auditing and debugging.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-transport-layer-mcp-communication">Transport Layer - MCP Communication<a class="headerlink" href="#lab01-mcp-fundamentals-lab-transport-layer-mcp-communication" title="Permanent link">&para;</a></h3>
<ul>
<li>MCP supports multiple transport mechanisms:</li>
</ul>
<table>
<thead>
<tr>
<th>Protocol</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>stdio</code></td>
<td>Standard input/output (used in K-Agent)</td>
</tr>
<tr>
<td><code>HTTP</code></td>
<td>RESTful API communication</td>
</tr>
<tr>
<td><code>WebSocket</code></td>
<td>Real-time bidirectional communication</td>
</tr>
<tr>
<td><code>gRPC</code></td>
<td>High-performance RPC framework</td>
</tr>
<tr>
<td><code>MQTT</code></td>
<td>Lightweight messaging protocol</td>
</tr>
<tr>
<td><code>Custom</code></td>
<td>Any custom transport implementation</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-mcp-communication-flow">MCP Communication Flow<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-communication-flow" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>sequenceDiagram
    participant C as Client
    participant S as Server

    C-&gt;&gt;S: 1. Discover available tools
    C-&gt;&gt;S: 2. Send tool call request (parameters)
    Note over S: 3. Validate request against schema
    Note over S: 4. Execute tool logic
    S--&gt;&gt;C: 5. Return structured response
    Note over C: 6. Process response &amp; continue interaction</code></pre>
<h2 id="lab01-mcp-fundamentals-lab-mcp-tool-structure">MCP Tool Structure<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-tool-structure" title="Permanent link">&para;</a></h2>
<ul>
<li>An MCP tool consists of:</li>
</ul>
<div class="cards grid single-column">
<ul>
<li>
<h4 id="lab01-mcp-fundamentals-lab-tool-definition">Tool Definition<a class="headerlink" href="#lab01-mcp-fundamentals-lab-tool-definition" title="Permanent link">&para;</a></h4>
<ul>
<li>Metadata about the tool (name, description)</li>
<li>Input schema defining parameters</li>
<li>Output schema defining response structure</li>
<li>Versioning information</li>
<li>Dependencies and requirements</li>
<li>Authentication requirements</li>
<li>Rate limiting information</li>
<li>Error handling strategies</li>
</ul>
</li>
</ul>
</div>
<div class="cards grid single-column">
<ul>
<li>
<h4 id="lab01-mcp-fundamentals-lab-tool-handler">Tool Handler<a class="headerlink" href="#lab01-mcp-fundamentals-lab-tool-handler" title="Permanent link">&para;</a></h4>
<ul>
<li>Function that implements the tool&rsquo;s logic</li>
<li>Receives input parameters</li>
<li>Performs the tool&rsquo;s operation</li>
<li>Returns structured output</li>
<li>Handles errors and exceptions</li>
<li>Logs execution details</li>
<li>Manages state/context if needed</li>
</ul>
</li>
</ul>
</div>
<div class="cards grid single-column">
<ul>
<li>
<h4 id="lab01-mcp-fundamentals-lab-tool-execution-flow">Tool Execution Flow<a class="headerlink" href="#lab01-mcp-fundamentals-lab-tool-execution-flow" title="Permanent link">&para;</a></h4>
<ul>
<li>Client discovers tool from server</li>
<li>Client sends tool call request with parameters</li>
<li>Server validates request against tool schema</li>
<li>Server invokes tool handler with parameters</li>
<li>Tool handler executes logic and returns response</li>
<li>Server sends structured response back to client</li>
</ul>
</li>
</ul>
</div>
<div class="cards grid single-column">
<ul>
<li>
<h3 id="lab01-mcp-fundamentals-lab-input-schema">Input Schema<a class="headerlink" href="#lab01-mcp-fundamentals-lab-input-schema" title="Permanent link">&para;</a></h3>
<ul>
<li>Defines expected parameters for the tool</li>
<li>Uses JSON Schema format</li>
<li>Specifies data types, required fields, and descriptions</li>
<li>Enables validation of incoming requests</li>
<li>Facilitates client-side form generation</li>
<li>Supports complex nested structures</li>
<li>Allows default values and constraints</li>
<li>Enhances interoperability between clients and servers</li>
</ul>
</li>
</ul>
</div>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-core-mcp-capabilities">Core MCP Capabilities<a class="headerlink" href="#lab01-mcp-fundamentals-lab-core-mcp-capabilities" title="Permanent link">&para;</a></h2>
<p><code>MCP</code> servers can expose three main types of capabilities:</p>
<h3 id="lab01-mcp-fundamentals-lab-1-tools">1. <strong>Tools</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-1-tools" title="Permanent link">&para;</a></h3>
<p>Functions that the LLM can call to perform actions or retrieve information.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>Search a database</li>
<li>Make an API call</li>
<li>Perform calculations</li>
<li>Execute system commands</li>
</ul>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Defined with JSON Schema for input validation</li>
<li>Return structured results</li>
<li>Can have side effects (create, update, delete operations)</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-examples">Examples:<a class="headerlink" href="#lab01-mcp-fundamentals-lab-examples" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Tool Definition</strong>:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab01-mcp-fundamentals-lab-__codelineno-0-1"></a><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab01-mcp-fundamentals-lab-__codelineno-0-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hello&quot;</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab01-mcp-fundamentals-lab-__codelineno-0-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Returns a greeting message&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab01-mcp-fundamentals-lab-__codelineno-0-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#lab01-mcp-fundamentals-lab-__codelineno-0-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#lab01-mcp-fundamentals-lab-__codelineno-0-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#lab01-mcp-fundamentals-lab-__codelineno-0-7"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#lab01-mcp-fundamentals-lab-__codelineno-0-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#lab01-mcp-fundamentals-lab-__codelineno-0-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Name to greet&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#lab01-mcp-fundamentals-lab-__codelineno-0-10"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#lab01-mcp-fundamentals-lab-__codelineno-0-11"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#lab01-mcp-fundamentals-lab-__codelineno-0-12"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#lab01-mcp-fundamentals-lab-__codelineno-0-13"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#lab01-mcp-fundamentals-lab-__codelineno-0-14"></a><span class="p">}</span>
</span></code></pre></div>
</li>
<li>
<p><strong>Tool Handler:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab01-mcp-fundamentals-lab-__codelineno-1-1"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleHello</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#lab01-mcp-fundamentals-lab-__codelineno-1-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#lab01-mcp-fundamentals-lab-__codelineno-1-3"></a><span class="w">    </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#lab01-mcp-fundamentals-lab-__codelineno-1-4"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#lab01-mcp-fundamentals-lab-__codelineno-1-5"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#lab01-mcp-fundamentals-lab-__codelineno-1-6"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Hello, </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">!`</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#lab01-mcp-fundamentals-lab-__codelineno-1-7"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#lab01-mcp-fundamentals-lab-__codelineno-1-8"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#lab01-mcp-fundamentals-lab-__codelineno-1-9"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#lab01-mcp-fundamentals-lab-__codelineno-1-10"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-2-resources">2. <strong>Resources</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-2-resources" title="Permanent link">&para;</a></h3>
<p>Contextual data that can be read by the LLM.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>File contents</li>
<li>Database records</li>
<li>API responses</li>
<li>Documentation</li>
</ul>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Identified by URI (Uniform Resource Identifier)</li>
<li>Can be text, binary, or structured data</li>
<li>Typically read-only</li>
<li>Support for templates and subscriptions</li>
</ul>
<hr />
<h3 id="lab01-mcp-fundamentals-lab-3-prompts">3. <strong>Prompts</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-3-prompts" title="Permanent link">&para;</a></h3>
<p>Pre-built prompt templates that users can invoke.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>Code review templates</li>
<li>Documentation generation prompts</li>
<li>Analysis frameworks</li>
<li>Interaction patterns</li>
</ul>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Can include embedded resources</li>
<li>Support arguments for customization</li>
<li>Help standardize common tasks</li>
<li>Improve consistency and quality</li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-the-mcp-lifecycle">The MCP Lifecycle<a class="headerlink" href="#lab01-mcp-fundamentals-lab-the-mcp-lifecycle" title="Permanent link">&para;</a></h2>
<p>Understanding how <code>MCP</code> clients and servers interact:</p>
<h3 id="lab01-mcp-fundamentals-lab-1-initialization">1. <strong>Initialization</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-1-initialization" title="Permanent link">&para;</a></h3>
<ul>
<li>Client connects to server via transport layer</li>
<li>Handshake to establish protocol version and capabilities</li>
<li>Server sends initial tool/resource/prompt listings</li>
<li>Client acknowledges and prepares for interaction</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-2-capability-discovery">2. <strong>Capability Discovery</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-2-capability-discovery" title="Permanent link">&para;</a></h3>
<ul>
<li>Client requests list of available tools, resources, or prompts</li>
<li>Server responds with detailed descriptions</li>
<li>Client presents these to the user/LLM</li>
<li>Client selects tools/resources/prompts to use</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-3-execution">3. <strong>Execution</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-3-execution" title="Permanent link">&para;</a></h3>
<ul>
<li>Client sends requests to invoke tools, read resources, or render prompts</li>
<li>Server processes the request</li>
<li>Server returns results in standardized format</li>
<li>Client handles the response and continues interaction</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-4-cleanup">4. <strong>Cleanup</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-4-cleanup" title="Permanent link">&para;</a></h3>
<ul>
<li>Either party can close the connection</li>
<li>Graceful shutdown with notifications</li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-mcp-communication-model">MCP Communication Model<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-communication-model" title="Permanent link">&para;</a></h2>
<p><code>MCP</code> uses <strong>three types of messages</strong>:</p>
<h3 id="lab01-mcp-fundamentals-lab-1-requests">1. <strong>Requests</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-1-requests" title="Permanent link">&para;</a></h3>
<ul>
<li>Require a response</li>
<li>Include a unique request ID</li>
<li>Examples: <code>tools/list</code>, <code>resources/read</code>, <code>tools/call</code></li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-2-responses">2. <strong>Responses</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-2-responses" title="Permanent link">&para;</a></h3>
<ul>
<li>Match to requests by ID</li>
<li>Contain either results or errors</li>
<li>Must be sent for every request</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-3-notifications">3. <strong>Notifications</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-3-notifications" title="Permanent link">&para;</a></h3>
<ul>
<li>One-way messages</li>
<li>Don&rsquo;t require responses</li>
<li>Examples: <code>notifications/initialized</code>, <code>notifications/cancelled</code></li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-security-considerations">Security Considerations<a class="headerlink" href="#lab01-mcp-fundamentals-lab-security-considerations" title="Permanent link">&para;</a></h2>
<p>When working with <code>MCP</code>, keep these best practices in mind:</p>
<ol>
<li>
<p><strong>Authentication &amp; Authorization</strong></p>
<ul>
<li>Servers should validate requests</li>
<li>Use appropriate credentials management</li>
<li>Implement least-privilege access</li>
</ul>
</li>
<li>
<p><strong>Data Privacy</strong></p>
<ul>
<li>Be mindful of what data is exposed</li>
<li>Implement proper access controls</li>
<li>Consider encryption for sensitive data</li>
</ul>
</li>
<li>
<p><strong>Rate Limiting</strong></p>
<ul>
<li>Protect against abuse</li>
<li>Implement appropriate throttling</li>
<li>Monitor usage patterns</li>
</ul>
</li>
<li>
<p><strong>Input Validation</strong></p>
<ul>
<li>Always validate tool inputs</li>
<li>Sanitize user-provided data</li>
<li>Prevent injection attacks</li>
</ul>
</li>
</ol>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-common-use-cases">Common Use Cases<a class="headerlink" href="#lab01-mcp-fundamentals-lab-common-use-cases" title="Permanent link">&para;</a></h2>
<p><code>MCP</code> is ideal for:</p>
<h3 id="lab01-mcp-fundamentals-lab-enterprise-integration">Enterprise Integration<a class="headerlink" href="#lab01-mcp-fundamentals-lab-enterprise-integration" title="Permanent link">&para;</a></h3>
<ul>
<li>Connect LLMs to internal databases</li>
<li>Access corporate knowledge bases</li>
<li>Integrate with business tools (CRM, ERP, etc.)</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-developer-tools">Developer Tools<a class="headerlink" href="#lab01-mcp-fundamentals-lab-developer-tools" title="Permanent link">&para;</a></h3>
<ul>
<li>File system access</li>
<li>Git operations</li>
<li>Database queries</li>
<li>API testing and documentation</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-data-analysis">Data Analysis<a class="headerlink" href="#lab01-mcp-fundamentals-lab-data-analysis" title="Permanent link">&para;</a></h3>
<ul>
<li>Query and visualize data</li>
<li>Generate reports</li>
<li>Perform statistical analysis</li>
<li>Access multiple data sources</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-productivity">Productivity<a class="headerlink" href="#lab01-mcp-fundamentals-lab-productivity" title="Permanent link">&para;</a></h3>
<ul>
<li>Calendar and email management</li>
<li>Task and project tracking</li>
<li>Document processing</li>
<li>Automated workflows</li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-mcp-vs-other-approaches">MCP vs. Other Approaches<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-vs-other-approaches" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Approach</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Function Calling</strong></td>
<td>Simple, direct</td>
<td>Requires custom implementation per app</td>
</tr>
<tr>
<td><strong>API Integration</strong></td>
<td>Flexible</td>
<td>No standard, duplicated effort</td>
</tr>
<tr>
<td><strong>MCP</strong></td>
<td>Universal standard, reusable, scalable</td>
<td>Requires initial setup</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-hands-on-exercise">Hands-On Exercise<a class="headerlink" href="#lab01-mcp-fundamentals-lab-hands-on-exercise" title="Permanent link">&para;</a></h2>
<h3 id="lab01-mcp-fundamentals-lab-explore-an-mcp-server-configuration">Explore an MCP Server Configuration<a class="headerlink" href="#lab01-mcp-fundamentals-lab-explore-an-mcp-server-configuration" title="Permanent link">&para;</a></h3>
<p>Look at how an <code>MCP</code> server is configured in a client application (like Roo Code):</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab01-mcp-fundamentals-lab-__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#lab01-mcp-fundamentals-lab-__codelineno-2-2"></a><span class="w">  </span><span class="nt">&quot;mcpServers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#lab01-mcp-fundamentals-lab-__codelineno-2-3"></a><span class="w">    </span><span class="nt">&quot;example-server&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#lab01-mcp-fundamentals-lab-__codelineno-2-4"></a><span class="w">      </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;node&quot;</span><span class="p">,</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#lab01-mcp-fundamentals-lab-__codelineno-2-5"></a><span class="w">      </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/path/to/server/index.js&quot;</span><span class="p">],</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#lab01-mcp-fundamentals-lab-__codelineno-2-6"></a><span class="w">      </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#lab01-mcp-fundamentals-lab-__codelineno-2-7"></a><span class="w">        </span><span class="nt">&quot;API_KEY&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;your-api-key&quot;</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#lab01-mcp-fundamentals-lab-__codelineno-2-8"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#lab01-mcp-fundamentals-lab-__codelineno-2-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#lab01-mcp-fundamentals-lab-__codelineno-2-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#lab01-mcp-fundamentals-lab-__codelineno-2-11"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-testing-mcp-tools-ts">Testing MCP Tools (TS)<a class="headerlink" href="#lab01-mcp-fundamentals-lab-testing-mcp-tools-ts" title="Permanent link">&para;</a></h2>
<h3 id="lab01-mcp-fundamentals-lab-using-mcp-inspector">Using MCP Inspector<a class="headerlink" href="#lab01-mcp-fundamentals-lab-using-mcp-inspector" title="Permanent link">&para;</a></h3>
<p><code>MCP Inspector</code> is a tool for testing MCP servers interactively.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab01-mcp-fundamentals-lab-__codelineno-3-1"></a><span class="c1"># Install mcp-inspector (if not already installed)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#lab01-mcp-fundamentals-lab-__codelineno-3-2"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@modelcontextprotocol/inspector
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#lab01-mcp-fundamentals-lab-__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#lab01-mcp-fundamentals-lab-__codelineno-3-4"></a><span class="c1"># Start the MCP Inspector with the TS code</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#lab01-mcp-fundamentals-lab-__codelineno-3-5"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node<span class="w"> </span>./build/index.js
</span></code></pre></div>
<div class="admonition info">
<p class="admonition-title">MCP Inspector UI</p>
<ul>
<li>MCP Inspector will start a web interface at <code>http://localhost:6274</code></li>
<li>You can also test tools programmatically using the examples below.</li>
</ul>
</div>
<hr />
<p><strong>Step-by-step MCP Inspector Testing:</strong></p>
<ol>
<li>
<p>Get the Authentication Token<br />
   When you start MCP Inspector, the terminal displays:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab01-mcp-fundamentals-lab-__codelineno-4-1"></a>🔑 Session token: [long-token-string]
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#lab01-mcp-fundamentals-lab-__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#lab01-mcp-fundamentals-lab-__codelineno-4-3"></a>🔗 Open inspector with token pre-filled:
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#lab01-mcp-fundamentals-lab-__codelineno-4-4"></a>    http://localhost:6274/?MCP_PROXY_AUTH_TOKEN=[token]
</span></code></pre></div>
</li>
<li>
<p>Copy the Authentication URL<br />
   Copy the complete URL with the token (the second line starting with <code>http://</code>)</p>
</li>
<li>
<p>Open MCP Inspector in Your Browser<br />
   Paste the complete URL with the token from step 2 into your browser. You&rsquo;ll be authenticated immediately.</p>
</li>
<li>
<p>Configure the Server Connection<br />
   In the MCP Inspector interface:</p>
<ul>
<li>Verify the <strong>&ldquo;Transport&rdquo;</strong> is set to <strong><code>stdio</code></strong> (NOT http or streamable-http)</li>
<li>You&rsquo;ll see a <strong>&ldquo;Command&rdquo;</strong> field - it should already show: <code>node</code></li>
<li>look for the <strong>&ldquo;Argument&rdquo;</strong> field - it should show: <code>/app/build/index.js</code></li>
<li>Click the <strong>&ldquo;Connect&rdquo;</strong> button</li>
<li>Wait for the status to show <strong>&ldquo;Connected&rdquo;</strong> with a green indicator</li>
</ul>
</li>
<li>
<p>Explore Available Tools:</p>
<ul>
<li>Once connected, click on the <strong>&ldquo;Tools&rdquo;</strong> tab at the top of the interface, and the on <strong>&ldquo;List Tools&rdquo;</strong> button</li>
<li>You&rsquo;ll see a list of available tools from your MCP server</li>
</ul>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Authentication Required</p>
<ul>
<li>The MCP Inspector requires authentication by default. </li>
<li>Always use the URL with the token (shown in the terminal when you start the inspector), or manually enter the token in the Configuration settings. </li>
<li>If you forget the token, restart the MCP Inspector to generate a new one.</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Disabling Authentication (Development Only)</p>
<p>Y* ou can disable authentication by setting the <code>DANGEROUSLY_OMIT_AUTH=true</code> environment variable:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab01-mcp-fundamentals-lab-__codelineno-5-1"></a><span class="nv">DANGEROUSLY_OMIT_AUTH</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node<span class="w"> </span>/app/build/index.js
</span></code></pre></div>
<strong>⚠️ WARNING</strong>: This is dangerous and should ONLY be used in isolated development environments, never in production or when exposed to the internet.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Keep MCP Inspector Running</p>
<ul>
<li>Make sure the MCP Inspector command (<code>npx @modelcontextprotocol/inspector node /app/build/index.js</code>) is still running in your terminal. </li>
<li>If the connection fails or you see errors, restart the command in the container.</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Interactive Testing</p>
<ul>
<li>The MCP Inspector provides a user-friendly web interface to test your MCP server without writing code. </li>
<li>This is perfect for debugging and understanding how MCP tools work before integrating them with AI assistants.</li>
</ul>
</div>
<div class="admonition explore">
<p class="admonition-title">Understanding MCP Inspector Output</p>
<ul>
<li>The Inspector displays tool results in a readable format. </li>
<li>Internally, MCP uses JSON-RPC 2.0 protocol with structured responses, but the UI shows you the human-readable content. </li>
<li>For JSON view, see the &ldquo;History&rdquo; section below the UI</li>
</ul>
</div>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-deep-dive-mcp-base-components-python-focus">Deep Dive: MCP Base Components (Python Focus)<a class="headerlink" href="#lab01-mcp-fundamentals-lab-deep-dive-mcp-base-components-python-focus" title="Permanent link">&para;</a></h2>
<p>Now let&rsquo;s examine the essential building blocks of MCP and how they&rsquo;re implemented in Python. We&rsquo;ll focus on the Python implementation since it&rsquo;s often clearer and more accessible than TypeScript.</p>
<h3 id="lab01-mcp-fundamentals-lab-1-mcp-server-framework-fastmcp">1. <strong>MCP Server Framework (FastMCP)</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-1-mcp-server-framework-fastmcp" title="Permanent link">&para;</a></h3>
<p>The foundation of any MCP server is the server framework. In Python, we use <code>FastMCP</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab01-mcp-fundamentals-lab-__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab01-mcp-fundamentals-lab-__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#lab01-mcp-fundamentals-lab-__codelineno-6-3"></a><span class="c1"># Create the MCP server instance</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#lab01-mcp-fundamentals-lab-__codelineno-6-4"></a><span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;my-mcp-server&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8889</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>What it does:</strong></p>
<ul>
<li>Provides the HTTP server infrastructure</li>
<li>Handles JSON-RPC communication</li>
<li>Manages tool, resource, and prompt registration</li>
<li>Implements the MCP protocol handshake</li>
</ul>
<p><strong>What&rsquo;s inside:</strong></p>
<ul>
<li>HTTP request handlers for all MCP endpoints</li>
<li>Tool execution engine</li>
<li>Resource serving system</li>
<li>Prompt template management</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-2-tool-registration-decorator">2. <strong>Tool Registration Decorator</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-2-tool-registration-decorator" title="Permanent link">&para;</a></h3>
<p>Tools are the core functionality exposed by MCP servers:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab01-mcp-fundamentals-lab-__codelineno-7-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#lab01-mcp-fundamentals-lab-__codelineno-7-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#lab01-mcp-fundamentals-lab-__codelineno-7-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a friendly greeting message&quot;&quot;&quot;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#lab01-mcp-fundamentals-lab-__codelineno-7-4"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">! Welcome to K-Agent Labs.&quot;</span>
</span></code></pre></div>
<p><strong>What it produces:</strong></p>
<ul>
<li>A callable function registered with the MCP server</li>
<li>JSON Schema for input validation</li>
<li>Metadata for client discovery</li>
</ul>
<p><strong>What&rsquo;s inside:</strong></p>
<ul>
<li>Function signature inspection</li>
<li>Automatic parameter validation</li>
<li>Execution tracking and logging</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-3-resource-handlers">3. <strong>Resource Handlers</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-3-resource-handlers" title="Permanent link">&para;</a></h3>
<p>Resources provide read-only data access:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab01-mcp-fundamentals-lab-__codelineno-8-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;mcp://server-info&quot;</span><span class="p">)</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#lab01-mcp-fundamentals-lab-__codelineno-8-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_server_info</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#lab01-mcp-fundamentals-lab-__codelineno-8-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns information about this MCP server&quot;&quot;&quot;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#lab01-mcp-fundamentals-lab-__codelineno-8-4"></a>    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;K-Agent MCP Server</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#lab01-mcp-fundamentals-lab-__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#lab01-mcp-fundamentals-lab-__codelineno-8-6"></a><span class="s2">Version: 0.1.0</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#lab01-mcp-fundamentals-lab-__codelineno-8-7"></a><span class="s2">Capabilities:</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#lab01-mcp-fundamentals-lab-__codelineno-8-8"></a><span class="s2">- Tools: hello, add</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#lab01-mcp-fundamentals-lab-__codelineno-8-9"></a><span class="s2">- Prompts: code_review_prompt, debug_prompt</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#lab01-mcp-fundamentals-lab-__codelineno-8-10"></a><span class="s2">- Resources: code, server-info</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#lab01-mcp-fundamentals-lab-__codelineno-8-11"></a><span class="s2">&quot;&quot;&quot;</span>
</span></code></pre></div>
<p><strong>What it produces:</strong></p>
<ul>
<li>A resource accessible via a URI</li>
<li>Content generation logic</li>
<li>MIME type specification</li>
<li>URI-addressable data endpoints</li>
<li>Structured metadata for discovery</li>
<li>MIME type information</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-4-prompt-templates">4. <strong>Prompt Templates</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-4-prompt-templates" title="Permanent link">&para;</a></h3>
<p>Reusable prompt templates for consistent interactions:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab01-mcp-fundamentals-lab-__codelineno-9-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">prompt</span><span class="p">()</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#lab01-mcp-fundamentals-lab-__codelineno-9-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">code_review_prompt</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;python&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#lab01-mcp-fundamentals-lab-__codelineno-9-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a code review prompt for the given code&quot;&quot;&quot;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#lab01-mcp-fundamentals-lab-__codelineno-9-4"></a>    <span class="c1"># Create the prompt template with proper markdown formatting</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#lab01-mcp-fundamentals-lab-__codelineno-9-5"></a>    <span class="n">template</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Please review this </span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2"> code and provide feedback:</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#lab01-mcp-fundamentals-lab-__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#lab01-mcp-fundamentals-lab-__codelineno-9-7"></a><span class="s2">``` + language + f&quot;&quot;&quot;</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#lab01-mcp-fundamentals-lab-__codelineno-9-8"></a><span class="sd">&quot;&quot;&quot; + code + f&quot;&quot;&quot;</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#lab01-mcp-fundamentals-lab-__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#lab01-mcp-fundamentals-lab-__codelineno-9-10"></a><span class="n">Focus</span> <span class="n">on</span><span class="p">:</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#lab01-mcp-fundamentals-lab-__codelineno-9-11"></a><span class="o">-</span> <span class="n">Code</span> <span class="n">quality</span> <span class="ow">and</span> <span class="n">best</span> <span class="n">practices</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#lab01-mcp-fundamentals-lab-__codelineno-9-12"></a><span class="o">-</span> <span class="n">Potential</span> <span class="n">bugs</span> <span class="ow">or</span> <span class="n">issues</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#lab01-mcp-fundamentals-lab-__codelineno-9-13"></a><span class="o">-</span> <span class="n">Performance</span> <span class="n">improvements</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#lab01-mcp-fundamentals-lab-__codelineno-9-14"></a><span class="o">-</span> <span class="n">Security</span> <span class="n">concerns</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#lab01-mcp-fundamentals-lab-__codelineno-9-15"></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#lab01-mcp-fundamentals-lab-__codelineno-9-16"></a><span class="s2">    return template</span>
</span></code></pre></div>
<p><strong>What it produces:</strong></p>
<ul>
<li>A prompt template registered with the MCP server</li>
<li>Argument definitions for dynamic rendering</li>
<li>Metadata for client discovery</li>
<li>Parameterized prompt templates</li>
<li>Standardized interaction patterns</li>
<li>Consistent output formatting</li>
</ul>
<p><strong>Example output when called:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab01-mcp-fundamentals-lab-__codelineno-10-1"></a>Please review this python code and provide feedback:
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#lab01-mcp-fundamentals-lab-__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#lab01-mcp-fundamentals-lab-__codelineno-10-3"></a>&amp;#96;&amp;#96;&amp;#96;python
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#lab01-mcp-fundamentals-lab-__codelineno-10-4"></a>def hello(): pass
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#lab01-mcp-fundamentals-lab-__codelineno-10-5"></a>&amp;#96;&amp;#96;&amp;#96;
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#lab01-mcp-fundamentals-lab-__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#lab01-mcp-fundamentals-lab-__codelineno-10-7"></a>Focus on:
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#lab01-mcp-fundamentals-lab-__codelineno-10-8"></a>- Code quality and best practices
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#lab01-mcp-fundamentals-lab-__codelineno-10-9"></a>- Potential bugs or issues
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#lab01-mcp-fundamentals-lab-__codelineno-10-10"></a>- Performance improvements
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#lab01-mcp-fundamentals-lab-__codelineno-10-11"></a>- Security concerns
</span></code></pre></div></p>
<h3 id="lab01-mcp-fundamentals-lab-5-transport-layer-http-routes">5. <strong>Transport Layer (HTTP Routes)</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-5-transport-layer-http-routes" title="Permanent link">&para;</a></h3>
<p>Custom routes handle the MCP protocol communication:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#lab01-mcp-fundamentals-lab-__codelineno-11-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">custom_route</span><span class="p">(</span><span class="s2">&quot;/.well-known/mcp&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;OPTIONS&quot;</span><span class="p">])</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#lab01-mcp-fundamentals-lab-__codelineno-11-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mcp_manifest</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONResponse</span><span class="p">:</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#lab01-mcp-fundamentals-lab-__codelineno-11-3"></a>    <span class="n">manifest</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#lab01-mcp-fundamentals-lab-__codelineno-11-4"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;kagent-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#lab01-mcp-fundamentals-lab-__codelineno-11-5"></a>        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#lab01-mcp-fundamentals-lab-__codelineno-11-6"></a>        <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#lab01-mcp-fundamentals-lab-__codelineno-11-7"></a>            <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#lab01-mcp-fundamentals-lab-__codelineno-11-8"></a>            <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#lab01-mcp-fundamentals-lab-__codelineno-11-9"></a>            <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#lab01-mcp-fundamentals-lab-__codelineno-11-10"></a>            <span class="s2">&quot;sampling&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#lab01-mcp-fundamentals-lab-__codelineno-11-11"></a>        <span class="p">}</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#lab01-mcp-fundamentals-lab-__codelineno-11-12"></a>    <span class="p">}</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#lab01-mcp-fundamentals-lab-__codelineno-11-13"></a>    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span><span class="n">manifest</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>What it does:</strong></p>
<ul>
<li>Implements MCP protocol endpoints</li>
<li>Handles client-server negotiation</li>
<li>Provides capability discovery</li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-mcp-method-flow-with-echo-commands">MCP Method Flow with Echo Commands<a class="headerlink" href="#lab01-mcp-fundamentals-lab-mcp-method-flow-with-echo-commands" title="Permanent link">&para;</a></h2>
<p>Let&rsquo;s trace through the Python methods called during a typical MCP interaction, with echo commands to show what&rsquo;s happening:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab01-mcp-fundamentals-lab-__codelineno-12-1"></a><span class="c1"># 1. Server Initialization</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#lab01-mcp-fundamentals-lab-__codelineno-12-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#lab01-mcp-fundamentals-lab-__codelineno-12-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔧 Initializing MCP server...&quot;</span><span class="p">)</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#lab01-mcp-fundamentals-lab-__codelineno-12-4"></a>    <span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;kagent-mcp-server&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8889</span><span class="p">)</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#lab01-mcp-fundamentals-lab-__codelineno-12-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Server instance created with port 8889&quot;</span><span class="p">)</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#lab01-mcp-fundamentals-lab-__codelineno-12-6"></a>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#lab01-mcp-fundamentals-lab-__codelineno-12-7"></a>    <span class="c1"># Register tools</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#lab01-mcp-fundamentals-lab-__codelineno-12-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🛠️  Registering tools...&quot;</span><span class="p">)</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#lab01-mcp-fundamentals-lab-__codelineno-12-9"></a>    <span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#lab01-mcp-fundamentals-lab-__codelineno-12-10"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#lab01-mcp-fundamentals-lab-__codelineno-12-11"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;👋 Executing hello tool for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#lab01-mcp-fundamentals-lab-__codelineno-12-12"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#lab01-mcp-fundamentals-lab-__codelineno-12-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Tool &#39;hello&#39; registered&quot;</span><span class="p">)</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#lab01-mcp-fundamentals-lab-__codelineno-12-14"></a>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#lab01-mcp-fundamentals-lab-__codelineno-12-15"></a>    <span class="c1"># Start the server</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#lab01-mcp-fundamentals-lab-__codelineno-12-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🚀 Starting MCP server...&quot;</span><span class="p">)</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#lab01-mcp-fundamentals-lab-__codelineno-12-17"></a>    <span class="n">mcp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="s2">&quot;streamable-http&quot;</span><span class="p">,</span> <span class="n">mount_path</span><span class="o">=</span><span class="s2">&quot;/mcp&quot;</span><span class="p">)</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#lab01-mcp-fundamentals-lab-__codelineno-12-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Server running on http://localhost:8889&quot;</span><span class="p">)</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#lab01-mcp-fundamentals-lab-__codelineno-12-19"></a>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#lab01-mcp-fundamentals-lab-__codelineno-12-20"></a><span class="c1"># 2. Client Connection Process</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#lab01-mcp-fundamentals-lab-__codelineno-12-21"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">connect_to_server</span><span class="p">():</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#lab01-mcp-fundamentals-lab-__codelineno-12-22"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔗 Connecting to MCP server...&quot;</span><span class="p">)</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#lab01-mcp-fundamentals-lab-__codelineno-12-23"></a>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#lab01-mcp-fundamentals-lab-__codelineno-12-24"></a>    <span class="c1"># Get manifest</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#lab01-mcp-fundamentals-lab-__codelineno-12-25"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📋 Fetching server manifest...&quot;</span><span class="p">)</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#lab01-mcp-fundamentals-lab-__codelineno-12-26"></a>    <span class="n">manifest</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/.well-known/mcp&quot;</span><span class="p">)</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#lab01-mcp-fundamentals-lab-__codelineno-12-27"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Got manifest: </span><span class="si">{</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> v</span><span class="si">{</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#lab01-mcp-fundamentals-lab-__codelineno-12-28"></a>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#lab01-mcp-fundamentals-lab-__codelineno-12-29"></a>    <span class="c1"># Negotiate connection</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#lab01-mcp-fundamentals-lab-__codelineno-12-30"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🤝 Negotiating connection...&quot;</span><span class="p">)</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#lab01-mcp-fundamentals-lab-__codelineno-12-31"></a>    <span class="n">negotiate_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/negotiate&quot;</span><span class="p">)</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#lab01-mcp-fundamentals-lab-__codelineno-12-32"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Negotiation complete: </span><span class="si">{</span><span class="n">negotiate_response</span><span class="p">[</span><span class="s1">&#39;transport&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#lab01-mcp-fundamentals-lab-__codelineno-12-33"></a>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#lab01-mcp-fundamentals-lab-__codelineno-12-34"></a>    <span class="c1"># List tools</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#lab01-mcp-fundamentals-lab-__codelineno-12-35"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📋 Listing available tools...&quot;</span><span class="p">)</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#lab01-mcp-fundamentals-lab-__codelineno-12-36"></a>    <span class="n">tools</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/tools&quot;</span><span class="p">)</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#lab01-mcp-fundamentals-lab-__codelineno-12-37"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tools</span><span class="p">[</span><span class="s1">&#39;tools&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> tools&quot;</span><span class="p">)</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#lab01-mcp-fundamentals-lab-__codelineno-12-38"></a>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#lab01-mcp-fundamentals-lab-__codelineno-12-39"></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#lab01-mcp-fundamentals-lab-__codelineno-12-40"></a>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41" href="#lab01-mcp-fundamentals-lab-__codelineno-12-41"></a><span class="c1"># 3. Tool Execution Flow</span>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42" href="#lab01-mcp-fundamentals-lab-__codelineno-12-42"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_tool_flow</span><span class="p">():</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43" href="#lab01-mcp-fundamentals-lab-__codelineno-12-43"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🎯 Executing tool &#39;hello&#39;...&quot;</span><span class="p">)</span>
</span><span id="__span-12-44"><a id="__codelineno-12-44" name="__codelineno-12-44" href="#lab01-mcp-fundamentals-lab-__codelineno-12-44"></a>
</span><span id="__span-12-45"><a id="__codelineno-12-45" name="__codelineno-12-45" href="#lab01-mcp-fundamentals-lab-__codelineno-12-45"></a>    <span class="c1"># Validate arguments</span>
</span><span id="__span-12-46"><a id="__codelineno-12-46" name="__codelineno-12-46" href="#lab01-mcp-fundamentals-lab-__codelineno-12-46"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔍 Validating tool arguments...&quot;</span><span class="p">)</span>
</span><span id="__span-12-47"><a id="__codelineno-12-47" name="__codelineno-12-47" href="#lab01-mcp-fundamentals-lab-__codelineno-12-47"></a>    <span class="c1"># (validation logic here)</span>
</span><span id="__span-12-48"><a id="__codelineno-12-48" name="__codelineno-12-48" href="#lab01-mcp-fundamentals-lab-__codelineno-12-48"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Arguments valid&quot;</span><span class="p">)</span>
</span><span id="__span-12-49"><a id="__codelineno-12-49" name="__codelineno-12-49" href="#lab01-mcp-fundamentals-lab-__codelineno-12-49"></a>
</span><span id="__span-12-50"><a id="__codelineno-12-50" name="__codelineno-12-50" href="#lab01-mcp-fundamentals-lab-__codelineno-12-50"></a>    <span class="c1"># Execute tool</span>
</span><span id="__span-12-51"><a id="__codelineno-12-51" name="__codelineno-12-51" href="#lab01-mcp-fundamentals-lab-__codelineno-12-51"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;⚡ Calling tool function...&quot;</span><span class="p">)</span>
</span><span id="__span-12-52"><a id="__codelineno-12-52" name="__codelineno-12-52" href="#lab01-mcp-fundamentals-lab-__codelineno-12-52"></a>    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">execute_tool</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">})</span>
</span><span id="__span-12-53"><a id="__codelineno-12-53" name="__codelineno-12-53" href="#lab01-mcp-fundamentals-lab-__codelineno-12-53"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Tool executed successfully: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-12-54"><a id="__codelineno-12-54" name="__codelineno-12-54" href="#lab01-mcp-fundamentals-lab-__codelineno-12-54"></a>
</span><span id="__span-12-55"><a id="__codelineno-12-55" name="__codelineno-12-55" href="#lab01-mcp-fundamentals-lab-__codelineno-12-55"></a>    <span class="c1"># Track execution</span>
</span><span id="__span-12-56"><a id="__codelineno-12-56" name="__codelineno-12-56" href="#lab01-mcp-fundamentals-lab-__codelineno-12-56"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Recording execution metrics...&quot;</span><span class="p">)</span>
</span><span id="__span-12-57"><a id="__codelineno-12-57" name="__codelineno-12-57" href="#lab01-mcp-fundamentals-lab-__codelineno-12-57"></a>    <span class="c1"># (tracking logic here)</span>
</span><span id="__span-12-58"><a id="__codelineno-12-58" name="__codelineno-12-58" href="#lab01-mcp-fundamentals-lab-__codelineno-12-58"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Execution tracked&quot;</span><span class="p">)</span>
</span><span id="__span-12-59"><a id="__codelineno-12-59" name="__codelineno-12-59" href="#lab01-mcp-fundamentals-lab-__codelineno-12-59"></a>
</span><span id="__span-12-60"><a id="__codelineno-12-60" name="__codelineno-12-60" href="#lab01-mcp-fundamentals-lab-__codelineno-12-60"></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-12-61"><a id="__codelineno-12-61" name="__codelineno-12-61" href="#lab01-mcp-fundamentals-lab-__codelineno-12-61"></a>
</span><span id="__span-12-62"><a id="__codelineno-12-62" name="__codelineno-12-62" href="#lab01-mcp-fundamentals-lab-__codelineno-12-62"></a><span class="c1"># 4. Resource Access Flow</span>
</span><span id="__span-12-63"><a id="__codelineno-12-63" name="__codelineno-12-63" href="#lab01-mcp-fundamentals-lab-__codelineno-12-63"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">access_resource_flow</span><span class="p">():</span>
</span><span id="__span-12-64"><a id="__codelineno-12-64" name="__codelineno-12-64" href="#lab01-mcp-fundamentals-lab-__codelineno-12-64"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📖 Accessing resource...&quot;</span><span class="p">)</span>
</span><span id="__span-12-65"><a id="__codelineno-12-65" name="__codelineno-12-65" href="#lab01-mcp-fundamentals-lab-__codelineno-12-65"></a>
</span><span id="__span-12-66"><a id="__codelineno-12-66" name="__codelineno-12-66" href="#lab01-mcp-fundamentals-lab-__codelineno-12-66"></a>    <span class="c1"># Resolve resource URI</span>
</span><span id="__span-12-67"><a id="__codelineno-12-67" name="__codelineno-12-67" href="#lab01-mcp-fundamentals-lab-__codelineno-12-67"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔗 Resolving resource URI...&quot;</span><span class="p">)</span>
</span><span id="__span-12-68"><a id="__codelineno-12-68" name="__codelineno-12-68" href="#lab01-mcp-fundamentals-lab-__codelineno-12-68"></a>    <span class="c1"># (URI resolution logic)</span>
</span><span id="__span-12-69"><a id="__codelineno-12-69" name="__codelineno-12-69" href="#lab01-mcp-fundamentals-lab-__codelineno-12-69"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Resource resolved&quot;</span><span class="p">)</span>
</span><span id="__span-12-70"><a id="__codelineno-12-70" name="__codelineno-12-70" href="#lab01-mcp-fundamentals-lab-__codelineno-12-70"></a>
</span><span id="__span-12-71"><a id="__codelineno-12-71" name="__codelineno-12-71" href="#lab01-mcp-fundamentals-lab-__codelineno-12-71"></a>    <span class="c1"># Fetch resource content</span>
</span><span id="__span-12-72"><a id="__codelineno-12-72" name="__codelineno-12-72" href="#lab01-mcp-fundamentals-lab-__codelineno-12-72"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📥 Fetching resource content...&quot;</span><span class="p">)</span>
</span><span id="__span-12-73"><a id="__codelineno-12-73" name="__codelineno-12-73" href="#lab01-mcp-fundamentals-lab-__codelineno-12-73"></a>    <span class="n">content</span> <span class="o">=</span> <span class="k">await</span> <span class="n">get_resource_content</span><span class="p">(</span><span class="s2">&quot;mcp://server-info&quot;</span><span class="p">)</span>
</span><span id="__span-12-74"><a id="__codelineno-12-74" name="__codelineno-12-74" href="#lab01-mcp-fundamentals-lab-__codelineno-12-74"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Resource content retrieved (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="si">}</span><span class="s2"> chars)&quot;</span><span class="p">)</span>
</span><span id="__span-12-75"><a id="__codelineno-12-75" name="__codelineno-12-75" href="#lab01-mcp-fundamentals-lab-__codelineno-12-75"></a>
</span><span id="__span-12-76"><a id="__codelineno-12-76" name="__codelineno-12-76" href="#lab01-mcp-fundamentals-lab-__codelineno-12-76"></a>    <span class="k">return</span> <span class="n">content</span>
</span><span id="__span-12-77"><a id="__codelineno-12-77" name="__codelineno-12-77" href="#lab01-mcp-fundamentals-lab-__codelineno-12-77"></a>
</span><span id="__span-12-78"><a id="__codelineno-12-78" name="__codelineno-12-78" href="#lab01-mcp-fundamentals-lab-__codelineno-12-78"></a><span class="c1"># 5. Prompt Usage Flow</span>
</span><span id="__span-12-79"><a id="__codelineno-12-79" name="__codelineno-12-79" href="#lab01-mcp-fundamentals-lab-__codelineno-12-79"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">use_prompt_flow</span><span class="p">():</span>
</span><span id="__span-12-80"><a id="__codelineno-12-80" name="__codelineno-12-80" href="#lab01-mcp-fundamentals-lab-__codelineno-12-80"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📝 Using prompt template...&quot;</span><span class="p">)</span>
</span><span id="__span-12-81"><a id="__codelineno-12-81" name="__codelineno-12-81" href="#lab01-mcp-fundamentals-lab-__codelineno-12-81"></a>
</span><span id="__span-12-82"><a id="__codelineno-12-82" name="__codelineno-12-82" href="#lab01-mcp-fundamentals-lab-__codelineno-12-82"></a>    <span class="c1"># Get prompt template</span>
</span><span id="__span-12-83"><a id="__codelineno-12-83" name="__codelineno-12-83" href="#lab01-mcp-fundamentals-lab-__codelineno-12-83"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔍 Finding prompt template...&quot;</span><span class="p">)</span>
</span><span id="__span-12-84"><a id="__codelineno-12-84" name="__codelineno-12-84" href="#lab01-mcp-fundamentals-lab-__codelineno-12-84"></a>    <span class="n">template</span> <span class="o">=</span> <span class="k">await</span> <span class="n">get_prompt_template</span><span class="p">(</span><span class="s2">&quot;code_review_prompt&quot;</span><span class="p">,</span> 
</span><span id="__span-12-85"><a id="__codelineno-12-85" name="__codelineno-12-85" href="#lab01-mcp-fundamentals-lab-__codelineno-12-85"></a>                                       <span class="n">code</span><span class="o">=</span><span class="s2">&quot;def test(): pass&quot;</span><span class="p">)</span>
</span><span id="__span-12-86"><a id="__codelineno-12-86" name="__codelineno-12-86" href="#lab01-mcp-fundamentals-lab-__codelineno-12-86"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Template retrieved (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">template</span><span class="p">)</span><span class="si">}</span><span class="s2"> chars)&quot;</span><span class="p">)</span>
</span><span id="__span-12-87"><a id="__codelineno-12-87" name="__codelineno-12-87" href="#lab01-mcp-fundamentals-lab-__codelineno-12-87"></a>
</span><span id="__span-12-88"><a id="__codelineno-12-88" name="__codelineno-12-88" href="#lab01-mcp-fundamentals-lab-__codelineno-12-88"></a>    <span class="c1"># Render with arguments</span>
</span><span id="__span-12-89"><a id="__codelineno-12-89" name="__codelineno-12-89" href="#lab01-mcp-fundamentals-lab-__codelineno-12-89"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🎨 Rendering prompt with arguments...&quot;</span><span class="p">)</span>
</span><span id="__span-12-90"><a id="__codelineno-12-90" name="__codelineno-12-90" href="#lab01-mcp-fundamentals-lab-__codelineno-12-90"></a>    <span class="n">final_prompt</span> <span class="o">=</span> <span class="n">template</span>  <span class="c1"># Already rendered</span>
</span><span id="__span-12-91"><a id="__codelineno-12-91" name="__codelineno-12-91" href="#lab01-mcp-fundamentals-lab-__codelineno-12-91"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Prompt rendered&quot;</span><span class="p">)</span>
</span><span id="__span-12-92"><a id="__codelineno-12-92" name="__codelineno-12-92" href="#lab01-mcp-fundamentals-lab-__codelineno-12-92"></a>
</span><span id="__span-12-93"><a id="__codelineno-12-93" name="__codelineno-12-93" href="#lab01-mcp-fundamentals-lab-__codelineno-12-93"></a>    <span class="c1"># Send to LLM</span>
</span><span id="__span-12-94"><a id="__codelineno-12-94" name="__codelineno-12-94" href="#lab01-mcp-fundamentals-lab-__codelineno-12-94"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🤖 Sending to LLM for processing...&quot;</span><span class="p">)</span>
</span><span id="__span-12-95"><a id="__codelineno-12-95" name="__codelineno-12-95" href="#lab01-mcp-fundamentals-lab-__codelineno-12-95"></a>    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">sample_llm</span><span class="p">(</span><span class="n">final_prompt</span><span class="p">)</span>
</span><span id="__span-12-96"><a id="__codelineno-12-96" name="__codelineno-12-96" href="#lab01-mcp-fundamentals-lab-__codelineno-12-96"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ LLM response received (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="si">}</span><span class="s2"> chars)&quot;</span><span class="p">)</span>
</span><span id="__span-12-97"><a id="__codelineno-12-97" name="__codelineno-12-97" href="#lab01-mcp-fundamentals-lab-__codelineno-12-97"></a>
</span><span id="__span-12-98"><a id="__codelineno-12-98" name="__codelineno-12-98" href="#lab01-mcp-fundamentals-lab-__codelineno-12-98"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div>
<p><strong>Method Call Order:</strong></p>
<ol>
<li><code>FastMCP.__init__()</code> - Server initialization</li>
<li><code>@mcp.tool()</code> decorator - Tool registration</li>
<li><code>mcp.run()</code> - Start HTTP server</li>
<li><code>/.well-known/mcp</code> GET - Client discovery</li>
<li><code>/negotiate</code> GET - Connection negotiation</li>
<li><code>/tools</code> POST - Tool discovery</li>
<li><code>/tools/execute</code> POST - Tool execution</li>
<li><code>/resources</code> GET - Resource discovery</li>
<li><code>/sampling</code> POST - LLM interaction</li>
</ol>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-what-realizes-mcp">What Realizes MCP<a class="headerlink" href="#lab01-mcp-fundamentals-lab-what-realizes-mcp" title="Permanent link">&para;</a></h2>
<h3 id="lab01-mcp-fundamentals-lab-what-makes-mcp-work">What Makes MCP Work<a class="headerlink" href="#lab01-mcp-fundamentals-lab-what-makes-mcp-work" title="Permanent link">&para;</a></h3>
<p>MCP is realized through several key mechanisms:</p>
<h4 id="lab01-mcp-fundamentals-lab-1-protocol-standardization">1. <strong>Protocol Standardization</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-1-protocol-standardization" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>JSON-RPC 2.0</strong> as the communication protocol</li>
<li><strong>HTTP transport</strong> for reliable message delivery</li>
<li><strong>Capability negotiation</strong> during connection establishment</li>
<li><strong>Structured error handling</strong> and response formatting</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-2-component-integration">2. <strong>Component Integration</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-2-component-integration" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Server frameworks</strong> (FastMCP, MCP SDK) that implement the protocol</li>
<li><strong>Client libraries</strong> that know how to communicate with servers</li>
<li><strong>Tool execution engines</strong> that safely run server-provided functions</li>
<li><strong>Resource resolution systems</strong> that handle URI-based data access</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-3-security-boundaries">3. <strong>Security Boundaries</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-3-security-boundaries" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Process isolation</strong> between client and server</li>
<li><strong>Input validation</strong> using JSON Schema</li>
<li><strong>Access control</strong> through authentication tokens</li>
<li><strong>Rate limiting</strong> and abuse prevention</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-whats-still-missing">What&rsquo;s Still Missing<a class="headerlink" href="#lab01-mcp-fundamentals-lab-whats-still-missing" title="Permanent link">&para;</a></h3>
<p>While MCP provides a solid foundation, some aspects are still evolving:</p>
<h4 id="lab01-mcp-fundamentals-lab-1-advanced-authentication">1. <strong>Advanced Authentication</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-1-advanced-authentication" title="Permanent link">&para;</a></h4>
<ul>
<li>OAuth 2.0 integration patterns</li>
<li>Role-based access control (RBAC)</li>
<li>Token refresh mechanisms</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-2-streaming-and-real-time-updates">2. <strong>Streaming and Real-time Updates</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-2-streaming-and-real-time-updates" title="Permanent link">&para;</a></h4>
<ul>
<li>Server-sent events for live data</li>
<li>WebSocket support for bidirectional streaming</li>
<li>Real-time resource subscriptions</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-3-performance-optimization">3. <strong>Performance Optimization</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-3-performance-optimization" title="Permanent link">&para;</a></h4>
<ul>
<li>Connection pooling</li>
<li>Caching strategies</li>
<li>Batch operation optimizations</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-4-enterprise-features">4. <strong>Enterprise Features</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-4-enterprise-features" title="Permanent link">&para;</a></h4>
<ul>
<li>Audit logging and compliance</li>
<li>Multi-tenant isolation</li>
<li>Service mesh integration</li>
</ul>
<h3 id="lab01-mcp-fundamentals-lab-extra-value-mcp-provides">Extra Value MCP Provides<a class="headerlink" href="#lab01-mcp-fundamentals-lab-extra-value-mcp-provides" title="Permanent link">&para;</a></h3>
<p>Beyond basic integration, MCP adds significant value:</p>
<h4 id="lab01-mcp-fundamentals-lab-1-developer-experience">1. <strong>Developer Experience</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-1-developer-experience" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Consistent APIs</strong> across different tools and services</li>
<li><strong>Auto-discovery</strong> of capabilities</li>
<li><strong>Type safety</strong> through schema validation</li>
<li><strong>Rich tooling</strong> (debuggers, inspectors, documentation)</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-2-operational-benefits">2. <strong>Operational Benefits</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-2-operational-benefits" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Centralized management</strong> of AI integrations</li>
<li><strong>Version compatibility</strong> checking</li>
<li><strong>Health monitoring</strong> and metrics</li>
<li><strong>Graceful degradation</strong> when services are unavailable</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-3-security-advantages">3. <strong>Security Advantages</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-3-security-advantages" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Controlled access</strong> to external systems</li>
<li><strong>Audit trails</strong> of AI actions</li>
<li><strong>Input sanitization</strong> and validation</li>
<li><strong>Isolation</strong> between different integrations</li>
</ul>
<h4 id="lab01-mcp-fundamentals-lab-4-scalability-features">4. <strong>Scalability Features</strong><a class="headerlink" href="#lab01-mcp-fundamentals-lab-4-scalability-features" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Horizontal scaling</strong> of MCP servers</li>
<li><strong>Load balancing</strong> across multiple instances</li>
<li><strong>Caching layers</strong> for performance</li>
<li><strong>Circuit breakers</strong> for resilience</li>
</ul>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-core-primitive-operations">Core Primitive Operations<a class="headerlink" href="#lab01-mcp-fundamentals-lab-core-primitive-operations" title="Permanent link">&para;</a></h2>
<p>Let&rsquo;s examine the fundamental MCP operations that make everything work:</p>
<h3 id="lab01-mcp-fundamentals-lab-1-wellknownmcp-server-discovery">1. <strong>wellknown/mcp</strong> - Server Discovery<a class="headerlink" href="#lab01-mcp-fundamentals-lab-1-wellknownmcp-server-discovery" title="Permanent link">&para;</a></h3>
<p><strong>Location:</strong> <code>/.well-known/mcp</code> endpoint<br />
<strong>When it happens:</strong> During initial client connection<br />
<strong>How it works:</strong>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab01-mcp-fundamentals-lab-__codelineno-13-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">custom_route</span><span class="p">(</span><span class="s2">&quot;/.well-known/mcp&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#lab01-mcp-fundamentals-lab-__codelineno-13-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mcp_manifest</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONResponse</span><span class="p">:</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#lab01-mcp-fundamentals-lab-__codelineno-13-3"></a>    <span class="n">manifest</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#lab01-mcp-fundamentals-lab-__codelineno-13-4"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;kagent-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#lab01-mcp-fundamentals-lab-__codelineno-13-5"></a>        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#lab01-mcp-fundamentals-lab-__codelineno-13-6"></a>        <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#lab01-mcp-fundamentals-lab-__codelineno-13-7"></a>            <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#lab01-mcp-fundamentals-lab-__codelineno-13-8"></a>            <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#lab01-mcp-fundamentals-lab-__codelineno-13-9"></a>            <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#lab01-mcp-fundamentals-lab-__codelineno-13-10"></a>            <span class="s2">&quot;sampling&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#lab01-mcp-fundamentals-lab-__codelineno-13-11"></a>        <span class="p">},</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#lab01-mcp-fundamentals-lab-__codelineno-13-12"></a>        <span class="s2">&quot;endpoints&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#lab01-mcp-fundamentals-lab-__codelineno-13-13"></a>            <span class="s2">&quot;negotiate&quot;</span><span class="p">:</span> <span class="s2">&quot;/negotiate&quot;</span><span class="p">,</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#lab01-mcp-fundamentals-lab-__codelineno-13-14"></a>            <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="s2">&quot;/tools&quot;</span><span class="p">,</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#lab01-mcp-fundamentals-lab-__codelineno-13-15"></a>            <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="s2">&quot;/resources&quot;</span><span class="p">,</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#lab01-mcp-fundamentals-lab-__codelineno-13-16"></a>            <span class="s2">&quot;sampling&quot;</span><span class="p">:</span> <span class="s2">&quot;/sampling&quot;</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#lab01-mcp-fundamentals-lab-__codelineno-13-17"></a>        <span class="p">}</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#lab01-mcp-fundamentals-lab-__codelineno-13-18"></a>    <span class="p">}</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#lab01-mcp-fundamentals-lab-__codelineno-13-19"></a>    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span><span class="n">manifest</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Outcome:</strong> Client learns server capabilities and available endpoints</p>
<h3 id="lab01-mcp-fundamentals-lab-2-negotiate-connection-establishment">2. <strong>negotiate</strong> - Connection Establishment<a class="headerlink" href="#lab01-mcp-fundamentals-lab-2-negotiate-connection-establishment" title="Permanent link">&para;</a></h3>
<p><strong>Location:</strong> <code>/negotiate</code> endpoint<br />
<strong>When it happens:</strong> After manifest discovery, before using server<br />
<strong>How it works:</strong>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab01-mcp-fundamentals-lab-__codelineno-14-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">custom_route</span><span class="p">(</span><span class="s2">&quot;/negotiate&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">])</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#lab01-mcp-fundamentals-lab-__codelineno-14-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">negotiate</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONResponse</span><span class="p">:</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#lab01-mcp-fundamentals-lab-__codelineno-14-3"></a>    <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;x-proxy-token&quot;</span><span class="p">)</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#lab01-mcp-fundamentals-lab-__codelineno-14-4"></a>    <span class="n">response</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#lab01-mcp-fundamentals-lab-__codelineno-14-5"></a>        <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;streamable-http&quot;</span><span class="p">,</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#lab01-mcp-fundamentals-lab-__codelineno-14-6"></a>        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">scheme</span><span class="si">}</span><span class="s2">://</span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">/mcp&quot;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#lab01-mcp-fundamentals-lab-__codelineno-14-7"></a>    <span class="p">}</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#lab01-mcp-fundamentals-lab-__codelineno-14-8"></a>    <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#lab01-mcp-fundamentals-lab-__codelineno-14-9"></a>        <span class="n">response</span><span class="p">[</span><span class="s2">&quot;proxy_token&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">token</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#lab01-mcp-fundamentals-lab-__codelineno-14-10"></a>    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Outcome:</strong> Establishes authenticated connection parameters</p>
<h3 id="lab01-mcp-fundamentals-lab-3-toolcall-tool-execution">3. <strong>tool/call</strong> - Tool Execution<a class="headerlink" href="#lab01-mcp-fundamentals-lab-3-toolcall-tool-execution" title="Permanent link">&para;</a></h3>
<p><strong>Location:</strong> <code>/tools/execute</code> endpoint<br />
<strong>When it happens:</strong> When client wants to execute a tool function<br />
<strong>How it works:</strong>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab01-mcp-fundamentals-lab-__codelineno-15-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">custom_route</span><span class="p">(</span><span class="s2">&quot;/tools/execute&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">])</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab01-mcp-fundamentals-lab-__codelineno-15-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">tool_execute</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONResponse</span><span class="p">:</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#lab01-mcp-fundamentals-lab-__codelineno-15-3"></a>    <span class="n">body</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#lab01-mcp-fundamentals-lab-__codelineno-15-4"></a>    <span class="n">tool_name</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tool&quot;</span><span class="p">)</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#lab01-mcp-fundamentals-lab-__codelineno-15-5"></a>    <span class="n">arguments</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;arguments&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#lab01-mcp-fundamentals-lab-__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#lab01-mcp-fundamentals-lab-__codelineno-15-7"></a>    <span class="c1"># Validate and execute</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#lab01-mcp-fundamentals-lab-__codelineno-15-8"></a>    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">execute_tool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#lab01-mcp-fundamentals-lab-__codelineno-15-9"></a>    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Outcome:</strong> Executes server-side function and returns structured result</p>
<h3 id="lab01-mcp-fundamentals-lab-4-resourceread-resource-access">4. <strong>resource/read</strong> - Resource Access<a class="headerlink" href="#lab01-mcp-fundamentals-lab-4-resourceread-resource-access" title="Permanent link">&para;</a></h3>
<p><strong>Location:</strong> <code>/resources</code> endpoint (for listing) or direct URI resolution<br />
<strong>When it happens:</strong> When client needs to access data resources<br />
<strong>How it works:</strong>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#lab01-mcp-fundamentals-lab-__codelineno-16-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;mcp://server-info&quot;</span><span class="p">)</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#lab01-mcp-fundamentals-lab-__codelineno-16-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_server_info</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#lab01-mcp-fundamentals-lab-__codelineno-16-3"></a>    <span class="k">return</span> <span class="s2">&quot;Server information content&quot;</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#lab01-mcp-fundamentals-lab-__codelineno-16-4"></a>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#lab01-mcp-fundamentals-lab-__codelineno-16-5"></a><span class="c1"># Or via endpoint:</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#lab01-mcp-fundamentals-lab-__codelineno-16-6"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">custom_route</span><span class="p">(</span><span class="s2">&quot;/resources&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#lab01-mcp-fundamentals-lab-__codelineno-16-7"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">resources_list</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONResponse</span><span class="p">:</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#lab01-mcp-fundamentals-lab-__codelineno-16-8"></a>    <span class="n">resources</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#lab01-mcp-fundamentals-lab-__codelineno-16-9"></a>        <span class="p">{</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#lab01-mcp-fundamentals-lab-__codelineno-16-10"></a>            <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;mcp://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#lab01-mcp-fundamentals-lab-__codelineno-16-11"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#lab01-mcp-fundamentals-lab-__codelineno-16-12"></a>            <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#lab01-mcp-fundamentals-lab-__codelineno-16-13"></a>        <span class="p">}</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#lab01-mcp-fundamentals-lab-__codelineno-16-14"></a>    <span class="p">]</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#lab01-mcp-fundamentals-lab-__codelineno-16-15"></a>    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">({</span><span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="n">resources</span><span class="p">})</span>
</span></code></pre></div></p>
<p><strong>Outcome:</strong> Provides access to structured data through URI-based addressing</p>
<h3 id="lab01-mcp-fundamentals-lab-5-sampling-llm-integration">5. <strong>sampling</strong> - LLM Integration<a class="headerlink" href="#lab01-mcp-fundamentals-lab-5-sampling-llm-integration" title="Permanent link">&para;</a></h3>
<p><strong>Location:</strong> <code>/sampling</code> endpoint<br />
<strong>When it happens:</strong> When client needs LLM processing<br />
<strong>How it works:</strong>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab01-mcp-fundamentals-lab-__codelineno-17-1"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">custom_route</span><span class="p">(</span><span class="s2">&quot;/sampling&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">])</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#lab01-mcp-fundamentals-lab-__codelineno-17-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">sampling</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONResponse</span><span class="p">:</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#lab01-mcp-fundamentals-lab-__codelineno-17-3"></a>    <span class="n">body</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#lab01-mcp-fundamentals-lab-__codelineno-17-4"></a>    <span class="n">prompt</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prompt&quot;</span><span class="p">)</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#lab01-mcp-fundamentals-lab-__codelineno-17-5"></a>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#lab01-mcp-fundamentals-lab-__codelineno-17-6"></a>    <span class="c1"># Call LLM API</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#lab01-mcp-fundamentals-lab-__codelineno-17-7"></a>    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">call_llm_api</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#lab01-mcp-fundamentals-lab-__codelineno-17-8"></a>    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">({</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#lab01-mcp-fundamentals-lab-__codelineno-17-9"></a>        <span class="s2">&quot;completion&quot;</span><span class="p">:</span> <span class="n">response</span><span class="p">,</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#lab01-mcp-fundamentals-lab-__codelineno-17-10"></a>        <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;llama3.2:latest&quot;</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#lab01-mcp-fundamentals-lab-__codelineno-17-11"></a>    <span class="p">})</span>
</span></code></pre></div></p>
<p><strong>Outcome:</strong> Enables AI processing through standardized interface</p>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-building-your-own-mcp-components">Building Your Own MCP Components<a class="headerlink" href="#lab01-mcp-fundamentals-lab-building-your-own-mcp-components" title="Permanent link">&para;</a></h2>
<h3 id="lab01-mcp-fundamentals-lab-step-by-step-creating-a-basic-tool">Step-by-Step: Creating a Basic Tool<a class="headerlink" href="#lab01-mcp-fundamentals-lab-step-by-step-creating-a-basic-tool" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab01-mcp-fundamentals-lab-__codelineno-18-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#lab01-mcp-fundamentals-lab-__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#lab01-mcp-fundamentals-lab-__codelineno-18-3"></a><span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;my-basic-server&quot;</span><span class="p">)</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#lab01-mcp-fundamentals-lab-__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#lab01-mcp-fundamentals-lab-__codelineno-18-5"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#lab01-mcp-fundamentals-lab-__codelineno-18-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate_area</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#lab01-mcp-fundamentals-lab-__codelineno-18-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the area of a rectangle&quot;&quot;&quot;</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#lab01-mcp-fundamentals-lab-__codelineno-18-8"></a>    <span class="n">area</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">width</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#lab01-mcp-fundamentals-lab-__codelineno-18-9"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;The area of a rectangle with length </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2"> and width </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">area</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#lab01-mcp-fundamentals-lab-__codelineno-18-10"></a>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#lab01-mcp-fundamentals-lab-__codelineno-18-11"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;mcp://math-constants&quot;</span><span class="p">)</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#lab01-mcp-fundamentals-lab-__codelineno-18-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_math_constants</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#lab01-mcp-fundamentals-lab-__codelineno-18-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns common mathematical constants&quot;&quot;&quot;</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#lab01-mcp-fundamentals-lab-__codelineno-18-14"></a>    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#lab01-mcp-fundamentals-lab-__codelineno-18-15"></a><span class="s2">Pi: 3.14159</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#lab01-mcp-fundamentals-lab-__codelineno-18-16"></a><span class="s2">E: 2.71828</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#lab01-mcp-fundamentals-lab-__codelineno-18-17"></a><span class="s2">Golden Ratio: 1.61803</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#lab01-mcp-fundamentals-lab-__codelineno-18-18"></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#lab01-mcp-fundamentals-lab-__codelineno-18-19"></a>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#lab01-mcp-fundamentals-lab-__codelineno-18-20"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#lab01-mcp-fundamentals-lab-__codelineno-18-21"></a>    <span class="n">mcp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>What this produces:</strong>
- A tool that can be called by MCP clients
- A resource that can be read by clients
- A complete MCP server ready to run</p>
<p><strong>What&rsquo;s inside each component:</strong>
- <strong>Tool:</strong> Function + JSON schema + metadata
- <strong>Resource:</strong> URI + content generator + MIME type
- <strong>Server:</strong> HTTP handlers + protocol implementation + capability management</p>
<hr />
<h2 id="lab01-mcp-fundamentals-lab-key-takeaways">Key Takeaways<a class="headerlink" href="#lab01-mcp-fundamentals-lab-key-takeaways" title="Permanent link">&para;</a></h2>
<p>✅ MCP consists of <strong>server frameworks</strong>, <strong>tool decorators</strong>, <strong>resource handlers</strong>, and <strong>transport layers</strong></p>
<p>✅ Python methods follow a <strong>clear execution flow</strong>: init → register → run → handle requests</p>
<p>✅ MCP is realized through <strong>protocol standardization</strong>, <strong>component integration</strong>, and <strong>security boundaries</strong></p>
<p>✅ Core primitives handle <strong>discovery</strong> (<code>wellknown/mcp</code>), <strong>connection</strong> (<code>negotiate</code>), <strong>execution</strong> (<code>tool/call</code>), and <strong>data access</strong> (<code>resource/read</code>)</p>
<p>✅ Each step produces <strong>structured outputs</strong> with <strong>clear interfaces</strong> and <strong>validation</strong></p>
<p>✅ <strong>Extra value</strong> comes from <strong>consistency</strong>, <strong>security</strong>, <strong>scalability</strong>, and <strong>developer experience</strong></p>
<h2 id="lab01-mcp-fundamentals-lab-next-steps">Next Steps<a class="headerlink" href="#lab01-mcp-fundamentals-lab-next-steps" title="Permanent link">&para;</a></h2>
<p>In <strong>Lab 2</strong>, you&rsquo;ll get hands-on experience by building your first MCP server from scratch. You&rsquo;ll learn:</p>
<ul>
<li>Setting up the development environment</li>
<li>Creating a basic MCP server structure</li>
<li>Implementing the initialization handshake</li>
<li>Testing your server with an MCP client</li>
</ul>
<h2 id="lab01-mcp-fundamentals-lab-additional-resources">Additional Resources<a class="headerlink" href="#lab01-mcp-fundamentals-lab-additional-resources" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://modelcontextprotocol.io">MCP Official Documentation</a></li>
<li><a href="https://spec.modelcontextprotocol.io">MCP Specification</a></li>
<li><a href="https://github.com/modelcontextprotocol">MCP GitHub Repository</a></li>
<li><a href="https://www.jsonrpc.org/specification">JSON-RPC 2.0 Specification</a></li>
<li><a href="https://github.com/jlowin/fastmcp">FastMCP Python Library</a></li>
</ul>
<hr />
<p><strong>Ready to build your first MCP server? <a href="#lab01-mcp-fundamentals-lab02-first-mcp-server-index.md">Continue to Lab 2!</a></strong></p></section><section class="print-page" id="lab02-first-mcp-server-lab" heading-number="2.4"><h1 id="lab02-first-mcp-server-lab-lab-2-building-your-first-mcp-server">Lab 2: Building Your First MCP Server<a class="headerlink" href="#lab02-first-mcp-server-lab-lab-2-building-your-first-mcp-server" title="Permanent link">&para;</a></h1>
<h2 id="lab02-first-mcp-server-lab-overview">Overview<a class="headerlink" href="#lab02-first-mcp-server-lab-overview" title="Permanent link">&para;</a></h2>
<p>Now that you understand the fundamentals of <code>MCP</code>, it&rsquo;s time to get hands-on! </p>
<p>In this lab, you&rsquo;ll build a complete, working <code>MCP</code> server from scratch. You&rsquo;ll learn how to set up the project, implement the core protocol, and connect it to an <code>MCP</code> client.</p>
<hr />
<h2 id="lab02-first-mcp-server-lab-learning-objectives">Learning Objectives<a class="headerlink" href="#lab02-first-mcp-server-lab-learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lab, you will:</p>
<ul>
<li>Set up a Node.js / TypeScript project for <code>MCP</code> development</li>
<li>Implement the <code>MCP</code> initialization handshake</li>
<li>Create a basic server structure using the <code>MCP</code> SDK</li>
<li>Test your server with a real <code>MCP</code> client</li>
<li>Understand the request/response lifecycle</li>
<li>Debug and troubleshoot common issues</li>
</ul>
<hr />
<h2 id="lab02-first-mcp-server-lab-prerequisites">Prerequisites<a class="headerlink" href="#lab02-first-mcp-server-lab-prerequisites" title="Permanent link">&para;</a></h2>
<p>Before starting, ensure you have:</p>
<ul>
<li><strong>Node.js</strong> (v18 or later) installed</li>
<li><strong>npm</strong> or <strong>yarn</strong> package manager</li>
<li>A code editor (<strong>VS Code</strong> recommended)</li>
<li>Basic understanding of <strong>JavaScript</strong> / <strong>TypeScript</strong></li>
<li>Completed <a href="#lab02-first-mcp-server-lab01-mcp-fundamentals-index.md">Lab 1 - MCP Fundamentals</a></li>
</ul>
<p>To verify your prerequisites are installed correctly, run the following commands:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab02-first-mcp-server-lab-__codelineno-0-1"></a><span class="c1"># Check Node.js version</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab02-first-mcp-server-lab-__codelineno-0-2"></a>node<span class="w"> </span>--version
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab02-first-mcp-server-lab-__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab02-first-mcp-server-lab-__codelineno-0-4"></a><span class="c1"># Check yarn version</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#lab02-first-mcp-server-lab-__codelineno-0-5"></a>yarn<span class="w"> </span>--version
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#lab02-first-mcp-server-lab-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#lab02-first-mcp-server-lab-__codelineno-0-7"></a><span class="c1"># Check npm version</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#lab02-first-mcp-server-lab-__codelineno-0-8"></a>npm<span class="w"> </span>--version
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#lab02-first-mcp-server-lab-__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#lab02-first-mcp-server-lab-__codelineno-0-10"></a><span class="c1"># Check JavaScript version (via Node.js V8 engine)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#lab02-first-mcp-server-lab-__codelineno-0-11"></a>node<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;console.log(&#39;V8 version:&#39;, process.versions.v8)&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#lab02-first-mcp-server-lab-__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#lab02-first-mcp-server-lab-__codelineno-0-13"></a><span class="c1"># Check VS Code version</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#lab02-first-mcp-server-lab-__codelineno-0-14"></a>code<span class="w"> </span>--version
</span></code></pre></div>
<hr />
<h2 id="lab02-first-mcp-server-lab-project-setup">Project Setup<a class="headerlink" href="#lab02-first-mcp-server-lab-project-setup" title="Permanent link">&para;</a></h2>
<h3 id="lab02-first-mcp-server-lab-step-1-initialize-your-project">Step 1: Initialize Your Project<a class="headerlink" href="#lab02-first-mcp-server-lab-step-1-initialize-your-project" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Create a new directory for your <code>MCP</code> server, navigate into it, and initialize a new Node.js project:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab02-first-mcp-server-lab-__codelineno-1-1"></a>mkdir<span class="w"> </span>my-first-mcp-server
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#lab02-first-mcp-server-lab-__codelineno-1-2"></a><span class="nb">cd</span><span class="w"> </span>my-first-mcp-server
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#lab02-first-mcp-server-lab-__codelineno-1-3"></a>npm<span class="w"> </span>init<span class="w"> </span>-y
</span></code></pre></div>
</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-step-2-install-dependencies">Step 2: Install Dependencies<a class="headerlink" href="#lab02-first-mcp-server-lab-step-2-install-dependencies" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Install the MCP SDK and TypeScript dependencies using npm and build tool:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab02-first-mcp-server-lab-__codelineno-2-1"></a><span class="c1"># Core MCP SDK</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#lab02-first-mcp-server-lab-__codelineno-2-2"></a>npm<span class="w"> </span>install<span class="w"> </span>@modelcontextprotocol/sdk
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#lab02-first-mcp-server-lab-__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#lab02-first-mcp-server-lab-__codelineno-2-4"></a><span class="c1"># TypeScript and type definitions</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#lab02-first-mcp-server-lab-__codelineno-2-5"></a>npm<span class="w"> </span>install<span class="w"> </span>-D<span class="w"> </span>typescript<span class="w"> </span>@types/node
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#lab02-first-mcp-server-lab-__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#lab02-first-mcp-server-lab-__codelineno-2-7"></a><span class="c1"># Build tool</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#lab02-first-mcp-server-lab-__codelineno-2-8"></a>npm<span class="w"> </span>install<span class="w"> </span>-D<span class="w"> </span>tsx
</span></code></pre></div>
</li>
<li>
<p>To verify TypeScript installation:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab02-first-mcp-server-lab-__codelineno-3-1"></a>tsc<span class="w"> </span>--version
</span></code></pre></div>
</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-step-3-configure-typescript">Step 3: Configure TypeScript<a class="headerlink" href="#lab02-first-mcp-server-lab-step-3-configure-typescript" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Create a <code>tsconfig.json</code> file:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab02-first-mcp-server-lab-__codelineno-4-1"></a><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#lab02-first-mcp-server-lab-__codelineno-4-2"></a><span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#lab02-first-mcp-server-lab-__codelineno-4-3"></a><span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES2022&quot;</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#lab02-first-mcp-server-lab-__codelineno-4-4"></a><span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Node16&quot;</span><span class="p">,</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#lab02-first-mcp-server-lab-__codelineno-4-5"></a><span class="w">    </span><span class="nt">&quot;moduleResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Node16&quot;</span><span class="p">,</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#lab02-first-mcp-server-lab-__codelineno-4-6"></a><span class="w">    </span><span class="nt">&quot;outDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./dist&quot;</span><span class="p">,</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#lab02-first-mcp-server-lab-__codelineno-4-7"></a><span class="w">    </span><span class="nt">&quot;rootDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src&quot;</span><span class="p">,</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#lab02-first-mcp-server-lab-__codelineno-4-8"></a><span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#lab02-first-mcp-server-lab-__codelineno-4-9"></a><span class="w">    </span><span class="nt">&quot;esModuleInterop&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#lab02-first-mcp-server-lab-__codelineno-4-10"></a><span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#lab02-first-mcp-server-lab-__codelineno-4-11"></a><span class="w">    </span><span class="nt">&quot;forceConsistentCasingInFileNames&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#lab02-first-mcp-server-lab-__codelineno-4-12"></a><span class="w">    </span><span class="nt">&quot;resolveJsonModule&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#lab02-first-mcp-server-lab-__codelineno-4-13"></a><span class="w">    </span><span class="nt">&quot;declaration&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#lab02-first-mcp-server-lab-__codelineno-4-14"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#lab02-first-mcp-server-lab-__codelineno-4-15"></a><span class="w">  </span><span class="nt">&quot;include&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/**/*&quot;</span><span class="p">],</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#lab02-first-mcp-server-lab-__codelineno-4-16"></a><span class="w">  </span><span class="nt">&quot;exclude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node_modules&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dist&quot;</span><span class="p">]</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#lab02-first-mcp-server-lab-__codelineno-4-17"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-step-4-update-packagejson">Step 4: Update package.json<a class="headerlink" href="#lab02-first-mcp-server-lab-step-4-update-packagejson" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Replace (copy / paste) the entire content of the file <code>package.json</code>, located inside the previously created <code>my-first-mcp-server</code> directory, with the following content to add scripts and set module type:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab02-first-mcp-server-lab-__codelineno-5-1"></a><span class="p">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#lab02-first-mcp-server-lab-__codelineno-5-2"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-first-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#lab02-first-mcp-server-lab-__codelineno-5-3"></a><span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#lab02-first-mcp-server-lab-__codelineno-5-4"></a><span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;module&quot;</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#lab02-first-mcp-server-lab-__codelineno-5-5"></a><span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;My first MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#lab02-first-mcp-server-lab-__codelineno-5-6"></a><span class="w">  </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dist/index.js&quot;</span><span class="p">,</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#lab02-first-mcp-server-lab-__codelineno-5-7"></a><span class="w">  </span><span class="nt">&quot;scripts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#lab02-first-mcp-server-lab-__codelineno-5-8"></a><span class="w">    </span><span class="nt">&quot;build&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tsc&quot;</span><span class="p">,</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#lab02-first-mcp-server-lab-__codelineno-5-9"></a><span class="w">    </span><span class="nt">&quot;dev&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tsx src/index.ts&quot;</span><span class="p">,</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#lab02-first-mcp-server-lab-__codelineno-5-10"></a><span class="w">    </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;node dist/index.js&quot;</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#lab02-first-mcp-server-lab-__codelineno-5-11"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#lab02-first-mcp-server-lab-__codelineno-5-12"></a><span class="w">  </span><span class="nt">&quot;keywords&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;mcp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;server&quot;</span><span class="p">],</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#lab02-first-mcp-server-lab-__codelineno-5-13"></a><span class="w">  </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Your Name&quot;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#lab02-first-mcp-server-lab-__codelineno-5-14"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<h2 id="lab02-first-mcp-server-lab-building-the-mcp-server">Building the MCP Server<a class="headerlink" href="#lab02-first-mcp-server-lab-building-the-mcp-server" title="Permanent link">&para;</a></h2>
<h3 id="lab02-first-mcp-server-lab-step-5-create-the-server-structure">Step 5: Create the Server Structure<a class="headerlink" href="#lab02-first-mcp-server-lab-step-5-create-the-server-structure" title="Permanent link">&para;</a></h3>
<ul>
<li>Create a directory named <code>src</code> inside <code>my-first-mcp-server</code>.</li>
<li>
<p>Create a file named <code>index.ts</code> inside the <code>src</code> directory and fill it with the following basic server skeleton code (copy / paste inside the file):</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab02-first-mcp-server-lab-__codelineno-6-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab02-first-mcp-server-lab-__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#lab02-first-mcp-server-lab-__codelineno-6-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#lab02-first-mcp-server-lab-__codelineno-6-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#lab02-first-mcp-server-lab-__codelineno-6-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#lab02-first-mcp-server-lab-__codelineno-6-6"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#lab02-first-mcp-server-lab-__codelineno-6-7"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#lab02-first-mcp-server-lab-__codelineno-6-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#lab02-first-mcp-server-lab-__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#lab02-first-mcp-server-lab-__codelineno-6-10"></a><span class="cm">/**</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#lab02-first-mcp-server-lab-__codelineno-6-11"></a><span class="cm">* Create an MCP server with core capabilities</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#lab02-first-mcp-server-lab-__codelineno-6-12"></a><span class="cm">*/</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#lab02-first-mcp-server-lab-__codelineno-6-13"></a><span class="kd">class</span><span class="w"> </span><span class="nx">MyFirstMCPServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#lab02-first-mcp-server-lab-__codelineno-6-14"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#lab02-first-mcp-server-lab-__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#lab02-first-mcp-server-lab-__codelineno-6-16"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#lab02-first-mcp-server-lab-__codelineno-6-17"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#lab02-first-mcp-server-lab-__codelineno-6-18"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#lab02-first-mcp-server-lab-__codelineno-6-19"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;my-first-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#lab02-first-mcp-server-lab-__codelineno-6-20"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#lab02-first-mcp-server-lab-__codelineno-6-21"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#lab02-first-mcp-server-lab-__codelineno-6-22"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#lab02-first-mcp-server-lab-__codelineno-6-23"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#lab02-first-mcp-server-lab-__codelineno-6-24"></a><span class="w">          </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#lab02-first-mcp-server-lab-__codelineno-6-25"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#lab02-first-mcp-server-lab-__codelineno-6-26"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#lab02-first-mcp-server-lab-__codelineno-6-27"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#lab02-first-mcp-server-lab-__codelineno-6-28"></a>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#lab02-first-mcp-server-lab-__codelineno-6-29"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#lab02-first-mcp-server-lab-__codelineno-6-30"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#lab02-first-mcp-server-lab-__codelineno-6-31"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#lab02-first-mcp-server-lab-__codelineno-6-32"></a>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#lab02-first-mcp-server-lab-__codelineno-6-33"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#lab02-first-mcp-server-lab-__codelineno-6-34"></a><span class="cm">  * Set up request handlers</span>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#lab02-first-mcp-server-lab-__codelineno-6-35"></a><span class="cm">  */</span>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#lab02-first-mcp-server-lab-__codelineno-6-36"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#lab02-first-mcp-server-lab-__codelineno-6-37"></a><span class="w">    </span><span class="c1">// Handler for listing available tools</span>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#lab02-first-mcp-server-lab-__codelineno-6-38"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#lab02-first-mcp-server-lab-__codelineno-6-39"></a><span class="w">      </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#lab02-first-mcp-server-lab-__codelineno-6-40"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#lab02-first-mcp-server-lab-__codelineno-6-41"></a><span class="w">        </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#lab02-first-mcp-server-lab-__codelineno-6-42"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#lab02-first-mcp-server-lab-__codelineno-6-43"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hello_world&quot;</span><span class="p">,</span>
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#lab02-first-mcp-server-lab-__codelineno-6-44"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Returns a friendly greeting message&quot;</span><span class="p">,</span>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#lab02-first-mcp-server-lab-__codelineno-6-45"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#lab02-first-mcp-server-lab-__codelineno-6-46"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#lab02-first-mcp-server-lab-__codelineno-6-47"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#lab02-first-mcp-server-lab-__codelineno-6-48"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#lab02-first-mcp-server-lab-__codelineno-6-49"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#lab02-first-mcp-server-lab-__codelineno-6-50"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The name to greet&quot;</span><span class="p">,</span>
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#lab02-first-mcp-server-lab-__codelineno-6-51"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#lab02-first-mcp-server-lab-__codelineno-6-52"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#lab02-first-mcp-server-lab-__codelineno-6-53"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#lab02-first-mcp-server-lab-__codelineno-6-54"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#lab02-first-mcp-server-lab-__codelineno-6-55"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#lab02-first-mcp-server-lab-__codelineno-6-56"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#lab02-first-mcp-server-lab-__codelineno-6-57"></a><span class="w">      </span><span class="p">})</span>
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#lab02-first-mcp-server-lab-__codelineno-6-58"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#lab02-first-mcp-server-lab-__codelineno-6-59"></a>
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#lab02-first-mcp-server-lab-__codelineno-6-60"></a><span class="w">    </span><span class="c1">// Handler for calling tools</span>
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#lab02-first-mcp-server-lab-__codelineno-6-61"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#lab02-first-mcp-server-lab-__codelineno-6-62"></a><span class="w">      </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#lab02-first-mcp-server-lab-__codelineno-6-63"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#lab02-first-mcp-server-lab-__codelineno-6-64"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#lab02-first-mcp-server-lab-__codelineno-6-65"></a>
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#lab02-first-mcp-server-lab-__codelineno-6-66"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;hello_world&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#lab02-first-mcp-server-lab-__codelineno-6-67"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#lab02-first-mcp-server-lab-__codelineno-6-68"></a>
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#lab02-first-mcp-server-lab-__codelineno-6-69"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">userName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-70"><a id="__codelineno-6-70" name="__codelineno-6-70" href="#lab02-first-mcp-server-lab-__codelineno-6-70"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Name parameter is required&quot;</span><span class="p">);</span>
</span><span id="__span-6-71"><a id="__codelineno-6-71" name="__codelineno-6-71" href="#lab02-first-mcp-server-lab-__codelineno-6-71"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-6-72"><a id="__codelineno-6-72" name="__codelineno-6-72" href="#lab02-first-mcp-server-lab-__codelineno-6-72"></a>
</span><span id="__span-6-73"><a id="__codelineno-6-73" name="__codelineno-6-73" href="#lab02-first-mcp-server-lab-__codelineno-6-73"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-74"><a id="__codelineno-6-74" name="__codelineno-6-74" href="#lab02-first-mcp-server-lab-__codelineno-6-74"></a><span class="w">            </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-6-75"><a id="__codelineno-6-75" name="__codelineno-6-75" href="#lab02-first-mcp-server-lab-__codelineno-6-75"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-6-76"><a id="__codelineno-6-76" name="__codelineno-6-76" href="#lab02-first-mcp-server-lab-__codelineno-6-76"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-6-77"><a id="__codelineno-6-77" name="__codelineno-6-77" href="#lab02-first-mcp-server-lab-__codelineno-6-77"></a><span class="w">                </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Hello, </span><span class="si">${</span><span class="nx">userName</span><span class="si">}</span><span class="sb">! Welcome to your first MCP server! 🎉`</span><span class="p">,</span>
</span><span id="__span-6-78"><a id="__codelineno-6-78" name="__codelineno-6-78" href="#lab02-first-mcp-server-lab-__codelineno-6-78"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-6-79"><a id="__codelineno-6-79" name="__codelineno-6-79" href="#lab02-first-mcp-server-lab-__codelineno-6-79"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-6-80"><a id="__codelineno-6-80" name="__codelineno-6-80" href="#lab02-first-mcp-server-lab-__codelineno-6-80"></a><span class="w">          </span><span class="p">};</span>
</span><span id="__span-6-81"><a id="__codelineno-6-81" name="__codelineno-6-81" href="#lab02-first-mcp-server-lab-__codelineno-6-81"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-6-82"><a id="__codelineno-6-82" name="__codelineno-6-82" href="#lab02-first-mcp-server-lab-__codelineno-6-82"></a>
</span><span id="__span-6-83"><a id="__codelineno-6-83" name="__codelineno-6-83" href="#lab02-first-mcp-server-lab-__codelineno-6-83"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-6-84"><a id="__codelineno-6-84" name="__codelineno-6-84" href="#lab02-first-mcp-server-lab-__codelineno-6-84"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-6-85"><a id="__codelineno-6-85" name="__codelineno-6-85" href="#lab02-first-mcp-server-lab-__codelineno-6-85"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-6-86"><a id="__codelineno-6-86" name="__codelineno-6-86" href="#lab02-first-mcp-server-lab-__codelineno-6-86"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-87"><a id="__codelineno-6-87" name="__codelineno-6-87" href="#lab02-first-mcp-server-lab-__codelineno-6-87"></a>
</span><span id="__span-6-88"><a id="__codelineno-6-88" name="__codelineno-6-88" href="#lab02-first-mcp-server-lab-__codelineno-6-88"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-6-89"><a id="__codelineno-6-89" name="__codelineno-6-89" href="#lab02-first-mcp-server-lab-__codelineno-6-89"></a><span class="cm">  * Set up error handling</span>
</span><span id="__span-6-90"><a id="__codelineno-6-90" name="__codelineno-6-90" href="#lab02-first-mcp-server-lab-__codelineno-6-90"></a><span class="cm">  */</span>
</span><span id="__span-6-91"><a id="__codelineno-6-91" name="__codelineno-6-91" href="#lab02-first-mcp-server-lab-__codelineno-6-91"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-92"><a id="__codelineno-6-92" name="__codelineno-6-92" href="#lab02-first-mcp-server-lab-__codelineno-6-92"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-93"><a id="__codelineno-6-93" name="__codelineno-6-93" href="#lab02-first-mcp-server-lab-__codelineno-6-93"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-6-94"><a id="__codelineno-6-94" name="__codelineno-6-94" href="#lab02-first-mcp-server-lab-__codelineno-6-94"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-6-95"><a id="__codelineno-6-95" name="__codelineno-6-95" href="#lab02-first-mcp-server-lab-__codelineno-6-95"></a>
</span><span id="__span-6-96"><a id="__codelineno-6-96" name="__codelineno-6-96" href="#lab02-first-mcp-server-lab-__codelineno-6-96"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-97"><a id="__codelineno-6-97" name="__codelineno-6-97" href="#lab02-first-mcp-server-lab-__codelineno-6-97"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-6-98"><a id="__codelineno-6-98" name="__codelineno-6-98" href="#lab02-first-mcp-server-lab-__codelineno-6-98"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-6-99"><a id="__codelineno-6-99" name="__codelineno-6-99" href="#lab02-first-mcp-server-lab-__codelineno-6-99"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-6-100"><a id="__codelineno-6-100" name="__codelineno-6-100" href="#lab02-first-mcp-server-lab-__codelineno-6-100"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-101"><a id="__codelineno-6-101" name="__codelineno-6-101" href="#lab02-first-mcp-server-lab-__codelineno-6-101"></a>
</span><span id="__span-6-102"><a id="__codelineno-6-102" name="__codelineno-6-102" href="#lab02-first-mcp-server-lab-__codelineno-6-102"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-6-103"><a id="__codelineno-6-103" name="__codelineno-6-103" href="#lab02-first-mcp-server-lab-__codelineno-6-103"></a><span class="cm">  * Start the server</span>
</span><span id="__span-6-104"><a id="__codelineno-6-104" name="__codelineno-6-104" href="#lab02-first-mcp-server-lab-__codelineno-6-104"></a><span class="cm">  */</span>
</span><span id="__span-6-105"><a id="__codelineno-6-105" name="__codelineno-6-105" href="#lab02-first-mcp-server-lab-__codelineno-6-105"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-106"><a id="__codelineno-6-106" name="__codelineno-6-106" href="#lab02-first-mcp-server-lab-__codelineno-6-106"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-6-107"><a id="__codelineno-6-107" name="__codelineno-6-107" href="#lab02-first-mcp-server-lab-__codelineno-6-107"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-6-108"><a id="__codelineno-6-108" name="__codelineno-6-108" href="#lab02-first-mcp-server-lab-__codelineno-6-108"></a>
</span><span id="__span-6-109"><a id="__codelineno-6-109" name="__codelineno-6-109" href="#lab02-first-mcp-server-lab-__codelineno-6-109"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;My First MCP Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-6-110"><a id="__codelineno-6-110" name="__codelineno-6-110" href="#lab02-first-mcp-server-lab-__codelineno-6-110"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-111"><a id="__codelineno-6-111" name="__codelineno-6-111" href="#lab02-first-mcp-server-lab-__codelineno-6-111"></a><span class="p">}</span>
</span><span id="__span-6-112"><a id="__codelineno-6-112" name="__codelineno-6-112" href="#lab02-first-mcp-server-lab-__codelineno-6-112"></a>
</span><span id="__span-6-113"><a id="__codelineno-6-113" name="__codelineno-6-113" href="#lab02-first-mcp-server-lab-__codelineno-6-113"></a><span class="cm">/**</span>
</span><span id="__span-6-114"><a id="__codelineno-6-114" name="__codelineno-6-114" href="#lab02-first-mcp-server-lab-__codelineno-6-114"></a><span class="cm">* Main entry point</span>
</span><span id="__span-6-115"><a id="__codelineno-6-115" name="__codelineno-6-115" href="#lab02-first-mcp-server-lab-__codelineno-6-115"></a><span class="cm">*/</span>
</span><span id="__span-6-116"><a id="__codelineno-6-116" name="__codelineno-6-116" href="#lab02-first-mcp-server-lab-__codelineno-6-116"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-117"><a id="__codelineno-6-117" name="__codelineno-6-117" href="#lab02-first-mcp-server-lab-__codelineno-6-117"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MyFirstMCPServer</span><span class="p">();</span>
</span><span id="__span-6-118"><a id="__codelineno-6-118" name="__codelineno-6-118" href="#lab02-first-mcp-server-lab-__codelineno-6-118"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-6-119"><a id="__codelineno-6-119" name="__codelineno-6-119" href="#lab02-first-mcp-server-lab-__codelineno-6-119"></a><span class="p">}</span>
</span><span id="__span-6-120"><a id="__codelineno-6-120" name="__codelineno-6-120" href="#lab02-first-mcp-server-lab-__codelineno-6-120"></a>
</span><span id="__span-6-121"><a id="__codelineno-6-121" name="__codelineno-6-121" href="#lab02-first-mcp-server-lab-__codelineno-6-121"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-122"><a id="__codelineno-6-122" name="__codelineno-6-122" href="#lab02-first-mcp-server-lab-__codelineno-6-122"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-6-123"><a id="__codelineno-6-123" name="__codelineno-6-123" href="#lab02-first-mcp-server-lab-__codelineno-6-123"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-6-124"><a id="__codelineno-6-124" name="__codelineno-6-124" href="#lab02-first-mcp-server-lab-__codelineno-6-124"></a><span class="p">});</span>
</span></code></pre></div>
</li>
</ul>
<h2 id="lab02-first-mcp-server-lab-understanding-the-code">Understanding the Code<a class="headerlink" href="#lab02-first-mcp-server-lab-understanding-the-code" title="Permanent link">&para;</a></h2>
<p>Let&rsquo;s break down the key components:</p>
<h3 id="lab02-first-mcp-server-lab-1-server-initialization">1. <strong>Server Initialization</strong><a class="headerlink" href="#lab02-first-mcp-server-lab-1-server-initialization" title="Permanent link">&para;</a></h3>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab02-first-mcp-server-lab-__codelineno-7-1"></a><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#lab02-first-mcp-server-lab-__codelineno-7-2"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#lab02-first-mcp-server-lab-__codelineno-7-3"></a><span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;my-first-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#lab02-first-mcp-server-lab-__codelineno-7-4"></a><span class="w">    </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#lab02-first-mcp-server-lab-__codelineno-7-5"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#lab02-first-mcp-server-lab-__codelineno-7-6"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#lab02-first-mcp-server-lab-__codelineno-7-7"></a><span class="w">    </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#lab02-first-mcp-server-lab-__codelineno-7-8"></a><span class="w">      </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#lab02-first-mcp-server-lab-__codelineno-7-9"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#lab02-first-mcp-server-lab-__codelineno-7-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#lab02-first-mcp-server-lab-__codelineno-7-11"></a><span class="p">);</span>
</span></code></pre></div>
<ul>
<li>Defines server metadata (name and version)</li>
<li>Declares capabilities (in this case, the server supports tools)</li>
<li>This information is sent during the initialization handshake</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-2-list-tools-handler">2. <strong>List Tools Handler</strong><a class="headerlink" href="#lab02-first-mcp-server-lab-2-list-tools-handler" title="Permanent link">&para;</a></h3>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab02-first-mcp-server-lab-__codelineno-8-1"></a><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#lab02-first-mcp-server-lab-__codelineno-8-2"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#lab02-first-mcp-server-lab-__codelineno-8-3"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#lab02-first-mcp-server-lab-__codelineno-8-4"></a><span class="w">    </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[...],</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#lab02-first-mcp-server-lab-__codelineno-8-5"></a><span class="w">  </span><span class="p">})</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#lab02-first-mcp-server-lab-__codelineno-8-6"></a><span class="p">);</span>
</span></code></pre></div>
<ul>
<li>Responds to <code>tools/list</code> requests from clients</li>
<li>Returns an array of tool definitions</li>
<li>Each tool has: name, description and inputSchema (JSON Schema)</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-3-call-tool-handler">3. <strong>Call Tool Handler</strong><a class="headerlink" href="#lab02-first-mcp-server-lab-3-call-tool-handler" title="Permanent link">&para;</a></h3>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab02-first-mcp-server-lab-__codelineno-9-1"></a><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#lab02-first-mcp-server-lab-__codelineno-9-2"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#lab02-first-mcp-server-lab-__codelineno-9-3"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#lab02-first-mcp-server-lab-__codelineno-9-4"></a><span class="w">    </span><span class="c1">// Tool execution logic</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#lab02-first-mcp-server-lab-__codelineno-9-5"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#lab02-first-mcp-server-lab-__codelineno-9-6"></a><span class="p">);</span>
</span></code></pre></div>
<ul>
<li>Responds to <code>tools/call</code> requests</li>
<li>Receives tool name and arguments</li>
<li>Returns tool results in a standardized format</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-4-transport-layer">4. <strong>Transport Layer</strong><a class="headerlink" href="#lab02-first-mcp-server-lab-4-transport-layer" title="Permanent link">&para;</a></h3>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab02-first-mcp-server-lab-__codelineno-10-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#lab02-first-mcp-server-lab-__codelineno-10-2"></a><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span></code></pre></div>
<ul>
<li>Uses stdio (standard input/output) for communication</li>
<li>Server runs as a subprocess of the client</li>
<li>All <code>MCP</code> messages flow through stdin/stdout</li>
</ul>
<hr />
<h2 id="lab02-first-mcp-server-lab-testing-your-server">Testing Your Server<a class="headerlink" href="#lab02-first-mcp-server-lab-testing-your-server" title="Permanent link">&para;</a></h2>
<h3 id="lab02-first-mcp-server-lab-testing-with-the-mcp-inspector">Testing with the MCP Inspector<a class="headerlink" href="#lab02-first-mcp-server-lab-testing-with-the-mcp-inspector" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>The MCP Inspector is a web-based tool for testing MCP servers. Run these commands from your <code>my-first-mcp-server</code> directory:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#lab02-first-mcp-server-lab-__codelineno-11-1"></a><span class="c1"># Install the inspector globally</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#lab02-first-mcp-server-lab-__codelineno-11-2"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@modelcontextprotocol/inspector
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#lab02-first-mcp-server-lab-__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#lab02-first-mcp-server-lab-__codelineno-11-4"></a><span class="c1"># Run your server with the inspector</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#lab02-first-mcp-server-lab-__codelineno-11-5"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
</li>
<li>
<p>This will open a web interface where you can:</p>
<ul>
<li>See the server&rsquo;s capabilities</li>
<li>List available tools</li>
<li>Call tools with test inputs</li>
<li>View request/response messages</li>
</ul>
</li>
</ul>
<h4 id="lab02-first-mcp-server-lab-how-to-test">How to Test:<a class="headerlink" href="#lab02-first-mcp-server-lab-how-to-test" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Open the Inspector</strong>: After running the command above, your default web browser should automatically open to the MCP Inspector interface (typically at <code>http://localhost:3000</code> or similar).</p>
</li>
<li>
<p><strong>Connect to the Server</strong>: Look for a &ldquo;Connect&rdquo; button and click it. You should see a &ldquo;Connected&rdquo; status indicator. If the server fails to connect, check the terminal for error messages.</p>
</li>
<li>
<p><strong>List Tools</strong>: Click on the &ldquo;Tools&rdquo; tab and then the &ldquo;List Tools&rdquo; button. You should see your <code>hello_world</code> tool appear in the list with its description and input schema. This confirms the server connection and capabilities.</p>
</li>
<li>
<p><strong>Call a Tool</strong>: In the &ldquo;Tools&rdquo; tab, select the <code>hello_world</code> tool from the dropdown. Enter a name in the &ldquo;name&rdquo; field and click &ldquo;Run Tool&rdquo;.</p>
</li>
<li>
<p><strong>View Results</strong>: The response should appear below, showing the greeting message. Check the logs or response sections for any errors or debug information.</p>
</li>
<li>
<p><strong>Test Error Handling</strong>: Try calling the tool without any input in the  &ldquo;name&rdquo; field to see how your server handles errors.</p>
</li>
<li>
<p><strong>Monitor Messages</strong>: Check the response areas in the Tools tab or other sections to see details about the JSON-RPC messages being exchanged.</p>
</li>
</ol>
<hr />
<h2 id="lab02-first-mcp-server-lab-the-request-response-lifecycle">The Request - Response Lifecycle<a class="headerlink" href="#lab02-first-mcp-server-lab-the-request-response-lifecycle" title="Permanent link">&para;</a></h2>
<p>Here&rsquo;s what happens when a tool is called:</p>
<pre class="mermaid"><code>sequenceDiagram
    participant Client
    participant Server

    Client-&gt;&gt;Server: tools/list request
    Note over Server: Process request:&lt;br/&gt;- Match handler&lt;br/&gt;- Execute handler function
    Server--&gt;&gt;Client: tools/list response&lt;br/&gt;(list of available tools)

    Client-&gt;&gt;Server: tools/call request&lt;br/&gt;{ name: "hello_world",&lt;br/&gt;arguments: { name: "Alice" } }
    Note over Server: Process request:&lt;br/&gt;- Validate tool name&lt;br/&gt;- Validate arguments&lt;br/&gt;- Execute tool logic&lt;br/&gt;- Format response
    Server--&gt;&gt;Client: tools/call response&lt;br/&gt;{ content: [...] }</code></pre>
<hr />
<h2 id="lab02-first-mcp-server-lab-error-handling-best-practices">Error Handling Best Practices<a class="headerlink" href="#lab02-first-mcp-server-lab-error-handling-best-practices" title="Permanent link">&para;</a></h2>
<p>Proper error handling is crucial for <code>MCP</code> servers! </p>
<p>Here&rsquo;s how to implement robust error handling, step by step:</p>
<h3 id="lab02-first-mcp-server-lab-1-validate-inputs">1. <strong>Validate Inputs</strong><a class="headerlink" href="#lab02-first-mcp-server-lab-1-validate-inputs" title="Permanent link">&para;</a></h3>
<p><strong>Why</strong>: Always validate input parameters before processing to prevent runtime errors and provide clear feedback to clients.</p>
<p><strong>Step-by-step implementation</strong>:</p>
<ol>
<li>
<p><strong>Check for required parameters</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab02-first-mcp-server-lab-__codelineno-12-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">userName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#lab02-first-mcp-server-lab-__codelineno-12-2"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Name parameter is required&quot;</span><span class="p">);</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#lab02-first-mcp-server-lab-__codelineno-12-3"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Validate parameter types</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab02-first-mcp-server-lab-__codelineno-13-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">userName</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#lab02-first-mcp-server-lab-__codelineno-13-2"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Name parameter must be a string&quot;</span><span class="p">);</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#lab02-first-mcp-server-lab-__codelineno-13-3"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Combine validation checks</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab02-first-mcp-server-lab-__codelineno-14-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">userName</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">userName</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#lab02-first-mcp-server-lab-__codelineno-14-2"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Name parameter is required and must be a string&quot;</span><span class="p">);</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#lab02-first-mcp-server-lab-__codelineno-14-3"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Validate against schema constraints</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab02-first-mcp-server-lab-__codelineno-15-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">userName</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab02-first-mcp-server-lab-__codelineno-15-2"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Name parameter cannot be empty&quot;</span><span class="p">);</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#lab02-first-mcp-server-lab-__codelineno-15-3"></a><span class="p">}</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#lab02-first-mcp-server-lab-__codelineno-15-4"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">userName</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#lab02-first-mcp-server-lab-__codelineno-15-5"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Name parameter cannot exceed 100 characters&quot;</span><span class="p">);</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#lab02-first-mcp-server-lab-__codelineno-15-6"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
</ol>
<h3 id="lab02-first-mcp-server-lab-2-provide-helpful-error-messages">2. <strong>Provide Helpful Error Messages</strong><a class="headerlink" href="#lab02-first-mcp-server-lab-2-provide-helpful-error-messages" title="Permanent link">&para;</a></h3>
<p><strong>Why</strong>: Clear error messages help developers understand what went wrong and how to fix it.</p>
<p><strong>Step-by-step implementation</strong>:</p>
<ol>
<li>
<p><strong>Include the problematic value in the error</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#lab02-first-mcp-server-lab-__codelineno-16-1"></a><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Suggest available alternatives</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab02-first-mcp-server-lab-__codelineno-17-1"></a><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">. Available tools: hello_world`</span><span class="p">);</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Provide context about what was expected</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab02-first-mcp-server-lab-__codelineno-18-1"></a><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid operation: </span><span class="si">${</span><span class="nx">operation</span><span class="si">}</span><span class="sb">. Expected: add, subtract, multiply, or divide`</span><span class="p">);</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Include parameter names for clarity</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#lab02-first-mcp-server-lab-__codelineno-19-1"></a><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Parameter &#39;count&#39; must be a positive number, got: </span><span class="si">${</span><span class="nx">count</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></code></pre></div></p>
</li>
</ol>
<h3 id="lab02-first-mcp-server-lab-3-handle-async-errors">3. <strong>Handle Async Errors</strong><a class="headerlink" href="#lab02-first-mcp-server-lab-3-handle-async-errors" title="Permanent link">&para;</a></h3>
<p><strong>Why</strong>: Asynchronous operations can fail, and these errors need to be caught and handled properly.</p>
<p><strong>Step-by-step implementation</strong>:</p>
<ol>
<li>
<p><strong>Wrap async operations in try-catch</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#lab02-first-mcp-server-lab-__codelineno-20-1"></a><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#lab02-first-mcp-server-lab-__codelineno-20-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">someAsyncOperation</span><span class="p">();</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#lab02-first-mcp-server-lab-__codelineno-20-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">result</span><span class="w"> </span><span class="p">}]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#lab02-first-mcp-server-lab-__codelineno-20-4"></a><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#lab02-first-mcp-server-lab-__codelineno-20-5"></a><span class="w">  </span><span class="c1">// Handle the error</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#lab02-first-mcp-server-lab-__codelineno-20-6"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Extract error information safely</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#lab02-first-mcp-server-lab-__codelineno-21-1"></a><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#lab02-first-mcp-server-lab-__codelineno-21-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">someAsyncOperation</span><span class="p">();</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#lab02-first-mcp-server-lab-__codelineno-21-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">result</span><span class="w"> </span><span class="p">}]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#lab02-first-mcp-server-lab-__codelineno-21-4"></a><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#lab02-first-mcp-server-lab-__codelineno-21-5"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error occurred&#39;</span><span class="p">;</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#lab02-first-mcp-server-lab-__codelineno-21-6"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Operation failed: </span><span class="si">${</span><span class="nx">errorMessage</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#lab02-first-mcp-server-lab-__codelineno-21-7"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Preserve original error context</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#lab02-first-mcp-server-lab-__codelineno-22-1"></a><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#lab02-first-mcp-server-lab-__codelineno-22-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">someAsyncOperation</span><span class="p">();</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#lab02-first-mcp-server-lab-__codelineno-22-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">result</span><span class="w"> </span><span class="p">}]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#lab02-first-mcp-server-lab-__codelineno-22-4"></a><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#lab02-first-mcp-server-lab-__codelineno-22-5"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Async operation failed:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#lab02-first-mcp-server-lab-__codelineno-22-6"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Operation failed: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#lab02-first-mcp-server-lab-__codelineno-22-7"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Handle different error types appropriately</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#lab02-first-mcp-server-lab-__codelineno-23-1"></a><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#lab02-first-mcp-server-lab-__codelineno-23-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">someAsyncOperation</span><span class="p">();</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#lab02-first-mcp-server-lab-__codelineno-23-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">result</span><span class="w"> </span><span class="p">}]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#lab02-first-mcp-server-lab-__codelineno-23-4"></a><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#lab02-first-mcp-server-lab-__codelineno-23-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ENOTFOUND&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#lab02-first-mcp-server-lab-__codelineno-23-6"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Network connection failed. Please check your internet connection.&#39;</span><span class="p">);</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#lab02-first-mcp-server-lab-__codelineno-23-7"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ETIMEDOUT&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#lab02-first-mcp-server-lab-__codelineno-23-8"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Operation timed out. Please try again.&#39;</span><span class="p">);</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#lab02-first-mcp-server-lab-__codelineno-23-9"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#lab02-first-mcp-server-lab-__codelineno-23-10"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Operation failed: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#lab02-first-mcp-server-lab-__codelineno-23-11"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#lab02-first-mcp-server-lab-__codelineno-23-12"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
</ol>
<h3 id="lab02-first-mcp-server-lab-4-log-to-stderr">4. <strong>Log to stderr</strong><a class="headerlink" href="#lab02-first-mcp-server-lab-4-log-to-stderr" title="Permanent link">&para;</a></h3>
<p><strong>Why</strong>: <code>MCP</code> protocol uses <code>stdout</code> for communication. Logging to <code>stdout</code> can break the protocol.</p>
<p><strong>Step-by-step implementation</strong>:</p>
<ol>
<li>
<p><strong>Use console.error() for all logging</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#lab02-first-mcp-server-lab-__codelineno-24-1"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[DEBUG] Tool called:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">);</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#lab02-first-mcp-server-lab-__codelineno-24-2"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[DEBUG] Arguments:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="p">);</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Structure your log messages</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#lab02-first-mcp-server-lab-__codelineno-25-1"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[INFO] Processing tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#lab02-first-mcp-server-lab-__codelineno-25-2"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[DEBUG] Input validation passed`</span><span class="p">);</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#lab02-first-mcp-server-lab-__codelineno-25-3"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[ERROR] Tool execution failed:`</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Log at appropriate levels</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#lab02-first-mcp-server-lab-__codelineno-26-1"></a><span class="c1">// Debug information</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#lab02-first-mcp-server-lab-__codelineno-26-2"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[DEBUG] Server initialized with capabilities:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">capabilities</span><span class="p">);</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#lab02-first-mcp-server-lab-__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#lab02-first-mcp-server-lab-__codelineno-26-4"></a><span class="c1">// Info for normal operations</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#lab02-first-mcp-server-lab-__codelineno-26-5"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[INFO] Tool executed successfully&quot;</span><span class="p">);</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#lab02-first-mcp-server-lab-__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#lab02-first-mcp-server-lab-__codelineno-26-7"></a><span class="c1">// Warnings for potential issues</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#lab02-first-mcp-server-lab-__codelineno-26-8"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[WARN] Using default value for optional parameter&quot;</span><span class="p">);</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#lab02-first-mcp-server-lab-__codelineno-26-9"></a>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#lab02-first-mcp-server-lab-__codelineno-26-10"></a><span class="c1">// Errors for failures</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#lab02-first-mcp-server-lab-__codelineno-26-11"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[ERROR] Tool execution failed:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Include timestamps for debugging</strong>:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#lab02-first-mcp-server-lab-__codelineno-27-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">();</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#lab02-first-mcp-server-lab-__codelineno-27-2"></a><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[</span><span class="si">${</span><span class="nx">timestamp</span><span class="si">}</span><span class="sb">] [INFO] Server started`</span><span class="p">);</span>
</span></code></pre></div></p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title"><strong>Important</strong></p>
<p>Use <code>console.error()</code> for logging, not <code>console.log()</code>. Your MCP server must not write to <code>stdout</code> for logging purposes, as
stdout is reserved for MCP protocol messages!</p>
</div>
<hr />
<h2 id="lab02-first-mcp-server-lab-common-issues-and-solutions">Common Issues and Solutions<a class="headerlink" href="#lab02-first-mcp-server-lab-common-issues-and-solutions" title="Permanent link">&para;</a></h2>
<h3 id="lab02-first-mcp-server-lab-issue-1-server-not-connecting">Issue 1: Server Not Connecting<a class="headerlink" href="#lab02-first-mcp-server-lab-issue-1-server-not-connecting" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Symptoms:</strong> Client doesn&rsquo;t see the server or times out</p>
</li>
<li>
<p><strong>Solutions:</strong></p>
<ul>
<li>Check that the command path is absolute</li>
<li>Verify Node.js is in the PATH</li>
<li>Look at client logs for connection errors</li>
<li>Ensure the server starts without crashing</li>
</ul>
</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-issue-2-tools-not-appearing">Issue 2: Tools Not Appearing<a class="headerlink" href="#lab02-first-mcp-server-lab-issue-2-tools-not-appearing" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Symptoms:</strong> Server connects but no tools are listed</p>
</li>
<li>
<p><strong>Solutions:</strong></p>
<ul>
<li>Verify <code>capabilities.tools</code> is declared in server initialization</li>
<li>Check that <code>ListToolsRequestSchema</code> handler is registered</li>
<li>Ensure the handler returns the correct format</li>
<li>Restart the client after code changes</li>
</ul>
</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-issue-3-tool-execution-fails">Issue 3: Tool Execution Fails<a class="headerlink" href="#lab02-first-mcp-server-lab-issue-3-tool-execution-fails" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Symptoms:</strong> Tool appears but fails when called</p>
</li>
<li>
<p><strong>Solutions:</strong></p>
<ul>
<li>Validate input arguments match the schema</li>
<li>Check for typos in tool names</li>
<li>Add debug logging to see what&rsquo;s received</li>
<li>Ensure return format matches <code>MCP</code> specification</li>
</ul>
</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-issue-4-server-crashes">Issue 4: Server Crashes<a class="headerlink" href="#lab02-first-mcp-server-lab-issue-4-server-crashes" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Symptoms:</strong> Server exits unexpectedly</p>
</li>
<li>
<p><strong>Solutions:</strong></p>
<ul>
<li>Add try-catch blocks around async code</li>
<li>Check for unhandled promise rejections</li>
<li>Validate all external data</li>
<li>Add process error handlers</li>
</ul>
</li>
</ul>
<hr />
<h2 id="lab02-first-mcp-server-lab-extending-your-server-hands-on-exercises">Extending Your Server: Hands-On Exercises<a class="headerlink" href="#lab02-first-mcp-server-lab-extending-your-server-hands-on-exercises" title="Permanent link">&para;</a></h2>
<p>Now that you have a working server, try these exercises:</p>
<h3 id="lab02-first-mcp-server-lab-exercise-1-add-a-calculator-tool">Exercise 1: Add a Calculator Tool<a class="headerlink" href="#lab02-first-mcp-server-lab-exercise-1-add-a-calculator-tool" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Create a tool that performs basic math operations:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#lab02-first-mcp-server-lab-__codelineno-28-1"></a><span class="p">{</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#lab02-first-mcp-server-lab-__codelineno-28-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#lab02-first-mcp-server-lab-__codelineno-28-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Performs basic math operations&quot;</span><span class="p">,</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#lab02-first-mcp-server-lab-__codelineno-28-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#lab02-first-mcp-server-lab-__codelineno-28-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#lab02-first-mcp-server-lab-__codelineno-28-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#lab02-first-mcp-server-lab-__codelineno-28-7"></a><span class="w">      </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#lab02-first-mcp-server-lab-__codelineno-28-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#lab02-first-mcp-server-lab-__codelineno-28-9"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;subtract&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;multiply&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#lab02-first-mcp-server-lab-__codelineno-28-10"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#lab02-first-mcp-server-lab-__codelineno-28-11"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#lab02-first-mcp-server-lab-__codelineno-28-12"></a><span class="w">      </span><span class="nx">a</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#lab02-first-mcp-server-lab-__codelineno-28-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#lab02-first-mcp-server-lab-__codelineno-28-14"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;First number&quot;</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#lab02-first-mcp-server-lab-__codelineno-28-15"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#lab02-first-mcp-server-lab-__codelineno-28-16"></a><span class="w">      </span><span class="nx">b</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#lab02-first-mcp-server-lab-__codelineno-28-17"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#lab02-first-mcp-server-lab-__codelineno-28-18"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#lab02-first-mcp-server-lab-__codelineno-28-19"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#lab02-first-mcp-server-lab-__codelineno-28-20"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#lab02-first-mcp-server-lab-__codelineno-28-21"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22" href="#lab02-first-mcp-server-lab-__codelineno-28-22"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23" href="#lab02-first-mcp-server-lab-__codelineno-28-23"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-exercise-2-add-an-echo-tool">Exercise 2: Add an Echo Tool<a class="headerlink" href="#lab02-first-mcp-server-lab-exercise-2-add-an-echo-tool" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Create a tool that returns whatever text it receives:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#lab02-first-mcp-server-lab-__codelineno-29-1"></a><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#lab02-first-mcp-server-lab-__codelineno-29-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#lab02-first-mcp-server-lab-__codelineno-29-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Echoes back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#lab02-first-mcp-server-lab-__codelineno-29-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#lab02-first-mcp-server-lab-__codelineno-29-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#lab02-first-mcp-server-lab-__codelineno-29-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#lab02-first-mcp-server-lab-__codelineno-29-7"></a><span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#lab02-first-mcp-server-lab-__codelineno-29-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#lab02-first-mcp-server-lab-__codelineno-29-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The message to echo&quot;</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#lab02-first-mcp-server-lab-__codelineno-29-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#lab02-first-mcp-server-lab-__codelineno-29-11"></a><span class="w">      </span><span class="nx">repeat</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#lab02-first-mcp-server-lab-__codelineno-29-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#lab02-first-mcp-server-lab-__codelineno-29-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Number of times to repeat (default: 1)&quot;</span><span class="p">,</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#lab02-first-mcp-server-lab-__codelineno-29-14"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#lab02-first-mcp-server-lab-__codelineno-29-15"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#lab02-first-mcp-server-lab-__codelineno-29-16"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#lab02-first-mcp-server-lab-__codelineno-29-17"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">]</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#lab02-first-mcp-server-lab-__codelineno-29-18"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#lab02-first-mcp-server-lab-__codelineno-29-19"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<h3 id="lab02-first-mcp-server-lab-exercise-3-add-logging">Exercise 3: Add Logging<a class="headerlink" href="#lab02-first-mcp-server-lab-exercise-3-add-logging" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Enhance your server with structured logging:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#lab02-first-mcp-server-lab-__codelineno-30-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">log</span><span class="p">(</span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">data?</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#lab02-first-mcp-server-lab-__codelineno-30-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">();</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#lab02-first-mcp-server-lab-__codelineno-30-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">logEntry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">timestamp</span><span class="p">,</span><span class="w"> </span><span class="nx">level</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#lab02-first-mcp-server-lab-__codelineno-30-4"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">logEntry</span><span class="p">));</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#lab02-first-mcp-server-lab-__codelineno-30-5"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<hr />
<h2 id="lab02-first-mcp-server-lab-key-takeaways">Key Takeaways<a class="headerlink" href="#lab02-first-mcp-server-lab-key-takeaways" title="Permanent link">&para;</a></h2>
<p>✅ MCP servers are built using the <code>@modelcontextprotocol/sdk</code> package</p>
<p>✅ The SDK handles protocol details, letting you focus on business logic</p>
<p>✅ Servers communicate via stdio, HTTP, or custom transports</p>
<p>✅ Tools are defined with JSON Schema for type safety</p>
<p>✅ Error handling and validation are critical for reliability</p>
<p>✅ The MCP Inspector is invaluable for development and testing</p>
<p>✅ Always log to stderr, never stdout (reserved for protocol)</p>
<hr />
<h2 id="lab02-first-mcp-server-lab-next-steps">Next Steps<a class="headerlink" href="#lab02-first-mcp-server-lab-next-steps" title="Permanent link">&para;</a></h2>
<p>In <a href="#lab02-first-mcp-server-lab03-mcp-tools"><strong>Lab 3</strong></a>, you&rsquo;ll dive deeper into implementing sophisticated MCP tools. </p>
<ul>
<li>
<p>You&rsquo;ll learn:</p>
<ul>
<li>Advanced input validation techniques</li>
<li>Returning rich content types (text, images, embedded resources)</li>
<li>Implementing async operations and long-running tasks</li>
<li>Error handling patterns</li>
<li>Tool composition and dependencies</li>
</ul>
</li>
</ul>
<hr />
<h2 id="lab02-first-mcp-server-lab-additional-resources">Additional Resources<a class="headerlink" href="#lab02-first-mcp-server-lab-additional-resources" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/modelcontextprotocol/typescript-sdk">MCP TypeScript SDK Documentation</a></li>
<li><a href="https://github.com/modelcontextprotocol/inspector">MCP Inspector Tool</a></li>
<li><a href="https://json-schema.org/">JSON Schema Reference</a></li>
<li><a href="https://spec.modelcontextprotocol.io">MCP Protocol Specification</a></li>
</ul>
<hr />
<h2 id="lab02-first-mcp-server-lab-troubleshooting-checklist">Troubleshooting Checklist<a class="headerlink" href="#lab02-first-mcp-server-lab-troubleshooting-checklist" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Before moving on, verify:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Your server builds without TypeScript errors</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> The server starts and logs &ldquo;running on stdio&rdquo;</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> The MCP Inspector can connect to your server</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Tools appear in the inspector&rsquo;s tool list</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> You can successfully call the <code>hello_world</code> tool</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Error messages are helpful and informative</li>
</ul>
</li>
</ul>
<hr />
<p><strong>Congratulations! You&rsquo;ve built your first MCP server! Ready for more? Continue to <a href="#lab02-first-mcp-server-lab03-mcp-tools"><strong>Lab 3</strong></a>!</strong></p></section><section class="print-page" id="lab03-mcp-tools-lab" heading-number="2.5"><h1 id="lab03-mcp-tools-lab-lab-3-implementing-mcp-tools">Lab 3: Implementing MCP Tools<a class="headerlink" href="#lab03-mcp-tools-lab-lab-3-implementing-mcp-tools" title="Permanent link">&para;</a></h1>
<h2 id="lab03-mcp-tools-lab-overview">Overview<a class="headerlink" href="#lab03-mcp-tools-lab-overview" title="Permanent link">&para;</a></h2>
<p>In <a href="#lab03-mcp-tools-lab02-first-mcp-server">Lab 2</a>, you created a basic <code>MCP</code> server with a simple &ldquo;hello world&rdquo; tool. Now it&rsquo;s time to level up! </p>
<p>In this lab, you&rsquo;ll master the art of creating sophisticated, production-ready <code>MCP</code> tools that can handle complex inputs, perform real-world operations, and return rich content types.</p>
<hr />
<h2 id="lab03-mcp-tools-lab-learning-objectives">Learning Objectives<a class="headerlink" href="#lab03-mcp-tools-lab-learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lab, you will:</p>
<ul>
<li>Design robust tool schemas with advanced validation</li>
<li>Implement tools that interact with external systems (APIs, databases, file systems)</li>
<li>Return multiple content types (text, images, resources)</li>
<li>Handle errors gracefully with detailed feedback</li>
<li>Implement async operations and streaming responses</li>
<li>Apply best practices for tool composition</li>
<li>Test tools thoroughly with various edge cases</li>
</ul>
<hr />
<h2 id="lab03-mcp-tools-lab-prerequisites">Prerequisites<a class="headerlink" href="#lab03-mcp-tools-lab-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Completed <a href="#lab03-mcp-tools-lab02-first-mcp-server">Lab 2 - Building Your First MCP Server</a></li>
<li>Understanding of async/await in JavaScript/TypeScript</li>
<li>Basic knowledge of REST APIs and JSON</li>
<li>Node.js development environment set up</li>
</ul>
<hr />
<h2 id="lab03-mcp-tools-lab-understanding-tool-design">Understanding Tool Design<a class="headerlink" href="#lab03-mcp-tools-lab-understanding-tool-design" title="Permanent link">&para;</a></h2>
<h3 id="lab03-mcp-tools-lab-what-makes-a-great-mcp-tool">What Makes a Great <code>MCP</code> Tool?<a class="headerlink" href="#lab03-mcp-tools-lab-what-makes-a-great-mcp-tool" title="Permanent link">&para;</a></h3>
<p>A well-designed tool should be:</p>
<ol>
<li><strong>Single Purpose</strong>: Does one thing well</li>
<li><strong>Self-Descriptive</strong>: Clear name and description</li>
<li><strong>Well-Validated</strong>: Comprehensive input schema</li>
<li><strong>Error-Resilient</strong>: Handles failures gracefully</li>
<li><strong>Efficient</strong>: Returns results quickly</li>
<li><strong>Composable</strong>: Can work with other tools</li>
</ol>
<h3 id="lab03-mcp-tools-lab-tool-anatomy">Tool Anatomy<a class="headerlink" href="#lab03-mcp-tools-lab-tool-anatomy" title="Permanent link">&para;</a></h3>
<p>Every <code>MCP</code> tool consists of the following key components:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab03-mcp-tools-lab-__codelineno-0-1"></a><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab03-mcp-tools-lab-__codelineno-0-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;tool_name&quot;</span><span class="p">,</span><span class="w">              </span><span class="c1">// Unique identifier</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab03-mcp-tools-lab-__codelineno-0-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;What it does&quot;</span><span class="p">,</span><span class="w">    </span><span class="c1">// Clear explanation for LLM</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab03-mcp-tools-lab-__codelineno-0-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w">                  </span><span class="c1">// JSON Schema for validation</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#lab03-mcp-tools-lab-__codelineno-0-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#lab03-mcp-tools-lab-__codelineno-0-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#lab03-mcp-tools-lab-__codelineno-0-7"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#lab03-mcp-tools-lab-__codelineno-0-8"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#lab03-mcp-tools-lab-__codelineno-0-9"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="lab03-mcp-tools-lab-advanced-input-schema-design">Advanced Input Schema Design<a class="headerlink" href="#lab03-mcp-tools-lab-advanced-input-schema-design" title="Permanent link">&para;</a></h2>
<h3 id="lab03-mcp-tools-lab-example-1-file-search-tool">Example 1: File Search Tool<a class="headerlink" href="#lab03-mcp-tools-lab-example-1-file-search-tool" title="Permanent link">&para;</a></h3>
<p><strong>Key Features:</strong></p>
<ul>
<li>Pattern validation using <code>regex</code></li>
<li>Default values for optional parameters</li>
<li>Min/max constraints for numbers</li>
<li>Clear descriptions for the <strong>LLM</strong> </li>
</ul>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab03-mcp-tools-lab-__codelineno-1-1"></a><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#lab03-mcp-tools-lab-__codelineno-1-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;search_files&quot;</span><span class="p">,</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#lab03-mcp-tools-lab-__codelineno-1-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Search for files in a directory using glob patterns&quot;</span><span class="p">,</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#lab03-mcp-tools-lab-__codelineno-1-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#lab03-mcp-tools-lab-__codelineno-1-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#lab03-mcp-tools-lab-__codelineno-1-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#lab03-mcp-tools-lab-__codelineno-1-7"></a><span class="w">      </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#lab03-mcp-tools-lab-__codelineno-1-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#lab03-mcp-tools-lab-__codelineno-1-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Directory path to search in&quot;</span><span class="p">,</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#lab03-mcp-tools-lab-__codelineno-1-10"></a><span class="w">        </span><span class="nx">pattern</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;^(/|\\./|\\.\\./).*&quot;</span><span class="w">  </span><span class="c1">// Must be absolute or relative path</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#lab03-mcp-tools-lab-__codelineno-1-11"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#lab03-mcp-tools-lab-__codelineno-1-12"></a><span class="w">      </span><span class="nx">pattern</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#lab03-mcp-tools-lab-__codelineno-1-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#lab03-mcp-tools-lab-__codelineno-1-14"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Glob pattern (e.g., &#39;*.ts&#39;, &#39;**/*.json&#39;)&quot;</span><span class="p">,</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#lab03-mcp-tools-lab-__codelineno-1-15"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#lab03-mcp-tools-lab-__codelineno-1-16"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#lab03-mcp-tools-lab-__codelineno-1-17"></a><span class="w">      </span><span class="nx">recursive</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#lab03-mcp-tools-lab-__codelineno-1-18"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#lab03-mcp-tools-lab-__codelineno-1-19"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Search subdirectories&quot;</span><span class="p">,</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#lab03-mcp-tools-lab-__codelineno-1-20"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#lab03-mcp-tools-lab-__codelineno-1-21"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#lab03-mcp-tools-lab-__codelineno-1-22"></a><span class="w">      </span><span class="nx">maxResults</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#lab03-mcp-tools-lab-__codelineno-1-23"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#lab03-mcp-tools-lab-__codelineno-1-24"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum number of results to return&quot;</span><span class="p">,</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#lab03-mcp-tools-lab-__codelineno-1-25"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#lab03-mcp-tools-lab-__codelineno-1-26"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="p">,</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#lab03-mcp-tools-lab-__codelineno-1-27"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#lab03-mcp-tools-lab-__codelineno-1-28"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#lab03-mcp-tools-lab-__codelineno-1-29"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#lab03-mcp-tools-lab-__codelineno-1-30"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#lab03-mcp-tools-lab-__codelineno-1-31"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#lab03-mcp-tools-lab-__codelineno-1-32"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="lab03-mcp-tools-lab-example-2-api-request-tool">Example 2: API Request Tool<a class="headerlink" href="#lab03-mcp-tools-lab-example-2-api-request-tool" title="Permanent link">&para;</a></h3>
<p><strong>Key Features:</strong></p>
<ul>
<li>Format validation (<code>uri</code>)</li>
<li>Enum constraints</li>
<li>Nested objects with additional properties</li>
<li>Practical defaults</li>
</ul>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab03-mcp-tools-lab-__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#lab03-mcp-tools-lab-__codelineno-2-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;make_api_request&quot;</span><span class="p">,</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#lab03-mcp-tools-lab-__codelineno-2-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Make HTTP requests to REST APIs&quot;</span><span class="p">,</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#lab03-mcp-tools-lab-__codelineno-2-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#lab03-mcp-tools-lab-__codelineno-2-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#lab03-mcp-tools-lab-__codelineno-2-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#lab03-mcp-tools-lab-__codelineno-2-7"></a><span class="w">      </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#lab03-mcp-tools-lab-__codelineno-2-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#lab03-mcp-tools-lab-__codelineno-2-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Full URL to request&quot;</span><span class="p">,</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#lab03-mcp-tools-lab-__codelineno-2-10"></a><span class="w">        </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;uri&quot;</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#lab03-mcp-tools-lab-__codelineno-2-11"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#lab03-mcp-tools-lab-__codelineno-2-12"></a><span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#lab03-mcp-tools-lab-__codelineno-2-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#lab03-mcp-tools-lab-__codelineno-2-14"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;HTTP method&quot;</span><span class="p">,</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#lab03-mcp-tools-lab-__codelineno-2-15"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;PUT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;PATCH&quot;</span><span class="p">],</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#lab03-mcp-tools-lab-__codelineno-2-16"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#lab03-mcp-tools-lab-__codelineno-2-17"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#lab03-mcp-tools-lab-__codelineno-2-18"></a><span class="w">      </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#lab03-mcp-tools-lab-__codelineno-2-19"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#lab03-mcp-tools-lab-__codelineno-2-20"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;HTTP headers as key-value pairs&quot;</span><span class="p">,</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#lab03-mcp-tools-lab-__codelineno-2-21"></a><span class="w">        </span><span class="nx">additionalProperties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#lab03-mcp-tools-lab-__codelineno-2-22"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#lab03-mcp-tools-lab-__codelineno-2-23"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#lab03-mcp-tools-lab-__codelineno-2-24"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#lab03-mcp-tools-lab-__codelineno-2-25"></a><span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#lab03-mcp-tools-lab-__codelineno-2-26"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#lab03-mcp-tools-lab-__codelineno-2-27"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Request body (JSON string for POST/PUT)&quot;</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#lab03-mcp-tools-lab-__codelineno-2-28"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#lab03-mcp-tools-lab-__codelineno-2-29"></a><span class="w">      </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#lab03-mcp-tools-lab-__codelineno-2-30"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#lab03-mcp-tools-lab-__codelineno-2-31"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Request timeout in milliseconds&quot;</span><span class="p">,</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#lab03-mcp-tools-lab-__codelineno-2-32"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#lab03-mcp-tools-lab-__codelineno-2-33"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">30000</span><span class="p">,</span>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#lab03-mcp-tools-lab-__codelineno-2-34"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">5000</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#lab03-mcp-tools-lab-__codelineno-2-35"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#lab03-mcp-tools-lab-__codelineno-2-36"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#lab03-mcp-tools-lab-__codelineno-2-37"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;method&quot;</span><span class="p">]</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#lab03-mcp-tools-lab-__codelineno-2-38"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#lab03-mcp-tools-lab-__codelineno-2-39"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="lab03-mcp-tools-lab-implementing-real-world-tools">Implementing Real-World Tools<a class="headerlink" href="#lab03-mcp-tools-lab-implementing-real-world-tools" title="Permanent link">&para;</a></h2>
<h3 id="lab03-mcp-tools-lab-tool-1-weather-information-with-ollama">Tool 1: Weather Information with Ollama<a class="headerlink" href="#lab03-mcp-tools-lab-tool-1-weather-information-with-ollama" title="Permanent link">&para;</a></h3>
<p><strong>Goal</strong>: Create a production-ready weather tool that uses Ollama (local AI) to generate weather information, handles errors gracefully, and returns formatted information.</p>
<h4 id="lab03-mcp-tools-lab-complete-weather-tool-implementation-with-ollama">Complete Weather Tool Implementation with Ollama<a class="headerlink" href="#lab03-mcp-tools-lab-complete-weather-tool-implementation-with-ollama" title="Permanent link">&para;</a></h4>
<p>Here is the complete <code>src/index.ts</code> file with the Ollama-based weather tool added. <strong>Copy this entire code and overwrite your existing <code>src/index.ts</code> file:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab03-mcp-tools-lab-__codelineno-3-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#lab03-mcp-tools-lab-__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#lab03-mcp-tools-lab-__codelineno-3-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#lab03-mcp-tools-lab-__codelineno-3-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#lab03-mcp-tools-lab-__codelineno-3-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#lab03-mcp-tools-lab-__codelineno-3-6"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#lab03-mcp-tools-lab-__codelineno-3-7"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#lab03-mcp-tools-lab-__codelineno-3-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#lab03-mcp-tools-lab-__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#lab03-mcp-tools-lab-__codelineno-3-10"></a><span class="cm">/**</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#lab03-mcp-tools-lab-__codelineno-3-11"></a><span class="cm">* Create an MCP server with core capabilities</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#lab03-mcp-tools-lab-__codelineno-3-12"></a><span class="cm">*/</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#lab03-mcp-tools-lab-__codelineno-3-13"></a><span class="kd">class</span><span class="w"> </span><span class="nx">MyFirstMCPServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#lab03-mcp-tools-lab-__codelineno-3-14"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#lab03-mcp-tools-lab-__codelineno-3-15"></a>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#lab03-mcp-tools-lab-__codelineno-3-16"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#lab03-mcp-tools-lab-__codelineno-3-17"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#lab03-mcp-tools-lab-__codelineno-3-18"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#lab03-mcp-tools-lab-__codelineno-3-19"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;my-first-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#lab03-mcp-tools-lab-__codelineno-3-20"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#lab03-mcp-tools-lab-__codelineno-3-21"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#lab03-mcp-tools-lab-__codelineno-3-22"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#lab03-mcp-tools-lab-__codelineno-3-23"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#lab03-mcp-tools-lab-__codelineno-3-24"></a><span class="w">          </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#lab03-mcp-tools-lab-__codelineno-3-25"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#lab03-mcp-tools-lab-__codelineno-3-26"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#lab03-mcp-tools-lab-__codelineno-3-27"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#lab03-mcp-tools-lab-__codelineno-3-28"></a>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#lab03-mcp-tools-lab-__codelineno-3-29"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#lab03-mcp-tools-lab-__codelineno-3-30"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#lab03-mcp-tools-lab-__codelineno-3-31"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#lab03-mcp-tools-lab-__codelineno-3-32"></a>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#lab03-mcp-tools-lab-__codelineno-3-33"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#lab03-mcp-tools-lab-__codelineno-3-34"></a><span class="cm">  * Set up request handlers</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#lab03-mcp-tools-lab-__codelineno-3-35"></a><span class="cm">  */</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#lab03-mcp-tools-lab-__codelineno-3-36"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#lab03-mcp-tools-lab-__codelineno-3-37"></a><span class="w">    </span><span class="c1">// Handler for listing available tools</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#lab03-mcp-tools-lab-__codelineno-3-38"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#lab03-mcp-tools-lab-__codelineno-3-39"></a><span class="w">      </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#lab03-mcp-tools-lab-__codelineno-3-40"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#lab03-mcp-tools-lab-__codelineno-3-41"></a><span class="w">        </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#lab03-mcp-tools-lab-__codelineno-3-42"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#lab03-mcp-tools-lab-__codelineno-3-43"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;get_weather&quot;</span><span class="p">,</span>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#lab03-mcp-tools-lab-__codelineno-3-44"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Get current weather information for a city using AI&quot;</span><span class="p">,</span>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#lab03-mcp-tools-lab-__codelineno-3-45"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#lab03-mcp-tools-lab-__codelineno-3-46"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#lab03-mcp-tools-lab-__codelineno-3-47"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#lab03-mcp-tools-lab-__codelineno-3-48"></a><span class="w">                </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#lab03-mcp-tools-lab-__codelineno-3-49"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#lab03-mcp-tools-lab-__codelineno-3-50"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;City name (e.g., &#39;London&#39;, &#39;New York&#39;)&quot;</span>
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#lab03-mcp-tools-lab-__codelineno-3-51"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#lab03-mcp-tools-lab-__codelineno-3-52"></a><span class="w">                </span><span class="nx">units</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#lab03-mcp-tools-lab-__codelineno-3-53"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#lab03-mcp-tools-lab-__codelineno-3-54"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Temperature units&quot;</span><span class="p">,</span>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#lab03-mcp-tools-lab-__codelineno-3-55"></a><span class="w">                  </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;celsius&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;fahrenheit&quot;</span><span class="p">],</span>
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#lab03-mcp-tools-lab-__codelineno-3-56"></a><span class="w">                  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;celsius&quot;</span>
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#lab03-mcp-tools-lab-__codelineno-3-57"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#lab03-mcp-tools-lab-__codelineno-3-58"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#lab03-mcp-tools-lab-__codelineno-3-59"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;city&quot;</span><span class="p">]</span>
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#lab03-mcp-tools-lab-__codelineno-3-60"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#lab03-mcp-tools-lab-__codelineno-3-61"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#lab03-mcp-tools-lab-__codelineno-3-62"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#lab03-mcp-tools-lab-__codelineno-3-63"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hello_world&quot;</span><span class="p">,</span>
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#lab03-mcp-tools-lab-__codelineno-3-64"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Returns a friendly greeting message&quot;</span><span class="p">,</span>
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#lab03-mcp-tools-lab-__codelineno-3-65"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#lab03-mcp-tools-lab-__codelineno-3-66"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67" href="#lab03-mcp-tools-lab-__codelineno-3-67"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68" href="#lab03-mcp-tools-lab-__codelineno-3-68"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69" href="#lab03-mcp-tools-lab-__codelineno-3-69"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70" href="#lab03-mcp-tools-lab-__codelineno-3-70"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The name to greet&quot;</span><span class="p">,</span>
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71" href="#lab03-mcp-tools-lab-__codelineno-3-71"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72" href="#lab03-mcp-tools-lab-__codelineno-3-72"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73" href="#lab03-mcp-tools-lab-__codelineno-3-73"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74" href="#lab03-mcp-tools-lab-__codelineno-3-74"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75" href="#lab03-mcp-tools-lab-__codelineno-3-75"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-3-76"><a id="__codelineno-3-76" name="__codelineno-3-76" href="#lab03-mcp-tools-lab-__codelineno-3-76"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-3-77"><a id="__codelineno-3-77" name="__codelineno-3-77" href="#lab03-mcp-tools-lab-__codelineno-3-77"></a><span class="w">      </span><span class="p">})</span>
</span><span id="__span-3-78"><a id="__codelineno-3-78" name="__codelineno-3-78" href="#lab03-mcp-tools-lab-__codelineno-3-78"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-3-79"><a id="__codelineno-3-79" name="__codelineno-3-79" href="#lab03-mcp-tools-lab-__codelineno-3-79"></a>
</span><span id="__span-3-80"><a id="__codelineno-3-80" name="__codelineno-3-80" href="#lab03-mcp-tools-lab-__codelineno-3-80"></a><span class="w">    </span><span class="c1">// Handler for calling tools</span>
</span><span id="__span-3-81"><a id="__codelineno-3-81" name="__codelineno-3-81" href="#lab03-mcp-tools-lab-__codelineno-3-81"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-3-82"><a id="__codelineno-3-82" name="__codelineno-3-82" href="#lab03-mcp-tools-lab-__codelineno-3-82"></a><span class="w">      </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-3-83"><a id="__codelineno-3-83" name="__codelineno-3-83" href="#lab03-mcp-tools-lab-__codelineno-3-83"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-84"><a id="__codelineno-3-84" name="__codelineno-3-84" href="#lab03-mcp-tools-lab-__codelineno-3-84"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-3-85"><a id="__codelineno-3-85" name="__codelineno-3-85" href="#lab03-mcp-tools-lab-__codelineno-3-85"></a>
</span><span id="__span-3-86"><a id="__codelineno-3-86" name="__codelineno-3-86" href="#lab03-mcp-tools-lab-__codelineno-3-86"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;get_weather&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-87"><a id="__codelineno-3-87" name="__codelineno-3-87" href="#lab03-mcp-tools-lab-__codelineno-3-87"></a><span class="w">          </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-88"><a id="__codelineno-3-88" name="__codelineno-3-88" href="#lab03-mcp-tools-lab-__codelineno-3-88"></a><span class="w">            </span><span class="c1">// Extract and validate parameters</span>
</span><span id="__span-3-89"><a id="__codelineno-3-89" name="__codelineno-3-89" href="#lab03-mcp-tools-lab-__codelineno-3-89"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">city</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-3-90"><a id="__codelineno-3-90" name="__codelineno-3-90" href="#lab03-mcp-tools-lab-__codelineno-3-90"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">units</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;celsius&quot;</span><span class="p">;</span>
</span><span id="__span-3-91"><a id="__codelineno-3-91" name="__codelineno-3-91" href="#lab03-mcp-tools-lab-__codelineno-3-91"></a>
</span><span id="__span-3-92"><a id="__codelineno-3-92" name="__codelineno-3-92" href="#lab03-mcp-tools-lab-__codelineno-3-92"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">city</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">city</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-93"><a id="__codelineno-3-93" name="__codelineno-3-93" href="#lab03-mcp-tools-lab-__codelineno-3-93"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;City name cannot be empty&quot;</span><span class="p">);</span>
</span><span id="__span-3-94"><a id="__codelineno-3-94" name="__codelineno-3-94" href="#lab03-mcp-tools-lab-__codelineno-3-94"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-3-95"><a id="__codelineno-3-95" name="__codelineno-3-95" href="#lab03-mcp-tools-lab-__codelineno-3-95"></a>
</span><span id="__span-3-96"><a id="__codelineno-3-96" name="__codelineno-3-96" href="#lab03-mcp-tools-lab-__codelineno-3-96"></a><span class="w">            </span><span class="c1">// Use Ollama to generate weather information</span>
</span><span id="__span-3-97"><a id="__codelineno-3-97" name="__codelineno-3-97" href="#lab03-mcp-tools-lab-__codelineno-3-97"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`Generate realistic current weather information for </span><span class="si">${</span><span class="nx">city</span><span class="si">}</span><span class="sb">.</span>
</span><span id="__span-3-98"><a id="__codelineno-3-98" name="__codelineno-3-98" href="#lab03-mcp-tools-lab-__codelineno-3-98"></a><span class="sb">            Return ONLY a JSON object with this exact structure:</span>
</span><span id="__span-3-99"><a id="__codelineno-3-99" name="__codelineno-3-99" href="#lab03-mcp-tools-lab-__codelineno-3-99"></a><span class="sb">            {</span>
</span><span id="__span-3-100"><a id="__codelineno-3-100" name="__codelineno-3-100" href="#lab03-mcp-tools-lab-__codelineno-3-100"></a><span class="sb">              &quot;name&quot;: &quot;</span><span class="si">${</span><span class="nx">city</span><span class="si">}</span><span class="sb">&quot;,</span>
</span><span id="__span-3-101"><a id="__codelineno-3-101" name="__codelineno-3-101" href="#lab03-mcp-tools-lab-__codelineno-3-101"></a><span class="sb">              &quot;sys&quot;: {&quot;country&quot;: &quot;XX&quot;},</span>
</span><span id="__span-3-102"><a id="__codelineno-3-102" name="__codelineno-3-102" href="#lab03-mcp-tools-lab-__codelineno-3-102"></a><span class="sb">              &quot;main&quot;: {&quot;temp&quot;: 20.5, &quot;feels_like&quot;: 22.1, &quot;humidity&quot;: 65},</span>
</span><span id="__span-3-103"><a id="__codelineno-3-103" name="__codelineno-3-103" href="#lab03-mcp-tools-lab-__codelineno-3-103"></a><span class="sb">              &quot;weather&quot;: [{&quot;description&quot;: &quot;clear sky&quot;}],</span>
</span><span id="__span-3-104"><a id="__codelineno-3-104" name="__codelineno-3-104" href="#lab03-mcp-tools-lab-__codelineno-3-104"></a><span class="sb">              &quot;wind&quot;: {&quot;speed&quot;: 3.2}</span>
</span><span id="__span-3-105"><a id="__codelineno-3-105" name="__codelineno-3-105" href="#lab03-mcp-tools-lab-__codelineno-3-105"></a><span class="sb">            }</span>
</span><span id="__span-3-106"><a id="__codelineno-3-106" name="__codelineno-3-106" href="#lab03-mcp-tools-lab-__codelineno-3-106"></a>
</span><span id="__span-3-107"><a id="__codelineno-3-107" name="__codelineno-3-107" href="#lab03-mcp-tools-lab-__codelineno-3-107"></a><span class="sb">            Use realistic weather data appropriate for the location. Temperature should be in Celsius. Choose an appropriate 2-letter country code for the city. Make the weather description realistic for the location and season.`</span><span class="p">;</span>
</span><span id="__span-3-108"><a id="__codelineno-3-108" name="__codelineno-3-108" href="#lab03-mcp-tools-lab-__codelineno-3-108"></a>
</span><span id="__span-3-109"><a id="__codelineno-3-109" name="__codelineno-3-109" href="#lab03-mcp-tools-lab-__codelineno-3-109"></a><span class="w">            </span><span class="c1">// Call Ollama API</span>
</span><span id="__span-3-110"><a id="__codelineno-3-110" name="__codelineno-3-110" href="#lab03-mcp-tools-lab-__codelineno-3-110"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://localhost:11434/api/generate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-111"><a id="__codelineno-3-111" name="__codelineno-3-111" href="#lab03-mcp-tools-lab-__codelineno-3-111"></a><span class="w">              </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span><span id="__span-3-112"><a id="__codelineno-3-112" name="__codelineno-3-112" href="#lab03-mcp-tools-lab-__codelineno-3-112"></a><span class="w">              </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-113"><a id="__codelineno-3-113" name="__codelineno-3-113" href="#lab03-mcp-tools-lab-__codelineno-3-113"></a><span class="w">                </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
</span><span id="__span-3-114"><a id="__codelineno-3-114" name="__codelineno-3-114" href="#lab03-mcp-tools-lab-__codelineno-3-114"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-3-115"><a id="__codelineno-3-115" name="__codelineno-3-115" href="#lab03-mcp-tools-lab-__codelineno-3-115"></a><span class="w">              </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-3-116"><a id="__codelineno-3-116" name="__codelineno-3-116" href="#lab03-mcp-tools-lab-__codelineno-3-116"></a><span class="w">                </span><span class="nx">model</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;gpt-oss:20b&#39;</span><span class="p">,</span>
</span><span id="__span-3-117"><a id="__codelineno-3-117" name="__codelineno-3-117" href="#lab03-mcp-tools-lab-__codelineno-3-117"></a><span class="w">                </span><span class="nx">prompt</span><span class="o">:</span><span class="w"> </span><span class="kt">prompt</span><span class="p">,</span>
</span><span id="__span-3-118"><a id="__codelineno-3-118" name="__codelineno-3-118" href="#lab03-mcp-tools-lab-__codelineno-3-118"></a><span class="w">                </span><span class="nx">stream</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-3-119"><a id="__codelineno-3-119" name="__codelineno-3-119" href="#lab03-mcp-tools-lab-__codelineno-3-119"></a><span class="w">                </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;json&#39;</span>
</span><span id="__span-3-120"><a id="__codelineno-3-120" name="__codelineno-3-120" href="#lab03-mcp-tools-lab-__codelineno-3-120"></a><span class="w">              </span><span class="p">}),</span>
</span><span id="__span-3-121"><a id="__codelineno-3-121" name="__codelineno-3-121" href="#lab03-mcp-tools-lab-__codelineno-3-121"></a><span class="w">            </span><span class="p">});</span>
</span><span id="__span-3-122"><a id="__codelineno-3-122" name="__codelineno-3-122" href="#lab03-mcp-tools-lab-__codelineno-3-122"></a>
</span><span id="__span-3-123"><a id="__codelineno-3-123" name="__codelineno-3-123" href="#lab03-mcp-tools-lab-__codelineno-3-123"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-124"><a id="__codelineno-3-124" name="__codelineno-3-124" href="#lab03-mcp-tools-lab-__codelineno-3-124"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Ollama API error: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb"> </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">. Make sure Ollama is running with &#39;ollama serve&#39;.`</span><span class="p">);</span>
</span><span id="__span-3-125"><a id="__codelineno-3-125" name="__codelineno-3-125" href="#lab03-mcp-tools-lab-__codelineno-3-125"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-3-126"><a id="__codelineno-3-126" name="__codelineno-3-126" href="#lab03-mcp-tools-lab-__codelineno-3-126"></a>
</span><span id="__span-3-127"><a id="__codelineno-3-127" name="__codelineno-3-127" href="#lab03-mcp-tools-lab-__codelineno-3-127"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">ollamaResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span><span id="__span-3-128"><a id="__codelineno-3-128" name="__codelineno-3-128" href="#lab03-mcp-tools-lab-__codelineno-3-128"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">data</span><span class="p">;</span>
</span><span id="__span-3-129"><a id="__codelineno-3-129" name="__codelineno-3-129" href="#lab03-mcp-tools-lab-__codelineno-3-129"></a>
</span><span id="__span-3-130"><a id="__codelineno-3-130" name="__codelineno-3-130" href="#lab03-mcp-tools-lab-__codelineno-3-130"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-131"><a id="__codelineno-3-131" name="__codelineno-3-131" href="#lab03-mcp-tools-lab-__codelineno-3-131"></a><span class="w">              </span><span class="c1">// Parse the JSON response from Ollama</span>
</span><span id="__span-3-132"><a id="__codelineno-3-132" name="__codelineno-3-132" href="#lab03-mcp-tools-lab-__codelineno-3-132"></a><span class="w">              </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">ollamaResult</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
</span><span id="__span-3-133"><a id="__codelineno-3-133" name="__codelineno-3-133" href="#lab03-mcp-tools-lab-__codelineno-3-133"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">parseError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-134"><a id="__codelineno-3-134" name="__codelineno-3-134" href="#lab03-mcp-tools-lab-__codelineno-3-134"></a><span class="w">              </span><span class="c1">// Fallback to mock data if parsing fails</span>
</span><span id="__span-3-135"><a id="__codelineno-3-135" name="__codelineno-3-135" href="#lab03-mcp-tools-lab-__codelineno-3-135"></a><span class="w">              </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;Failed to parse Ollama response, using fallback data&#39;</span><span class="p">);</span>
</span><span id="__span-3-136"><a id="__codelineno-3-136" name="__codelineno-3-136" href="#lab03-mcp-tools-lab-__codelineno-3-136"></a><span class="w">              </span><span class="kd">const</span><span class="w"> </span><span class="nx">fallbackData</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-137"><a id="__codelineno-3-137" name="__codelineno-3-137" href="#lab03-mcp-tools-lab-__codelineno-3-137"></a><span class="w">                </span><span class="s2">&quot;london&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-138"><a id="__codelineno-3-138" name="__codelineno-3-138" href="#lab03-mcp-tools-lab-__codelineno-3-138"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;London&quot;</span><span class="p">,</span>
</span><span id="__span-3-139"><a id="__codelineno-3-139" name="__codelineno-3-139" href="#lab03-mcp-tools-lab-__codelineno-3-139"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;GB&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-140"><a id="__codelineno-3-140" name="__codelineno-3-140" href="#lab03-mcp-tools-lab-__codelineno-3-140"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">15.2</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">14.8</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">82</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-141"><a id="__codelineno-3-141" name="__codelineno-3-141" href="#lab03-mcp-tools-lab-__codelineno-3-141"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;light rain&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-3-142"><a id="__codelineno-3-142" name="__codelineno-3-142" href="#lab03-mcp-tools-lab-__codelineno-3-142"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">3.6</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-3-143"><a id="__codelineno-3-143" name="__codelineno-3-143" href="#lab03-mcp-tools-lab-__codelineno-3-143"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-3-144"><a id="__codelineno-3-144" name="__codelineno-3-144" href="#lab03-mcp-tools-lab-__codelineno-3-144"></a><span class="w">                </span><span class="s2">&quot;new york&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-145"><a id="__codelineno-3-145" name="__codelineno-3-145" href="#lab03-mcp-tools-lab-__codelineno-3-145"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;New York&quot;</span><span class="p">,</span>
</span><span id="__span-3-146"><a id="__codelineno-3-146" name="__codelineno-3-146" href="#lab03-mcp-tools-lab-__codelineno-3-146"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;US&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-147"><a id="__codelineno-3-147" name="__codelineno-3-147" href="#lab03-mcp-tools-lab-__codelineno-3-147"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">22.5</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">24.1</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">65</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-148"><a id="__codelineno-3-148" name="__codelineno-3-148" href="#lab03-mcp-tools-lab-__codelineno-3-148"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;clear sky&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-3-149"><a id="__codelineno-3-149" name="__codelineno-3-149" href="#lab03-mcp-tools-lab-__codelineno-3-149"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">2.1</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-3-150"><a id="__codelineno-3-150" name="__codelineno-3-150" href="#lab03-mcp-tools-lab-__codelineno-3-150"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-3-151"><a id="__codelineno-3-151" name="__codelineno-3-151" href="#lab03-mcp-tools-lab-__codelineno-3-151"></a><span class="w">                </span><span class="s2">&quot;tokyo&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-152"><a id="__codelineno-3-152" name="__codelineno-3-152" href="#lab03-mcp-tools-lab-__codelineno-3-152"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
</span><span id="__span-3-153"><a id="__codelineno-3-153" name="__codelineno-3-153" href="#lab03-mcp-tools-lab-__codelineno-3-153"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;JP&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-154"><a id="__codelineno-3-154" name="__codelineno-3-154" href="#lab03-mcp-tools-lab-__codelineno-3-154"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">18.7</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">18.2</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">78</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-155"><a id="__codelineno-3-155" name="__codelineno-3-155" href="#lab03-mcp-tools-lab-__codelineno-3-155"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;few clouds&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-3-156"><a id="__codelineno-3-156" name="__codelineno-3-156" href="#lab03-mcp-tools-lab-__codelineno-3-156"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">1.8</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-3-157"><a id="__codelineno-3-157" name="__codelineno-3-157" href="#lab03-mcp-tools-lab-__codelineno-3-157"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-3-158"><a id="__codelineno-3-158" name="__codelineno-3-158" href="#lab03-mcp-tools-lab-__codelineno-3-158"></a><span class="w">                </span><span class="s2">&quot;paris&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-159"><a id="__codelineno-3-159" name="__codelineno-3-159" href="#lab03-mcp-tools-lab-__codelineno-3-159"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Paris&quot;</span><span class="p">,</span>
</span><span id="__span-3-160"><a id="__codelineno-3-160" name="__codelineno-3-160" href="#lab03-mcp-tools-lab-__codelineno-3-160"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;FR&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-161"><a id="__codelineno-3-161" name="__codelineno-3-161" href="#lab03-mcp-tools-lab-__codelineno-3-161"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">12.8</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">11.9</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">71</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-162"><a id="__codelineno-3-162" name="__codelineno-3-162" href="#lab03-mcp-tools-lab-__codelineno-3-162"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;overcast clouds&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-3-163"><a id="__codelineno-3-163" name="__codelineno-3-163" href="#lab03-mcp-tools-lab-__codelineno-3-163"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">4.2</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-3-164"><a id="__codelineno-3-164" name="__codelineno-3-164" href="#lab03-mcp-tools-lab-__codelineno-3-164"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-3-165"><a id="__codelineno-3-165" name="__codelineno-3-165" href="#lab03-mcp-tools-lab-__codelineno-3-165"></a><span class="w">                </span><span class="s2">&quot;sydney&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-166"><a id="__codelineno-3-166" name="__codelineno-3-166" href="#lab03-mcp-tools-lab-__codelineno-3-166"></a><span class="w">                  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Sydney&quot;</span><span class="p">,</span>
</span><span id="__span-3-167"><a id="__codelineno-3-167" name="__codelineno-3-167" href="#lab03-mcp-tools-lab-__codelineno-3-167"></a><span class="w">                  </span><span class="nx">sys</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">country</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;AU&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-168"><a id="__codelineno-3-168" name="__codelineno-3-168" href="#lab03-mcp-tools-lab-__codelineno-3-168"></a><span class="w">                  </span><span class="nx">main</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="kt">24.3</span><span class="p">,</span><span class="w"> </span><span class="nx">feels_like</span><span class="o">:</span><span class="w"> </span><span class="kt">25.1</span><span class="p">,</span><span class="w"> </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">73</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-3-169"><a id="__codelineno-3-169" name="__codelineno-3-169" href="#lab03-mcp-tools-lab-__codelineno-3-169"></a><span class="w">                  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;sunny&quot;</span><span class="w"> </span><span class="p">}],</span>
</span><span id="__span-3-170"><a id="__codelineno-3-170" name="__codelineno-3-170" href="#lab03-mcp-tools-lab-__codelineno-3-170"></a><span class="w">                  </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">2.8</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-3-171"><a id="__codelineno-3-171" name="__codelineno-3-171" href="#lab03-mcp-tools-lab-__codelineno-3-171"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-3-172"><a id="__codelineno-3-172" name="__codelineno-3-172" href="#lab03-mcp-tools-lab-__codelineno-3-172"></a><span class="w">              </span><span class="p">};</span>
</span><span id="__span-3-173"><a id="__codelineno-3-173" name="__codelineno-3-173" href="#lab03-mcp-tools-lab-__codelineno-3-173"></a><span class="w">              </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fallbackData</span><span class="p">[</span><span class="nx">city</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">trim</span><span class="p">()]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">fallbackData</span><span class="p">[</span><span class="s2">&quot;london&quot;</span><span class="p">];</span>
</span><span id="__span-3-174"><a id="__codelineno-3-174" name="__codelineno-3-174" href="#lab03-mcp-tools-lab-__codelineno-3-174"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-3-175"><a id="__codelineno-3-175" name="__codelineno-3-175" href="#lab03-mcp-tools-lab-__codelineno-3-175"></a>
</span><span id="__span-3-176"><a id="__codelineno-3-176" name="__codelineno-3-176" href="#lab03-mcp-tools-lab-__codelineno-3-176"></a><span class="w">            </span><span class="c1">// Format response</span>
</span><span id="__span-3-177"><a id="__codelineno-3-177" name="__codelineno-3-177" href="#lab03-mcp-tools-lab-__codelineno-3-177"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">tempUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">units</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;fahrenheit&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">&quot;°F&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;°C&quot;</span><span class="p">;</span>
</span><span id="__span-3-178"><a id="__codelineno-3-178" name="__codelineno-3-178" href="#lab03-mcp-tools-lab-__codelineno-3-178"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">weatherText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-3-179"><a id="__codelineno-3-179" name="__codelineno-3-179" href="#lab03-mcp-tools-lab-__codelineno-3-179"></a><span class="sb">Weather in </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">sys</span><span class="p">.</span><span class="nx">country</span><span class="si">}</span><span class="sb">:</span>
</span><span id="__span-3-180"><a id="__codelineno-3-180" name="__codelineno-3-180" href="#lab03-mcp-tools-lab-__codelineno-3-180"></a><span class="sb">- Temperature: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">temp</span><span class="si">}${</span><span class="nx">tempUnit</span><span class="si">}</span>
</span><span id="__span-3-181"><a id="__codelineno-3-181" name="__codelineno-3-181" href="#lab03-mcp-tools-lab-__codelineno-3-181"></a><span class="sb">- Feels like: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">feels_like</span><span class="si">}${</span><span class="nx">tempUnit</span><span class="si">}</span>
</span><span id="__span-3-182"><a id="__codelineno-3-182" name="__codelineno-3-182" href="#lab03-mcp-tools-lab-__codelineno-3-182"></a><span class="sb">- Conditions: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">weather</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">description</span><span class="si">}</span>
</span><span id="__span-3-183"><a id="__codelineno-3-183" name="__codelineno-3-183" href="#lab03-mcp-tools-lab-__codelineno-3-183"></a><span class="sb">- Humidity: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">humidity</span><span class="si">}</span><span class="sb">%</span>
</span><span id="__span-3-184"><a id="__codelineno-3-184" name="__codelineno-3-184" href="#lab03-mcp-tools-lab-__codelineno-3-184"></a><span class="sb">- Wind Speed: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">wind</span><span class="p">.</span><span class="nx">speed</span><span class="si">}</span><span class="sb"> m/s</span>
</span><span id="__span-3-185"><a id="__codelineno-3-185" name="__codelineno-3-185" href="#lab03-mcp-tools-lab-__codelineno-3-185"></a>
</span><span id="__span-3-186"><a id="__codelineno-3-186" name="__codelineno-3-186" href="#lab03-mcp-tools-lab-__codelineno-3-186"></a><span class="sb">*Generated by Ollama AI*</span>
</span><span id="__span-3-187"><a id="__codelineno-3-187" name="__codelineno-3-187" href="#lab03-mcp-tools-lab-__codelineno-3-187"></a><span class="sb">`</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
</span><span id="__span-3-188"><a id="__codelineno-3-188" name="__codelineno-3-188" href="#lab03-mcp-tools-lab-__codelineno-3-188"></a>
</span><span id="__span-3-189"><a id="__codelineno-3-189" name="__codelineno-3-189" href="#lab03-mcp-tools-lab-__codelineno-3-189"></a><span class="w">            </span><span class="c1">// Return MCP response</span>
</span><span id="__span-3-190"><a id="__codelineno-3-190" name="__codelineno-3-190" href="#lab03-mcp-tools-lab-__codelineno-3-190"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-191"><a id="__codelineno-3-191" name="__codelineno-3-191" href="#lab03-mcp-tools-lab-__codelineno-3-191"></a><span class="w">              </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-3-192"><a id="__codelineno-3-192" name="__codelineno-3-192" href="#lab03-mcp-tools-lab-__codelineno-3-192"></a><span class="w">                </span><span class="p">{</span>
</span><span id="__span-3-193"><a id="__codelineno-3-193" name="__codelineno-3-193" href="#lab03-mcp-tools-lab-__codelineno-3-193"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-3-194"><a id="__codelineno-3-194" name="__codelineno-3-194" href="#lab03-mcp-tools-lab-__codelineno-3-194"></a><span class="w">                  </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">weatherText</span>
</span><span id="__span-3-195"><a id="__codelineno-3-195" name="__codelineno-3-195" href="#lab03-mcp-tools-lab-__codelineno-3-195"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-3-196"><a id="__codelineno-3-196" name="__codelineno-3-196" href="#lab03-mcp-tools-lab-__codelineno-3-196"></a><span class="w">              </span><span class="p">]</span>
</span><span id="__span-3-197"><a id="__codelineno-3-197" name="__codelineno-3-197" href="#lab03-mcp-tools-lab-__codelineno-3-197"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-3-198"><a id="__codelineno-3-198" name="__codelineno-3-198" href="#lab03-mcp-tools-lab-__codelineno-3-198"></a>
</span><span id="__span-3-199"><a id="__codelineno-3-199" name="__codelineno-3-199" href="#lab03-mcp-tools-lab-__codelineno-3-199"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-200"><a id="__codelineno-3-200" name="__codelineno-3-200" href="#lab03-mcp-tools-lab-__codelineno-3-200"></a><span class="w">            </span><span class="c1">// Handle errors</span>
</span><span id="__span-3-201"><a id="__codelineno-3-201" name="__codelineno-3-201" href="#lab03-mcp-tools-lab-__codelineno-3-201"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-3-202"><a id="__codelineno-3-202" name="__codelineno-3-202" href="#lab03-mcp-tools-lab-__codelineno-3-202"></a><span class="w">              </span><span class="sb">`Failed to get weather: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-3-203"><a id="__codelineno-3-203" name="__codelineno-3-203" href="#lab03-mcp-tools-lab-__codelineno-3-203"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-3-204"><a id="__codelineno-3-204" name="__codelineno-3-204" href="#lab03-mcp-tools-lab-__codelineno-3-204"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-3-205"><a id="__codelineno-3-205" name="__codelineno-3-205" href="#lab03-mcp-tools-lab-__codelineno-3-205"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-3-206"><a id="__codelineno-3-206" name="__codelineno-3-206" href="#lab03-mcp-tools-lab-__codelineno-3-206"></a>
</span><span id="__span-3-207"><a id="__codelineno-3-207" name="__codelineno-3-207" href="#lab03-mcp-tools-lab-__codelineno-3-207"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;hello_world&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-208"><a id="__codelineno-3-208" name="__codelineno-3-208" href="#lab03-mcp-tools-lab-__codelineno-3-208"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-3-209"><a id="__codelineno-3-209" name="__codelineno-3-209" href="#lab03-mcp-tools-lab-__codelineno-3-209"></a>
</span><span id="__span-3-210"><a id="__codelineno-3-210" name="__codelineno-3-210" href="#lab03-mcp-tools-lab-__codelineno-3-210"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">userName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-211"><a id="__codelineno-3-211" name="__codelineno-3-211" href="#lab03-mcp-tools-lab-__codelineno-3-211"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Name parameter is required&quot;</span><span class="p">);</span>
</span><span id="__span-3-212"><a id="__codelineno-3-212" name="__codelineno-3-212" href="#lab03-mcp-tools-lab-__codelineno-3-212"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-3-213"><a id="__codelineno-3-213" name="__codelineno-3-213" href="#lab03-mcp-tools-lab-__codelineno-3-213"></a>
</span><span id="__span-3-214"><a id="__codelineno-3-214" name="__codelineno-3-214" href="#lab03-mcp-tools-lab-__codelineno-3-214"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-215"><a id="__codelineno-3-215" name="__codelineno-3-215" href="#lab03-mcp-tools-lab-__codelineno-3-215"></a><span class="w">            </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-3-216"><a id="__codelineno-3-216" name="__codelineno-3-216" href="#lab03-mcp-tools-lab-__codelineno-3-216"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-3-217"><a id="__codelineno-3-217" name="__codelineno-3-217" href="#lab03-mcp-tools-lab-__codelineno-3-217"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-3-218"><a id="__codelineno-3-218" name="__codelineno-3-218" href="#lab03-mcp-tools-lab-__codelineno-3-218"></a><span class="w">                </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Hello, </span><span class="si">${</span><span class="nx">userName</span><span class="si">}</span><span class="sb">! Welcome to your first MCP server! 🎉`</span><span class="p">,</span>
</span><span id="__span-3-219"><a id="__codelineno-3-219" name="__codelineno-3-219" href="#lab03-mcp-tools-lab-__codelineno-3-219"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-3-220"><a id="__codelineno-3-220" name="__codelineno-3-220" href="#lab03-mcp-tools-lab-__codelineno-3-220"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-3-221"><a id="__codelineno-3-221" name="__codelineno-3-221" href="#lab03-mcp-tools-lab-__codelineno-3-221"></a><span class="w">          </span><span class="p">};</span>
</span><span id="__span-3-222"><a id="__codelineno-3-222" name="__codelineno-3-222" href="#lab03-mcp-tools-lab-__codelineno-3-222"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-3-223"><a id="__codelineno-3-223" name="__codelineno-3-223" href="#lab03-mcp-tools-lab-__codelineno-3-223"></a>
</span><span id="__span-3-224"><a id="__codelineno-3-224" name="__codelineno-3-224" href="#lab03-mcp-tools-lab-__codelineno-3-224"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-3-225"><a id="__codelineno-3-225" name="__codelineno-3-225" href="#lab03-mcp-tools-lab-__codelineno-3-225"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-3-226"><a id="__codelineno-3-226" name="__codelineno-3-226" href="#lab03-mcp-tools-lab-__codelineno-3-226"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-3-227"><a id="__codelineno-3-227" name="__codelineno-3-227" href="#lab03-mcp-tools-lab-__codelineno-3-227"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-3-228"><a id="__codelineno-3-228" name="__codelineno-3-228" href="#lab03-mcp-tools-lab-__codelineno-3-228"></a>
</span><span id="__span-3-229"><a id="__codelineno-3-229" name="__codelineno-3-229" href="#lab03-mcp-tools-lab-__codelineno-3-229"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-3-230"><a id="__codelineno-3-230" name="__codelineno-3-230" href="#lab03-mcp-tools-lab-__codelineno-3-230"></a><span class="cm">  * Set up error handling</span>
</span><span id="__span-3-231"><a id="__codelineno-3-231" name="__codelineno-3-231" href="#lab03-mcp-tools-lab-__codelineno-3-231"></a><span class="cm">  */</span>
</span><span id="__span-3-232"><a id="__codelineno-3-232" name="__codelineno-3-232" href="#lab03-mcp-tools-lab-__codelineno-3-232"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-233"><a id="__codelineno-3-233" name="__codelineno-3-233" href="#lab03-mcp-tools-lab-__codelineno-3-233"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-234"><a id="__codelineno-3-234" name="__codelineno-3-234" href="#lab03-mcp-tools-lab-__codelineno-3-234"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-3-235"><a id="__codelineno-3-235" name="__codelineno-3-235" href="#lab03-mcp-tools-lab-__codelineno-3-235"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-3-236"><a id="__codelineno-3-236" name="__codelineno-3-236" href="#lab03-mcp-tools-lab-__codelineno-3-236"></a>
</span><span id="__span-3-237"><a id="__codelineno-3-237" name="__codelineno-3-237" href="#lab03-mcp-tools-lab-__codelineno-3-237"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-238"><a id="__codelineno-3-238" name="__codelineno-3-238" href="#lab03-mcp-tools-lab-__codelineno-3-238"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-3-239"><a id="__codelineno-3-239" name="__codelineno-3-239" href="#lab03-mcp-tools-lab-__codelineno-3-239"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-3-240"><a id="__codelineno-3-240" name="__codelineno-3-240" href="#lab03-mcp-tools-lab-__codelineno-3-240"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-3-241"><a id="__codelineno-3-241" name="__codelineno-3-241" href="#lab03-mcp-tools-lab-__codelineno-3-241"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-3-242"><a id="__codelineno-3-242" name="__codelineno-3-242" href="#lab03-mcp-tools-lab-__codelineno-3-242"></a>
</span><span id="__span-3-243"><a id="__codelineno-3-243" name="__codelineno-3-243" href="#lab03-mcp-tools-lab-__codelineno-3-243"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-3-244"><a id="__codelineno-3-244" name="__codelineno-3-244" href="#lab03-mcp-tools-lab-__codelineno-3-244"></a><span class="cm">  * Start the server</span>
</span><span id="__span-3-245"><a id="__codelineno-3-245" name="__codelineno-3-245" href="#lab03-mcp-tools-lab-__codelineno-3-245"></a><span class="cm">  */</span>
</span><span id="__span-3-246"><a id="__codelineno-3-246" name="__codelineno-3-246" href="#lab03-mcp-tools-lab-__codelineno-3-246"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-247"><a id="__codelineno-3-247" name="__codelineno-3-247" href="#lab03-mcp-tools-lab-__codelineno-3-247"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-3-248"><a id="__codelineno-3-248" name="__codelineno-3-248" href="#lab03-mcp-tools-lab-__codelineno-3-248"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-3-249"><a id="__codelineno-3-249" name="__codelineno-3-249" href="#lab03-mcp-tools-lab-__codelineno-3-249"></a>
</span><span id="__span-3-250"><a id="__codelineno-3-250" name="__codelineno-3-250" href="#lab03-mcp-tools-lab-__codelineno-3-250"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;My First MCP Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-3-251"><a id="__codelineno-3-251" name="__codelineno-3-251" href="#lab03-mcp-tools-lab-__codelineno-3-251"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-3-252"><a id="__codelineno-3-252" name="__codelineno-3-252" href="#lab03-mcp-tools-lab-__codelineno-3-252"></a><span class="p">}</span>
</span><span id="__span-3-253"><a id="__codelineno-3-253" name="__codelineno-3-253" href="#lab03-mcp-tools-lab-__codelineno-3-253"></a>
</span><span id="__span-3-254"><a id="__codelineno-3-254" name="__codelineno-3-254" href="#lab03-mcp-tools-lab-__codelineno-3-254"></a><span class="cm">/**</span>
</span><span id="__span-3-255"><a id="__codelineno-3-255" name="__codelineno-3-255" href="#lab03-mcp-tools-lab-__codelineno-3-255"></a><span class="cm">* Main entry point</span>
</span><span id="__span-3-256"><a id="__codelineno-3-256" name="__codelineno-3-256" href="#lab03-mcp-tools-lab-__codelineno-3-256"></a><span class="cm">*/</span>
</span><span id="__span-3-257"><a id="__codelineno-3-257" name="__codelineno-3-257" href="#lab03-mcp-tools-lab-__codelineno-3-257"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-258"><a id="__codelineno-3-258" name="__codelineno-3-258" href="#lab03-mcp-tools-lab-__codelineno-3-258"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MyFirstMCPServer</span><span class="p">();</span>
</span><span id="__span-3-259"><a id="__codelineno-3-259" name="__codelineno-3-259" href="#lab03-mcp-tools-lab-__codelineno-3-259"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-3-260"><a id="__codelineno-3-260" name="__codelineno-3-260" href="#lab03-mcp-tools-lab-__codelineno-3-260"></a><span class="p">}</span>
</span><span id="__span-3-261"><a id="__codelineno-3-261" name="__codelineno-3-261" href="#lab03-mcp-tools-lab-__codelineno-3-261"></a>
</span><span id="__span-3-262"><a id="__codelineno-3-262" name="__codelineno-3-262" href="#lab03-mcp-tools-lab-__codelineno-3-262"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-263"><a id="__codelineno-3-263" name="__codelineno-3-263" href="#lab03-mcp-tools-lab-__codelineno-3-263"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-3-264"><a id="__codelineno-3-264" name="__codelineno-3-264" href="#lab03-mcp-tools-lab-__codelineno-3-264"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-3-265"><a id="__codelineno-3-265" name="__codelineno-3-265" href="#lab03-mcp-tools-lab-__codelineno-3-265"></a><span class="p">});</span>
</span></code></pre></div>
<h4 id="lab03-mcp-tools-lab-testing-the-weather-tool-with-ollama">Testing the Weather Tool with Ollama:<a class="headerlink" href="#lab03-mcp-tools-lab-testing-the-weather-tool-with-ollama" title="Permanent link">&para;</a></h4>
<p><strong>Step 1: Install Ollama</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab03-mcp-tools-lab-__codelineno-4-1"></a><span class="c1"># On macOS (using Homebrew)</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#lab03-mcp-tools-lab-__codelineno-4-2"></a>brew<span class="w"> </span>install<span class="w"> </span>ollama
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#lab03-mcp-tools-lab-__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#lab03-mcp-tools-lab-__codelineno-4-4"></a><span class="c1"># Or download from the official website: https://ollama.ai/download</span>
</span></code></pre></div>
<p><strong>Step 2: Download a Model</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab03-mcp-tools-lab-__codelineno-5-1"></a><span class="c1"># Pull the recommended model for this lab</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#lab03-mcp-tools-lab-__codelineno-5-2"></a>ollama<span class="w"> </span>pull<span class="w"> </span>gpt-oss:20b
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#lab03-mcp-tools-lab-__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#lab03-mcp-tools-lab-__codelineno-5-4"></a><span class="c1"># List available models to verify the download completed successfully</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#lab03-mcp-tools-lab-__codelineno-5-5"></a>ollama<span class="w"> </span>list
</span></code></pre></div>
<p><strong>Step 3: Start Ollama Server</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab03-mcp-tools-lab-__codelineno-6-1"></a><span class="c1"># Start the Ollama server (keep this running in a terminal)</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab03-mcp-tools-lab-__codelineno-6-2"></a>ollama<span class="w"> </span>serve
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#lab03-mcp-tools-lab-__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#lab03-mcp-tools-lab-__codelineno-6-4"></a><span class="c1"># Check which models are currently running locally:</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#lab03-mcp-tools-lab-__codelineno-6-5"></a>curl<span class="w"> </span>http://localhost:11434/api/tags<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span></code></pre></div>
<p>The server will run on <a href="http://localhost:11434">http://localhost:11434</a> by default.</p>
<p><strong>Step 4: Test the Weather Tool</strong></p>
<ol>
<li>
<p><strong>Start the MCP Inspector</strong> (in a new terminal):
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab03-mcp-tools-lab-__codelineno-7-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
</span></code></pre></div></p>
</li>
<li>
<p><strong>In the MCP Inspector interface</strong>:</p>
<ul>
<li>You should see both <code>get_weather</code> and <code>hello_world</code> tools listed</li>
<li>Click on <code>get_weather</code> tool</li>
<li>Enter a city name like &ldquo;London&rdquo;, &ldquo;New York&rdquo;, &ldquo;Tokyo&rdquo;, &ldquo;Paris&rdquo;, or &ldquo;Sydney&rdquo;</li>
<li>Optionally set units to &ldquo;fahrenheit&rdquo; for Fahrenheit temperatures</li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Test different scenarios</strong>:</p>
<ul>
<li>Valid cities: &ldquo;London&rdquo;, &ldquo;New York&rdquo;, &ldquo;Tokyo&rdquo;, &ldquo;Paris&rdquo;, &ldquo;Sydney&rdquo;</li>
<li>Invalid cities: &ldquo;InvalidCity123&rdquo; (will use fallback data)</li>
<li>Different units: Try both &ldquo;celsius&rdquo; and &ldquo;fahrenheit&rdquo;</li>
<li>Empty city: Try with empty string (should show validation error)</li>
</ul>
</li>
<li>
<p><strong>Test error cases</strong>:</p>
<ul>
<li>Stop Ollama server and try calling the tool (should show API error)</li>
<li>Try with invalid model name in the code (should show error)</li>
</ul>
</li>
</ol>
<p><strong>Step 5: Verify Everything Works</strong></p>
<ul>
<li>
<p>You should see AI-generated weather information formatted like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab03-mcp-tools-lab-__codelineno-8-1"></a>Weather in London, GB:
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#lab03-mcp-tools-lab-__codelineno-8-2"></a>- Temperature: 15.2°C
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#lab03-mcp-tools-lab-__codelineno-8-3"></a>- Feels like: 14.8°C
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#lab03-mcp-tools-lab-__codelineno-8-4"></a>- Conditions: light rain
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#lab03-mcp-tools-lab-__codelineno-8-5"></a>- Humidity: 82%
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#lab03-mcp-tools-lab-__codelineno-8-6"></a>- Wind Speed: 3.6 m/s
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#lab03-mcp-tools-lab-__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#lab03-mcp-tools-lab-__codelineno-8-8"></a>*Generated by Ollama AI*
</span></code></pre></div>
</li>
</ul>
<p><strong>Troubleshooting:</strong></p>
<ul>
<li>If you get &ldquo;Ollama API error&rdquo;, make sure <code>ollama serve</code> is running</li>
<li>If you see fallback data, Ollama might not be responding properly</li>
<li>Check that the model is downloaded with <code>ollama list</code></li>
<li>Try a different model if gpt-oss:20b doesn&rsquo;t work well</li>
<li>Make sure you&rsquo;re in the correct directory when running commands</li>
</ul>
<h4 id="lab03-mcp-tools-lab-key-learning-points">Key Learning Points:<a class="headerlink" href="#lab03-mcp-tools-lab-key-learning-points" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Local AI integration</strong> using Ollama for generating content</li>
<li><strong>Fallback handling</strong> when AI services are unavailable</li>
<li><strong>JSON parsing</strong> from AI-generated responses</li>
<li><strong>Error handling</strong> for external service dependencies</li>
<li><strong>Input validation</strong> and data formatting</li>
<li><strong>API communication</strong> with local services</li>
</ul>
<hr />
<h3 id="lab03-mcp-tools-lab-tool-2-file-operations">Tool 2: File Operations<a class="headerlink" href="#lab03-mcp-tools-lab-tool-2-file-operations" title="Permanent link">&para;</a></h3>
<p><strong>Goal</strong>: Create a secure file reading tool that can handle various file types, validate paths, and return formatted content with metadata.</p>
<h4 id="lab03-mcp-tools-lab-complete-file-operations-tool-implementation">Complete File Operations Tool Implementation<a class="headerlink" href="#lab03-mcp-tools-lab-complete-file-operations-tool-implementation" title="Permanent link">&para;</a></h4>
<p><strong>Important</strong>: Do NOT copy the entire code block below. Instead, add the <code>read_file</code> tool to your existing <code>src/index.ts</code> file by following these specific steps:</p>
<ol>
<li>
<p><strong>Add the import</strong> at the top of your file (after existing imports):
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab03-mcp-tools-lab-__codelineno-9-1"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs/promises&#39;</span><span class="p">;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#lab03-mcp-tools-lab-__codelineno-9-2"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;path&#39;</span><span class="p">;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add the <code>read_file</code> tool to your tools array</strong> in the <code>ListToolsRequestSchema</code> handler:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab03-mcp-tools-lab-__codelineno-10-1"></a><span class="p">{</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#lab03-mcp-tools-lab-__codelineno-10-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;read_file&quot;</span><span class="p">,</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#lab03-mcp-tools-lab-__codelineno-10-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Read contents of a text file with security validation&quot;</span><span class="p">,</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#lab03-mcp-tools-lab-__codelineno-10-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#lab03-mcp-tools-lab-__codelineno-10-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#lab03-mcp-tools-lab-__codelineno-10-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#lab03-mcp-tools-lab-__codelineno-10-7"></a><span class="w">      </span><span class="nx">filepath</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#lab03-mcp-tools-lab-__codelineno-10-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#lab03-mcp-tools-lab-__codelineno-10-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Absolute path to the file&quot;</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#lab03-mcp-tools-lab-__codelineno-10-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#lab03-mcp-tools-lab-__codelineno-10-11"></a><span class="w">      </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#lab03-mcp-tools-lab-__codelineno-10-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#lab03-mcp-tools-lab-__codelineno-10-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;File encoding&quot;</span><span class="p">,</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#lab03-mcp-tools-lab-__codelineno-10-14"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;utf8&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;base64&quot;</span><span class="p">],</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#lab03-mcp-tools-lab-__codelineno-10-15"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;utf8&quot;</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#lab03-mcp-tools-lab-__codelineno-10-16"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#lab03-mcp-tools-lab-__codelineno-10-17"></a><span class="w">      </span><span class="nx">maxSize</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#lab03-mcp-tools-lab-__codelineno-10-18"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#lab03-mcp-tools-lab-__codelineno-10-19"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum file size in bytes&quot;</span><span class="p">,</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#lab03-mcp-tools-lab-__codelineno-10-20"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#lab03-mcp-tools-lab-__codelineno-10-21"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">10485760</span><span class="p">,</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#lab03-mcp-tools-lab-__codelineno-10-22"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">1048576</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#lab03-mcp-tools-lab-__codelineno-10-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#lab03-mcp-tools-lab-__codelineno-10-24"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#lab03-mcp-tools-lab-__codelineno-10-25"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;filepath&quot;</span><span class="p">]</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#lab03-mcp-tools-lab-__codelineno-10-26"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#lab03-mcp-tools-lab-__codelineno-10-27"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add the <code>read_file</code> handler</strong> in the <code>CallToolRequestSchema</code> handler (before the final <code>throw new Error</code>):
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#lab03-mcp-tools-lab-__codelineno-11-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;read_file&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#lab03-mcp-tools-lab-__codelineno-11-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#lab03-mcp-tools-lab-__codelineno-11-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#lab03-mcp-tools-lab-__codelineno-11-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">encoding</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">BufferEncoding</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;utf8&quot;</span><span class="p">;</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#lab03-mcp-tools-lab-__codelineno-11-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">1048576</span><span class="p">;</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#lab03-mcp-tools-lab-__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#lab03-mcp-tools-lab-__codelineno-11-7"></a><span class="w">    </span><span class="c1">// Security: Validate input</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#lab03-mcp-tools-lab-__codelineno-11-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">filepath</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">filepath</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#lab03-mcp-tools-lab-__codelineno-11-9"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;filepath must be a non-empty string&quot;</span><span class="p">);</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#lab03-mcp-tools-lab-__codelineno-11-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#lab03-mcp-tools-lab-__codelineno-11-11"></a>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#lab03-mcp-tools-lab-__codelineno-11-12"></a><span class="w">    </span><span class="c1">// Security: Resolve and validate path</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#lab03-mcp-tools-lab-__codelineno-11-13"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">resolvedPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">filepath</span><span class="p">);</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#lab03-mcp-tools-lab-__codelineno-11-14"></a>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#lab03-mcp-tools-lab-__codelineno-11-15"></a><span class="w">    </span><span class="c1">// Prevent directory traversal attacks</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#lab03-mcp-tools-lab-__codelineno-11-16"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">resolvedPath</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#lab03-mcp-tools-lab-__codelineno-11-17"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Access denied: file path outside allowed directory&quot;</span><span class="p">);</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#lab03-mcp-tools-lab-__codelineno-11-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#lab03-mcp-tools-lab-__codelineno-11-19"></a>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#lab03-mcp-tools-lab-__codelineno-11-20"></a><span class="w">    </span><span class="c1">// Check if file exists and is readable</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#lab03-mcp-tools-lab-__codelineno-11-21"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#lab03-mcp-tools-lab-__codelineno-11-22"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">,</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">R_OK</span><span class="p">);</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#lab03-mcp-tools-lab-__codelineno-11-23"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#lab03-mcp-tools-lab-__codelineno-11-24"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`File not found or not readable: </span><span class="si">${</span><span class="nx">filepath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#lab03-mcp-tools-lab-__codelineno-11-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#lab03-mcp-tools-lab-__codelineno-11-26"></a>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#lab03-mcp-tools-lab-__codelineno-11-27"></a><span class="w">    </span><span class="c1">// Get file stats</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#lab03-mcp-tools-lab-__codelineno-11-28"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">);</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#lab03-mcp-tools-lab-__codelineno-11-29"></a>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#lab03-mcp-tools-lab-__codelineno-11-30"></a><span class="w">    </span><span class="c1">// Check if it&#39;s actually a file (not a directory)</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#lab03-mcp-tools-lab-__codelineno-11-31"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">stats</span><span class="p">.</span><span class="nx">isFile</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#lab03-mcp-tools-lab-__codelineno-11-32"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Path is not a file: </span><span class="si">${</span><span class="nx">filepath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#lab03-mcp-tools-lab-__codelineno-11-33"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="#lab03-mcp-tools-lab-__codelineno-11-34"></a>
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="#lab03-mcp-tools-lab-__codelineno-11-35"></a><span class="w">    </span><span class="c1">// Check file size</span>
</span><span id="__span-11-36"><a id="__codelineno-11-36" name="__codelineno-11-36" href="#lab03-mcp-tools-lab-__codelineno-11-36"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">maxSize</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-37"><a id="__codelineno-11-37" name="__codelineno-11-37" href="#lab03-mcp-tools-lab-__codelineno-11-37"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-11-38"><a id="__codelineno-11-38" name="__codelineno-11-38" href="#lab03-mcp-tools-lab-__codelineno-11-38"></a><span class="w">        </span><span class="sb">`File too large: </span><span class="si">${</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="si">}</span><span class="sb"> bytes (max: </span><span class="si">${</span><span class="nx">maxSize</span><span class="si">}</span><span class="sb">)`</span>
</span><span id="__span-11-39"><a id="__codelineno-11-39" name="__codelineno-11-39" href="#lab03-mcp-tools-lab-__codelineno-11-39"></a><span class="w">      </span><span class="p">);</span>
</span><span id="__span-11-40"><a id="__codelineno-11-40" name="__codelineno-11-40" href="#lab03-mcp-tools-lab-__codelineno-11-40"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-41"><a id="__codelineno-11-41" name="__codelineno-11-41" href="#lab03-mcp-tools-lab-__codelineno-11-41"></a>
</span><span id="__span-11-42"><a id="__codelineno-11-42" name="__codelineno-11-42" href="#lab03-mcp-tools-lab-__codelineno-11-42"></a><span class="w">    </span><span class="c1">// Read file content</span>
</span><span id="__span-11-43"><a id="__codelineno-11-43" name="__codelineno-11-43" href="#lab03-mcp-tools-lab-__codelineno-11-43"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">,</span><span class="w"> </span><span class="nx">encoding</span><span class="p">);</span>
</span><span id="__span-11-44"><a id="__codelineno-11-44" name="__codelineno-11-44" href="#lab03-mcp-tools-lab-__codelineno-11-44"></a>
</span><span id="__span-11-45"><a id="__codelineno-11-45" name="__codelineno-11-45" href="#lab03-mcp-tools-lab-__codelineno-11-45"></a><span class="w">    </span><span class="c1">// Format response with metadata</span>
</span><span id="__span-11-46"><a id="__codelineno-11-46" name="__codelineno-11-46" href="#lab03-mcp-tools-lab-__codelineno-11-46"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">fileInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-47"><a id="__codelineno-11-47" name="__codelineno-11-47" href="#lab03-mcp-tools-lab-__codelineno-11-47"></a><span class="w">      </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="kt">resolvedPath</span><span class="p">,</span>
</span><span id="__span-11-48"><a id="__codelineno-11-48" name="__codelineno-11-48" href="#lab03-mcp-tools-lab-__codelineno-11-48"></a><span class="w">      </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="kt">stats.size</span><span class="p">,</span>
</span><span id="__span-11-49"><a id="__codelineno-11-49" name="__codelineno-11-49" href="#lab03-mcp-tools-lab-__codelineno-11-49"></a><span class="w">      </span><span class="nx">modified</span><span class="o">:</span><span class="w"> </span><span class="kt">stats.mtime.toISOString</span><span class="p">(),</span>
</span><span id="__span-11-50"><a id="__codelineno-11-50" name="__codelineno-11-50" href="#lab03-mcp-tools-lab-__codelineno-11-50"></a><span class="w">      </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="kt">encoding</span>
</span><span id="__span-11-51"><a id="__codelineno-11-51" name="__codelineno-11-51" href="#lab03-mcp-tools-lab-__codelineno-11-51"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-11-52"><a id="__codelineno-11-52" name="__codelineno-11-52" href="#lab03-mcp-tools-lab-__codelineno-11-52"></a>
</span><span id="__span-11-53"><a id="__codelineno-11-53" name="__codelineno-11-53" href="#lab03-mcp-tools-lab-__codelineno-11-53"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-54"><a id="__codelineno-11-54" name="__codelineno-11-54" href="#lab03-mcp-tools-lab-__codelineno-11-54"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-11-55"><a id="__codelineno-11-55" name="__codelineno-11-55" href="#lab03-mcp-tools-lab-__codelineno-11-55"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-11-56"><a id="__codelineno-11-56" name="__codelineno-11-56" href="#lab03-mcp-tools-lab-__codelineno-11-56"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-11-57"><a id="__codelineno-11-57" name="__codelineno-11-57" href="#lab03-mcp-tools-lab-__codelineno-11-57"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`File Information:\n</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">fileInfo</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">\n\nContent:\n</span><span class="si">${</span><span class="nx">content</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-11-58"><a id="__codelineno-11-58" name="__codelineno-11-58" href="#lab03-mcp-tools-lab-__codelineno-11-58"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-11-59"><a id="__codelineno-11-59" name="__codelineno-11-59" href="#lab03-mcp-tools-lab-__codelineno-11-59"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-11-60"><a id="__codelineno-11-60" name="__codelineno-11-60" href="#lab03-mcp-tools-lab-__codelineno-11-60"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-11-61"><a id="__codelineno-11-61" name="__codelineno-11-61" href="#lab03-mcp-tools-lab-__codelineno-11-61"></a>
</span><span id="__span-11-62"><a id="__codelineno-11-62" name="__codelineno-11-62" href="#lab03-mcp-tools-lab-__codelineno-11-62"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-63"><a id="__codelineno-11-63" name="__codelineno-11-63" href="#lab03-mcp-tools-lab-__codelineno-11-63"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-11-64"><a id="__codelineno-11-64" name="__codelineno-11-64" href="#lab03-mcp-tools-lab-__codelineno-11-64"></a><span class="w">      </span><span class="sb">`Failed to read file: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-11-65"><a id="__codelineno-11-65" name="__codelineno-11-65" href="#lab03-mcp-tools-lab-__codelineno-11-65"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-11-66"><a id="__codelineno-11-66" name="__codelineno-11-66" href="#lab03-mcp-tools-lab-__codelineno-11-66"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-11-67"><a id="__codelineno-11-67" name="__codelineno-11-67" href="#lab03-mcp-tools-lab-__codelineno-11-67"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
</ol>
<p><strong>The code block below is for reference only</strong> - it shows what your complete file should look like after adding the tool. Do not copy-paste the entire block:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab03-mcp-tools-lab-__codelineno-12-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#lab03-mcp-tools-lab-__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#lab03-mcp-tools-lab-__codelineno-12-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#lab03-mcp-tools-lab-__codelineno-12-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#lab03-mcp-tools-lab-__codelineno-12-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#lab03-mcp-tools-lab-__codelineno-12-6"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#lab03-mcp-tools-lab-__codelineno-12-7"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#lab03-mcp-tools-lab-__codelineno-12-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#lab03-mcp-tools-lab-__codelineno-12-9"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs/promises&#39;</span><span class="p">;</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#lab03-mcp-tools-lab-__codelineno-12-10"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;path&#39;</span><span class="p">;</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#lab03-mcp-tools-lab-__codelineno-12-11"></a>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#lab03-mcp-tools-lab-__codelineno-12-12"></a><span class="cm">/**</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#lab03-mcp-tools-lab-__codelineno-12-13"></a><span class="cm">* Create an MCP server with core capabilities</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#lab03-mcp-tools-lab-__codelineno-12-14"></a><span class="cm">*/</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#lab03-mcp-tools-lab-__codelineno-12-15"></a><span class="kd">class</span><span class="w"> </span><span class="nx">MyFirstMCPServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#lab03-mcp-tools-lab-__codelineno-12-16"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#lab03-mcp-tools-lab-__codelineno-12-17"></a>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#lab03-mcp-tools-lab-__codelineno-12-18"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#lab03-mcp-tools-lab-__codelineno-12-19"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#lab03-mcp-tools-lab-__codelineno-12-20"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#lab03-mcp-tools-lab-__codelineno-12-21"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;my-first-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#lab03-mcp-tools-lab-__codelineno-12-22"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#lab03-mcp-tools-lab-__codelineno-12-23"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#lab03-mcp-tools-lab-__codelineno-12-24"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#lab03-mcp-tools-lab-__codelineno-12-25"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#lab03-mcp-tools-lab-__codelineno-12-26"></a><span class="w">          </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#lab03-mcp-tools-lab-__codelineno-12-27"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#lab03-mcp-tools-lab-__codelineno-12-28"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#lab03-mcp-tools-lab-__codelineno-12-29"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#lab03-mcp-tools-lab-__codelineno-12-30"></a>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#lab03-mcp-tools-lab-__codelineno-12-31"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#lab03-mcp-tools-lab-__codelineno-12-32"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#lab03-mcp-tools-lab-__codelineno-12-33"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#lab03-mcp-tools-lab-__codelineno-12-34"></a>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#lab03-mcp-tools-lab-__codelineno-12-35"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#lab03-mcp-tools-lab-__codelineno-12-36"></a><span class="cm">  * Set up request handlers</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#lab03-mcp-tools-lab-__codelineno-12-37"></a><span class="cm">  */</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#lab03-mcp-tools-lab-__codelineno-12-38"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#lab03-mcp-tools-lab-__codelineno-12-39"></a><span class="w">    </span><span class="c1">// Handler for listing available tools</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#lab03-mcp-tools-lab-__codelineno-12-40"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41" href="#lab03-mcp-tools-lab-__codelineno-12-41"></a><span class="w">      </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42" href="#lab03-mcp-tools-lab-__codelineno-12-42"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43" href="#lab03-mcp-tools-lab-__codelineno-12-43"></a><span class="w">        </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-12-44"><a id="__codelineno-12-44" name="__codelineno-12-44" href="#lab03-mcp-tools-lab-__codelineno-12-44"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-12-45"><a id="__codelineno-12-45" name="__codelineno-12-45" href="#lab03-mcp-tools-lab-__codelineno-12-45"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;get_weather&quot;</span><span class="p">,</span>
</span><span id="__span-12-46"><a id="__codelineno-12-46" name="__codelineno-12-46" href="#lab03-mcp-tools-lab-__codelineno-12-46"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Get current weather information for a city using AI&quot;</span><span class="p">,</span>
</span><span id="__span-12-47"><a id="__codelineno-12-47" name="__codelineno-12-47" href="#lab03-mcp-tools-lab-__codelineno-12-47"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-48"><a id="__codelineno-12-48" name="__codelineno-12-48" href="#lab03-mcp-tools-lab-__codelineno-12-48"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-12-49"><a id="__codelineno-12-49" name="__codelineno-12-49" href="#lab03-mcp-tools-lab-__codelineno-12-49"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-50"><a id="__codelineno-12-50" name="__codelineno-12-50" href="#lab03-mcp-tools-lab-__codelineno-12-50"></a><span class="w">                </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-51"><a id="__codelineno-12-51" name="__codelineno-12-51" href="#lab03-mcp-tools-lab-__codelineno-12-51"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-12-52"><a id="__codelineno-12-52" name="__codelineno-12-52" href="#lab03-mcp-tools-lab-__codelineno-12-52"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;City name (e.g., &#39;London&#39;, &#39;New York&#39;)&quot;</span>
</span><span id="__span-12-53"><a id="__codelineno-12-53" name="__codelineno-12-53" href="#lab03-mcp-tools-lab-__codelineno-12-53"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-12-54"><a id="__codelineno-12-54" name="__codelineno-12-54" href="#lab03-mcp-tools-lab-__codelineno-12-54"></a><span class="w">                </span><span class="nx">units</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-55"><a id="__codelineno-12-55" name="__codelineno-12-55" href="#lab03-mcp-tools-lab-__codelineno-12-55"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-12-56"><a id="__codelineno-12-56" name="__codelineno-12-56" href="#lab03-mcp-tools-lab-__codelineno-12-56"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Temperature units&quot;</span><span class="p">,</span>
</span><span id="__span-12-57"><a id="__codelineno-12-57" name="__codelineno-12-57" href="#lab03-mcp-tools-lab-__codelineno-12-57"></a><span class="w">                  </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;celsius&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;fahrenheit&quot;</span><span class="p">],</span>
</span><span id="__span-12-58"><a id="__codelineno-12-58" name="__codelineno-12-58" href="#lab03-mcp-tools-lab-__codelineno-12-58"></a><span class="w">                  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;celsius&quot;</span>
</span><span id="__span-12-59"><a id="__codelineno-12-59" name="__codelineno-12-59" href="#lab03-mcp-tools-lab-__codelineno-12-59"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-12-60"><a id="__codelineno-12-60" name="__codelineno-12-60" href="#lab03-mcp-tools-lab-__codelineno-12-60"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-12-61"><a id="__codelineno-12-61" name="__codelineno-12-61" href="#lab03-mcp-tools-lab-__codelineno-12-61"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;city&quot;</span><span class="p">]</span>
</span><span id="__span-12-62"><a id="__codelineno-12-62" name="__codelineno-12-62" href="#lab03-mcp-tools-lab-__codelineno-12-62"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-12-63"><a id="__codelineno-12-63" name="__codelineno-12-63" href="#lab03-mcp-tools-lab-__codelineno-12-63"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-12-64"><a id="__codelineno-12-64" name="__codelineno-12-64" href="#lab03-mcp-tools-lab-__codelineno-12-64"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-12-65"><a id="__codelineno-12-65" name="__codelineno-12-65" href="#lab03-mcp-tools-lab-__codelineno-12-65"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;read_file&quot;</span><span class="p">,</span>
</span><span id="__span-12-66"><a id="__codelineno-12-66" name="__codelineno-12-66" href="#lab03-mcp-tools-lab-__codelineno-12-66"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Read contents of a text file with security validation&quot;</span><span class="p">,</span>
</span><span id="__span-12-67"><a id="__codelineno-12-67" name="__codelineno-12-67" href="#lab03-mcp-tools-lab-__codelineno-12-67"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-68"><a id="__codelineno-12-68" name="__codelineno-12-68" href="#lab03-mcp-tools-lab-__codelineno-12-68"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-12-69"><a id="__codelineno-12-69" name="__codelineno-12-69" href="#lab03-mcp-tools-lab-__codelineno-12-69"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-70"><a id="__codelineno-12-70" name="__codelineno-12-70" href="#lab03-mcp-tools-lab-__codelineno-12-70"></a><span class="w">                </span><span class="nx">filepath</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-71"><a id="__codelineno-12-71" name="__codelineno-12-71" href="#lab03-mcp-tools-lab-__codelineno-12-71"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-12-72"><a id="__codelineno-12-72" name="__codelineno-12-72" href="#lab03-mcp-tools-lab-__codelineno-12-72"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Absolute path to the file&quot;</span>
</span><span id="__span-12-73"><a id="__codelineno-12-73" name="__codelineno-12-73" href="#lab03-mcp-tools-lab-__codelineno-12-73"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-12-74"><a id="__codelineno-12-74" name="__codelineno-12-74" href="#lab03-mcp-tools-lab-__codelineno-12-74"></a><span class="w">                </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-75"><a id="__codelineno-12-75" name="__codelineno-12-75" href="#lab03-mcp-tools-lab-__codelineno-12-75"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-12-76"><a id="__codelineno-12-76" name="__codelineno-12-76" href="#lab03-mcp-tools-lab-__codelineno-12-76"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;File encoding&quot;</span><span class="p">,</span>
</span><span id="__span-12-77"><a id="__codelineno-12-77" name="__codelineno-12-77" href="#lab03-mcp-tools-lab-__codelineno-12-77"></a><span class="w">                  </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;utf8&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;base64&quot;</span><span class="p">],</span>
</span><span id="__span-12-78"><a id="__codelineno-12-78" name="__codelineno-12-78" href="#lab03-mcp-tools-lab-__codelineno-12-78"></a><span class="w">                  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;utf8&quot;</span>
</span><span id="__span-12-79"><a id="__codelineno-12-79" name="__codelineno-12-79" href="#lab03-mcp-tools-lab-__codelineno-12-79"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-12-80"><a id="__codelineno-12-80" name="__codelineno-12-80" href="#lab03-mcp-tools-lab-__codelineno-12-80"></a><span class="w">                </span><span class="nx">maxSize</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-81"><a id="__codelineno-12-81" name="__codelineno-12-81" href="#lab03-mcp-tools-lab-__codelineno-12-81"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-12-82"><a id="__codelineno-12-82" name="__codelineno-12-82" href="#lab03-mcp-tools-lab-__codelineno-12-82"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum file size in bytes&quot;</span><span class="p">,</span>
</span><span id="__span-12-83"><a id="__codelineno-12-83" name="__codelineno-12-83" href="#lab03-mcp-tools-lab-__codelineno-12-83"></a><span class="w">                  </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span>
</span><span id="__span-12-84"><a id="__codelineno-12-84" name="__codelineno-12-84" href="#lab03-mcp-tools-lab-__codelineno-12-84"></a><span class="w">                  </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">10485760</span><span class="p">,</span>
</span><span id="__span-12-85"><a id="__codelineno-12-85" name="__codelineno-12-85" href="#lab03-mcp-tools-lab-__codelineno-12-85"></a><span class="w">                  </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">1048576</span>
</span><span id="__span-12-86"><a id="__codelineno-12-86" name="__codelineno-12-86" href="#lab03-mcp-tools-lab-__codelineno-12-86"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-12-87"><a id="__codelineno-12-87" name="__codelineno-12-87" href="#lab03-mcp-tools-lab-__codelineno-12-87"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-12-88"><a id="__codelineno-12-88" name="__codelineno-12-88" href="#lab03-mcp-tools-lab-__codelineno-12-88"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;filepath&quot;</span><span class="p">]</span>
</span><span id="__span-12-89"><a id="__codelineno-12-89" name="__codelineno-12-89" href="#lab03-mcp-tools-lab-__codelineno-12-89"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-12-90"><a id="__codelineno-12-90" name="__codelineno-12-90" href="#lab03-mcp-tools-lab-__codelineno-12-90"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-12-91"><a id="__codelineno-12-91" name="__codelineno-12-91" href="#lab03-mcp-tools-lab-__codelineno-12-91"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-12-92"><a id="__codelineno-12-92" name="__codelineno-12-92" href="#lab03-mcp-tools-lab-__codelineno-12-92"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hello_world&quot;</span><span class="p">,</span>
</span><span id="__span-12-93"><a id="__codelineno-12-93" name="__codelineno-12-93" href="#lab03-mcp-tools-lab-__codelineno-12-93"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Returns a friendly greeting message&quot;</span><span class="p">,</span>
</span><span id="__span-12-94"><a id="__codelineno-12-94" name="__codelineno-12-94" href="#lab03-mcp-tools-lab-__codelineno-12-94"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-95"><a id="__codelineno-12-95" name="__codelineno-12-95" href="#lab03-mcp-tools-lab-__codelineno-12-95"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-12-96"><a id="__codelineno-12-96" name="__codelineno-12-96" href="#lab03-mcp-tools-lab-__codelineno-12-96"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-97"><a id="__codelineno-12-97" name="__codelineno-12-97" href="#lab03-mcp-tools-lab-__codelineno-12-97"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-98"><a id="__codelineno-12-98" name="__codelineno-12-98" href="#lab03-mcp-tools-lab-__codelineno-12-98"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-12-99"><a id="__codelineno-12-99" name="__codelineno-12-99" href="#lab03-mcp-tools-lab-__codelineno-12-99"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The name to greet&quot;</span><span class="p">,</span>
</span><span id="__span-12-100"><a id="__codelineno-12-100" name="__codelineno-12-100" href="#lab03-mcp-tools-lab-__codelineno-12-100"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-12-101"><a id="__codelineno-12-101" name="__codelineno-12-101" href="#lab03-mcp-tools-lab-__codelineno-12-101"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-12-102"><a id="__codelineno-12-102" name="__codelineno-12-102" href="#lab03-mcp-tools-lab-__codelineno-12-102"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="__span-12-103"><a id="__codelineno-12-103" name="__codelineno-12-103" href="#lab03-mcp-tools-lab-__codelineno-12-103"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-12-104"><a id="__codelineno-12-104" name="__codelineno-12-104" href="#lab03-mcp-tools-lab-__codelineno-12-104"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-12-105"><a id="__codelineno-12-105" name="__codelineno-12-105" href="#lab03-mcp-tools-lab-__codelineno-12-105"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-12-106"><a id="__codelineno-12-106" name="__codelineno-12-106" href="#lab03-mcp-tools-lab-__codelineno-12-106"></a><span class="w">      </span><span class="p">})</span>
</span><span id="__span-12-107"><a id="__codelineno-12-107" name="__codelineno-12-107" href="#lab03-mcp-tools-lab-__codelineno-12-107"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-12-108"><a id="__codelineno-12-108" name="__codelineno-12-108" href="#lab03-mcp-tools-lab-__codelineno-12-108"></a>
</span><span id="__span-12-109"><a id="__codelineno-12-109" name="__codelineno-12-109" href="#lab03-mcp-tools-lab-__codelineno-12-109"></a><span class="w">    </span><span class="c1">// Handler for calling tools</span>
</span><span id="__span-12-110"><a id="__codelineno-12-110" name="__codelineno-12-110" href="#lab03-mcp-tools-lab-__codelineno-12-110"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-12-111"><a id="__codelineno-12-111" name="__codelineno-12-111" href="#lab03-mcp-tools-lab-__codelineno-12-111"></a><span class="w">      </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-12-112"><a id="__codelineno-12-112" name="__codelineno-12-112" href="#lab03-mcp-tools-lab-__codelineno-12-112"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-113"><a id="__codelineno-12-113" name="__codelineno-12-113" href="#lab03-mcp-tools-lab-__codelineno-12-113"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-12-114"><a id="__codelineno-12-114" name="__codelineno-12-114" href="#lab03-mcp-tools-lab-__codelineno-12-114"></a>
</span><span id="__span-12-115"><a id="__codelineno-12-115" name="__codelineno-12-115" href="#lab03-mcp-tools-lab-__codelineno-12-115"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;get_weather&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-116"><a id="__codelineno-12-116" name="__codelineno-12-116" href="#lab03-mcp-tools-lab-__codelineno-12-116"></a><span class="w">          </span><span class="c1">// ... existing weather tool code ...</span>
</span><span id="__span-12-117"><a id="__codelineno-12-117" name="__codelineno-12-117" href="#lab03-mcp-tools-lab-__codelineno-12-117"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-12-118"><a id="__codelineno-12-118" name="__codelineno-12-118" href="#lab03-mcp-tools-lab-__codelineno-12-118"></a>
</span><span id="__span-12-119"><a id="__codelineno-12-119" name="__codelineno-12-119" href="#lab03-mcp-tools-lab-__codelineno-12-119"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;read_file&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-120"><a id="__codelineno-12-120" name="__codelineno-12-120" href="#lab03-mcp-tools-lab-__codelineno-12-120"></a><span class="w">          </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-121"><a id="__codelineno-12-121" name="__codelineno-12-121" href="#lab03-mcp-tools-lab-__codelineno-12-121"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-12-122"><a id="__codelineno-12-122" name="__codelineno-12-122" href="#lab03-mcp-tools-lab-__codelineno-12-122"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">encoding</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">BufferEncoding</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;utf8&quot;</span><span class="p">;</span>
</span><span id="__span-12-123"><a id="__codelineno-12-123" name="__codelineno-12-123" href="#lab03-mcp-tools-lab-__codelineno-12-123"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">1048576</span><span class="p">;</span>
</span><span id="__span-12-124"><a id="__codelineno-12-124" name="__codelineno-12-124" href="#lab03-mcp-tools-lab-__codelineno-12-124"></a>
</span><span id="__span-12-125"><a id="__codelineno-12-125" name="__codelineno-12-125" href="#lab03-mcp-tools-lab-__codelineno-12-125"></a><span class="w">            </span><span class="c1">// Security: Validate input</span>
</span><span id="__span-12-126"><a id="__codelineno-12-126" name="__codelineno-12-126" href="#lab03-mcp-tools-lab-__codelineno-12-126"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">filepath</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">filepath</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-127"><a id="__codelineno-12-127" name="__codelineno-12-127" href="#lab03-mcp-tools-lab-__codelineno-12-127"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;filepath must be a non-empty string&quot;</span><span class="p">);</span>
</span><span id="__span-12-128"><a id="__codelineno-12-128" name="__codelineno-12-128" href="#lab03-mcp-tools-lab-__codelineno-12-128"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-12-129"><a id="__codelineno-12-129" name="__codelineno-12-129" href="#lab03-mcp-tools-lab-__codelineno-12-129"></a>
</span><span id="__span-12-130"><a id="__codelineno-12-130" name="__codelineno-12-130" href="#lab03-mcp-tools-lab-__codelineno-12-130"></a><span class="w">            </span><span class="c1">// Security: Resolve and validate path</span>
</span><span id="__span-12-131"><a id="__codelineno-12-131" name="__codelineno-12-131" href="#lab03-mcp-tools-lab-__codelineno-12-131"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">resolvedPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">filepath</span><span class="p">);</span>
</span><span id="__span-12-132"><a id="__codelineno-12-132" name="__codelineno-12-132" href="#lab03-mcp-tools-lab-__codelineno-12-132"></a>
</span><span id="__span-12-133"><a id="__codelineno-12-133" name="__codelineno-12-133" href="#lab03-mcp-tools-lab-__codelineno-12-133"></a><span class="w">            </span><span class="c1">// Prevent directory traversal attacks</span>
</span><span id="__span-12-134"><a id="__codelineno-12-134" name="__codelineno-12-134" href="#lab03-mcp-tools-lab-__codelineno-12-134"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">resolvedPath</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-135"><a id="__codelineno-12-135" name="__codelineno-12-135" href="#lab03-mcp-tools-lab-__codelineno-12-135"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Access denied: file path outside allowed directory&quot;</span><span class="p">);</span>
</span><span id="__span-12-136"><a id="__codelineno-12-136" name="__codelineno-12-136" href="#lab03-mcp-tools-lab-__codelineno-12-136"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-12-137"><a id="__codelineno-12-137" name="__codelineno-12-137" href="#lab03-mcp-tools-lab-__codelineno-12-137"></a>
</span><span id="__span-12-138"><a id="__codelineno-12-138" name="__codelineno-12-138" href="#lab03-mcp-tools-lab-__codelineno-12-138"></a><span class="w">            </span><span class="c1">// Check if file exists and is readable</span>
</span><span id="__span-12-139"><a id="__codelineno-12-139" name="__codelineno-12-139" href="#lab03-mcp-tools-lab-__codelineno-12-139"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-140"><a id="__codelineno-12-140" name="__codelineno-12-140" href="#lab03-mcp-tools-lab-__codelineno-12-140"></a><span class="w">              </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">,</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">R_OK</span><span class="p">);</span>
</span><span id="__span-12-141"><a id="__codelineno-12-141" name="__codelineno-12-141" href="#lab03-mcp-tools-lab-__codelineno-12-141"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-142"><a id="__codelineno-12-142" name="__codelineno-12-142" href="#lab03-mcp-tools-lab-__codelineno-12-142"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`File not found or not readable: </span><span class="si">${</span><span class="nx">filepath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-12-143"><a id="__codelineno-12-143" name="__codelineno-12-143" href="#lab03-mcp-tools-lab-__codelineno-12-143"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-12-144"><a id="__codelineno-12-144" name="__codelineno-12-144" href="#lab03-mcp-tools-lab-__codelineno-12-144"></a>
</span><span id="__span-12-145"><a id="__codelineno-12-145" name="__codelineno-12-145" href="#lab03-mcp-tools-lab-__codelineno-12-145"></a><span class="w">            </span><span class="c1">// Get file stats</span>
</span><span id="__span-12-146"><a id="__codelineno-12-146" name="__codelineno-12-146" href="#lab03-mcp-tools-lab-__codelineno-12-146"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">stats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">);</span>
</span><span id="__span-12-147"><a id="__codelineno-12-147" name="__codelineno-12-147" href="#lab03-mcp-tools-lab-__codelineno-12-147"></a>
</span><span id="__span-12-148"><a id="__codelineno-12-148" name="__codelineno-12-148" href="#lab03-mcp-tools-lab-__codelineno-12-148"></a><span class="w">            </span><span class="c1">// Check if it&#39;s actually a file (not a directory)</span>
</span><span id="__span-12-149"><a id="__codelineno-12-149" name="__codelineno-12-149" href="#lab03-mcp-tools-lab-__codelineno-12-149"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">stats</span><span class="p">.</span><span class="nx">isFile</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-150"><a id="__codelineno-12-150" name="__codelineno-12-150" href="#lab03-mcp-tools-lab-__codelineno-12-150"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Path is not a file: </span><span class="si">${</span><span class="nx">filepath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-12-151"><a id="__codelineno-12-151" name="__codelineno-12-151" href="#lab03-mcp-tools-lab-__codelineno-12-151"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-12-152"><a id="__codelineno-12-152" name="__codelineno-12-152" href="#lab03-mcp-tools-lab-__codelineno-12-152"></a>
</span><span id="__span-12-153"><a id="__codelineno-12-153" name="__codelineno-12-153" href="#lab03-mcp-tools-lab-__codelineno-12-153"></a><span class="w">            </span><span class="c1">// Check file size</span>
</span><span id="__span-12-154"><a id="__codelineno-12-154" name="__codelineno-12-154" href="#lab03-mcp-tools-lab-__codelineno-12-154"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">maxSize</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-155"><a id="__codelineno-12-155" name="__codelineno-12-155" href="#lab03-mcp-tools-lab-__codelineno-12-155"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-12-156"><a id="__codelineno-12-156" name="__codelineno-12-156" href="#lab03-mcp-tools-lab-__codelineno-12-156"></a><span class="w">                </span><span class="sb">`File too large: </span><span class="si">${</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="si">}</span><span class="sb"> bytes (max: </span><span class="si">${</span><span class="nx">maxSize</span><span class="si">}</span><span class="sb">)`</span>
</span><span id="__span-12-157"><a id="__codelineno-12-157" name="__codelineno-12-157" href="#lab03-mcp-tools-lab-__codelineno-12-157"></a><span class="w">              </span><span class="p">);</span>
</span><span id="__span-12-158"><a id="__codelineno-12-158" name="__codelineno-12-158" href="#lab03-mcp-tools-lab-__codelineno-12-158"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-12-159"><a id="__codelineno-12-159" name="__codelineno-12-159" href="#lab03-mcp-tools-lab-__codelineno-12-159"></a>
</span><span id="__span-12-160"><a id="__codelineno-12-160" name="__codelineno-12-160" href="#lab03-mcp-tools-lab-__codelineno-12-160"></a><span class="w">            </span><span class="c1">// Read file content</span>
</span><span id="__span-12-161"><a id="__codelineno-12-161" name="__codelineno-12-161" href="#lab03-mcp-tools-lab-__codelineno-12-161"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">resolvedPath</span><span class="p">,</span><span class="w"> </span><span class="nx">encoding</span><span class="p">);</span>
</span><span id="__span-12-162"><a id="__codelineno-12-162" name="__codelineno-12-162" href="#lab03-mcp-tools-lab-__codelineno-12-162"></a>
</span><span id="__span-12-163"><a id="__codelineno-12-163" name="__codelineno-12-163" href="#lab03-mcp-tools-lab-__codelineno-12-163"></a><span class="w">            </span><span class="c1">// Format response with metadata</span>
</span><span id="__span-12-164"><a id="__codelineno-12-164" name="__codelineno-12-164" href="#lab03-mcp-tools-lab-__codelineno-12-164"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">fileInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-165"><a id="__codelineno-12-165" name="__codelineno-12-165" href="#lab03-mcp-tools-lab-__codelineno-12-165"></a><span class="w">              </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="kt">resolvedPath</span><span class="p">,</span>
</span><span id="__span-12-166"><a id="__codelineno-12-166" name="__codelineno-12-166" href="#lab03-mcp-tools-lab-__codelineno-12-166"></a><span class="w">              </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="kt">stats.size</span><span class="p">,</span>
</span><span id="__span-12-167"><a id="__codelineno-12-167" name="__codelineno-12-167" href="#lab03-mcp-tools-lab-__codelineno-12-167"></a><span class="w">              </span><span class="nx">modified</span><span class="o">:</span><span class="w"> </span><span class="kt">stats.mtime.toISOString</span><span class="p">(),</span>
</span><span id="__span-12-168"><a id="__codelineno-12-168" name="__codelineno-12-168" href="#lab03-mcp-tools-lab-__codelineno-12-168"></a><span class="w">              </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="kt">encoding</span>
</span><span id="__span-12-169"><a id="__codelineno-12-169" name="__codelineno-12-169" href="#lab03-mcp-tools-lab-__codelineno-12-169"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-12-170"><a id="__codelineno-12-170" name="__codelineno-12-170" href="#lab03-mcp-tools-lab-__codelineno-12-170"></a>
</span><span id="__span-12-171"><a id="__codelineno-12-171" name="__codelineno-12-171" href="#lab03-mcp-tools-lab-__codelineno-12-171"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-172"><a id="__codelineno-12-172" name="__codelineno-12-172" href="#lab03-mcp-tools-lab-__codelineno-12-172"></a><span class="w">              </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-12-173"><a id="__codelineno-12-173" name="__codelineno-12-173" href="#lab03-mcp-tools-lab-__codelineno-12-173"></a><span class="w">                </span><span class="p">{</span>
</span><span id="__span-12-174"><a id="__codelineno-12-174" name="__codelineno-12-174" href="#lab03-mcp-tools-lab-__codelineno-12-174"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-12-175"><a id="__codelineno-12-175" name="__codelineno-12-175" href="#lab03-mcp-tools-lab-__codelineno-12-175"></a><span class="w">                  </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`File Information:\n</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">fileInfo</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">\n\nContent:\n</span><span class="si">${</span><span class="nx">content</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-12-176"><a id="__codelineno-12-176" name="__codelineno-12-176" href="#lab03-mcp-tools-lab-__codelineno-12-176"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-12-177"><a id="__codelineno-12-177" name="__codelineno-12-177" href="#lab03-mcp-tools-lab-__codelineno-12-177"></a><span class="w">              </span><span class="p">]</span>
</span><span id="__span-12-178"><a id="__codelineno-12-178" name="__codelineno-12-178" href="#lab03-mcp-tools-lab-__codelineno-12-178"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-12-179"><a id="__codelineno-12-179" name="__codelineno-12-179" href="#lab03-mcp-tools-lab-__codelineno-12-179"></a>
</span><span id="__span-12-180"><a id="__codelineno-12-180" name="__codelineno-12-180" href="#lab03-mcp-tools-lab-__codelineno-12-180"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-181"><a id="__codelineno-12-181" name="__codelineno-12-181" href="#lab03-mcp-tools-lab-__codelineno-12-181"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-12-182"><a id="__codelineno-12-182" name="__codelineno-12-182" href="#lab03-mcp-tools-lab-__codelineno-12-182"></a><span class="w">              </span><span class="sb">`Failed to read file: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-12-183"><a id="__codelineno-12-183" name="__codelineno-12-183" href="#lab03-mcp-tools-lab-__codelineno-12-183"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-12-184"><a id="__codelineno-12-184" name="__codelineno-12-184" href="#lab03-mcp-tools-lab-__codelineno-12-184"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-12-185"><a id="__codelineno-12-185" name="__codelineno-12-185" href="#lab03-mcp-tools-lab-__codelineno-12-185"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-12-186"><a id="__codelineno-12-186" name="__codelineno-12-186" href="#lab03-mcp-tools-lab-__codelineno-12-186"></a>
</span><span id="__span-12-187"><a id="__codelineno-12-187" name="__codelineno-12-187" href="#lab03-mcp-tools-lab-__codelineno-12-187"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;hello_world&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-188"><a id="__codelineno-12-188" name="__codelineno-12-188" href="#lab03-mcp-tools-lab-__codelineno-12-188"></a><span class="w">          </span><span class="c1">// ... existing hello world code ...</span>
</span><span id="__span-12-189"><a id="__codelineno-12-189" name="__codelineno-12-189" href="#lab03-mcp-tools-lab-__codelineno-12-189"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-12-190"><a id="__codelineno-12-190" name="__codelineno-12-190" href="#lab03-mcp-tools-lab-__codelineno-12-190"></a>
</span><span id="__span-12-191"><a id="__codelineno-12-191" name="__codelineno-12-191" href="#lab03-mcp-tools-lab-__codelineno-12-191"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-12-192"><a id="__codelineno-12-192" name="__codelineno-12-192" href="#lab03-mcp-tools-lab-__codelineno-12-192"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-12-193"><a id="__codelineno-12-193" name="__codelineno-12-193" href="#lab03-mcp-tools-lab-__codelineno-12-193"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-12-194"><a id="__codelineno-12-194" name="__codelineno-12-194" href="#lab03-mcp-tools-lab-__codelineno-12-194"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-195"><a id="__codelineno-12-195" name="__codelineno-12-195" href="#lab03-mcp-tools-lab-__codelineno-12-195"></a>
</span><span id="__span-12-196"><a id="__codelineno-12-196" name="__codelineno-12-196" href="#lab03-mcp-tools-lab-__codelineno-12-196"></a><span class="w">  </span><span class="c1">// ... rest of the class remains the same ...</span>
</span><span id="__span-12-197"><a id="__codelineno-12-197" name="__codelineno-12-197" href="#lab03-mcp-tools-lab-__codelineno-12-197"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="lab03-mcp-tools-lab-testing-the-file-operations-tool">Testing the File Operations Tool<a class="headerlink" href="#lab03-mcp-tools-lab-testing-the-file-operations-tool" title="Permanent link">&para;</a></h4>
<p><strong>Step 1: Create Test Files</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab03-mcp-tools-lab-__codelineno-13-1"></a><span class="c1"># Create a test directory and files</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#lab03-mcp-tools-lab-__codelineno-13-2"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>test-files
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#lab03-mcp-tools-lab-__codelineno-13-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hello, this is a test file!&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test-files/hello.txt
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#lab03-mcp-tools-lab-__codelineno-13-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;test&quot;, &quot;value&quot;: 123}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>test-files/data.json
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#lab03-mcp-tools-lab-__codelineno-13-5"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Line 1\nLine 2\nLine 3&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test-files/lines.txt
</span></code></pre></div>
<p><strong>Step 2: Start the MCP Inspector</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab03-mcp-tools-lab-__codelineno-14-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><strong>Step 3: Test File Reading</strong></p>
<ol>
<li>
<p><strong>Test with a simple text file</strong>:</p>
<ul>
<li>Tool: <code>read_file</code></li>
<li>filepath: <code>/absolute/path/to/test-files/hello.txt</code> (use the full absolute path)</li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Test with JSON file</strong>:</p>
<ul>
<li>Tool: <code>read_file</code></li>
<li>filepath: <code>/absolute/path/to/test-files/data.json</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Test with different encoding</strong>:</p>
<ul>
<li>Tool: <code>read_file</code></li>
<li>filepath: <code>/absolute/path/to/test-files/hello.txt</code></li>
<li>encoding: <code>base64</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Test file size limit</strong>:</p>
<ul>
<li>Create a large file: <code>dd if=/dev/zero of=test-files/large.txt bs=1M count=2</code></li>
<li>Try reading it with default maxSize (1MB)</li>
<li>Try with maxSize: <code>2097152</code> (2MB)</li>
</ul>
</li>
</ol>
<p><strong>Step 4: Test Error Cases</strong></p>
<ol>
<li>
<p><strong>Non-existent file</strong>:</p>
<ul>
<li>filepath: <code>/absolute/path/to/test-files/nonexistent.txt</code></li>
</ul>
</li>
<li>
<p><strong>Directory instead of file</strong>:</p>
<ul>
<li>filepath: <code>/absolute/path/to/test-files</code> (the directory itself)</li>
</ul>
</li>
<li>
<p><strong>Empty filepath</strong>:</p>
<ul>
<li>filepath: <code>""</code></li>
</ul>
</li>
<li>
<p><strong>Path traversal attempt</strong>:</p>
<ul>
<li>filepath: <code>/absolute/path/../../../etc/passwd</code></li>
</ul>
</li>
</ol>
<p><strong>Step 5: Verify Output</strong></p>
<ul>
<li>
<p>You should see output like:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab03-mcp-tools-lab-__codelineno-15-1"></a>File Information:
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab03-mcp-tools-lab-__codelineno-15-2"></a>{
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#lab03-mcp-tools-lab-__codelineno-15-3"></a>  &quot;path&quot;: &quot;/Users/username/project/test-files/hello.txt&quot;,
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#lab03-mcp-tools-lab-__codelineno-15-4"></a>  &quot;size&quot;: 27,
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#lab03-mcp-tools-lab-__codelineno-15-5"></a>  &quot;modified&quot;: &quot;2024-01-06T10:30:00.000Z&quot;,
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#lab03-mcp-tools-lab-__codelineno-15-6"></a>  &quot;encoding&quot;: &quot;utf8&quot;
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#lab03-mcp-tools-lab-__codelineno-15-7"></a>}
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#lab03-mcp-tools-lab-__codelineno-15-8"></a>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#lab03-mcp-tools-lab-__codelineno-15-9"></a>Content:
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#lab03-mcp-tools-lab-__codelineno-15-10"></a>Hello, this is a test file!
</span></code></pre></div>
</li>
</ul>
<h4 id="lab03-mcp-tools-lab-troubleshooting"><strong>Troubleshooting:</strong><a class="headerlink" href="#lab03-mcp-tools-lab-troubleshooting" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>&ldquo;File not found&rdquo;</strong>: Make sure you&rsquo;re using the absolute path</li>
<li><strong>&ldquo;Access denied&rdquo;</strong>: The file path is outside your project directory</li>
<li><strong>&ldquo;Path is not a file&rdquo;</strong>: You tried to read a directory</li>
<li><strong>&ldquo;File too large&rdquo;</strong>: Increase the maxSize parameter</li>
</ul>
<h4 id="lab03-mcp-tools-lab-key-learning-points_1">Key Learning Points:<a class="headerlink" href="#lab03-mcp-tools-lab-key-learning-points_1" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Path security</strong> and preventing directory traversal attacks</li>
<li><strong>File system operations</strong> with Node.js fs/promises</li>
<li><strong>Input validation</strong> beyond JSON Schema</li>
<li><strong>File metadata</strong> extraction and formatting</li>
<li><strong>Error handling</strong> for various file system scenarios</li>
<li><strong>Resource limits</strong> to prevent abuse</li>
</ul>
<hr />
<h3 id="lab03-mcp-tools-lab-tool-3-database-query">Tool 3: Database Query<a class="headerlink" href="#lab03-mcp-tools-lab-tool-3-database-query" title="Permanent link">&para;</a></h3>
<p><strong>Goal</strong>: Create a secure database query tool that can execute SELECT statements on a SQLite database with proper validation and safety measures.</p>
<h4 id="lab03-mcp-tools-lab-complete-database-query-tool-implementation">Complete Database Query Tool Implementation<a class="headerlink" href="#lab03-mcp-tools-lab-complete-database-query-tool-implementation" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>First, install the SQLite dependency:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#lab03-mcp-tools-lab-__codelineno-16-1"></a>npm<span class="w"> </span>install<span class="w"> </span>better-sqlite3
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#lab03-mcp-tools-lab-__codelineno-16-2"></a>npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>@types/better-sqlite3
</span></code></pre></div>
</li>
</ul>
<p><strong>Important</strong>: Do NOT copy the entire code block below. Instead, add the <code>query_database</code> tool to your existing <code>src/index.ts</code> file by following these specific steps:</p>
<ol>
<li>
<p><strong>Add the imports</strong> at the top of your file (after existing imports):
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab03-mcp-tools-lab-__codelineno-17-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">Database</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;better-sqlite3&#39;</span><span class="p">;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add the <code>query_database</code> tool to your tools array</strong> in the <code>ListToolsRequestSchema</code> handler:
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab03-mcp-tools-lab-__codelineno-18-1"></a><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#lab03-mcp-tools-lab-__codelineno-18-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;query_database&quot;</span><span class="p">,</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#lab03-mcp-tools-lab-__codelineno-18-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Execute SELECT queries on a SQLite database&quot;</span><span class="p">,</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#lab03-mcp-tools-lab-__codelineno-18-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#lab03-mcp-tools-lab-__codelineno-18-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#lab03-mcp-tools-lab-__codelineno-18-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#lab03-mcp-tools-lab-__codelineno-18-7"></a><span class="w">      </span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#lab03-mcp-tools-lab-__codelineno-18-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#lab03-mcp-tools-lab-__codelineno-18-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;SQL SELECT query to execute&quot;</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#lab03-mcp-tools-lab-__codelineno-18-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#lab03-mcp-tools-lab-__codelineno-18-11"></a><span class="w">      </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#lab03-mcp-tools-lab-__codelineno-18-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#lab03-mcp-tools-lab-__codelineno-18-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Query parameters for prepared statement&quot;</span><span class="p">,</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#lab03-mcp-tools-lab-__codelineno-18-14"></a><span class="w">        </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#lab03-mcp-tools-lab-__codelineno-18-15"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;null&quot;</span><span class="p">]</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#lab03-mcp-tools-lab-__codelineno-18-16"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#lab03-mcp-tools-lab-__codelineno-18-17"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#lab03-mcp-tools-lab-__codelineno-18-18"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#lab03-mcp-tools-lab-__codelineno-18-19"></a><span class="w">      </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#lab03-mcp-tools-lab-__codelineno-18-20"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#lab03-mcp-tools-lab-__codelineno-18-21"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum number of rows to return&quot;</span><span class="p">,</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#lab03-mcp-tools-lab-__codelineno-18-22"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#lab03-mcp-tools-lab-__codelineno-18-23"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="p">,</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#lab03-mcp-tools-lab-__codelineno-18-24"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#lab03-mcp-tools-lab-__codelineno-18-25"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#lab03-mcp-tools-lab-__codelineno-18-26"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#lab03-mcp-tools-lab-__codelineno-18-27"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28" href="#lab03-mcp-tools-lab-__codelineno-18-28"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-18-29"><a id="__codelineno-18-29" name="__codelineno-18-29" href="#lab03-mcp-tools-lab-__codelineno-18-29"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add the <code>query_database</code> handler</strong> in the <code>CallToolRequestSchema</code> handler (before the final <code>throw new Error</code>):
   <div class="language-typescript highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#lab03-mcp-tools-lab-__codelineno-19-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;query_database&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#lab03-mcp-tools-lab-__codelineno-19-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#lab03-mcp-tools-lab-__codelineno-19-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">query</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#lab03-mcp-tools-lab-__codelineno-19-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">parameters</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">[])</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#lab03-mcp-tools-lab-__codelineno-19-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">limit</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#lab03-mcp-tools-lab-__codelineno-19-6"></a>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#lab03-mcp-tools-lab-__codelineno-19-7"></a><span class="w">    </span><span class="c1">// Security: Validate input</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#lab03-mcp-tools-lab-__codelineno-19-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">query</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">query</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#lab03-mcp-tools-lab-__codelineno-19-9"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;query must be a non-empty string&quot;</span><span class="p">);</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#lab03-mcp-tools-lab-__codelineno-19-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#lab03-mcp-tools-lab-__codelineno-19-11"></a>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#lab03-mcp-tools-lab-__codelineno-19-12"></a><span class="w">    </span><span class="c1">// Security: Only allow SELECT queries</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#lab03-mcp-tools-lab-__codelineno-19-13"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">trimmedQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">query</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toUpperCase</span><span class="p">();</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#lab03-mcp-tools-lab-__codelineno-19-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">trimmedQuery</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;SELECT&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#lab03-mcp-tools-lab-__codelineno-19-15"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Only SELECT queries are allowed for security&quot;</span><span class="p">);</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#lab03-mcp-tools-lab-__codelineno-19-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#lab03-mcp-tools-lab-__codelineno-19-17"></a>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#lab03-mcp-tools-lab-__codelineno-19-18"></a><span class="w">    </span><span class="c1">// Check if database file exists</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#lab03-mcp-tools-lab-__codelineno-19-19"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">dbPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./data.db&#39;</span><span class="p">;</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#lab03-mcp-tools-lab-__codelineno-19-20"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#lab03-mcp-tools-lab-__codelineno-19-21"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="nx">dbPath</span><span class="p">,</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">R_OK</span><span class="p">);</span>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#lab03-mcp-tools-lab-__codelineno-19-22"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#lab03-mcp-tools-lab-__codelineno-19-23"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Database file &#39;data.db&#39; not found in project root&quot;</span><span class="p">);</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24" href="#lab03-mcp-tools-lab-__codelineno-19-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25" href="#lab03-mcp-tools-lab-__codelineno-19-25"></a>
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26" href="#lab03-mcp-tools-lab-__codelineno-19-26"></a><span class="w">    </span><span class="c1">// Open database in read-only mode</span>
</span><span id="__span-19-27"><a id="__codelineno-19-27" name="__codelineno-19-27" href="#lab03-mcp-tools-lab-__codelineno-19-27"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Database</span><span class="p">(</span><span class="nx">dbPath</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">readonly</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-19-28"><a id="__codelineno-19-28" name="__codelineno-19-28" href="#lab03-mcp-tools-lab-__codelineno-19-28"></a>
</span><span id="__span-19-29"><a id="__codelineno-19-29" name="__codelineno-19-29" href="#lab03-mcp-tools-lab-__codelineno-19-29"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-30"><a id="__codelineno-19-30" name="__codelineno-19-30" href="#lab03-mcp-tools-lab-__codelineno-19-30"></a><span class="w">      </span><span class="c1">// Prepare statement</span>
</span><span id="__span-19-31"><a id="__codelineno-19-31" name="__codelineno-19-31" href="#lab03-mcp-tools-lab-__codelineno-19-31"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="nx">query</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; LIMIT ?&#39;</span><span class="p">);</span>
</span><span id="__span-19-32"><a id="__codelineno-19-32" name="__codelineno-19-32" href="#lab03-mcp-tools-lab-__codelineno-19-32"></a>
</span><span id="__span-19-33"><a id="__codelineno-19-33" name="__codelineno-19-33" href="#lab03-mcp-tools-lab-__codelineno-19-33"></a><span class="w">      </span><span class="c1">// Execute query</span>
</span><span id="__span-19-34"><a id="__codelineno-19-34" name="__codelineno-19-34" href="#lab03-mcp-tools-lab-__codelineno-19-34"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stmt</span><span class="p">.</span><span class="nx">all</span><span class="p">(...</span><span class="nx">parameters</span><span class="p">,</span><span class="w"> </span><span class="nx">limit</span><span class="p">);</span>
</span><span id="__span-19-35"><a id="__codelineno-19-35" name="__codelineno-19-35" href="#lab03-mcp-tools-lab-__codelineno-19-35"></a>
</span><span id="__span-19-36"><a id="__codelineno-19-36" name="__codelineno-19-36" href="#lab03-mcp-tools-lab-__codelineno-19-36"></a><span class="w">      </span><span class="c1">// Format results</span>
</span><span id="__span-19-37"><a id="__codelineno-19-37" name="__codelineno-19-37" href="#lab03-mcp-tools-lab-__codelineno-19-37"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resultText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span>
</span><span id="__span-19-38"><a id="__codelineno-19-38" name="__codelineno-19-38" href="#lab03-mcp-tools-lab-__codelineno-19-38"></a><span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">rows</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
</span><span id="__span-19-39"><a id="__codelineno-19-39" name="__codelineno-19-39" href="#lab03-mcp-tools-lab-__codelineno-19-39"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;No results found&quot;</span><span class="p">;</span>
</span><span id="__span-19-40"><a id="__codelineno-19-40" name="__codelineno-19-40" href="#lab03-mcp-tools-lab-__codelineno-19-40"></a>
</span><span id="__span-19-41"><a id="__codelineno-19-41" name="__codelineno-19-41" href="#lab03-mcp-tools-lab-__codelineno-19-41"></a><span class="w">      </span><span class="c1">// Get query info</span>
</span><span id="__span-19-42"><a id="__codelineno-19-42" name="__codelineno-19-42" href="#lab03-mcp-tools-lab-__codelineno-19-42"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stmt</span><span class="p">.</span><span class="nx">columns</span><span class="p">();</span>
</span><span id="__span-19-43"><a id="__codelineno-19-43" name="__codelineno-19-43" href="#lab03-mcp-tools-lab-__codelineno-19-43"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">columnNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">info</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">col</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">col</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span><span id="__span-19-44"><a id="__codelineno-19-44" name="__codelineno-19-44" href="#lab03-mcp-tools-lab-__codelineno-19-44"></a>
</span><span id="__span-19-45"><a id="__codelineno-19-45" name="__codelineno-19-45" href="#lab03-mcp-tools-lab-__codelineno-19-45"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-46"><a id="__codelineno-19-46" name="__codelineno-19-46" href="#lab03-mcp-tools-lab-__codelineno-19-46"></a><span class="w">        </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-19-47"><a id="__codelineno-19-47" name="__codelineno-19-47" href="#lab03-mcp-tools-lab-__codelineno-19-47"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-19-48"><a id="__codelineno-19-48" name="__codelineno-19-48" href="#lab03-mcp-tools-lab-__codelineno-19-48"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-19-49"><a id="__codelineno-19-49" name="__codelineno-19-49" href="#lab03-mcp-tools-lab-__codelineno-19-49"></a><span class="w">            </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Query executed successfully.\nDatabase: </span><span class="si">${</span><span class="nx">dbPath</span><span class="si">}</span><span class="sb">\nColumns: </span><span class="si">${</span><span class="nx">columnNames</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">\nRows returned: </span><span class="si">${</span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb">\n\nResults:\n</span><span class="si">${</span><span class="nx">resultText</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-19-50"><a id="__codelineno-19-50" name="__codelineno-19-50" href="#lab03-mcp-tools-lab-__codelineno-19-50"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-19-51"><a id="__codelineno-19-51" name="__codelineno-19-51" href="#lab03-mcp-tools-lab-__codelineno-19-51"></a><span class="w">        </span><span class="p">]</span>
</span><span id="__span-19-52"><a id="__codelineno-19-52" name="__codelineno-19-52" href="#lab03-mcp-tools-lab-__codelineno-19-52"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-19-53"><a id="__codelineno-19-53" name="__codelineno-19-53" href="#lab03-mcp-tools-lab-__codelineno-19-53"></a>
</span><span id="__span-19-54"><a id="__codelineno-19-54" name="__codelineno-19-54" href="#lab03-mcp-tools-lab-__codelineno-19-54"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-55"><a id="__codelineno-19-55" name="__codelineno-19-55" href="#lab03-mcp-tools-lab-__codelineno-19-55"></a><span class="w">      </span><span class="nx">db</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-19-56"><a id="__codelineno-19-56" name="__codelineno-19-56" href="#lab03-mcp-tools-lab-__codelineno-19-56"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-57"><a id="__codelineno-19-57" name="__codelineno-19-57" href="#lab03-mcp-tools-lab-__codelineno-19-57"></a>
</span><span id="__span-19-58"><a id="__codelineno-19-58" name="__codelineno-19-58" href="#lab03-mcp-tools-lab-__codelineno-19-58"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-59"><a id="__codelineno-19-59" name="__codelineno-19-59" href="#lab03-mcp-tools-lab-__codelineno-19-59"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-19-60"><a id="__codelineno-19-60" name="__codelineno-19-60" href="#lab03-mcp-tools-lab-__codelineno-19-60"></a><span class="w">      </span><span class="sb">`Database query failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-19-61"><a id="__codelineno-19-61" name="__codelineno-19-61" href="#lab03-mcp-tools-lab-__codelineno-19-61"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-19-62"><a id="__codelineno-19-62" name="__codelineno-19-62" href="#lab03-mcp-tools-lab-__codelineno-19-62"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-19-63"><a id="__codelineno-19-63" name="__codelineno-19-63" href="#lab03-mcp-tools-lab-__codelineno-19-63"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
</ol>
<p><br></p>
<ul>
<li>
<p><strong>The code block below is for reference only</strong> - it shows what your complete file should look like after adding the tool. Do not copy-paste the entire block:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#lab03-mcp-tools-lab-__codelineno-20-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#lab03-mcp-tools-lab-__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#lab03-mcp-tools-lab-__codelineno-20-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#lab03-mcp-tools-lab-__codelineno-20-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#lab03-mcp-tools-lab-__codelineno-20-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#lab03-mcp-tools-lab-__codelineno-20-6"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#lab03-mcp-tools-lab-__codelineno-20-7"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#lab03-mcp-tools-lab-__codelineno-20-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#lab03-mcp-tools-lab-__codelineno-20-9"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs/promises&#39;</span><span class="p">;</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#lab03-mcp-tools-lab-__codelineno-20-10"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;path&#39;</span><span class="p">;</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#lab03-mcp-tools-lab-__codelineno-20-11"></a><span class="k">import</span><span class="w"> </span><span class="nx">Database</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;better-sqlite3&#39;</span><span class="p">;</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#lab03-mcp-tools-lab-__codelineno-20-12"></a>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#lab03-mcp-tools-lab-__codelineno-20-13"></a><span class="c1">// ... existing imports and class definition ...</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#lab03-mcp-tools-lab-__codelineno-20-14"></a>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#lab03-mcp-tools-lab-__codelineno-20-15"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#lab03-mcp-tools-lab-__codelineno-20-16"></a><span class="cm">  * Set up request handlers</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#lab03-mcp-tools-lab-__codelineno-20-17"></a><span class="cm">  */</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#lab03-mcp-tools-lab-__codelineno-20-18"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#lab03-mcp-tools-lab-__codelineno-20-19"></a><span class="w">    </span><span class="c1">// Handler for listing available tools</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#lab03-mcp-tools-lab-__codelineno-20-20"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#lab03-mcp-tools-lab-__codelineno-20-21"></a><span class="w">      </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#lab03-mcp-tools-lab-__codelineno-20-22"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#lab03-mcp-tools-lab-__codelineno-20-23"></a><span class="w">        </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#lab03-mcp-tools-lab-__codelineno-20-24"></a><span class="w">          </span><span class="c1">// ... existing tools ...</span>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#lab03-mcp-tools-lab-__codelineno-20-25"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#lab03-mcp-tools-lab-__codelineno-20-26"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;query_database&quot;</span><span class="p">,</span>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#lab03-mcp-tools-lab-__codelineno-20-27"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Execute SELECT queries on a SQLite database&quot;</span><span class="p">,</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#lab03-mcp-tools-lab-__codelineno-20-28"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#lab03-mcp-tools-lab-__codelineno-20-29"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#lab03-mcp-tools-lab-__codelineno-20-30"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#lab03-mcp-tools-lab-__codelineno-20-31"></a><span class="w">                </span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#lab03-mcp-tools-lab-__codelineno-20-32"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33" href="#lab03-mcp-tools-lab-__codelineno-20-33"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;SQL SELECT query to execute&quot;</span>
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34" href="#lab03-mcp-tools-lab-__codelineno-20-34"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35" href="#lab03-mcp-tools-lab-__codelineno-20-35"></a><span class="w">                </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36" href="#lab03-mcp-tools-lab-__codelineno-20-36"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37" href="#lab03-mcp-tools-lab-__codelineno-20-37"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Query parameters for prepared statement&quot;</span><span class="p">,</span>
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38" href="#lab03-mcp-tools-lab-__codelineno-20-38"></a><span class="w">                  </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39" href="#lab03-mcp-tools-lab-__codelineno-20-39"></a><span class="w">                    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;null&quot;</span><span class="p">]</span>
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40" href="#lab03-mcp-tools-lab-__codelineno-20-40"></a><span class="w">                  </span><span class="p">},</span>
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41" href="#lab03-mcp-tools-lab-__codelineno-20-41"></a><span class="w">                  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span>
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42" href="#lab03-mcp-tools-lab-__codelineno-20-42"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43" href="#lab03-mcp-tools-lab-__codelineno-20-43"></a><span class="w">                </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-44"><a id="__codelineno-20-44" name="__codelineno-20-44" href="#lab03-mcp-tools-lab-__codelineno-20-44"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-20-45"><a id="__codelineno-20-45" name="__codelineno-20-45" href="#lab03-mcp-tools-lab-__codelineno-20-45"></a><span class="w">                  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum number of rows to return&quot;</span><span class="p">,</span>
</span><span id="__span-20-46"><a id="__codelineno-20-46" name="__codelineno-20-46" href="#lab03-mcp-tools-lab-__codelineno-20-46"></a><span class="w">                  </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span>
</span><span id="__span-20-47"><a id="__codelineno-20-47" name="__codelineno-20-47" href="#lab03-mcp-tools-lab-__codelineno-20-47"></a><span class="w">                  </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="p">,</span>
</span><span id="__span-20-48"><a id="__codelineno-20-48" name="__codelineno-20-48" href="#lab03-mcp-tools-lab-__codelineno-20-48"></a><span class="w">                  </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span>
</span><span id="__span-20-49"><a id="__codelineno-20-49" name="__codelineno-20-49" href="#lab03-mcp-tools-lab-__codelineno-20-49"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-20-50"><a id="__codelineno-20-50" name="__codelineno-20-50" href="#lab03-mcp-tools-lab-__codelineno-20-50"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-20-51"><a id="__codelineno-20-51" name="__codelineno-20-51" href="#lab03-mcp-tools-lab-__codelineno-20-51"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>
</span><span id="__span-20-52"><a id="__codelineno-20-52" name="__codelineno-20-52" href="#lab03-mcp-tools-lab-__codelineno-20-52"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-20-53"><a id="__codelineno-20-53" name="__codelineno-20-53" href="#lab03-mcp-tools-lab-__codelineno-20-53"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-20-54"><a id="__codelineno-20-54" name="__codelineno-20-54" href="#lab03-mcp-tools-lab-__codelineno-20-54"></a><span class="w">          </span><span class="c1">// ... existing tools ...</span>
</span><span id="__span-20-55"><a id="__codelineno-20-55" name="__codelineno-20-55" href="#lab03-mcp-tools-lab-__codelineno-20-55"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-20-56"><a id="__codelineno-20-56" name="__codelineno-20-56" href="#lab03-mcp-tools-lab-__codelineno-20-56"></a><span class="w">      </span><span class="p">})</span>
</span><span id="__span-20-57"><a id="__codelineno-20-57" name="__codelineno-20-57" href="#lab03-mcp-tools-lab-__codelineno-20-57"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-20-58"><a id="__codelineno-20-58" name="__codelineno-20-58" href="#lab03-mcp-tools-lab-__codelineno-20-58"></a>
</span><span id="__span-20-59"><a id="__codelineno-20-59" name="__codelineno-20-59" href="#lab03-mcp-tools-lab-__codelineno-20-59"></a><span class="w">    </span><span class="c1">// Handler for calling tools</span>
</span><span id="__span-20-60"><a id="__codelineno-20-60" name="__codelineno-20-60" href="#lab03-mcp-tools-lab-__codelineno-20-60"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span>
</span><span id="__span-20-61"><a id="__codelineno-20-61" name="__codelineno-20-61" href="#lab03-mcp-tools-lab-__codelineno-20-61"></a><span class="w">      </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-62"><a id="__codelineno-20-62" name="__codelineno-20-62" href="#lab03-mcp-tools-lab-__codelineno-20-62"></a><span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-63"><a id="__codelineno-20-63" name="__codelineno-20-63" href="#lab03-mcp-tools-lab-__codelineno-20-63"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-20-64"><a id="__codelineno-20-64" name="__codelineno-20-64" href="#lab03-mcp-tools-lab-__codelineno-20-64"></a>
</span><span id="__span-20-65"><a id="__codelineno-20-65" name="__codelineno-20-65" href="#lab03-mcp-tools-lab-__codelineno-20-65"></a><span class="w">        </span><span class="c1">// ... existing tool handlers ...</span>
</span><span id="__span-20-66"><a id="__codelineno-20-66" name="__codelineno-20-66" href="#lab03-mcp-tools-lab-__codelineno-20-66"></a>
</span><span id="__span-20-67"><a id="__codelineno-20-67" name="__codelineno-20-67" href="#lab03-mcp-tools-lab-__codelineno-20-67"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;query_database&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-68"><a id="__codelineno-20-68" name="__codelineno-20-68" href="#lab03-mcp-tools-lab-__codelineno-20-68"></a><span class="w">          </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-69"><a id="__codelineno-20-69" name="__codelineno-20-69" href="#lab03-mcp-tools-lab-__codelineno-20-69"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">query</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-20-70"><a id="__codelineno-20-70" name="__codelineno-20-70" href="#lab03-mcp-tools-lab-__codelineno-20-70"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">parameters</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">[])</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-20-71"><a id="__codelineno-20-71" name="__codelineno-20-71" href="#lab03-mcp-tools-lab-__codelineno-20-71"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">limit</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
</span><span id="__span-20-72"><a id="__codelineno-20-72" name="__codelineno-20-72" href="#lab03-mcp-tools-lab-__codelineno-20-72"></a>
</span><span id="__span-20-73"><a id="__codelineno-20-73" name="__codelineno-20-73" href="#lab03-mcp-tools-lab-__codelineno-20-73"></a><span class="w">            </span><span class="c1">// Security: Validate input</span>
</span><span id="__span-20-74"><a id="__codelineno-20-74" name="__codelineno-20-74" href="#lab03-mcp-tools-lab-__codelineno-20-74"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">query</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">query</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-75"><a id="__codelineno-20-75" name="__codelineno-20-75" href="#lab03-mcp-tools-lab-__codelineno-20-75"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;query must be a non-empty string&quot;</span><span class="p">);</span>
</span><span id="__span-20-76"><a id="__codelineno-20-76" name="__codelineno-20-76" href="#lab03-mcp-tools-lab-__codelineno-20-76"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-20-77"><a id="__codelineno-20-77" name="__codelineno-20-77" href="#lab03-mcp-tools-lab-__codelineno-20-77"></a>
</span><span id="__span-20-78"><a id="__codelineno-20-78" name="__codelineno-20-78" href="#lab03-mcp-tools-lab-__codelineno-20-78"></a><span class="w">            </span><span class="c1">// Security: Only allow SELECT queries</span>
</span><span id="__span-20-79"><a id="__codelineno-20-79" name="__codelineno-20-79" href="#lab03-mcp-tools-lab-__codelineno-20-79"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">trimmedQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">query</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toUpperCase</span><span class="p">();</span>
</span><span id="__span-20-80"><a id="__codelineno-20-80" name="__codelineno-20-80" href="#lab03-mcp-tools-lab-__codelineno-20-80"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">trimmedQuery</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;SELECT&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-81"><a id="__codelineno-20-81" name="__codelineno-20-81" href="#lab03-mcp-tools-lab-__codelineno-20-81"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Only SELECT queries are allowed for security&quot;</span><span class="p">);</span>
</span><span id="__span-20-82"><a id="__codelineno-20-82" name="__codelineno-20-82" href="#lab03-mcp-tools-lab-__codelineno-20-82"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-20-83"><a id="__codelineno-20-83" name="__codelineno-20-83" href="#lab03-mcp-tools-lab-__codelineno-20-83"></a>
</span><span id="__span-20-84"><a id="__codelineno-20-84" name="__codelineno-20-84" href="#lab03-mcp-tools-lab-__codelineno-20-84"></a><span class="w">            </span><span class="c1">// Check if database file exists</span>
</span><span id="__span-20-85"><a id="__codelineno-20-85" name="__codelineno-20-85" href="#lab03-mcp-tools-lab-__codelineno-20-85"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">dbPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./data.db&#39;</span><span class="p">;</span>
</span><span id="__span-20-86"><a id="__codelineno-20-86" name="__codelineno-20-86" href="#lab03-mcp-tools-lab-__codelineno-20-86"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-87"><a id="__codelineno-20-87" name="__codelineno-20-87" href="#lab03-mcp-tools-lab-__codelineno-20-87"></a><span class="w">              </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="nx">dbPath</span><span class="p">,</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">R_OK</span><span class="p">);</span>
</span><span id="__span-20-88"><a id="__codelineno-20-88" name="__codelineno-20-88" href="#lab03-mcp-tools-lab-__codelineno-20-88"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-89"><a id="__codelineno-20-89" name="__codelineno-20-89" href="#lab03-mcp-tools-lab-__codelineno-20-89"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Database file &#39;data.db&#39; not found in project root&quot;</span><span class="p">);</span>
</span><span id="__span-20-90"><a id="__codelineno-20-90" name="__codelineno-20-90" href="#lab03-mcp-tools-lab-__codelineno-20-90"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-20-91"><a id="__codelineno-20-91" name="__codelineno-20-91" href="#lab03-mcp-tools-lab-__codelineno-20-91"></a>
</span><span id="__span-20-92"><a id="__codelineno-20-92" name="__codelineno-20-92" href="#lab03-mcp-tools-lab-__codelineno-20-92"></a><span class="w">            </span><span class="c1">// Open database in read-only mode</span>
</span><span id="__span-20-93"><a id="__codelineno-20-93" name="__codelineno-20-93" href="#lab03-mcp-tools-lab-__codelineno-20-93"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Database</span><span class="p">(</span><span class="nx">dbPath</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">readonly</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-20-94"><a id="__codelineno-20-94" name="__codelineno-20-94" href="#lab03-mcp-tools-lab-__codelineno-20-94"></a>
</span><span id="__span-20-95"><a id="__codelineno-20-95" name="__codelineno-20-95" href="#lab03-mcp-tools-lab-__codelineno-20-95"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-96"><a id="__codelineno-20-96" name="__codelineno-20-96" href="#lab03-mcp-tools-lab-__codelineno-20-96"></a><span class="w">              </span><span class="c1">// Prepare statement</span>
</span><span id="__span-20-97"><a id="__codelineno-20-97" name="__codelineno-20-97" href="#lab03-mcp-tools-lab-__codelineno-20-97"></a><span class="w">              </span><span class="kd">const</span><span class="w"> </span><span class="nx">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="nx">query</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; LIMIT ?&#39;</span><span class="p">);</span>
</span><span id="__span-20-98"><a id="__codelineno-20-98" name="__codelineno-20-98" href="#lab03-mcp-tools-lab-__codelineno-20-98"></a>
</span><span id="__span-20-99"><a id="__codelineno-20-99" name="__codelineno-20-99" href="#lab03-mcp-tools-lab-__codelineno-20-99"></a><span class="w">              </span><span class="c1">// Execute query</span>
</span><span id="__span-20-100"><a id="__codelineno-20-100" name="__codelineno-20-100" href="#lab03-mcp-tools-lab-__codelineno-20-100"></a><span class="w">              </span><span class="kd">const</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stmt</span><span class="p">.</span><span class="nx">all</span><span class="p">(...</span><span class="nx">parameters</span><span class="p">,</span><span class="w"> </span><span class="nx">limit</span><span class="p">);</span>
</span><span id="__span-20-101"><a id="__codelineno-20-101" name="__codelineno-20-101" href="#lab03-mcp-tools-lab-__codelineno-20-101"></a>
</span><span id="__span-20-102"><a id="__codelineno-20-102" name="__codelineno-20-102" href="#lab03-mcp-tools-lab-__codelineno-20-102"></a><span class="w">              </span><span class="c1">// Format results</span>
</span><span id="__span-20-103"><a id="__codelineno-20-103" name="__codelineno-20-103" href="#lab03-mcp-tools-lab-__codelineno-20-103"></a><span class="w">              </span><span class="kd">const</span><span class="w"> </span><span class="nx">resultText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span>
</span><span id="__span-20-104"><a id="__codelineno-20-104" name="__codelineno-20-104" href="#lab03-mcp-tools-lab-__codelineno-20-104"></a><span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">rows</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
</span><span id="__span-20-105"><a id="__codelineno-20-105" name="__codelineno-20-105" href="#lab03-mcp-tools-lab-__codelineno-20-105"></a><span class="w">                </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;No results found&quot;</span><span class="p">;</span>
</span><span id="__span-20-106"><a id="__codelineno-20-106" name="__codelineno-20-106" href="#lab03-mcp-tools-lab-__codelineno-20-106"></a>
</span><span id="__span-20-107"><a id="__codelineno-20-107" name="__codelineno-20-107" href="#lab03-mcp-tools-lab-__codelineno-20-107"></a><span class="w">              </span><span class="c1">// Get query info</span>
</span><span id="__span-20-108"><a id="__codelineno-20-108" name="__codelineno-20-108" href="#lab03-mcp-tools-lab-__codelineno-20-108"></a><span class="w">              </span><span class="kd">const</span><span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stmt</span><span class="p">.</span><span class="nx">columns</span><span class="p">();</span>
</span><span id="__span-20-109"><a id="__codelineno-20-109" name="__codelineno-20-109" href="#lab03-mcp-tools-lab-__codelineno-20-109"></a><span class="w">              </span><span class="kd">const</span><span class="w"> </span><span class="nx">columnNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">info</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">col</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">col</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span><span id="__span-20-110"><a id="__codelineno-20-110" name="__codelineno-20-110" href="#lab03-mcp-tools-lab-__codelineno-20-110"></a>
</span><span id="__span-20-111"><a id="__codelineno-20-111" name="__codelineno-20-111" href="#lab03-mcp-tools-lab-__codelineno-20-111"></a><span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-112"><a id="__codelineno-20-112" name="__codelineno-20-112" href="#lab03-mcp-tools-lab-__codelineno-20-112"></a><span class="w">                </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-113"><a id="__codelineno-20-113" name="__codelineno-20-113" href="#lab03-mcp-tools-lab-__codelineno-20-113"></a><span class="w">                  </span><span class="p">{</span>
</span><span id="__span-20-114"><a id="__codelineno-20-114" name="__codelineno-20-114" href="#lab03-mcp-tools-lab-__codelineno-20-114"></a><span class="w">                    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-20-115"><a id="__codelineno-20-115" name="__codelineno-20-115" href="#lab03-mcp-tools-lab-__codelineno-20-115"></a><span class="w">                    </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Query executed successfully.\nDatabase: </span><span class="si">${</span><span class="nx">dbPath</span><span class="si">}</span><span class="sb">\nColumns: </span><span class="si">${</span><span class="nx">columnNames</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">\nRows returned: </span><span class="si">${</span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb">\n\nResults:\n</span><span class="si">${</span><span class="nx">resultText</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-20-116"><a id="__codelineno-20-116" name="__codelineno-20-116" href="#lab03-mcp-tools-lab-__codelineno-20-116"></a><span class="w">                  </span><span class="p">}</span>
</span><span id="__span-20-117"><a id="__codelineno-20-117" name="__codelineno-20-117" href="#lab03-mcp-tools-lab-__codelineno-20-117"></a><span class="w">                </span><span class="p">]</span>
</span><span id="__span-20-118"><a id="__codelineno-20-118" name="__codelineno-20-118" href="#lab03-mcp-tools-lab-__codelineno-20-118"></a><span class="w">              </span><span class="p">};</span>
</span><span id="__span-20-119"><a id="__codelineno-20-119" name="__codelineno-20-119" href="#lab03-mcp-tools-lab-__codelineno-20-119"></a>
</span><span id="__span-20-120"><a id="__codelineno-20-120" name="__codelineno-20-120" href="#lab03-mcp-tools-lab-__codelineno-20-120"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-121"><a id="__codelineno-20-121" name="__codelineno-20-121" href="#lab03-mcp-tools-lab-__codelineno-20-121"></a><span class="w">              </span><span class="nx">db</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-20-122"><a id="__codelineno-20-122" name="__codelineno-20-122" href="#lab03-mcp-tools-lab-__codelineno-20-122"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-20-123"><a id="__codelineno-20-123" name="__codelineno-20-123" href="#lab03-mcp-tools-lab-__codelineno-20-123"></a>
</span><span id="__span-20-124"><a id="__codelineno-20-124" name="__codelineno-20-124" href="#lab03-mcp-tools-lab-__codelineno-20-124"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-125"><a id="__codelineno-20-125" name="__codelineno-20-125" href="#lab03-mcp-tools-lab-__codelineno-20-125"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-20-126"><a id="__codelineno-20-126" name="__codelineno-20-126" href="#lab03-mcp-tools-lab-__codelineno-20-126"></a><span class="w">              </span><span class="sb">`Database query failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-20-127"><a id="__codelineno-20-127" name="__codelineno-20-127" href="#lab03-mcp-tools-lab-__codelineno-20-127"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-20-128"><a id="__codelineno-20-128" name="__codelineno-20-128" href="#lab03-mcp-tools-lab-__codelineno-20-128"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-20-129"><a id="__codelineno-20-129" name="__codelineno-20-129" href="#lab03-mcp-tools-lab-__codelineno-20-129"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-20-130"><a id="__codelineno-20-130" name="__codelineno-20-130" href="#lab03-mcp-tools-lab-__codelineno-20-130"></a>
</span><span id="__span-20-131"><a id="__codelineno-20-131" name="__codelineno-20-131" href="#lab03-mcp-tools-lab-__codelineno-20-131"></a><span class="w">        </span><span class="c1">// ... existing tool handlers ...</span>
</span><span id="__span-20-132"><a id="__codelineno-20-132" name="__codelineno-20-132" href="#lab03-mcp-tools-lab-__codelineno-20-132"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-20-133"><a id="__codelineno-20-133" name="__codelineno-20-133" href="#lab03-mcp-tools-lab-__codelineno-20-133"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-20-134"><a id="__codelineno-20-134" name="__codelineno-20-134" href="#lab03-mcp-tools-lab-__codelineno-20-134"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-135"><a id="__codelineno-20-135" name="__codelineno-20-135" href="#lab03-mcp-tools-lab-__codelineno-20-135"></a>
</span><span id="__span-20-136"><a id="__codelineno-20-136" name="__codelineno-20-136" href="#lab03-mcp-tools-lab-__codelineno-20-136"></a><span class="w">  </span><span class="c1">// ... rest of the class remains the same ...</span>
</span></code></pre></div>
</li>
</ul>
<h4 id="lab03-mcp-tools-lab-testing-the-database-query-tool">Testing the Database Query Tool<a class="headerlink" href="#lab03-mcp-tools-lab-testing-the-database-query-tool" title="Permanent link">&para;</a></h4>
<p><strong>Step 1: Install SQLite</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#lab03-mcp-tools-lab-__codelineno-21-1"></a><span class="c1"># Install sqlite3 command-line tool (if not already installed)</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#lab03-mcp-tools-lab-__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#lab03-mcp-tools-lab-__codelineno-21-3"></a><span class="c1"># On macOS:</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#lab03-mcp-tools-lab-__codelineno-21-4"></a>brew<span class="w"> </span>install<span class="w"> </span>sqlite3
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#lab03-mcp-tools-lab-__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#lab03-mcp-tools-lab-__codelineno-21-6"></a><span class="c1"># On Linux (Ubuntu/Debian):</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#lab03-mcp-tools-lab-__codelineno-21-7"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>sqlite3
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#lab03-mcp-tools-lab-__codelineno-21-8"></a>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#lab03-mcp-tools-lab-__codelineno-21-9"></a><span class="c1"># On Linux (CentOS/RHEL/Fedora):</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#lab03-mcp-tools-lab-__codelineno-21-10"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>sqlite3<span class="w">    </span><span class="c1"># or sudo dnf install sqlite3</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#lab03-mcp-tools-lab-__codelineno-21-11"></a>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#lab03-mcp-tools-lab-__codelineno-21-12"></a><span class="c1"># On Windows (using Chocolatey):</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#lab03-mcp-tools-lab-__codelineno-21-13"></a>choco<span class="w"> </span>install<span class="w"> </span>sqlite
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#lab03-mcp-tools-lab-__codelineno-21-14"></a>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#lab03-mcp-tools-lab-__codelineno-21-15"></a><span class="c1"># On Windows (manual download):</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#lab03-mcp-tools-lab-__codelineno-21-16"></a><span class="c1"># Download from: https://www.sqlite.org/download.html</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#lab03-mcp-tools-lab-__codelineno-21-17"></a><span class="c1"># Extract sqlite3.exe to a folder in your PATH</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#lab03-mcp-tools-lab-__codelineno-21-18"></a>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#lab03-mcp-tools-lab-__codelineno-21-19"></a><span class="c1"># Verify installation:</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#lab03-mcp-tools-lab-__codelineno-21-20"></a>sqlite3<span class="w"> </span>--version
</span></code></pre></div>
<p><br></p>
<p><strong>Step 2: Create a Sample Database</strong></p>
<p><strong>Navigate to your MCP server directory</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#lab03-mcp-tools-lab-__codelineno-22-1"></a><span class="nb">cd</span><span class="w"> </span>/Users/orni/Code-Wizard/MCP_Lab/MCP_Lab/lab_solution/my-first-mcp-server
</span></code></pre></div>
<p><strong>Run the database creation command</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#lab03-mcp-tools-lab-__codelineno-23-1"></a>sqlite3<span class="w"> </span>data.db<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#lab03-mcp-tools-lab-__codelineno-23-2"></a><span class="s">CREATE TABLE users (</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#lab03-mcp-tools-lab-__codelineno-23-3"></a><span class="s">  id INTEGER PRIMARY KEY,</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#lab03-mcp-tools-lab-__codelineno-23-4"></a><span class="s">  name TEXT NOT NULL,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#lab03-mcp-tools-lab-__codelineno-23-5"></a><span class="s">  email TEXT UNIQUE,</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#lab03-mcp-tools-lab-__codelineno-23-6"></a><span class="s">  age INTEGER,</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#lab03-mcp-tools-lab-__codelineno-23-7"></a><span class="s">  created_at DATETIME DEFAULT CURRENT_TIMESTAMP</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#lab03-mcp-tools-lab-__codelineno-23-8"></a><span class="s">);</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#lab03-mcp-tools-lab-__codelineno-23-9"></a>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#lab03-mcp-tools-lab-__codelineno-23-10"></a><span class="s">CREATE TABLE products (</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#lab03-mcp-tools-lab-__codelineno-23-11"></a><span class="s">  id INTEGER PRIMARY KEY,</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#lab03-mcp-tools-lab-__codelineno-23-12"></a><span class="s">  name TEXT NOT NULL,</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#lab03-mcp-tools-lab-__codelineno-23-13"></a><span class="s">  price REAL,</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#lab03-mcp-tools-lab-__codelineno-23-14"></a><span class="s">  category TEXT,</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#lab03-mcp-tools-lab-__codelineno-23-15"></a><span class="s">  in_stock BOOLEAN DEFAULT 1</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#lab03-mcp-tools-lab-__codelineno-23-16"></a><span class="s">);</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#lab03-mcp-tools-lab-__codelineno-23-17"></a>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#lab03-mcp-tools-lab-__codelineno-23-18"></a><span class="s">INSERT INTO users (name, email, age) VALUES </span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#lab03-mcp-tools-lab-__codelineno-23-19"></a><span class="s">  (&#39;Alice Johnson&#39;, &#39;alice@example.com&#39;, 28),</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#lab03-mcp-tools-lab-__codelineno-23-20"></a><span class="s">  (&#39;Bob Smith&#39;, &#39;bob@example.com&#39;, 34),</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#lab03-mcp-tools-lab-__codelineno-23-21"></a><span class="s">  (&#39;Charlie Brown&#39;, &#39;charlie@example.com&#39;, 22);</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#lab03-mcp-tools-lab-__codelineno-23-22"></a>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#lab03-mcp-tools-lab-__codelineno-23-23"></a><span class="s">INSERT INTO products (name, price, category, in_stock) VALUES </span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#lab03-mcp-tools-lab-__codelineno-23-24"></a><span class="s">  (&#39;Laptop&#39;, 999.99, &#39;Electronics&#39;, 1),</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#lab03-mcp-tools-lab-__codelineno-23-25"></a><span class="s">  (&#39;Book&#39;, 19.99, &#39;Education&#39;, 1),</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#lab03-mcp-tools-lab-__codelineno-23-26"></a><span class="s">  (&#39;Coffee Mug&#39;, 12.50, &#39;Kitchen&#39;, 0);</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#lab03-mcp-tools-lab-__codelineno-23-27"></a>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#lab03-mcp-tools-lab-__codelineno-23-28"></a><span class="s">.quit</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#lab03-mcp-tools-lab-__codelineno-23-29"></a><span class="s">EOF</span>
</span></code></pre></div>
<p><strong>Verify the database was created</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#lab03-mcp-tools-lab-__codelineno-24-1"></a>sqlite3<span class="w"> </span>data.db<span class="w"> </span><span class="s2">&quot;SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;&quot;</span>
</span></code></pre></div>
<ul>
<li>
<p>You should see output like:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#lab03-mcp-tools-lab-__codelineno-25-1"></a>users
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#lab03-mcp-tools-lab-__codelineno-25-2"></a>products
</span></code></pre></div>
</li>
</ul>
<p><strong>What this does:</strong></p>
<ul>
<li>Creates a SQLite database file called <code>data.db</code> in your project directory</li>
<li>Creates two tables: <code>users</code> and <code>products</code></li>
<li>Inserts sample data into both tables</li>
<li>This gives you test data to query with your <code>query_database</code> tool</li>
</ul>
<p><br></p>
<p><strong>Step 2: Start the MCP Inspector</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#lab03-mcp-tools-lab-__codelineno-26-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><br></p>
<p><strong>Step 3: Test Database Queries</strong></p>
<ol>
<li>
<p><strong>Simple SELECT query</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT * FROM users</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Query with WHERE clause</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT name, email FROM users WHERE age &gt; 25</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Query with parameters</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT * FROM products WHERE category = ?</code></li>
<li>parameters: <code>["Electronics"]</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Query with LIMIT</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT * FROM users</code></li>
<li>limit: <code>2</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
<li>
<p><strong>JOIN query</strong>:</p>
<ul>
<li>Tool: <code>query_database</code></li>
<li>query: <code>SELECT u.name, p.name as product FROM users u CROSS JOIN products p LIMIT 5</code></li>
<li>Click &ldquo;Call Tool&rdquo;</li>
</ul>
</li>
</ol>
<p><br></p>
<p><strong>Step 4: Test Error Cases</strong></p>
<ol>
<li>
<p><strong>Non-SELECT query</strong>:</p>
<ul>
<li>query: <code>DELETE FROM users WHERE id = 1</code></li>
</ul>
</li>
<li>
<p><strong>Invalid SQL syntax</strong>:</p>
<ul>
<li>query: <code>SELECT * FROM nonexistent_table</code></li>
</ul>
</li>
<li>
<p><strong>Missing database file</strong>:</p>
<ul>
<li>Rename <code>data.db</code> to <code>data.db.backup</code> and try a query</li>
</ul>
</li>
<li>
<p><strong>Empty query</strong>:</p>
<ul>
<li>query: <code>""</code></li>
</ul>
</li>
</ol>
<p><br></p>
<p><strong>Step 5: Verify Output</strong></p>
<ul>
<li>
<p>You should see output like:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#lab03-mcp-tools-lab-__codelineno-27-1"></a>Query executed successfully.
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#lab03-mcp-tools-lab-__codelineno-27-2"></a>Database: ./data.db
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#lab03-mcp-tools-lab-__codelineno-27-3"></a>Columns: id, name, email, age, created_at
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#lab03-mcp-tools-lab-__codelineno-27-4"></a>Rows returned: 3
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#lab03-mcp-tools-lab-__codelineno-27-5"></a>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#lab03-mcp-tools-lab-__codelineno-27-6"></a>Results:
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#lab03-mcp-tools-lab-__codelineno-27-7"></a>[
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#lab03-mcp-tools-lab-__codelineno-27-8"></a>  {
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#lab03-mcp-tools-lab-__codelineno-27-9"></a>    &quot;id&quot;: 1,
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#lab03-mcp-tools-lab-__codelineno-27-10"></a>    &quot;name&quot;: &quot;Alice Johnson&quot;,
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#lab03-mcp-tools-lab-__codelineno-27-11"></a>    &quot;email&quot;: &quot;alice@example.com&quot;,
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#lab03-mcp-tools-lab-__codelineno-27-12"></a>    &quot;age&quot;: 28,
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#lab03-mcp-tools-lab-__codelineno-27-13"></a>    &quot;created_at&quot;: &quot;2024-01-06 10:30:00&quot;
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#lab03-mcp-tools-lab-__codelineno-27-14"></a>  },
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#lab03-mcp-tools-lab-__codelineno-27-15"></a>  ...
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#lab03-mcp-tools-lab-__codelineno-27-16"></a>]
</span></code></pre></div>
</li>
</ul>
<p><strong>Troubleshooting:</strong></p>
<ul>
<li><strong>&ldquo;Database file not found&rdquo;</strong>: Make sure <code>data.db</code> exists in your project root</li>
<li><strong>&ldquo;Only SELECT queries are allowed&rdquo;</strong>: The tool only allows SELECT statements for security</li>
<li><strong>&ldquo;no such table&rdquo;</strong>: Check your table names in the database</li>
<li><strong>&ldquo;sqlite3: command not found&rdquo;</strong>: Install sqlite3 CLI tool</li>
</ul>
<h4 id="lab03-mcp-tools-lab-key-learning-points_2">Key Learning Points:<a class="headerlink" href="#lab03-mcp-tools-lab-key-learning-points_2" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>SQL injection prevention</strong> using prepared statements</li>
<li><strong>Database security</strong> with read-only access and query restrictions</li>
<li><strong>SQLite operations</strong> with better-sqlite3</li>
<li><strong>Query parameterization</strong> for safe dynamic queries</li>
<li><strong>Result formatting</strong> and metadata extraction</li>
<li><strong>Resource management</strong> with proper database connection handling</li>
</ul>
<hr />
<h2 id="lab03-mcp-tools-lab-returning-rich-content">Returning Rich Content<a class="headerlink" href="#lab03-mcp-tools-lab-returning-rich-content" title="Permanent link">&para;</a></h2>
<p>MCP supports multiple content types in tool responses, allowing you to return not just text but also images, resources, and combinations of different content types. This enables richer, more interactive responses that can include visual data, file references, and structured information.</p>
<h3 id="lab03-mcp-tools-lab-1-text-content">1. Text Content<a class="headerlink" href="#lab03-mcp-tools-lab-1-text-content" title="Permanent link">&para;</a></h3>
<p><strong>Text content</strong> is the most common and basic type of response. Use it for any string-based information like analysis results, status messages, or formatted data.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#lab03-mcp-tools-lab-__codelineno-28-1"></a><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#lab03-mcp-tools-lab-__codelineno-28-2"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#lab03-mcp-tools-lab-__codelineno-28-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#lab03-mcp-tools-lab-__codelineno-28-4"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#lab03-mcp-tools-lab-__codelineno-28-5"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Simple text response&quot;</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#lab03-mcp-tools-lab-__codelineno-28-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#lab03-mcp-tools-lab-__codelineno-28-7"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#lab03-mcp-tools-lab-__codelineno-28-8"></a><span class="p">};</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Most tool responses will use text content. It&rsquo;s perfect for:</p>
<ul>
<li>Status messages and confirmations</li>
<li>Formatted data output (JSON, tables, lists)</li>
<li>Error messages and explanations</li>
<li>Analysis results and summaries</li>
</ul>
<h3 id="lab03-mcp-tools-lab-2-image-content">2. Image Content<a class="headerlink" href="#lab03-mcp-tools-lab-2-image-content" title="Permanent link">&para;</a></h3>
<p><strong>Image content</strong> allows you to return visual data directly in the response. The image data must be base64-encoded and include the appropriate MIME type.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#lab03-mcp-tools-lab-__codelineno-29-1"></a><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#lab03-mcp-tools-lab-__codelineno-29-2"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#lab03-mcp-tools-lab-__codelineno-29-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#lab03-mcp-tools-lab-__codelineno-29-4"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image&quot;</span><span class="p">,</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#lab03-mcp-tools-lab-__codelineno-29-5"></a><span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">base64ImageData</span><span class="p">,</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#lab03-mcp-tools-lab-__codelineno-29-6"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#lab03-mcp-tools-lab-__codelineno-29-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#lab03-mcp-tools-lab-__codelineno-29-8"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#lab03-mcp-tools-lab-__codelineno-29-9"></a><span class="p">};</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Ideal for tools that generate or process visual content:</p>
<ul>
<li>Charts and graphs from data analysis</li>
<li>Screenshots or visual captures</li>
<li>Generated diagrams or illustrations</li>
<li>Image processing results</li>
</ul>
<p><strong>Important:</strong> Always specify the correct MIME type (image/png, image/jpeg, image/svg+xml, etc.) and ensure the base64 data is properly encoded.</p>
<h3 id="lab03-mcp-tools-lab-3-resource-content">3. Resource Content<a class="headerlink" href="#lab03-mcp-tools-lab-3-resource-content" title="Permanent link">&para;</a></h3>
<p><strong>Resource content</strong> references external resources rather than including their data directly. This is useful for large files or when you want to provide access to resources without embedding them.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#lab03-mcp-tools-lab-__codelineno-30-1"></a><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#lab03-mcp-tools-lab-__codelineno-30-2"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#lab03-mcp-tools-lab-__codelineno-30-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#lab03-mcp-tools-lab-__codelineno-30-4"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;resource&quot;</span><span class="p">,</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#lab03-mcp-tools-lab-__codelineno-30-5"></a><span class="w">      </span><span class="nx">resource</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#lab03-mcp-tools-lab-__codelineno-30-6"></a><span class="w">        </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;file:///path/to/file.txt&quot;</span><span class="p">,</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#lab03-mcp-tools-lab-__codelineno-30-7"></a><span class="w">        </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text/plain&quot;</span><span class="p">,</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#lab03-mcp-tools-lab-__codelineno-30-8"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;File contents...&quot;</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#lab03-mcp-tools-lab-__codelineno-30-9"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#lab03-mcp-tools-lab-__codelineno-30-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#lab03-mcp-tools-lab-__codelineno-30-11"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#lab03-mcp-tools-lab-__codelineno-30-12"></a><span class="p">};</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Best for:</p>
<ul>
<li>Large files that would make responses too bulky</li>
<li>References to external files or URLs</li>
<li>When the client should handle the resource directly</li>
<li>Providing access to generated files</li>
</ul>
<p><strong>Note:</strong> The <code>text</code> field is optional - you can omit it if the resource content is too large or if you just want to provide a reference.</p>
<h3 id="lab03-mcp-tools-lab-4-multiple-content-items">4. Multiple Content Items<a class="headerlink" href="#lab03-mcp-tools-lab-4-multiple-content-items" title="Permanent link">&para;</a></h3>
<p><strong>Multiple content items</strong> allow you to combine different types of content in a single response. This creates rich, multi-part responses that can include text explanations alongside visual data.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#lab03-mcp-tools-lab-__codelineno-31-1"></a><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#lab03-mcp-tools-lab-__codelineno-31-2"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#lab03-mcp-tools-lab-__codelineno-31-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#lab03-mcp-tools-lab-__codelineno-31-4"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#lab03-mcp-tools-lab-__codelineno-31-5"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analysis complete:&quot;</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#lab03-mcp-tools-lab-__codelineno-31-6"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#lab03-mcp-tools-lab-__codelineno-31-7"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#lab03-mcp-tools-lab-__codelineno-31-8"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#lab03-mcp-tools-lab-__codelineno-31-9"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Details:\n- Item 1\n- Item 2&quot;</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#lab03-mcp-tools-lab-__codelineno-31-10"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#lab03-mcp-tools-lab-__codelineno-31-11"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#lab03-mcp-tools-lab-__codelineno-31-12"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image&quot;</span><span class="p">,</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#lab03-mcp-tools-lab-__codelineno-31-13"></a><span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">chartImage</span><span class="p">,</span>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#lab03-mcp-tools-lab-__codelineno-31-14"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#lab03-mcp-tools-lab-__codelineno-31-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#lab03-mcp-tools-lab-__codelineno-31-16"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#lab03-mcp-tools-lab-__codelineno-31-17"></a><span class="p">};</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Perfect for comprehensive responses that need multiple components:</p>
<ul>
<li>Analysis reports with both text summaries and visual charts</li>
<li>File processing results with metadata and content preview</li>
<li>Multi-step operations with status updates and final results</li>
<li>Complex data with both tabular and graphical representations</li>
</ul>
<p><strong>Tip:</strong> Order your content logically - start with text explanations, then show supporting images or resources.</p>
<hr />
<h2 id="lab03-mcp-tools-lab-error-handling-patterns">Error Handling Patterns<a class="headerlink" href="#lab03-mcp-tools-lab-error-handling-patterns" title="Permanent link">&para;</a></h2>
<p>Error handling is crucial for robust MCP tools. Different situations require different approaches to handle failures gracefully while providing useful feedback to users. Here are three essential patterns for handling errors effectively.</p>
<h3 id="lab03-mcp-tools-lab-pattern-1-input-validation">Pattern 1: Input Validation<a class="headerlink" href="#lab03-mcp-tools-lab-pattern-1-input-validation" title="Permanent link">&para;</a></h3>
<p><strong>Input validation</strong> ensures that tool arguments meet your requirements before processing begins. This prevents runtime errors and provides clear feedback when users provide invalid data.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#lab03-mcp-tools-lab-__codelineno-32-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">validateInput</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#lab03-mcp-tools-lab-__codelineno-32-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#lab03-mcp-tools-lab-__codelineno-32-3"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;filepath must be a non-empty string&quot;</span><span class="p">);</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#lab03-mcp-tools-lab-__codelineno-32-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#lab03-mcp-tools-lab-__codelineno-32-5"></a>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#lab03-mcp-tools-lab-__codelineno-32-6"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">maxSize</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">10485760</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#lab03-mcp-tools-lab-__codelineno-32-7"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;maxSize must be between 1 and 10485760 bytes&quot;</span><span class="p">);</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#lab03-mcp-tools-lab-__codelineno-32-8"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#lab03-mcp-tools-lab-__codelineno-32-9"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> Always validate inputs before processing, even when using JSON Schema validation. This pattern is essential for:</p>
<ul>
<li>Type checking beyond JSON Schema capabilities</li>
<li>Business logic validation (file size limits, path security)</li>
<li>Preventing runtime errors from malformed data</li>
<li>Providing specific, actionable error messages</li>
</ul>
<p><strong>Why it matters:</strong> Early validation fails fast and gives users clear guidance on how to fix their input.</p>
<h3 id="lab03-mcp-tools-lab-pattern-2-graceful-degradation">Pattern 2: Graceful Degradation<a class="headerlink" href="#lab03-mcp-tools-lab-pattern-2-graceful-degradation" title="Permanent link">&para;</a></h3>
<p><strong>Graceful degradation</strong> provides partial functionality when full operation isn&rsquo;t possible. Instead of failing completely, the tool returns useful information or falls back to alternative approaches.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#lab03-mcp-tools-lab-__codelineno-33-1"></a><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#lab03-mcp-tools-lab-__codelineno-33-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetchFromAPI</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#lab03-mcp-tools-lab-__codelineno-33-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">formatSuccess</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#lab03-mcp-tools-lab-__codelineno-33-4"></a><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#lab03-mcp-tools-lab-__codelineno-33-5"></a><span class="w">  </span><span class="c1">// Log error but return partial results if possible</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#lab03-mcp-tools-lab-__codelineno-33-6"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;API call failed:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#lab03-mcp-tools-lab-__codelineno-33-7"></a>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#lab03-mcp-tools-lab-__codelineno-33-8"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#lab03-mcp-tools-lab-__codelineno-33-9"></a><span class="w">    </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#lab03-mcp-tools-lab-__codelineno-33-10"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#lab03-mcp-tools-lab-__codelineno-33-11"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#lab03-mcp-tools-lab-__codelineno-33-12"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;⚠️ Could not fetch live data. Using cached results...&quot;</span>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#lab03-mcp-tools-lab-__codelineno-33-13"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#lab03-mcp-tools-lab-__codelineno-33-14"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#lab03-mcp-tools-lab-__codelineno-33-15"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#lab03-mcp-tools-lab-__codelineno-33-16"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For external dependencies that might be unreliable:</p>
<ul>
<li>API calls that could timeout or fail</li>
<li>Network-dependent operations</li>
<li>Services with occasional downtime</li>
<li>When partial results are better than no results</li>
</ul>
<p><strong>Why it matters:</strong> Users get some value even when systems are partially broken, improving overall reliability and user experience.</p>
<h3 id="lab03-mcp-tools-lab-pattern-3-detailed-error-context">Pattern 3: Detailed Error Context<a class="headerlink" href="#lab03-mcp-tools-lab-pattern-3-detailed-error-context" title="Permanent link">&para;</a></h3>
<p><strong>Detailed error context</strong> provides comprehensive information for debugging while keeping user-facing messages clean. Log full details internally but expose only safe, helpful information to users.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#lab03-mcp-tools-lab-__codelineno-34-1"></a><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#lab03-mcp-tools-lab-__codelineno-34-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="p">;</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#lab03-mcp-tools-lab-__codelineno-34-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#lab03-mcp-tools-lab-__codelineno-34-4"></a><span class="w">    </span><span class="nx">tool</span><span class="o">:</span><span class="w"> </span><span class="kt">name</span><span class="p">,</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#lab03-mcp-tools-lab-__codelineno-34-5"></a><span class="w">    </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="p">,</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#lab03-mcp-tools-lab-__codelineno-34-6"></a><span class="w">    </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#lab03-mcp-tools-lab-__codelineno-34-7"></a><span class="w">    </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">errorMessage</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#lab03-mcp-tools-lab-__codelineno-34-8"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#lab03-mcp-tools-lab-__codelineno-34-9"></a>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#lab03-mcp-tools-lab-__codelineno-34-10"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[Tool Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">errorContext</span><span class="p">));</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#lab03-mcp-tools-lab-__codelineno-34-11"></a>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#lab03-mcp-tools-lab-__codelineno-34-12"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#lab03-mcp-tools-lab-__codelineno-34-13"></a><span class="w">    </span><span class="sb">`Tool &#39;</span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">&#39; failed: </span><span class="si">${</span><span class="nx">errorMessage</span><span class="si">}</span><span class="sb">. Check server logs for details.`</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#lab03-mcp-tools-lab-__codelineno-34-14"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#lab03-mcp-tools-lab-__codelineno-34-15"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For complex operations where debugging might be needed:</p>
<ul>
<li>Multi-step processes with potential failure points</li>
<li>Operations involving external systems</li>
<li>When you need to track error patterns over time</li>
<li>Production environments where detailed logging is crucial</li>
</ul>
<p><strong>Why it matters:</strong> Developers can diagnose issues effectively while users get clear, non-technical error messages.</p>
<p><br></p>
<h4 id="lab03-mcp-tools-lab-best-practices-for-error-handling"><strong>Best Practices for Error Handling:</strong><a class="headerlink" href="#lab03-mcp-tools-lab-best-practices-for-error-handling" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Fail Fast:</strong> Validate inputs early and stop processing on critical errors</li>
<li><strong>Log Internally:</strong> Use <code>console.error()</code> for detailed logging (goes to stderr, not stdout)</li>
<li><strong>User-Friendly Messages:</strong> Keep error messages clear and actionable</li>
<li><strong>Don&rsquo;t Leak Sensitive Data:</strong> Never expose file paths, credentials, or internal details</li>
<li><strong>Consistent Format:</strong> Use similar error message patterns across tools</li>
<li><strong>Recovery Options:</strong> When possible, suggest how users can resolve the issue</li>
</ul>
<hr />
<h2 id="lab03-mcp-tools-lab-async-operations-and-performance">Async Operations and Performance<a class="headerlink" href="#lab03-mcp-tools-lab-async-operations-and-performance" title="Permanent link">&para;</a></h2>
<p>MCP tools often need to handle asynchronous operations and optimize performance. Long-running tasks require special handling to prevent timeouts and provide feedback, while expensive operations benefit from caching to improve response times and reduce resource usage.</p>
<h3 id="lab03-mcp-tools-lab-long-running-operations">Long-Running Operations<a class="headerlink" href="#lab03-mcp-tools-lab-long-running-operations" title="Permanent link">&para;</a></h3>
<p><strong>Long-running operations</strong> need monitoring and progress feedback to prevent timeouts and keep users informed. Use logging and timing to track operation progress and provide completion status.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#lab03-mcp-tools-lab-__codelineno-35-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;analyze_large_file&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#lab03-mcp-tools-lab-__codelineno-35-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">filepath</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#lab03-mcp-tools-lab-__codelineno-35-3"></a>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#lab03-mcp-tools-lab-__codelineno-35-4"></a><span class="w">  </span><span class="c1">// For very long operations, consider streaming or progress updates</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#lab03-mcp-tools-lab-__codelineno-35-5"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[INFO] Starting analysis of </span><span class="si">${</span><span class="nx">filepath</span><span class="si">}</span><span class="sb">...`</span><span class="p">);</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#lab03-mcp-tools-lab-__codelineno-35-6"></a>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#lab03-mcp-tools-lab-__codelineno-35-7"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#lab03-mcp-tools-lab-__codelineno-35-8"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#lab03-mcp-tools-lab-__codelineno-35-9"></a>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#lab03-mcp-tools-lab-__codelineno-35-10"></a><span class="w">    </span><span class="c1">// Perform analysis</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#lab03-mcp-tools-lab-__codelineno-35-11"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">performLongAnalysis</span><span class="p">(</span><span class="nx">filepath</span><span class="p">);</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#lab03-mcp-tools-lab-__codelineno-35-12"></a>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#lab03-mcp-tools-lab-__codelineno-35-13"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="p">;</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#lab03-mcp-tools-lab-__codelineno-35-14"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[INFO] Analysis completed in </span><span class="si">${</span><span class="nx">duration</span><span class="si">}</span><span class="sb">ms`</span><span class="p">);</span>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#lab03-mcp-tools-lab-__codelineno-35-15"></a>
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#lab03-mcp-tools-lab-__codelineno-35-16"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#lab03-mcp-tools-lab-__codelineno-35-17"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18" href="#lab03-mcp-tools-lab-__codelineno-35-18"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-35-19"><a id="__codelineno-35-19" name="__codelineno-35-19" href="#lab03-mcp-tools-lab-__codelineno-35-19"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-35-20"><a id="__codelineno-35-20" name="__codelineno-35-20" href="#lab03-mcp-tools-lab-__codelineno-35-20"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Analysis Results (completed in </span><span class="si">${</span><span class="nx">duration</span><span class="si">}</span><span class="sb">ms):\n\n</span><span class="si">${</span><span class="nx">result</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-35-21"><a id="__codelineno-35-21" name="__codelineno-35-21" href="#lab03-mcp-tools-lab-__codelineno-35-21"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-35-22"><a id="__codelineno-35-22" name="__codelineno-35-22" href="#lab03-mcp-tools-lab-__codelineno-35-22"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-35-23"><a id="__codelineno-35-23" name="__codelineno-35-23" href="#lab03-mcp-tools-lab-__codelineno-35-23"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-35-24"><a id="__codelineno-35-24" name="__codelineno-35-24" href="#lab03-mcp-tools-lab-__codelineno-35-24"></a>
</span><span id="__span-35-25"><a id="__codelineno-35-25" name="__codelineno-35-25" href="#lab03-mcp-tools-lab-__codelineno-35-25"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-26"><a id="__codelineno-35-26" name="__codelineno-35-26" href="#lab03-mcp-tools-lab-__codelineno-35-26"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[ERROR] Analysis failed after </span><span class="si">${</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="si">}</span><span class="sb">ms`</span><span class="p">);</span>
</span><span id="__span-35-27"><a id="__codelineno-35-27" name="__codelineno-35-27" href="#lab03-mcp-tools-lab-__codelineno-35-27"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="nx">error</span><span class="p">;</span>
</span><span id="__span-35-28"><a id="__codelineno-35-28" name="__codelineno-35-28" href="#lab03-mcp-tools-lab-__codelineno-35-28"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-35-29"><a id="__codelineno-35-29" name="__codelineno-35-29" href="#lab03-mcp-tools-lab-__codelineno-35-29"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For operations that take more than a few seconds:</p>
<ul>
<li>Large file processing or analysis</li>
<li>Complex computations</li>
<li>External API calls with potential delays</li>
<li>Batch operations on multiple items</li>
</ul>
<p><strong>Why it matters:</strong> Prevents timeouts, provides user feedback, enables monitoring and debugging of slow operations.</p>
<h3 id="lab03-mcp-tools-lab-caching-results">Caching Results<a class="headerlink" href="#lab03-mcp-tools-lab-caching-results" title="Permanent link">&para;</a></h3>
<p><strong>Caching results</strong> stores expensive operation results to avoid redundant computation. Use time-based expiration and proper cache keys for efficient reuse of results.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#lab03-mcp-tools-lab-__codelineno-36-1"></a><span class="kd">class</span><span class="w"> </span><span class="nx">CachedMCPServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#lab03-mcp-tools-lab-__codelineno-36-2"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cache</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span><span class="w"> </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#lab03-mcp-tools-lab-__codelineno-36-3"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cacheTTL</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">60000</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1 minute</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#lab03-mcp-tools-lab-__codelineno-36-4"></a>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#lab03-mcp-tools-lab-__codelineno-36-5"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#lab03-mcp-tools-lab-__codelineno-36-6"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#lab03-mcp-tools-lab-__codelineno-36-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#lab03-mcp-tools-lab-__codelineno-36-8"></a>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#lab03-mcp-tools-lab-__codelineno-36-9"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getCacheKey</span><span class="p">(</span><span class="nx">toolName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#lab03-mcp-tools-lab-__codelineno-36-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">toolName</span><span class="si">}</span><span class="sb">:</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#lab03-mcp-tools-lab-__codelineno-36-11"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#lab03-mcp-tools-lab-__codelineno-36-12"></a>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#lab03-mcp-tools-lab-__codelineno-36-13"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getCached</span><span class="p">(</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#lab03-mcp-tools-lab-__codelineno-36-14"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cached</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#lab03-mcp-tools-lab-__codelineno-36-15"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">cached</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#lab03-mcp-tools-lab-__codelineno-36-16"></a>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#lab03-mcp-tools-lab-__codelineno-36-17"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">cached</span><span class="p">.</span><span class="nx">timestamp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cacheTTL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#lab03-mcp-tools-lab-__codelineno-36-18"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span><span id="__span-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#lab03-mcp-tools-lab-__codelineno-36-19"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-36-20"><a id="__codelineno-36-20" name="__codelineno-36-20" href="#lab03-mcp-tools-lab-__codelineno-36-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-36-21"><a id="__codelineno-36-21" name="__codelineno-36-21" href="#lab03-mcp-tools-lab-__codelineno-36-21"></a>
</span><span id="__span-36-22"><a id="__codelineno-36-22" name="__codelineno-36-22" href="#lab03-mcp-tools-lab-__codelineno-36-22"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">cached</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
</span><span id="__span-36-23"><a id="__codelineno-36-23" name="__codelineno-36-23" href="#lab03-mcp-tools-lab-__codelineno-36-23"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-36-24"><a id="__codelineno-36-24" name="__codelineno-36-24" href="#lab03-mcp-tools-lab-__codelineno-36-24"></a>
</span><span id="__span-36-25"><a id="__codelineno-36-25" name="__codelineno-36-25" href="#lab03-mcp-tools-lab-__codelineno-36-25"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setCache</span><span class="p">(</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-26"><a id="__codelineno-36-26" name="__codelineno-36-26" href="#lab03-mcp-tools-lab-__codelineno-36-26"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-27"><a id="__codelineno-36-27" name="__codelineno-36-27" href="#lab03-mcp-tools-lab-__codelineno-36-27"></a><span class="w">      </span><span class="nx">data</span><span class="p">,</span>
</span><span id="__span-36-28"><a id="__codelineno-36-28" name="__codelineno-36-28" href="#lab03-mcp-tools-lab-__codelineno-36-28"></a><span class="w">      </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">()</span>
</span><span id="__span-36-29"><a id="__codelineno-36-29" name="__codelineno-36-29" href="#lab03-mcp-tools-lab-__codelineno-36-29"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-36-30"><a id="__codelineno-36-30" name="__codelineno-36-30" href="#lab03-mcp-tools-lab-__codelineno-36-30"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-36-31"><a id="__codelineno-36-31" name="__codelineno-36-31" href="#lab03-mcp-tools-lab-__codelineno-36-31"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For expensive operations that return consistent results:</p>
<ul>
<li>API calls to external services</li>
<li>Complex calculations or data processing</li>
<li>Database queries with static data</li>
<li>File analysis that doesn&rsquo;t change frequently</li>
</ul>
<p><strong>Why it matters:</strong> Dramatically improves response times, reduces resource usage, and provides better user experience for repeated requests.</p>
<h4 id="lab03-mcp-tools-lab-best-practices-for-async-operations-and-performance"><strong>Best Practices for Async Operations and Performance:</strong><a class="headerlink" href="#lab03-mcp-tools-lab-best-practices-for-async-operations-and-performance" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Monitor Execution Time:</strong> Log start/end times for operations over 1 second</li>
<li><strong>Set Reasonable Timeouts:</strong> Use appropriate timeouts for external calls (5-30 seconds)</li>
<li><strong>Cache Strategically:</strong> Cache expensive operations but consider data freshness</li>
<li><strong>Use Streaming:</strong> For very large responses, consider streaming or pagination</li>
<li><strong>Resource Cleanup:</strong> Always clean up connections, file handles, and memory</li>
<li><strong>Progress Feedback:</strong> For long operations, provide progress updates via logging</li>
<li><strong>Memory Management:</strong> Be mindful of memory usage in long-running processes</li>
</ul>
<hr />
<h2 id="lab03-mcp-tools-lab-tool-composition">Tool Composition<a class="headerlink" href="#lab03-mcp-tools-lab-tool-composition" title="Permanent link">&para;</a></h2>
<p><strong>Tool composition</strong> is the art of designing MCP tools that work seamlessly together, allowing LLMs to chain multiple tools to accomplish complex tasks. Well-composed tools create a powerful ecosystem where each tool handles a specific responsibility while enabling sophisticated workflows through intelligent combination.</p>
<h3 id="lab03-mcp-tools-lab-example-multi-step-analysis">Example: Multi-Step Analysis<a class="headerlink" href="#lab03-mcp-tools-lab-example-multi-step-analysis" title="Permanent link">&para;</a></h3>
<p><strong>Multi-step analysis</strong> demonstrates how simple, focused tools can be combined to perform complex data processing workflows. Each tool has a clear responsibility and can be used independently or as part of larger operations.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#lab03-mcp-tools-lab-__codelineno-37-1"></a><span class="c1">// Tool 1: List files</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#lab03-mcp-tools-lab-__codelineno-37-2"></a><span class="p">{</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#lab03-mcp-tools-lab-__codelineno-37-3"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;list_files&quot;</span><span class="p">,</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#lab03-mcp-tools-lab-__codelineno-37-4"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;List files in a directory&quot;</span><span class="p">,</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#lab03-mcp-tools-lab-__codelineno-37-5"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#lab03-mcp-tools-lab-__codelineno-37-6"></a><span class="p">}</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#lab03-mcp-tools-lab-__codelineno-37-7"></a>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#lab03-mcp-tools-lab-__codelineno-37-8"></a><span class="c1">// Tool 2: Read file</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#lab03-mcp-tools-lab-__codelineno-37-9"></a><span class="p">{</span>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#lab03-mcp-tools-lab-__codelineno-37-10"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;read_file&quot;</span><span class="p">,</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#lab03-mcp-tools-lab-__codelineno-37-11"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Read a specific file&quot;</span><span class="p">,</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#lab03-mcp-tools-lab-__codelineno-37-12"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#lab03-mcp-tools-lab-__codelineno-37-13"></a><span class="p">}</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#lab03-mcp-tools-lab-__codelineno-37-14"></a>
</span><span id="__span-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#lab03-mcp-tools-lab-__codelineno-37-15"></a><span class="c1">// Tool 3: Analyze content</span>
</span><span id="__span-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#lab03-mcp-tools-lab-__codelineno-37-16"></a><span class="p">{</span>
</span><span id="__span-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#lab03-mcp-tools-lab-__codelineno-37-17"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;analyze_text&quot;</span><span class="p">,</span>
</span><span id="__span-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#lab03-mcp-tools-lab-__codelineno-37-18"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analyze text content&quot;</span><span class="p">,</span>
</span><span id="__span-37-19"><a id="__codelineno-37-19" name="__codelineno-37-19" href="#lab03-mcp-tools-lab-__codelineno-37-19"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-37-20"><a id="__codelineno-37-20" name="__codelineno-37-20" href="#lab03-mcp-tools-lab-__codelineno-37-20"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For workflows that require multiple processing steps:</p>
<ul>
<li>Data analysis pipelines</li>
<li>File processing workflows</li>
<li>Multi-stage computations</li>
<li>Complex research tasks</li>
</ul>
<p><strong>Why it matters:</strong> Breaks down complex problems into manageable, reusable components that can be combined in flexible ways.</p>
<h3 id="lab03-mcp-tools-lab-llm-tool-chaining">LLM Tool Chaining<a class="headerlink" href="#lab03-mcp-tools-lab-llm-tool-chaining" title="Permanent link">&para;</a></h3>
<p><strong>LLM tool chaining</strong> allows AI models to automatically sequence tool calls based on intermediate results. The LLM analyzes outputs from one tool and determines which tool to call next, creating intelligent workflows without explicit programming.</p>
<p>The LLM can chain these tools:</p>
<ol>
<li><strong>List files in directory</strong> - Discover available files</li>
<li><strong>Read interesting files</strong> - Access content based on filenames</li>
<li><strong>Analyze their content</strong> - Process and extract insights</li>
</ol>
<p><strong>When to use -</strong> When tasks naturally break down into sequential steps:</p>
<ul>
<li>Research and analysis workflows</li>
<li>Data processing pipelines</li>
<li>Content generation chains</li>
<li>Problem-solving sequences</li>
</ul>
<p><strong>Why it matters:</strong> Enables complex, multi-step reasoning and problem-solving that would be difficult to implement in single tools.</p>
<h3 id="lab03-mcp-tools-lab-testing-composed-tools">Testing Composed Tools<a class="headerlink" href="#lab03-mcp-tools-lab-testing-composed-tools" title="Permanent link">&para;</a></h3>
<p><strong>Testing composed tools</strong> ensures that individual tools work correctly both in isolation and when chained together. Use comprehensive test suites that cover single-tool usage and multi-tool workflows.</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#lab03-mcp-tools-lab-__codelineno-38-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">describe</span><span class="p">,</span><span class="w"> </span><span class="nx">it</span><span class="p">,</span><span class="w"> </span><span class="nx">expect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;vitest&#39;</span><span class="p">;</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#lab03-mcp-tools-lab-__codelineno-38-2"></a>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#lab03-mcp-tools-lab-__codelineno-38-3"></a><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;Weather Tool&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#lab03-mcp-tools-lab-__codelineno-38-4"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should validate city name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#lab03-mcp-tools-lab-__codelineno-38-5"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">expect</span><span class="p">(</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#lab03-mcp-tools-lab-__codelineno-38-6"></a><span class="w">      </span><span class="nx">callTool</span><span class="p">(</span><span class="s1">&#39;get_weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="p">})</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#lab03-mcp-tools-lab-__codelineno-38-7"></a><span class="w">    </span><span class="p">).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="s1">&#39;City name cannot be empty&#39;</span><span class="p">);</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#lab03-mcp-tools-lab-__codelineno-38-8"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#lab03-mcp-tools-lab-__codelineno-38-9"></a>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#lab03-mcp-tools-lab-__codelineno-38-10"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should handle invalid city&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#lab03-mcp-tools-lab-__codelineno-38-11"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">expect</span><span class="p">(</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#lab03-mcp-tools-lab-__codelineno-38-12"></a><span class="w">      </span><span class="nx">callTool</span><span class="p">(</span><span class="s1">&#39;get_weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;InvalidCity12345&#39;</span><span class="w"> </span><span class="p">})</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#lab03-mcp-tools-lab-__codelineno-38-13"></a><span class="w">    </span><span class="p">).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="s1">&#39;not found&#39;</span><span class="p">);</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#lab03-mcp-tools-lab-__codelineno-38-14"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#lab03-mcp-tools-lab-__codelineno-38-15"></a>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#lab03-mcp-tools-lab-__codelineno-38-16"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return weather data&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#lab03-mcp-tools-lab-__codelineno-38-17"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">callTool</span><span class="p">(</span><span class="s1">&#39;get_weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18" href="#lab03-mcp-tools-lab-__codelineno-38-18"></a><span class="w">      </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;London&#39;</span><span class="p">,</span>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19" href="#lab03-mcp-tools-lab-__codelineno-38-19"></a><span class="w">      </span><span class="nx">units</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;celsius&#39;</span>
</span><span id="__span-38-20"><a id="__codelineno-38-20" name="__codelineno-38-20" href="#lab03-mcp-tools-lab-__codelineno-38-20"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-38-21"><a id="__codelineno-38-21" name="__codelineno-38-21" href="#lab03-mcp-tools-lab-__codelineno-38-21"></a>
</span><span id="__span-38-22"><a id="__codelineno-38-22" name="__codelineno-38-22" href="#lab03-mcp-tools-lab-__codelineno-38-22"></a><span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">content</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-38-23"><a id="__codelineno-38-23" name="__codelineno-38-23" href="#lab03-mcp-tools-lab-__codelineno-38-23"></a><span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">content</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">text</span><span class="p">).</span><span class="nx">toContain</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">);</span>
</span><span id="__span-38-24"><a id="__codelineno-38-24" name="__codelineno-38-24" href="#lab03-mcp-tools-lab-__codelineno-38-24"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-38-25"><a id="__codelineno-38-25" name="__codelineno-38-25" href="#lab03-mcp-tools-lab-__codelineno-38-25"></a><span class="p">});</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For validating tool behavior in different scenarios:</p>
<ul>
<li>Unit testing individual tools</li>
<li>Integration testing tool chains</li>
<li>Regression testing after changes</li>
<li>Edge case validation</li>
</ul>
<p><strong>Why it matters:</strong> Ensures reliability and predictability when tools are used individually or in combination.</p>
<h4 id="lab03-mcp-tools-lab-best-practices-for-tool-composition"><strong>Best Practices for Tool Composition:</strong><a class="headerlink" href="#lab03-mcp-tools-lab-best-practices-for-tool-composition" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Single Responsibility:</strong> Each tool should do one thing well</li>
<li><strong>Consistent Interfaces:</strong> Use similar parameter patterns across tools</li>
<li><strong>Clear Dependencies:</strong> Document which tools work well together</li>
<li><strong>Error Propagation:</strong> Handle failures gracefully in tool chains</li>
<li><strong>State Management:</strong> Avoid tools that require complex state between calls</li>
<li><strong>Flexible Outputs:</strong> Design tool outputs to be usable as inputs for other tools</li>
<li><strong>Documentation:</strong> Clearly explain how tools can be combined</li>
<li><strong>Version Compatibility:</strong> Ensure tool interfaces remain stable</li>
</ul>
<hr />
<h2 id="lab03-mcp-tools-lab-best-practices-checklist">Best Practices Checklist<a class="headerlink" href="#lab03-mcp-tools-lab-best-practices-checklist" title="Permanent link">&para;</a></h2>
<p>✅ <strong>Schema Design</strong></p>
<ul>
<li>Use descriptive names and descriptions</li>
<li>Add examples in descriptions</li>
<li>Set reasonable defaults</li>
<li>Use enums for constrained values</li>
<li>Add min/max for numbers</li>
</ul>
<p>✅ <strong>Implementation</strong></p>
<ul>
<li>Validate all inputs, even with schemas</li>
<li>Handle errors gracefully</li>
<li>Log to stderr, not stdout</li>
<li>Use async/await properly</li>
<li>Clean up resources (file handles, connections)</li>
</ul>
<p>✅ <strong>Security</strong></p>
<ul>
<li>Validate and sanitize file paths</li>
<li>Use prepared statements for SQL</li>
<li>Limit resource usage (file sizes, API calls)</li>
<li>Don&rsquo;t expose sensitive data in errors</li>
<li>Implement rate limiting</li>
</ul>
<p>✅ <strong>Performance</strong></p>
<ul>
<li>Cache expensive operations</li>
<li>Set reasonable timeouts</li>
<li>Limit result sizes</li>
<li>Use streaming for large data</li>
<li>Monitor execution time</li>
</ul>
<p>✅ <strong>User Experience</strong></p>
<ul>
<li>Provide clear error messages</li>
<li>Return structured data when possible</li>
<li>Include relevant context in responses</li>
<li>Handle edge cases gracefully</li>
<li>Document expected behavior</li>
</ul>
<hr />
<h2 id="lab03-mcp-tools-lab-hands-on-exercises">Hands-On Exercises<a class="headerlink" href="#lab03-mcp-tools-lab-hands-on-exercises" title="Permanent link">&para;</a></h2>
<h3 id="lab03-mcp-tools-lab-exercise-1-text-processing-tool">Exercise 1: Text Processing Tool<a class="headerlink" href="#lab03-mcp-tools-lab-exercise-1-text-processing-tool" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Counts words, characters, lines</li>
<li>Finds specific patterns</li>
<li>Calculates reading time</li>
<li>Detects language</li>
</ul>
<details>
<summary>💡 Solution: Text Processing Tool</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#lab03-mcp-tools-lab-__codelineno-39-1"></a><span class="p">{</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#lab03-mcp-tools-lab-__codelineno-39-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;process_text&quot;</span><span class="p">,</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#lab03-mcp-tools-lab-__codelineno-39-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analyze and process text content with various metrics and operations&quot;</span><span class="p">,</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#lab03-mcp-tools-lab-__codelineno-39-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#lab03-mcp-tools-lab-__codelineno-39-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#lab03-mcp-tools-lab-__codelineno-39-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#lab03-mcp-tools-lab-__codelineno-39-7"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#lab03-mcp-tools-lab-__codelineno-39-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#lab03-mcp-tools-lab-__codelineno-39-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The text content to process&quot;</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#lab03-mcp-tools-lab-__codelineno-39-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#lab03-mcp-tools-lab-__codelineno-39-11"></a><span class="w">      </span><span class="nx">operations</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#lab03-mcp-tools-lab-__codelineno-39-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#lab03-mcp-tools-lab-__codelineno-39-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Operations to perform&quot;</span><span class="p">,</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#lab03-mcp-tools-lab-__codelineno-39-14"></a><span class="w">        </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#lab03-mcp-tools-lab-__codelineno-39-15"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#lab03-mcp-tools-lab-__codelineno-39-16"></a><span class="w">          </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;find_pattern&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;reading_time&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;detect_language&quot;</span><span class="p">]</span>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#lab03-mcp-tools-lab-__codelineno-39-17"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18" href="#lab03-mcp-tools-lab-__codelineno-39-18"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span>
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19" href="#lab03-mcp-tools-lab-__codelineno-39-19"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20" href="#lab03-mcp-tools-lab-__codelineno-39-20"></a><span class="w">      </span><span class="nx">pattern</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-21"><a id="__codelineno-39-21" name="__codelineno-39-21" href="#lab03-mcp-tools-lab-__codelineno-39-21"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-39-22"><a id="__codelineno-39-22" name="__codelineno-39-22" href="#lab03-mcp-tools-lab-__codelineno-39-22"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Regex pattern for find_pattern operation&quot;</span>
</span><span id="__span-39-23"><a id="__codelineno-39-23" name="__codelineno-39-23" href="#lab03-mcp-tools-lab-__codelineno-39-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-39-24"><a id="__codelineno-39-24" name="__codelineno-39-24" href="#lab03-mcp-tools-lab-__codelineno-39-24"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-39-25"><a id="__codelineno-39-25" name="__codelineno-39-25" href="#lab03-mcp-tools-lab-__codelineno-39-25"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-39-26"><a id="__codelineno-39-26" name="__codelineno-39-26" href="#lab03-mcp-tools-lab-__codelineno-39-26"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-39-27"><a id="__codelineno-39-27" name="__codelineno-39-27" href="#lab03-mcp-tools-lab-__codelineno-39-27"></a><span class="p">}</span>
</span></code></pre></div>

Implementation - Add this handler in your "CallToolRequestSchema" handler:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#lab03-mcp-tools-lab-__codelineno-40-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;process_text&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#lab03-mcp-tools-lab-__codelineno-40-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#lab03-mcp-tools-lab-__codelineno-40-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">text</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#lab03-mcp-tools-lab-__codelineno-40-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">operations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">operations</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">[])</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">];</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#lab03-mcp-tools-lab-__codelineno-40-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">pattern</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#lab03-mcp-tools-lab-__codelineno-40-6"></a>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#lab03-mcp-tools-lab-__codelineno-40-7"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">results</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#lab03-mcp-tools-lab-__codelineno-40-8"></a>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#lab03-mcp-tools-lab-__codelineno-40-9"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">op</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">operations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#lab03-mcp-tools-lab-__codelineno-40-10"></a><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">op</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#lab03-mcp-tools-lab-__codelineno-40-11"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;count&quot;</span><span class="o">:</span>
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#lab03-mcp-tools-lab-__codelineno-40-12"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#lab03-mcp-tools-lab-__codelineno-40-13"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">w</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#lab03-mcp-tools-lab-__codelineno-40-14"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">chars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#lab03-mcp-tools-lab-__codelineno-40-15"></a><span class="w">          </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`📊 Text Statistics:\n- Lines: </span><span class="si">${</span><span class="nx">lines</span><span class="si">}</span><span class="sb">\n- Words: </span><span class="si">${</span><span class="nx">words</span><span class="si">}</span><span class="sb">\n- Characters: </span><span class="si">${</span><span class="nx">chars</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-40-16"><a id="__codelineno-40-16" name="__codelineno-40-16" href="#lab03-mcp-tools-lab-__codelineno-40-16"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-40-17"><a id="__codelineno-40-17" name="__codelineno-40-17" href="#lab03-mcp-tools-lab-__codelineno-40-17"></a>
</span><span id="__span-40-18"><a id="__codelineno-40-18" name="__codelineno-40-18" href="#lab03-mcp-tools-lab-__codelineno-40-18"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;find_pattern&quot;</span><span class="o">:</span>
</span><span id="__span-40-19"><a id="__codelineno-40-19" name="__codelineno-40-19" href="#lab03-mcp-tools-lab-__codelineno-40-19"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">pattern</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-20"><a id="__codelineno-40-20" name="__codelineno-40-20" href="#lab03-mcp-tools-lab-__codelineno-40-20"></a><span class="w">            </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;❌ Pattern required for find_pattern operation&quot;</span><span class="p">);</span>
</span><span id="__span-40-21"><a id="__codelineno-40-21" name="__codelineno-40-21" href="#lab03-mcp-tools-lab-__codelineno-40-21"></a><span class="w">            </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-40-22"><a id="__codelineno-40-22" name="__codelineno-40-22" href="#lab03-mcp-tools-lab-__codelineno-40-22"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-40-23"><a id="__codelineno-40-23" name="__codelineno-40-23" href="#lab03-mcp-tools-lab-__codelineno-40-23"></a><span class="w">          </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-24"><a id="__codelineno-40-24" name="__codelineno-40-24" href="#lab03-mcp-tools-lab-__codelineno-40-24"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">RegExp</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;g&#39;</span><span class="p">);</span>
</span><span id="__span-40-25"><a id="__codelineno-40-25" name="__codelineno-40-25" href="#lab03-mcp-tools-lab-__codelineno-40-25"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">regex</span><span class="p">);</span>
</span><span id="__span-40-26"><a id="__codelineno-40-26" name="__codelineno-40-26" href="#lab03-mcp-tools-lab-__codelineno-40-26"></a><span class="w">            </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`🔍 Pattern Matches (</span><span class="si">${</span><span class="nx">pattern</span><span class="si">}</span><span class="sb">):\nFound </span><span class="si">${</span><span class="nx">matches</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">matches.length</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">0</span><span class="si">}</span><span class="sb"> matches:\n</span><span class="si">${</span><span class="nx">matches</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">matches</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-40-27"><a id="__codelineno-40-27" name="__codelineno-40-27" href="#lab03-mcp-tools-lab-__codelineno-40-27"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-28"><a id="__codelineno-40-28" name="__codelineno-40-28" href="#lab03-mcp-tools-lab-__codelineno-40-28"></a><span class="w">            </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`❌ Invalid regex pattern: </span><span class="si">${</span><span class="nx">pattern</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-40-29"><a id="__codelineno-40-29" name="__codelineno-40-29" href="#lab03-mcp-tools-lab-__codelineno-40-29"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-40-30"><a id="__codelineno-40-30" name="__codelineno-40-30" href="#lab03-mcp-tools-lab-__codelineno-40-30"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-40-31"><a id="__codelineno-40-31" name="__codelineno-40-31" href="#lab03-mcp-tools-lab-__codelineno-40-31"></a>
</span><span id="__span-40-32"><a id="__codelineno-40-32" name="__codelineno-40-32" href="#lab03-mcp-tools-lab-__codelineno-40-32"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;reading_time&quot;</span><span class="o">:</span>
</span><span id="__span-40-33"><a id="__codelineno-40-33" name="__codelineno-40-33" href="#lab03-mcp-tools-lab-__codelineno-40-33"></a><span class="w">          </span><span class="c1">// Average reading speed: 200 words per minute</span>
</span><span id="__span-40-34"><a id="__codelineno-40-34" name="__codelineno-40-34" href="#lab03-mcp-tools-lab-__codelineno-40-34"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">wordCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">w</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-40-35"><a id="__codelineno-40-35" name="__codelineno-40-35" href="#lab03-mcp-tools-lab-__codelineno-40-35"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">readingTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">wordCount</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">200</span><span class="p">);</span>
</span><span id="__span-40-36"><a id="__codelineno-40-36" name="__codelineno-40-36" href="#lab03-mcp-tools-lab-__codelineno-40-36"></a><span class="w">          </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`⏱️ Reading Time: Approximately </span><span class="si">${</span><span class="nx">readingTime</span><span class="si">}</span><span class="sb"> minute</span><span class="si">${</span><span class="nx">readingTime</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;s&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="sb"> (</span><span class="si">${</span><span class="nx">wordCount</span><span class="si">}</span><span class="sb"> words at 200 WPM)`</span><span class="p">);</span>
</span><span id="__span-40-37"><a id="__codelineno-40-37" name="__codelineno-40-37" href="#lab03-mcp-tools-lab-__codelineno-40-37"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-40-38"><a id="__codelineno-40-38" name="__codelineno-40-38" href="#lab03-mcp-tools-lab-__codelineno-40-38"></a>
</span><span id="__span-40-39"><a id="__codelineno-40-39" name="__codelineno-40-39" href="#lab03-mcp-tools-lab-__codelineno-40-39"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;detect_language&quot;</span><span class="o">:</span>
</span><span id="__span-40-40"><a id="__codelineno-40-40" name="__codelineno-40-40" href="#lab03-mcp-tools-lab-__codelineno-40-40"></a><span class="w">          </span><span class="c1">// Simple language detection based on common words</span>
</span><span id="__span-40-41"><a id="__codelineno-40-41" name="__codelineno-40-41" href="#lab03-mcp-tools-lab-__codelineno-40-41"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">englishWords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/\b(the|and|or|but|in|on|at|to|for|of|with|by)\b/gi</span><span class="p">;</span>
</span><span id="__span-40-42"><a id="__codelineno-40-42" name="__codelineno-40-42" href="#lab03-mcp-tools-lab-__codelineno-40-42"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">spanishWords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/\b(el|la|los|las|y|o|pero|en|sobre|a|para|de|con|por)\b/gi</span><span class="p">;</span>
</span><span id="__span-40-43"><a id="__codelineno-40-43" name="__codelineno-40-43" href="#lab03-mcp-tools-lab-__codelineno-40-43"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">frenchWords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/\b(le|la|les|et|ou|mais|dans|sur|à|pour|de|avec|par)\b/gi</span><span class="p">;</span>
</span><span id="__span-40-44"><a id="__codelineno-40-44" name="__codelineno-40-44" href="#lab03-mcp-tools-lab-__codelineno-40-44"></a>
</span><span id="__span-40-45"><a id="__codelineno-40-45" name="__codelineno-40-45" href="#lab03-mcp-tools-lab-__codelineno-40-45"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">englishMatches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">englishWords</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[]).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-40-46"><a id="__codelineno-40-46" name="__codelineno-40-46" href="#lab03-mcp-tools-lab-__codelineno-40-46"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">spanishMatches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">spanishWords</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[]).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-40-47"><a id="__codelineno-40-47" name="__codelineno-40-47" href="#lab03-mcp-tools-lab-__codelineno-40-47"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">frenchMatches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">frenchWords</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[]).</span><span class="nx">length</span><span class="p">;</span>
</span><span id="__span-40-48"><a id="__codelineno-40-48" name="__codelineno-40-48" href="#lab03-mcp-tools-lab-__codelineno-40-48"></a>
</span><span id="__span-40-49"><a id="__codelineno-40-49" name="__codelineno-40-49" href="#lab03-mcp-tools-lab-__codelineno-40-49"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxMatches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">englishMatches</span><span class="p">,</span><span class="w"> </span><span class="nx">spanishMatches</span><span class="p">,</span><span class="w"> </span><span class="nx">frenchMatches</span><span class="p">);</span>
</span><span id="__span-40-50"><a id="__codelineno-40-50" name="__codelineno-40-50" href="#lab03-mcp-tools-lab-__codelineno-40-50"></a><span class="w">          </span><span class="kd">let</span><span class="w"> </span><span class="nx">detectedLang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Unknown&quot;</span><span class="p">;</span>
</span><span id="__span-40-51"><a id="__codelineno-40-51" name="__codelineno-40-51" href="#lab03-mcp-tools-lab-__codelineno-40-51"></a>
</span><span id="__span-40-52"><a id="__codelineno-40-52" name="__codelineno-40-52" href="#lab03-mcp-tools-lab-__codelineno-40-52"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">maxMatches</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-53"><a id="__codelineno-40-53" name="__codelineno-40-53" href="#lab03-mcp-tools-lab-__codelineno-40-53"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">englishMatches</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">maxMatches</span><span class="p">)</span><span class="w"> </span><span class="nx">detectedLang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;English&quot;</span><span class="p">;</span>
</span><span id="__span-40-54"><a id="__codelineno-40-54" name="__codelineno-40-54" href="#lab03-mcp-tools-lab-__codelineno-40-54"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">spanishMatches</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">maxMatches</span><span class="p">)</span><span class="w"> </span><span class="nx">detectedLang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Spanish&quot;</span><span class="p">;</span>
</span><span id="__span-40-55"><a id="__codelineno-40-55" name="__codelineno-40-55" href="#lab03-mcp-tools-lab-__codelineno-40-55"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">frenchMatches</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">maxMatches</span><span class="p">)</span><span class="w"> </span><span class="nx">detectedLang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;French&quot;</span><span class="p">;</span>
</span><span id="__span-40-56"><a id="__codelineno-40-56" name="__codelineno-40-56" href="#lab03-mcp-tools-lab-__codelineno-40-56"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-40-57"><a id="__codelineno-40-57" name="__codelineno-40-57" href="#lab03-mcp-tools-lab-__codelineno-40-57"></a>
</span><span id="__span-40-58"><a id="__codelineno-40-58" name="__codelineno-40-58" href="#lab03-mcp-tools-lab-__codelineno-40-58"></a><span class="w">          </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`🌍 Detected Language: </span><span class="si">${</span><span class="nx">detectedLang</span><span class="si">}</span><span class="sb"> (confidence: </span><span class="si">${</span><span class="nx">maxMatches</span><span class="si">}</span><span class="sb"> common words)`</span><span class="p">);</span>
</span><span id="__span-40-59"><a id="__codelineno-40-59" name="__codelineno-40-59" href="#lab03-mcp-tools-lab-__codelineno-40-59"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-40-60"><a id="__codelineno-40-60" name="__codelineno-40-60" href="#lab03-mcp-tools-lab-__codelineno-40-60"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-40-61"><a id="__codelineno-40-61" name="__codelineno-40-61" href="#lab03-mcp-tools-lab-__codelineno-40-61"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-40-62"><a id="__codelineno-40-62" name="__codelineno-40-62" href="#lab03-mcp-tools-lab-__codelineno-40-62"></a>
</span><span id="__span-40-63"><a id="__codelineno-40-63" name="__codelineno-40-63" href="#lab03-mcp-tools-lab-__codelineno-40-63"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-64"><a id="__codelineno-40-64" name="__codelineno-40-64" href="#lab03-mcp-tools-lab-__codelineno-40-64"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-40-65"><a id="__codelineno-40-65" name="__codelineno-40-65" href="#lab03-mcp-tools-lab-__codelineno-40-65"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-40-66"><a id="__codelineno-40-66" name="__codelineno-40-66" href="#lab03-mcp-tools-lab-__codelineno-40-66"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-40-67"><a id="__codelineno-40-67" name="__codelineno-40-67" href="#lab03-mcp-tools-lab-__codelineno-40-67"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">results.join</span><span class="p">(</span><span class="s1">&#39;\n\n&#39;</span><span class="p">)</span>
</span><span id="__span-40-68"><a id="__codelineno-40-68" name="__codelineno-40-68" href="#lab03-mcp-tools-lab-__codelineno-40-68"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-40-69"><a id="__codelineno-40-69" name="__codelineno-40-69" href="#lab03-mcp-tools-lab-__codelineno-40-69"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-40-70"><a id="__codelineno-40-70" name="__codelineno-40-70" href="#lab03-mcp-tools-lab-__codelineno-40-70"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-40-71"><a id="__codelineno-40-71" name="__codelineno-40-71" href="#lab03-mcp-tools-lab-__codelineno-40-71"></a>
</span><span id="__span-40-72"><a id="__codelineno-40-72" name="__codelineno-40-72" href="#lab03-mcp-tools-lab-__codelineno-40-72"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-73"><a id="__codelineno-40-73" name="__codelineno-40-73" href="#lab03-mcp-tools-lab-__codelineno-40-73"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Text processing failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-40-74"><a id="__codelineno-40-74" name="__codelineno-40-74" href="#lab03-mcp-tools-lab-__codelineno-40-74"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-40-75"><a id="__codelineno-40-75" name="__codelineno-40-75" href="#lab03-mcp-tools-lab-__codelineno-40-75"></a><span class="p">}</span>
</span></code></pre></div>

Testing - Test with different inputs:

<div class="language-javascript highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#lab03-mcp-tools-lab-__codelineno-41-1"></a><span class="c1">// Basic counting</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#lab03-mcp-tools-lab-__codelineno-41-2"></a><span class="p">{</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Hello world\nThis is a test&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">operations</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#lab03-mcp-tools-lab-__codelineno-41-3"></a>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#lab03-mcp-tools-lab-__codelineno-41-4"></a><span class="c1">// Pattern matching</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#lab03-mcp-tools-lab-__codelineno-41-5"></a><span class="p">{</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;The quick brown fox jumps over the lazy dog&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">operations</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;find_pattern&quot;</span><span class="p">],</span><span class="w"> </span><span class="nx">pattern</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;\\b\\w{4}\\b&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#lab03-mcp-tools-lab-__codelineno-41-6"></a>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#lab03-mcp-tools-lab-__codelineno-41-7"></a><span class="c1">// Multiple operations</span>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#lab03-mcp-tools-lab-__codelineno-41-8"></a><span class="p">{</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;This is a longer piece of text to analyze for various metrics and patterns.&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">operations</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;reading_time&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;detect_language&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>

</details>

<h3 id="lab03-mcp-tools-lab-exercise-2-json-validator-tool">Exercise 2: JSON Validator Tool<a class="headerlink" href="#lab03-mcp-tools-lab-exercise-2-json-validator-tool" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Validates JSON syntax</li>
<li>Validates against JSON Schema</li>
<li>Formats/pretty-prints JSON</li>
<li>Compares two JSON objects</li>
</ul>
<details>
<summary>💡 Solution: JSON Validator Tool</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#lab03-mcp-tools-lab-__codelineno-42-1"></a><span class="p">{</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#lab03-mcp-tools-lab-__codelineno-42-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;validate_json&quot;</span><span class="p">,</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#lab03-mcp-tools-lab-__codelineno-42-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Validate, format, and compare JSON data&quot;</span><span class="p">,</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#lab03-mcp-tools-lab-__codelineno-42-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#lab03-mcp-tools-lab-__codelineno-42-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#lab03-mcp-tools-lab-__codelineno-42-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#lab03-mcp-tools-lab-__codelineno-42-7"></a><span class="w">      </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#lab03-mcp-tools-lab-__codelineno-42-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#lab03-mcp-tools-lab-__codelineno-42-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;JSON string to validate or format&quot;</span>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#lab03-mcp-tools-lab-__codelineno-42-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#lab03-mcp-tools-lab-__codelineno-42-11"></a><span class="w">      </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#lab03-mcp-tools-lab-__codelineno-42-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#lab03-mcp-tools-lab-__codelineno-42-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Operation to perform&quot;</span><span class="p">,</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#lab03-mcp-tools-lab-__codelineno-42-14"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;validate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;format&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;schema_validate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;compare&quot;</span><span class="p">],</span>
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#lab03-mcp-tools-lab-__codelineno-42-15"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;validate&quot;</span>
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16" href="#lab03-mcp-tools-lab-__codelineno-42-16"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17" href="#lab03-mcp-tools-lab-__codelineno-42-17"></a><span class="w">      </span><span class="nx">schema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18" href="#lab03-mcp-tools-lab-__codelineno-42-18"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19" href="#lab03-mcp-tools-lab-__codelineno-42-19"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;JSON Schema for schema validation (as JSON string)&quot;</span>
</span><span id="__span-42-20"><a id="__codelineno-42-20" name="__codelineno-42-20" href="#lab03-mcp-tools-lab-__codelineno-42-20"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-42-21"><a id="__codelineno-42-21" name="__codelineno-42-21" href="#lab03-mcp-tools-lab-__codelineno-42-21"></a><span class="w">      </span><span class="nx">json2</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-22"><a id="__codelineno-42-22" name="__codelineno-42-22" href="#lab03-mcp-tools-lab-__codelineno-42-22"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-42-23"><a id="__codelineno-42-23" name="__codelineno-42-23" href="#lab03-mcp-tools-lab-__codelineno-42-23"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Second JSON string for comparison&quot;</span>
</span><span id="__span-42-24"><a id="__codelineno-42-24" name="__codelineno-42-24" href="#lab03-mcp-tools-lab-__codelineno-42-24"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-42-25"><a id="__codelineno-42-25" name="__codelineno-42-25" href="#lab03-mcp-tools-lab-__codelineno-42-25"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-42-26"><a id="__codelineno-42-26" name="__codelineno-42-26" href="#lab03-mcp-tools-lab-__codelineno-42-26"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;operation&quot;</span><span class="p">]</span>
</span><span id="__span-42-27"><a id="__codelineno-42-27" name="__codelineno-42-27" href="#lab03-mcp-tools-lab-__codelineno-42-27"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-42-28"><a id="__codelineno-42-28" name="__codelineno-42-28" href="#lab03-mcp-tools-lab-__codelineno-42-28"></a><span class="p">}</span>
</span></code></pre></div>

Implementation - First, install the required dependency:

<div class="language-bash highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#lab03-mcp-tools-lab-__codelineno-43-1"></a>npm<span class="w"> </span>install<span class="w"> </span>ajv
</span></code></pre></div>

Add the import:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#lab03-mcp-tools-lab-__codelineno-44-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">Ajv</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;ajv&#39;</span><span class="p">;</span>
</span></code></pre></div>

Add this handler in your "CallToolRequestSchema" handler:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#lab03-mcp-tools-lab-__codelineno-45-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;validate_json&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#lab03-mcp-tools-lab-__codelineno-45-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#lab03-mcp-tools-lab-__codelineno-45-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">json</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#lab03-mcp-tools-lab-__codelineno-45-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">operation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">operation</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#lab03-mcp-tools-lab-__codelineno-45-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">schema</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#lab03-mcp-tools-lab-__codelineno-45-6"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">json2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">json2</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#lab03-mcp-tools-lab-__codelineno-45-7"></a>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#lab03-mcp-tools-lab-__codelineno-45-8"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#lab03-mcp-tools-lab-__codelineno-45-9"></a>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#lab03-mcp-tools-lab-__codelineno-45-10"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">operation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#lab03-mcp-tools-lab-__codelineno-45-11"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;validate&quot;</span><span class="o">:</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#lab03-mcp-tools-lab-__codelineno-45-12"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#lab03-mcp-tools-lab-__codelineno-45-13"></a><span class="w">          </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#lab03-mcp-tools-lab-__codelineno-45-14"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;✅ Valid JSON syntax&quot;</span><span class="p">;</span>
</span><span id="__span-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15" href="#lab03-mcp-tools-lab-__codelineno-45-15"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16" href="#lab03-mcp-tools-lab-__codelineno-45-16"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Invalid JSON: </span><span class="si">${</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-45-17"><a id="__codelineno-45-17" name="__codelineno-45-17" href="#lab03-mcp-tools-lab-__codelineno-45-17"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-18"><a id="__codelineno-45-18" name="__codelineno-45-18" href="#lab03-mcp-tools-lab-__codelineno-45-18"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-45-19"><a id="__codelineno-45-19" name="__codelineno-45-19" href="#lab03-mcp-tools-lab-__codelineno-45-19"></a>
</span><span id="__span-45-20"><a id="__codelineno-45-20" name="__codelineno-45-20" href="#lab03-mcp-tools-lab-__codelineno-45-20"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;format&quot;</span><span class="o">:</span>
</span><span id="__span-45-21"><a id="__codelineno-45-21" name="__codelineno-45-21" href="#lab03-mcp-tools-lab-__codelineno-45-21"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-22"><a id="__codelineno-45-22" name="__codelineno-45-22" href="#lab03-mcp-tools-lab-__codelineno-45-22"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">parsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</span><span id="__span-45-23"><a id="__codelineno-45-23" name="__codelineno-45-23" href="#lab03-mcp-tools-lab-__codelineno-45-23"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`📄 Formatted JSON:\n\`\`\`json\n</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">parsed</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">\n\`\`\``</span><span class="p">;</span>
</span><span id="__span-45-24"><a id="__codelineno-45-24" name="__codelineno-45-24" href="#lab03-mcp-tools-lab-__codelineno-45-24"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-25"><a id="__codelineno-45-25" name="__codelineno-45-25" href="#lab03-mcp-tools-lab-__codelineno-45-25"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Cannot format invalid JSON: </span><span class="si">${</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-45-26"><a id="__codelineno-45-26" name="__codelineno-45-26" href="#lab03-mcp-tools-lab-__codelineno-45-26"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-27"><a id="__codelineno-45-27" name="__codelineno-45-27" href="#lab03-mcp-tools-lab-__codelineno-45-27"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-45-28"><a id="__codelineno-45-28" name="__codelineno-45-28" href="#lab03-mcp-tools-lab-__codelineno-45-28"></a>
</span><span id="__span-45-29"><a id="__codelineno-45-29" name="__codelineno-45-29" href="#lab03-mcp-tools-lab-__codelineno-45-29"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;schema_validate&quot;</span><span class="o">:</span>
</span><span id="__span-45-30"><a id="__codelineno-45-30" name="__codelineno-45-30" href="#lab03-mcp-tools-lab-__codelineno-45-30"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">schema</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-31"><a id="__codelineno-45-31" name="__codelineno-45-31" href="#lab03-mcp-tools-lab-__codelineno-45-31"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;❌ Schema required for schema validation&quot;</span><span class="p">;</span>
</span><span id="__span-45-32"><a id="__codelineno-45-32" name="__codelineno-45-32" href="#lab03-mcp-tools-lab-__codelineno-45-32"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-45-33"><a id="__codelineno-45-33" name="__codelineno-45-33" href="#lab03-mcp-tools-lab-__codelineno-45-33"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-34"><a id="__codelineno-45-34" name="__codelineno-45-34" href="#lab03-mcp-tools-lab-__codelineno-45-34"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-35"><a id="__codelineno-45-35" name="__codelineno-45-35" href="#lab03-mcp-tools-lab-__codelineno-45-35"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">ajv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Ajv</span><span class="p">();</span>
</span><span id="__span-45-36"><a id="__codelineno-45-36" name="__codelineno-45-36" href="#lab03-mcp-tools-lab-__codelineno-45-36"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">parsedJson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</span><span id="__span-45-37"><a id="__codelineno-45-37" name="__codelineno-45-37" href="#lab03-mcp-tools-lab-__codelineno-45-37"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">parsedSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">schema</span><span class="p">);</span>
</span><span id="__span-45-38"><a id="__codelineno-45-38" name="__codelineno-45-38" href="#lab03-mcp-tools-lab-__codelineno-45-38"></a>
</span><span id="__span-45-39"><a id="__codelineno-45-39" name="__codelineno-45-39" href="#lab03-mcp-tools-lab-__codelineno-45-39"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">validate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ajv</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">parsedSchema</span><span class="p">);</span>
</span><span id="__span-45-40"><a id="__codelineno-45-40" name="__codelineno-45-40" href="#lab03-mcp-tools-lab-__codelineno-45-40"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">validate</span><span class="p">(</span><span class="nx">parsedJson</span><span class="p">);</span>
</span><span id="__span-45-41"><a id="__codelineno-45-41" name="__codelineno-45-41" href="#lab03-mcp-tools-lab-__codelineno-45-41"></a>
</span><span id="__span-45-42"><a id="__codelineno-45-42" name="__codelineno-45-42" href="#lab03-mcp-tools-lab-__codelineno-45-42"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">valid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-43"><a id="__codelineno-45-43" name="__codelineno-45-43" href="#lab03-mcp-tools-lab-__codelineno-45-43"></a><span class="w">            </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;✅ JSON validates against schema&quot;</span><span class="p">;</span>
</span><span id="__span-45-44"><a id="__codelineno-45-44" name="__codelineno-45-44" href="#lab03-mcp-tools-lab-__codelineno-45-44"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-45"><a id="__codelineno-45-45" name="__codelineno-45-45" href="#lab03-mcp-tools-lab-__codelineno-45-45"></a><span class="w">            </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Schema validation failed:\n</span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">validate</span><span class="p">.</span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-45-46"><a id="__codelineno-45-46" name="__codelineno-45-46" href="#lab03-mcp-tools-lab-__codelineno-45-46"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-45-47"><a id="__codelineno-45-47" name="__codelineno-45-47" href="#lab03-mcp-tools-lab-__codelineno-45-47"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-48"><a id="__codelineno-45-48" name="__codelineno-45-48" href="#lab03-mcp-tools-lab-__codelineno-45-48"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Schema validation error: </span><span class="si">${</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-45-49"><a id="__codelineno-45-49" name="__codelineno-45-49" href="#lab03-mcp-tools-lab-__codelineno-45-49"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-50"><a id="__codelineno-45-50" name="__codelineno-45-50" href="#lab03-mcp-tools-lab-__codelineno-45-50"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-45-51"><a id="__codelineno-45-51" name="__codelineno-45-51" href="#lab03-mcp-tools-lab-__codelineno-45-51"></a>
</span><span id="__span-45-52"><a id="__codelineno-45-52" name="__codelineno-45-52" href="#lab03-mcp-tools-lab-__codelineno-45-52"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;compare&quot;</span><span class="o">:</span>
</span><span id="__span-45-53"><a id="__codelineno-45-53" name="__codelineno-45-53" href="#lab03-mcp-tools-lab-__codelineno-45-53"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">json2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-54"><a id="__codelineno-45-54" name="__codelineno-45-54" href="#lab03-mcp-tools-lab-__codelineno-45-54"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;❌ Second JSON required for comparison&quot;</span><span class="p">;</span>
</span><span id="__span-45-55"><a id="__codelineno-45-55" name="__codelineno-45-55" href="#lab03-mcp-tools-lab-__codelineno-45-55"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-45-56"><a id="__codelineno-45-56" name="__codelineno-45-56" href="#lab03-mcp-tools-lab-__codelineno-45-56"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-57"><a id="__codelineno-45-57" name="__codelineno-45-57" href="#lab03-mcp-tools-lab-__codelineno-45-57"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-58"><a id="__codelineno-45-58" name="__codelineno-45-58" href="#lab03-mcp-tools-lab-__codelineno-45-58"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</span><span id="__span-45-59"><a id="__codelineno-45-59" name="__codelineno-45-59" href="#lab03-mcp-tools-lab-__codelineno-45-59"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">obj2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json2</span><span class="p">);</span>
</span><span id="__span-45-60"><a id="__codelineno-45-60" name="__codelineno-45-60" href="#lab03-mcp-tools-lab-__codelineno-45-60"></a>
</span><span id="__span-45-61"><a id="__codelineno-45-61" name="__codelineno-45-61" href="#lab03-mcp-tools-lab-__codelineno-45-61"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">differences</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-45-62"><a id="__codelineno-45-62" name="__codelineno-45-62" href="#lab03-mcp-tools-lab-__codelineno-45-62"></a>
</span><span id="__span-45-63"><a id="__codelineno-45-63" name="__codelineno-45-63" href="#lab03-mcp-tools-lab-__codelineno-45-63"></a><span class="w">          </span><span class="c1">// Simple comparison - check if objects are equal</span>
</span><span id="__span-45-64"><a id="__codelineno-45-64" name="__codelineno-45-64" href="#lab03-mcp-tools-lab-__codelineno-45-64"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj1</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj2</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-65"><a id="__codelineno-45-65" name="__codelineno-45-65" href="#lab03-mcp-tools-lab-__codelineno-45-65"></a><span class="w">            </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;✅ JSON objects are identical&quot;</span><span class="p">;</span>
</span><span id="__span-45-66"><a id="__codelineno-45-66" name="__codelineno-45-66" href="#lab03-mcp-tools-lab-__codelineno-45-66"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-67"><a id="__codelineno-45-67" name="__codelineno-45-67" href="#lab03-mcp-tools-lab-__codelineno-45-67"></a><span class="w">            </span><span class="c1">// Find differences</span>
</span><span id="__span-45-68"><a id="__codelineno-45-68" name="__codelineno-45-68" href="#lab03-mcp-tools-lab-__codelineno-45-68"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">keys1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj1</span><span class="p">);</span>
</span><span id="__span-45-69"><a id="__codelineno-45-69" name="__codelineno-45-69" href="#lab03-mcp-tools-lab-__codelineno-45-69"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">keys2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj2</span><span class="p">);</span>
</span><span id="__span-45-70"><a id="__codelineno-45-70" name="__codelineno-45-70" href="#lab03-mcp-tools-lab-__codelineno-45-70"></a>
</span><span id="__span-45-71"><a id="__codelineno-45-71" name="__codelineno-45-71" href="#lab03-mcp-tools-lab-__codelineno-45-71"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">added</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">keys2</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">k</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">!</span><span class="nx">keys1</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">k</span><span class="p">));</span>
</span><span id="__span-45-72"><a id="__codelineno-45-72" name="__codelineno-45-72" href="#lab03-mcp-tools-lab-__codelineno-45-72"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">removed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">keys1</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">k</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">!</span><span class="nx">keys2</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">k</span><span class="p">));</span>
</span><span id="__span-45-73"><a id="__codelineno-45-73" name="__codelineno-45-73" href="#lab03-mcp-tools-lab-__codelineno-45-73"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">keys1</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">k</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">keys2</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj1</span><span class="p">[</span><span class="nx">k</span><span class="p">])</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj2</span><span class="p">[</span><span class="nx">k</span><span class="p">]));</span>
</span><span id="__span-45-74"><a id="__codelineno-45-74" name="__codelineno-45-74" href="#lab03-mcp-tools-lab-__codelineno-45-74"></a>
</span><span id="__span-45-75"><a id="__codelineno-45-75" name="__codelineno-45-75" href="#lab03-mcp-tools-lab-__codelineno-45-75"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">added</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">differences</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`Added keys: </span><span class="si">${</span><span class="nx">added</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-45-76"><a id="__codelineno-45-76" name="__codelineno-45-76" href="#lab03-mcp-tools-lab-__codelineno-45-76"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">removed</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">differences</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`Removed keys: </span><span class="si">${</span><span class="nx">removed</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-45-77"><a id="__codelineno-45-77" name="__codelineno-45-77" href="#lab03-mcp-tools-lab-__codelineno-45-77"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">modified</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">differences</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`Modified keys: </span><span class="si">${</span><span class="nx">modified</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-45-78"><a id="__codelineno-45-78" name="__codelineno-45-78" href="#lab03-mcp-tools-lab-__codelineno-45-78"></a>
</span><span id="__span-45-79"><a id="__codelineno-45-79" name="__codelineno-45-79" href="#lab03-mcp-tools-lab-__codelineno-45-79"></a><span class="w">            </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`⚠️ JSON objects differ:\n</span><span class="si">${</span><span class="nx">differences</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-45-80"><a id="__codelineno-45-80" name="__codelineno-45-80" href="#lab03-mcp-tools-lab-__codelineno-45-80"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-45-81"><a id="__codelineno-45-81" name="__codelineno-45-81" href="#lab03-mcp-tools-lab-__codelineno-45-81"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-82"><a id="__codelineno-45-82" name="__codelineno-45-82" href="#lab03-mcp-tools-lab-__codelineno-45-82"></a><span class="w">          </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`❌ Comparison error: </span><span class="si">${</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-45-83"><a id="__codelineno-45-83" name="__codelineno-45-83" href="#lab03-mcp-tools-lab-__codelineno-45-83"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-84"><a id="__codelineno-45-84" name="__codelineno-45-84" href="#lab03-mcp-tools-lab-__codelineno-45-84"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-45-85"><a id="__codelineno-45-85" name="__codelineno-45-85" href="#lab03-mcp-tools-lab-__codelineno-45-85"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-45-86"><a id="__codelineno-45-86" name="__codelineno-45-86" href="#lab03-mcp-tools-lab-__codelineno-45-86"></a>
</span><span id="__span-45-87"><a id="__codelineno-45-87" name="__codelineno-45-87" href="#lab03-mcp-tools-lab-__codelineno-45-87"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-88"><a id="__codelineno-45-88" name="__codelineno-45-88" href="#lab03-mcp-tools-lab-__codelineno-45-88"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-45-89"><a id="__codelineno-45-89" name="__codelineno-45-89" href="#lab03-mcp-tools-lab-__codelineno-45-89"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-45-90"><a id="__codelineno-45-90" name="__codelineno-45-90" href="#lab03-mcp-tools-lab-__codelineno-45-90"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-45-91"><a id="__codelineno-45-91" name="__codelineno-45-91" href="#lab03-mcp-tools-lab-__codelineno-45-91"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">result</span>
</span><span id="__span-45-92"><a id="__codelineno-45-92" name="__codelineno-45-92" href="#lab03-mcp-tools-lab-__codelineno-45-92"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-93"><a id="__codelineno-45-93" name="__codelineno-45-93" href="#lab03-mcp-tools-lab-__codelineno-45-93"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-45-94"><a id="__codelineno-45-94" name="__codelineno-45-94" href="#lab03-mcp-tools-lab-__codelineno-45-94"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-45-95"><a id="__codelineno-45-95" name="__codelineno-45-95" href="#lab03-mcp-tools-lab-__codelineno-45-95"></a>
</span><span id="__span-45-96"><a id="__codelineno-45-96" name="__codelineno-45-96" href="#lab03-mcp-tools-lab-__codelineno-45-96"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-97"><a id="__codelineno-45-97" name="__codelineno-45-97" href="#lab03-mcp-tools-lab-__codelineno-45-97"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`JSON validation failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-45-98"><a id="__codelineno-45-98" name="__codelineno-45-98" href="#lab03-mcp-tools-lab-__codelineno-45-98"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-45-99"><a id="__codelineno-45-99" name="__codelineno-45-99" href="#lab03-mcp-tools-lab-__codelineno-45-99"></a><span class="p">}</span>
</span></code></pre></div>

Testing - Test different operations:

<div class="language-javascript highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#lab03-mcp-tools-lab-__codelineno-46-1"></a><span class="c1">// Validate syntax</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#lab03-mcp-tools-lab-__codelineno-46-2"></a><span class="p">{</span><span class="w"> </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;test&quot;, &quot;value&quot;: 123}&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;validate&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#lab03-mcp-tools-lab-__codelineno-46-3"></a>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#lab03-mcp-tools-lab-__codelineno-46-4"></a><span class="c1">// Format JSON</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#lab03-mcp-tools-lab-__codelineno-46-5"></a><span class="p">{</span><span class="w"> </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;:&quot;test&quot;,&quot;value&quot;:123}&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;format&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#lab03-mcp-tools-lab-__codelineno-46-6"></a>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#lab03-mcp-tools-lab-__codelineno-46-7"></a><span class="c1">// Schema validation</span>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#lab03-mcp-tools-lab-__codelineno-46-8"></a><span class="p">{</span><span class="w"> </span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#lab03-mcp-tools-lab-__codelineno-46-9"></a><span class="w">  </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;John&quot;, &quot;age&quot;: 30}&#39;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#lab03-mcp-tools-lab-__codelineno-46-10"></a><span class="w">  </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;schema_validate&quot;</span><span class="p">,</span>
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#lab03-mcp-tools-lab-__codelineno-46-11"></a><span class="w">  </span><span class="nx">schema</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;type&quot;: &quot;object&quot;, &quot;properties&quot;: {&quot;name&quot;: {&quot;type&quot;: &quot;string&quot;}, &quot;age&quot;: {&quot;type&quot;: &quot;number&quot;}}}&#39;</span>
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#lab03-mcp-tools-lab-__codelineno-46-12"></a><span class="p">}</span>
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#lab03-mcp-tools-lab-__codelineno-46-13"></a>
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14" href="#lab03-mcp-tools-lab-__codelineno-46-14"></a><span class="c1">// Compare JSON</span>
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15" href="#lab03-mcp-tools-lab-__codelineno-46-15"></a><span class="p">{</span>
</span><span id="__span-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16" href="#lab03-mcp-tools-lab-__codelineno-46-16"></a><span class="w">  </span><span class="nx">json</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;a&quot;: 1, &quot;b&quot;: 2}&#39;</span><span class="p">,</span>
</span><span id="__span-46-17"><a id="__codelineno-46-17" name="__codelineno-46-17" href="#lab03-mcp-tools-lab-__codelineno-46-17"></a><span class="w">  </span><span class="nx">json2</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&quot;a&quot;: 1, &quot;c&quot;: 3}&#39;</span><span class="p">,</span>
</span><span id="__span-46-18"><a id="__codelineno-46-18" name="__codelineno-46-18" href="#lab03-mcp-tools-lab-__codelineno-46-18"></a><span class="w">  </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;compare&quot;</span>
</span><span id="__span-46-19"><a id="__codelineno-46-19" name="__codelineno-46-19" href="#lab03-mcp-tools-lab-__codelineno-46-19"></a><span class="p">}</span>
</span></code></pre></div>

</details>

<h3 id="lab03-mcp-tools-lab-exercise-3-web-scraper-tool">Exercise 3: Web Scraper Tool<a class="headerlink" href="#lab03-mcp-tools-lab-exercise-3-web-scraper-tool" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Fetches web page content</li>
<li>Extracts specific elements</li>
<li>Returns clean text</li>
<li>Handles errors gracefully</li>
</ul>
<details>
<summary>💡 Solution: Web Scraper Tool</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#lab03-mcp-tools-lab-__codelineno-47-1"></a><span class="p">{</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#lab03-mcp-tools-lab-__codelineno-47-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;scrape_web&quot;</span><span class="p">,</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#lab03-mcp-tools-lab-__codelineno-47-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Fetch and extract content from web pages&quot;</span><span class="p">,</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#lab03-mcp-tools-lab-__codelineno-47-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#lab03-mcp-tools-lab-__codelineno-47-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#lab03-mcp-tools-lab-__codelineno-47-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#lab03-mcp-tools-lab-__codelineno-47-7"></a><span class="w">      </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#lab03-mcp-tools-lab-__codelineno-47-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#lab03-mcp-tools-lab-__codelineno-47-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;URL to scrape&quot;</span><span class="p">,</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#lab03-mcp-tools-lab-__codelineno-47-10"></a><span class="w">        </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;uri&quot;</span>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#lab03-mcp-tools-lab-__codelineno-47-11"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#lab03-mcp-tools-lab-__codelineno-47-12"></a><span class="w">      </span><span class="nx">selector</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="#lab03-mcp-tools-lab-__codelineno-47-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="#lab03-mcp-tools-lab-__codelineno-47-14"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;CSS selector to extract specific elements (optional)&quot;</span><span class="p">,</span>
</span><span id="__span-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15" href="#lab03-mcp-tools-lab-__codelineno-47-15"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;body&quot;</span>
</span><span id="__span-47-16"><a id="__codelineno-47-16" name="__codelineno-47-16" href="#lab03-mcp-tools-lab-__codelineno-47-16"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-47-17"><a id="__codelineno-47-17" name="__codelineno-47-17" href="#lab03-mcp-tools-lab-__codelineno-47-17"></a><span class="w">      </span><span class="nx">includeText</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-18"><a id="__codelineno-47-18" name="__codelineno-47-18" href="#lab03-mcp-tools-lab-__codelineno-47-18"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
</span><span id="__span-47-19"><a id="__codelineno-47-19" name="__codelineno-47-19" href="#lab03-mcp-tools-lab-__codelineno-47-19"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Extract only text content (remove HTML)&quot;</span><span class="p">,</span>
</span><span id="__span-47-20"><a id="__codelineno-47-20" name="__codelineno-47-20" href="#lab03-mcp-tools-lab-__codelineno-47-20"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span>
</span><span id="__span-47-21"><a id="__codelineno-47-21" name="__codelineno-47-21" href="#lab03-mcp-tools-lab-__codelineno-47-21"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-47-22"><a id="__codelineno-47-22" name="__codelineno-47-22" href="#lab03-mcp-tools-lab-__codelineno-47-22"></a><span class="w">      </span><span class="nx">maxLength</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-23"><a id="__codelineno-47-23" name="__codelineno-47-23" href="#lab03-mcp-tools-lab-__codelineno-47-23"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-47-24"><a id="__codelineno-47-24" name="__codelineno-47-24" href="#lab03-mcp-tools-lab-__codelineno-47-24"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum length of extracted content&quot;</span><span class="p">,</span>
</span><span id="__span-47-25"><a id="__codelineno-47-25" name="__codelineno-47-25" href="#lab03-mcp-tools-lab-__codelineno-47-25"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span>
</span><span id="__span-47-26"><a id="__codelineno-47-26" name="__codelineno-47-26" href="#lab03-mcp-tools-lab-__codelineno-47-26"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">10000</span><span class="p">,</span>
</span><span id="__span-47-27"><a id="__codelineno-47-27" name="__codelineno-47-27" href="#lab03-mcp-tools-lab-__codelineno-47-27"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">2000</span>
</span><span id="__span-47-28"><a id="__codelineno-47-28" name="__codelineno-47-28" href="#lab03-mcp-tools-lab-__codelineno-47-28"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-47-29"><a id="__codelineno-47-29" name="__codelineno-47-29" href="#lab03-mcp-tools-lab-__codelineno-47-29"></a><span class="w">      </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-30"><a id="__codelineno-47-30" name="__codelineno-47-30" href="#lab03-mcp-tools-lab-__codelineno-47-30"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-47-31"><a id="__codelineno-47-31" name="__codelineno-47-31" href="#lab03-mcp-tools-lab-__codelineno-47-31"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Request timeout in milliseconds&quot;</span><span class="p">,</span>
</span><span id="__span-47-32"><a id="__codelineno-47-32" name="__codelineno-47-32" href="#lab03-mcp-tools-lab-__codelineno-47-32"></a><span class="w">        </span><span class="nx">minimum</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="p">,</span>
</span><span id="__span-47-33"><a id="__codelineno-47-33" name="__codelineno-47-33" href="#lab03-mcp-tools-lab-__codelineno-47-33"></a><span class="w">        </span><span class="nx">maximum</span><span class="o">:</span><span class="w"> </span><span class="kt">30000</span><span class="p">,</span>
</span><span id="__span-47-34"><a id="__codelineno-47-34" name="__codelineno-47-34" href="#lab03-mcp-tools-lab-__codelineno-47-34"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">10000</span>
</span><span id="__span-47-35"><a id="__codelineno-47-35" name="__codelineno-47-35" href="#lab03-mcp-tools-lab-__codelineno-47-35"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-47-36"><a id="__codelineno-47-36" name="__codelineno-47-36" href="#lab03-mcp-tools-lab-__codelineno-47-36"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-47-37"><a id="__codelineno-47-37" name="__codelineno-47-37" href="#lab03-mcp-tools-lab-__codelineno-47-37"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
</span><span id="__span-47-38"><a id="__codelineno-47-38" name="__codelineno-47-38" href="#lab03-mcp-tools-lab-__codelineno-47-38"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-47-39"><a id="__codelineno-47-39" name="__codelineno-47-39" href="#lab03-mcp-tools-lab-__codelineno-47-39"></a><span class="p">}</span>
</span></code></pre></div>

Implementation - First, install the required dependencies:

<div class="language-bash highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#lab03-mcp-tools-lab-__codelineno-48-1"></a>npm<span class="w"> </span>install<span class="w"> </span>axios<span class="w"> </span>cheerio
</span></code></pre></div>

Add the imports:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#lab03-mcp-tools-lab-__codelineno-49-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">axios</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;axios&#39;</span><span class="p">;</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#lab03-mcp-tools-lab-__codelineno-49-2"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">cheerio</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;cheerio&#39;</span><span class="p">;</span>
</span></code></pre></div>

Add this handler in your `CallToolRequestSchema` handler:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#lab03-mcp-tools-lab-__codelineno-50-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;scrape_web&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#lab03-mcp-tools-lab-__codelineno-50-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#lab03-mcp-tools-lab-__codelineno-50-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">url</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#lab03-mcp-tools-lab-__codelineno-50-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">selector</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;body&quot;</span><span class="p">;</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#lab03-mcp-tools-lab-__codelineno-50-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">includeText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">includeText</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w"> </span><span class="c1">// default true</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#lab03-mcp-tools-lab-__codelineno-50-6"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">maxLength</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">2000</span><span class="p">;</span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#lab03-mcp-tools-lab-__codelineno-50-7"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">timeout</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">10000</span><span class="p">;</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#lab03-mcp-tools-lab-__codelineno-50-8"></a>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#lab03-mcp-tools-lab-__codelineno-50-9"></a><span class="w">    </span><span class="c1">// Validate URL</span>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#lab03-mcp-tools-lab-__codelineno-50-10"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#lab03-mcp-tools-lab-__codelineno-50-11"></a><span class="w">      </span><span class="ow">new</span><span class="w"> </span><span class="nx">URL</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#lab03-mcp-tools-lab-__codelineno-50-12"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#lab03-mcp-tools-lab-__codelineno-50-13"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Invalid URL format&quot;</span><span class="p">);</span>
</span><span id="__span-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#lab03-mcp-tools-lab-__codelineno-50-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15" href="#lab03-mcp-tools-lab-__codelineno-50-15"></a>
</span><span id="__span-50-16"><a id="__codelineno-50-16" name="__codelineno-50-16" href="#lab03-mcp-tools-lab-__codelineno-50-16"></a><span class="w">    </span><span class="c1">// Fetch the webpage</span>
</span><span id="__span-50-17"><a id="__codelineno-50-17" name="__codelineno-50-17" href="#lab03-mcp-tools-lab-__codelineno-50-17"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-18"><a id="__codelineno-50-18" name="__codelineno-50-18" href="#lab03-mcp-tools-lab-__codelineno-50-18"></a><span class="w">      </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="kt">timeout</span><span class="p">,</span>
</span><span id="__span-50-19"><a id="__codelineno-50-19" name="__codelineno-50-19" href="#lab03-mcp-tools-lab-__codelineno-50-19"></a><span class="w">      </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-20"><a id="__codelineno-50-20" name="__codelineno-50-20" href="#lab03-mcp-tools-lab-__codelineno-50-20"></a><span class="w">        </span><span class="s1">&#39;User-Agent&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MCP-Web-Scraper/1.0 (Educational Tool)&#39;</span>
</span><span id="__span-50-21"><a id="__codelineno-50-21" name="__codelineno-50-21" href="#lab03-mcp-tools-lab-__codelineno-50-21"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-50-22"><a id="__codelineno-50-22" name="__codelineno-50-22" href="#lab03-mcp-tools-lab-__codelineno-50-22"></a><span class="w">      </span><span class="nx">maxContentLength</span><span class="o">:</span><span class="w"> </span><span class="kt">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1024</span><span class="p">,</span><span class="w"> </span><span class="c1">// 5MB limit</span>
</span><span id="__span-50-23"><a id="__codelineno-50-23" name="__codelineno-50-23" href="#lab03-mcp-tools-lab-__codelineno-50-23"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-50-24"><a id="__codelineno-50-24" name="__codelineno-50-24" href="#lab03-mcp-tools-lab-__codelineno-50-24"></a>
</span><span id="__span-50-25"><a id="__codelineno-50-25" name="__codelineno-50-25" href="#lab03-mcp-tools-lab-__codelineno-50-25"></a><span class="w">    </span><span class="c1">// Load HTML into cheerio</span>
</span><span id="__span-50-26"><a id="__codelineno-50-26" name="__codelineno-50-26" href="#lab03-mcp-tools-lab-__codelineno-50-26"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">$</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cheerio</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-50-27"><a id="__codelineno-50-27" name="__codelineno-50-27" href="#lab03-mcp-tools-lab-__codelineno-50-27"></a>
</span><span id="__span-50-28"><a id="__codelineno-50-28" name="__codelineno-50-28" href="#lab03-mcp-tools-lab-__codelineno-50-28"></a><span class="w">    </span><span class="c1">// Extract content based on selector</span>
</span><span id="__span-50-29"><a id="__codelineno-50-29" name="__codelineno-50-29" href="#lab03-mcp-tools-lab-__codelineno-50-29"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="__span-50-30"><a id="__codelineno-50-30" name="__codelineno-50-30" href="#lab03-mcp-tools-lab-__codelineno-50-30"></a>
</span><span id="__span-50-31"><a id="__codelineno-50-31" name="__codelineno-50-31" href="#lab03-mcp-tools-lab-__codelineno-50-31"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selector</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;body&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-32"><a id="__codelineno-50-32" name="__codelineno-50-32" href="#lab03-mcp-tools-lab-__codelineno-50-32"></a><span class="w">      </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">includeText</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="__span-50-33"><a id="__codelineno-50-33" name="__codelineno-50-33" href="#lab03-mcp-tools-lab-__codelineno-50-33"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-34"><a id="__codelineno-50-34" name="__codelineno-50-34" href="#lab03-mcp-tools-lab-__codelineno-50-34"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
</span><span id="__span-50-35"><a id="__codelineno-50-35" name="__codelineno-50-35" href="#lab03-mcp-tools-lab-__codelineno-50-35"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-36"><a id="__codelineno-50-36" name="__codelineno-50-36" href="#lab03-mcp-tools-lab-__codelineno-50-36"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`No elements found matching selector: </span><span class="si">${</span><span class="nx">selector</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-50-37"><a id="__codelineno-50-37" name="__codelineno-50-37" href="#lab03-mcp-tools-lab-__codelineno-50-37"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-50-38"><a id="__codelineno-50-38" name="__codelineno-50-38" href="#lab03-mcp-tools-lab-__codelineno-50-38"></a>
</span><span id="__span-50-39"><a id="__codelineno-50-39" name="__codelineno-50-39" href="#lab03-mcp-tools-lab-__codelineno-50-39"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">includeText</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-40"><a id="__codelineno-50-40" name="__codelineno-50-40" href="#lab03-mcp-tools-lab-__codelineno-50-40"></a><span class="w">        </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">elements</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">el</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">get</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n\n&#39;</span><span class="p">);</span>
</span><span id="__span-50-41"><a id="__codelineno-50-41" name="__codelineno-50-41" href="#lab03-mcp-tools-lab-__codelineno-50-41"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-42"><a id="__codelineno-50-42" name="__codelineno-50-42" href="#lab03-mcp-tools-lab-__codelineno-50-42"></a><span class="w">        </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">elements</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">el</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">$</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">el</span><span class="p">)).</span><span class="nx">get</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n\n&#39;</span><span class="p">);</span>
</span><span id="__span-50-43"><a id="__codelineno-50-43" name="__codelineno-50-43" href="#lab03-mcp-tools-lab-__codelineno-50-43"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-50-44"><a id="__codelineno-50-44" name="__codelineno-50-44" href="#lab03-mcp-tools-lab-__codelineno-50-44"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-45"><a id="__codelineno-50-45" name="__codelineno-50-45" href="#lab03-mcp-tools-lab-__codelineno-50-45"></a>
</span><span id="__span-50-46"><a id="__codelineno-50-46" name="__codelineno-50-46" href="#lab03-mcp-tools-lab-__codelineno-50-46"></a><span class="w">    </span><span class="c1">// Clean up the content</span>
</span><span id="__span-50-47"><a id="__codelineno-50-47" name="__codelineno-50-47" href="#lab03-mcp-tools-lab-__codelineno-50-47"></a><span class="w">    </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">extractedContent</span>
</span><span id="__span-50-48"><a id="__codelineno-50-48" name="__codelineno-50-48" href="#lab03-mcp-tools-lab-__codelineno-50-48"></a><span class="w">      </span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s+/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Replace multiple whitespace with single space</span>
</span><span id="__span-50-49"><a id="__codelineno-50-49" name="__codelineno-50-49" href="#lab03-mcp-tools-lab-__codelineno-50-49"></a><span class="w">      </span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n\s*\n/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Remove empty lines</span>
</span><span id="__span-50-50"><a id="__codelineno-50-50" name="__codelineno-50-50" href="#lab03-mcp-tools-lab-__codelineno-50-50"></a><span class="w">      </span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
</span><span id="__span-50-51"><a id="__codelineno-50-51" name="__codelineno-50-51" href="#lab03-mcp-tools-lab-__codelineno-50-51"></a>
</span><span id="__span-50-52"><a id="__codelineno-50-52" name="__codelineno-50-52" href="#lab03-mcp-tools-lab-__codelineno-50-52"></a><span class="w">    </span><span class="c1">// Truncate if too long</span>
</span><span id="__span-50-53"><a id="__codelineno-50-53" name="__codelineno-50-53" href="#lab03-mcp-tools-lab-__codelineno-50-53"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">extractedContent</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">maxLength</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-54"><a id="__codelineno-50-54" name="__codelineno-50-54" href="#lab03-mcp-tools-lab-__codelineno-50-54"></a><span class="w">      </span><span class="nx">extractedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">extractedContent</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">maxLength</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">;</span>
</span><span id="__span-50-55"><a id="__codelineno-50-55" name="__codelineno-50-55" href="#lab03-mcp-tools-lab-__codelineno-50-55"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-56"><a id="__codelineno-50-56" name="__codelineno-50-56" href="#lab03-mcp-tools-lab-__codelineno-50-56"></a>
</span><span id="__span-50-57"><a id="__codelineno-50-57" name="__codelineno-50-57" href="#lab03-mcp-tools-lab-__codelineno-50-57"></a><span class="w">    </span><span class="c1">// Prepare metadata</span>
</span><span id="__span-50-58"><a id="__codelineno-50-58" name="__codelineno-50-58" href="#lab03-mcp-tools-lab-__codelineno-50-58"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-59"><a id="__codelineno-50-59" name="__codelineno-50-59" href="#lab03-mcp-tools-lab-__codelineno-50-59"></a><span class="w">      </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="kt">url</span><span class="p">,</span>
</span><span id="__span-50-60"><a id="__codelineno-50-60" name="__codelineno-50-60" href="#lab03-mcp-tools-lab-__codelineno-50-60"></a><span class="w">      </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="kt">response.status</span><span class="p">,</span>
</span><span id="__span-50-61"><a id="__codelineno-50-61" name="__codelineno-50-61" href="#lab03-mcp-tools-lab-__codelineno-50-61"></a><span class="w">      </span><span class="nx">contentType</span><span class="o">:</span><span class="w"> </span><span class="kt">response.headers</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">],</span>
</span><span id="__span-50-62"><a id="__codelineno-50-62" name="__codelineno-50-62" href="#lab03-mcp-tools-lab-__codelineno-50-62"></a><span class="w">      </span><span class="nx">contentLength</span><span class="o">:</span><span class="w"> </span><span class="kt">response.data.length</span><span class="p">,</span>
</span><span id="__span-50-63"><a id="__codelineno-50-63" name="__codelineno-50-63" href="#lab03-mcp-tools-lab-__codelineno-50-63"></a><span class="w">      </span><span class="nx">extractedLength</span><span class="o">:</span><span class="w"> </span><span class="kt">extractedContent.length</span><span class="p">,</span>
</span><span id="__span-50-64"><a id="__codelineno-50-64" name="__codelineno-50-64" href="#lab03-mcp-tools-lab-__codelineno-50-64"></a><span class="w">      </span><span class="nx">selector</span><span class="o">:</span><span class="w"> </span><span class="kt">selector</span><span class="p">,</span>
</span><span id="__span-50-65"><a id="__codelineno-50-65" name="__codelineno-50-65" href="#lab03-mcp-tools-lab-__codelineno-50-65"></a><span class="w">      </span><span class="nx">elementsFound</span><span class="o">:</span><span class="w"> </span><span class="kt">selector</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;body&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">length</span>
</span><span id="__span-50-66"><a id="__codelineno-50-66" name="__codelineno-50-66" href="#lab03-mcp-tools-lab-__codelineno-50-66"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-50-67"><a id="__codelineno-50-67" name="__codelineno-50-67" href="#lab03-mcp-tools-lab-__codelineno-50-67"></a>
</span><span id="__span-50-68"><a id="__codelineno-50-68" name="__codelineno-50-68" href="#lab03-mcp-tools-lab-__codelineno-50-68"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-69"><a id="__codelineno-50-69" name="__codelineno-50-69" href="#lab03-mcp-tools-lab-__codelineno-50-69"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-50-70"><a id="__codelineno-50-70" name="__codelineno-50-70" href="#lab03-mcp-tools-lab-__codelineno-50-70"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-50-71"><a id="__codelineno-50-71" name="__codelineno-50-71" href="#lab03-mcp-tools-lab-__codelineno-50-71"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-50-72"><a id="__codelineno-50-72" name="__codelineno-50-72" href="#lab03-mcp-tools-lab-__codelineno-50-72"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`🌐 Web Scraping Results\n\n📊 Metadata:\n</span><span class="si">${</span><span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">metadata</span><span class="p">).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">k</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="sb">`- </span><span class="si">${</span><span class="nx">k</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">v</span><span class="si">}</span><span class="sb">`</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">\n\n📄 Extracted Content:\n</span><span class="si">${</span><span class="nx">extractedContent</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-50-73"><a id="__codelineno-50-73" name="__codelineno-50-73" href="#lab03-mcp-tools-lab-__codelineno-50-73"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-50-74"><a id="__codelineno-50-74" name="__codelineno-50-74" href="#lab03-mcp-tools-lab-__codelineno-50-74"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-50-75"><a id="__codelineno-50-75" name="__codelineno-50-75" href="#lab03-mcp-tools-lab-__codelineno-50-75"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-50-76"><a id="__codelineno-50-76" name="__codelineno-50-76" href="#lab03-mcp-tools-lab-__codelineno-50-76"></a>
</span><span id="__span-50-77"><a id="__codelineno-50-77" name="__codelineno-50-77" href="#lab03-mcp-tools-lab-__codelineno-50-77"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-78"><a id="__codelineno-50-78" name="__codelineno-50-78" href="#lab03-mcp-tools-lab-__codelineno-50-78"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">axios</span><span class="p">.</span><span class="nx">isAxiosError</span><span class="p">(</span><span class="nx">error</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-79"><a id="__codelineno-50-79" name="__codelineno-50-79" href="#lab03-mcp-tools-lab-__codelineno-50-79"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ENOTFOUND&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-80"><a id="__codelineno-50-80" name="__codelineno-50-80" href="#lab03-mcp-tools-lab-__codelineno-50-80"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Could not resolve hostname: </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-50-81"><a id="__codelineno-50-81" name="__codelineno-50-81" href="#lab03-mcp-tools-lab-__codelineno-50-81"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ECONNREFUSED&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-82"><a id="__codelineno-50-82" name="__codelineno-50-82" href="#lab03-mcp-tools-lab-__codelineno-50-82"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Connection refused: </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-50-83"><a id="__codelineno-50-83" name="__codelineno-50-83" href="#lab03-mcp-tools-lab-__codelineno-50-83"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-84"><a id="__codelineno-50-84" name="__codelineno-50-84" href="#lab03-mcp-tools-lab-__codelineno-50-84"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`HTTP </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-50-85"><a id="__codelineno-50-85" name="__codelineno-50-85" href="#lab03-mcp-tools-lab-__codelineno-50-85"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ETIMEDOUT&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-86"><a id="__codelineno-50-86" name="__codelineno-50-86" href="#lab03-mcp-tools-lab-__codelineno-50-86"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Request timeout after </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">timeout</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">10000</span><span class="si">}</span><span class="sb">ms`</span><span class="p">);</span>
</span><span id="__span-50-87"><a id="__codelineno-50-87" name="__codelineno-50-87" href="#lab03-mcp-tools-lab-__codelineno-50-87"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-88"><a id="__codelineno-50-88" name="__codelineno-50-88" href="#lab03-mcp-tools-lab-__codelineno-50-88"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Network error: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-50-89"><a id="__codelineno-50-89" name="__codelineno-50-89" href="#lab03-mcp-tools-lab-__codelineno-50-89"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-50-90"><a id="__codelineno-50-90" name="__codelineno-50-90" href="#lab03-mcp-tools-lab-__codelineno-50-90"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-91"><a id="__codelineno-50-91" name="__codelineno-50-91" href="#lab03-mcp-tools-lab-__codelineno-50-91"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Web scraping failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-50-92"><a id="__codelineno-50-92" name="__codelineno-50-92" href="#lab03-mcp-tools-lab-__codelineno-50-92"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-93"><a id="__codelineno-50-93" name="__codelineno-50-93" href="#lab03-mcp-tools-lab-__codelineno-50-93"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-50-94"><a id="__codelineno-50-94" name="__codelineno-50-94" href="#lab03-mcp-tools-lab-__codelineno-50-94"></a><span class="p">}</span>
</span></code></pre></div>

Testing - Test with different websites and selectors:

<div class="language-javascript highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#lab03-mcp-tools-lab-__codelineno-51-1"></a><span class="c1">// Basic page scraping</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#lab03-mcp-tools-lab-__codelineno-51-2"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://httpbin.org/html&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#lab03-mcp-tools-lab-__codelineno-51-3"></a>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#lab03-mcp-tools-lab-__codelineno-51-4"></a><span class="c1">// Extract specific elements</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#lab03-mcp-tools-lab-__codelineno-51-5"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://httpbin.org/html&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">selector</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;h1&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#lab03-mcp-tools-lab-__codelineno-51-6"></a>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#lab03-mcp-tools-lab-__codelineno-51-7"></a><span class="c1">// Get HTML instead of text</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#lab03-mcp-tools-lab-__codelineno-51-8"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://httpbin.org/html&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">selector</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;p&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">includeText</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#lab03-mcp-tools-lab-__codelineno-51-9"></a>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#lab03-mcp-tools-lab-__codelineno-51-10"></a><span class="c1">// Test error handling</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#lab03-mcp-tools-lab-__codelineno-51-11"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://nonexistent-domain-12345.com&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#lab03-mcp-tools-lab-__codelineno-51-12"></a><span class="p">{</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://httpbin.org/status/404&quot;</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>

#### Security Notes

- This tool includes basic security measures but should not be used for production scraping
- Always respect robots.txt and terms of service
- Consider rate limiting to avoid being blocked
- Some websites may block requests without proper headers

</details>

<hr />
<h2 id="lab03-mcp-tools-lab-key-takeaways">Key Takeaways<a class="headerlink" href="#lab03-mcp-tools-lab-key-takeaways" title="Permanent link">&para;</a></h2>
<p>✅ Well-designed tools have clear schemas with validation</p>
<p>✅ Always validate inputs, even with JSON Schema</p>
<p>✅ Return rich content types when appropriate</p>
<p>✅ Handle errors gracefully with helpful messages</p>
<p>✅ Consider performance and caching for expensive operations</p>
<p>✅ Design tools to be composable with others</p>
<p>✅ Test thoroughly with edge cases</p>
<p>✅ Security is paramount - validate and sanitize everything</p>
<hr />
<h2 id="lab03-mcp-tools-lab-next-steps">Next Steps<a class="headerlink" href="#lab03-mcp-tools-lab-next-steps" title="Permanent link">&para;</a></h2>
<p>In <a href="#lab03-mcp-tools-lab04-mcp-resources"><strong>Lab 4</strong></a>, you&rsquo;ll explore MCP Resources. You&rsquo;ll learn:</p>
<ul>
<li>What resources are and how they differ from tools</li>
<li>Implementing resource URIs and templates</li>
<li>Supporting resource subscriptions for live updates</li>
<li>Best practices for resource organization</li>
<li>Combining tools and resources effectively</li>
</ul>
<hr />
<p><strong>You&rsquo;re becoming an MCP expert! Continue to <a href="#lab03-mcp-tools-lab04-mcp-resources"><strong>Lab 4</strong></a>.</strong></p></section><section class="print-page" id="lab04-mcp-resources-lab" heading-number="2.6"><h1 id="lab04-mcp-resources-lab-lab-4-working-with-mcp-resources">Lab 4: Working with MCP Resources<a class="headerlink" href="#lab04-mcp-resources-lab-lab-4-working-with-mcp-resources" title="Permanent link">&para;</a></h1>
<h2 id="lab04-mcp-resources-lab-overview">Overview<a class="headerlink" href="#lab04-mcp-resources-lab-overview" title="Permanent link">&para;</a></h2>
<p>In <a href="#lab04-mcp-resources-lab03-mcp-tools">Lab 3</a>, you mastered the art of creating sophisticated MCP tools that perform actions and return rich content. Now it&rsquo;s time to explore <strong>MCP Resources</strong> - the passive counterpart to tools that provides contextual data for LLMs to read and reference.</p>
<p>Resources are the foundation for giving LLMs access to your knowledge bases, files, databases, and other data sources. Unlike tools that <em>do</em> things, resources <em>are</em> things - they represent the data itself that LLMs can access for context and reasoning.</p>
<hr />
<h2 id="lab04-mcp-resources-lab-learning-objectives">Learning Objectives<a class="headerlink" href="#lab04-mcp-resources-lab-learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lab, you will:</p>
<ul>
<li>Understand the fundamental difference between tools and resources</li>
<li>Design effective resource URI schemes for different data types</li>
<li>Implement static and dynamic resources with proper metadata</li>
<li>Create resource templates for parameterized access</li>
<li>Build resource subscriptions for real-time updates</li>
<li>Apply security best practices for resource access</li>
<li>Combine resources with tools for comprehensive MCP servers</li>
<li>Test resource implementations thoroughly</li>
</ul>
<hr />
<h2 id="lab04-mcp-resources-lab-prerequisites">Prerequisites<a class="headerlink" href="#lab04-mcp-resources-lab-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Completed <a href="#lab04-mcp-resources-lab03-mcp-tools">Lab 3 - Implementing MCP Tools</a></li>
<li>Understanding of URI / URL patterns and RESTful design</li>
<li>Familiarity with file systems and data structures</li>
<li>Basic knowledge of caching and performance optimization</li>
</ul>
<hr />
<h2 id="lab04-mcp-resources-lab-tools-vs-resources">Tools vs. Resources<a class="headerlink" href="#lab04-mcp-resources-lab-tools-vs-resources" title="Permanent link">&para;</a></h2>
<h3 id="lab04-mcp-resources-lab-the-fundamental-difference">The Fundamental Difference<a class="headerlink" href="#lab04-mcp-resources-lab-the-fundamental-difference" title="Permanent link">&para;</a></h3>
<p>Before diving into implementation, it&rsquo;s crucial to understand when to use tools versus resources. They serve different purposes in the MCP ecosystem.</p>
<h3 id="lab04-mcp-resources-lab-tools-active-operations">Tools: Active Operations<a class="headerlink" href="#lab04-mcp-resources-lab-tools-active-operations" title="Permanent link">&para;</a></h3>
<p><strong>Tools perform actions and return results based on parameters.</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab04-mcp-resources-lab-__codelineno-0-1"></a><span class="c1">// Tool: Active, parameterized, can have side effects</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab04-mcp-resources-lab-__codelineno-0-2"></a><span class="p">{</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab04-mcp-resources-lab-__codelineno-0-3"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;search_database&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab04-mcp-resources-lab-__codelineno-0-4"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Search database with custom query&quot;</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#lab04-mcp-resources-lab-__codelineno-0-5"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#lab04-mcp-resources-lab-__codelineno-0-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#lab04-mcp-resources-lab-__codelineno-0-7"></a><span class="w">      </span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#lab04-mcp-resources-lab-__codelineno-0-8"></a><span class="w">      </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#lab04-mcp-resources-lab-__codelineno-0-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#lab04-mcp-resources-lab-__codelineno-0-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#lab04-mcp-resources-lab-__codelineno-0-11"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use tools:</strong></p>
<ul>
<li>Data changes frequently or needs computation</li>
<li>Operations require parameters or user input</li>
<li>Actions have side effects (create, update, delete)</li>
<li>Results need processing or transformation</li>
</ul>
<h3 id="lab04-mcp-resources-lab-resources-passive-data">Resources: Passive Data<a class="headerlink" href="#lab04-mcp-resources-lab-resources-passive-data" title="Permanent link">&para;</a></h3>
<p><strong>Resources expose existing data that can be read and referenced.</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab04-mcp-resources-lab-__codelineno-1-1"></a><span class="c1">// Resource: Passive, addressable, read-only</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#lab04-mcp-resources-lab-__codelineno-1-2"></a><span class="p">{</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#lab04-mcp-resources-lab-__codelineno-1-3"></a><span class="w">  </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://users/123/profile&quot;</span><span class="p">,</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#lab04-mcp-resources-lab-__codelineno-1-4"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;User Profile&quot;</span><span class="p">,</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#lab04-mcp-resources-lab-__codelineno-1-5"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;User profile data for ID 123&quot;</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#lab04-mcp-resources-lab-__codelineno-1-6"></a><span class="w">  </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#lab04-mcp-resources-lab-__codelineno-1-7"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use resources:</strong></p>
<ul>
<li>Data is relatively static or changes predictably</li>
<li>Direct access to structured data is needed</li>
<li>Content should be cached or bookmarked</li>
<li>Data serves as context for LLM reasoning</li>
</ul>
<h3 id="lab04-mcp-resources-lab-decision-framework">Decision Framework<a class="headerlink" href="#lab04-mcp-resources-lab-decision-framework" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Use Tool</th>
<th>Use Resource</th>
<th>Why</th>
</tr>
</thead>
<tbody>
<tr>
<td>Current weather</td>
<td>✅ Tool</td>
<td>❌ Resource</td>
<td>Data changes constantly</td>
</tr>
<tr>
<td>API documentation</td>
<td>❌ Tool</td>
<td>✅ Resource</td>
<td>Static reference material</td>
</tr>
<tr>
<td>Database search</td>
<td>✅ Tool</td>
<td>❌ Resource</td>
<td>Requires query parameters</td>
</tr>
<tr>
<td>User profile</td>
<td>❌ Tool</td>
<td>✅ Resource</td>
<td>Direct data access needed</td>
</tr>
<tr>
<td>File contents</td>
<td>❌ Tool</td>
<td>✅ Resource</td>
<td>Static file data</td>
</tr>
<tr>
<td>Generate report</td>
<td>✅ Tool</td>
<td>❌ Resource</td>
<td>Computation required</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="lab04-mcp-resources-lab-resource-fundamentals">Resource Fundamentals<a class="headerlink" href="#lab04-mcp-resources-lab-resource-fundamentals" title="Permanent link">&para;</a></h2>
<h3 id="lab04-mcp-resources-lab-resource-structure">Resource Structure<a class="headerlink" href="#lab04-mcp-resources-lab-resource-structure" title="Permanent link">&para;</a></h3>
<p>Every MCP resource has a consistent structure with metadata that helps LLMs understand what they&rsquo;re accessing:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab04-mcp-resources-lab-__codelineno-2-1"></a><span class="kd">interface</span><span class="w"> </span><span class="nx">Resource</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#lab04-mcp-resources-lab-__codelineno-2-2"></a><span class="w">  </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">           </span><span class="c1">// Unique identifier (like a URL)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#lab04-mcp-resources-lab-__codelineno-2-3"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">          </span><span class="c1">// Human-readable title</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#lab04-mcp-resources-lab-__codelineno-2-4"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">   </span><span class="c1">// What the resource contains</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#lab04-mcp-resources-lab-__codelineno-2-5"></a><span class="w">  </span><span class="nx">mimeType?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">     </span><span class="c1">// Content type (optional but recommended)</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#lab04-mcp-resources-lab-__codelineno-2-6"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="lab04-mcp-resources-lab-resource-content">Resource Content<a class="headerlink" href="#lab04-mcp-resources-lab-resource-content" title="Permanent link">&para;</a></h3>
<p>When a resource is read, it returns structured content:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab04-mcp-resources-lab-__codelineno-3-1"></a><span class="kd">interface</span><span class="w"> </span><span class="nx">ResourceContent</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#lab04-mcp-resources-lab-__codelineno-3-2"></a><span class="w">  </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#lab04-mcp-resources-lab-__codelineno-3-3"></a><span class="w">    </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#lab04-mcp-resources-lab-__codelineno-3-4"></a><span class="w">    </span><span class="nx">mimeType?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#lab04-mcp-resources-lab-__codelineno-3-5"></a><span class="w">    </span><span class="nx">text?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">       </span><span class="c1">// For text content</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#lab04-mcp-resources-lab-__codelineno-3-6"></a><span class="w">    </span><span class="nx">blob?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">       </span><span class="c1">// For binary content (base64)</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#lab04-mcp-resources-lab-__codelineno-3-7"></a><span class="w">  </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#lab04-mcp-resources-lab-__codelineno-3-8"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Key Points:</strong></p>
<ul>
<li>Resources are <strong>read-only</strong> by convention</li>
<li>Content can be <strong>text</strong> or <strong>binary</strong> (base64 encoded)</li>
<li>Multiple content items can be returned for complex resources</li>
<li><code>MIME (Multipurpose Internet Mail Extensions) types</code> help clients handle content appropriately</li>
</ul>
<hr />
<h2 id="lab04-mcp-resources-lab-designing-resource-uri-schemes">Designing Resource URI Schemes<a class="headerlink" href="#lab04-mcp-resources-lab-designing-resource-uri-schemes" title="Permanent link">&para;</a></h2>
<p>Effective URI design is crucial for resource organization and discoverability. A good URI scheme should be:</p>
<ul>
<li><strong>Hierarchical</strong>: Reflects data organization</li>
<li><strong>Descriptive</strong>: Self-documenting structure</li>
<li><strong>Consistent</strong>: Follows patterns across similar resources</li>
<li><strong>Extensible</strong>: Allows for future additions</li>
</ul>
<h3 id="lab04-mcp-resources-lab-common-uri-patterns">Common URI Patterns<a class="headerlink" href="#lab04-mcp-resources-lab-common-uri-patterns" title="Permanent link">&para;</a></h3>
<h4 id="lab04-mcp-resources-lab-file-system-resources">File System Resources<a class="headerlink" href="#lab04-mcp-resources-lab-file-system-resources" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab04-mcp-resources-lab-__codelineno-4-1"></a>file:///project/src/index.ts
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#lab04-mcp-resources-lab-__codelineno-4-2"></a>file:///docs/api-reference.md
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#lab04-mcp-resources-lab-__codelineno-4-3"></a>file:///config/database.json
</span></code></pre></div>
<h4 id="lab04-mcp-resources-lab-database-resources">Database Resources<a class="headerlink" href="#lab04-mcp-resources-lab-database-resources" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab04-mcp-resources-lab-__codelineno-5-1"></a>db://users/123/profile
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#lab04-mcp-resources-lab-__codelineno-5-2"></a>db://products/category/electronics
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#lab04-mcp-resources-lab-__codelineno-5-3"></a>db://orders/recent?limit=10
</span></code></pre></div>
<h4 id="lab04-mcp-resources-lab-api-documentation">API Documentation<a class="headerlink" href="#lab04-mcp-resources-lab-api-documentation" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab04-mcp-resources-lab-__codelineno-6-1"></a>api://petstore/v1/swagger.json
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab04-mcp-resources-lab-__codelineno-6-2"></a>api://github/repos/microsoft/vscode/issues
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#lab04-mcp-resources-lab-__codelineno-6-3"></a>api://weather/current/london
</span></code></pre></div>
<h4 id="lab04-mcp-resources-lab-configuration-resources">Configuration Resources<a class="headerlink" href="#lab04-mcp-resources-lab-configuration-resources" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab04-mcp-resources-lab-__codelineno-7-1"></a>config://app/settings
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#lab04-mcp-resources-lab-__codelineno-7-2"></a>config://database/connection
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#lab04-mcp-resources-lab-__codelineno-7-3"></a>config://logging/level
</span></code></pre></div>
<h3 id="lab04-mcp-resources-lab-uri-design-best-practices">URI Design Best Practices<a class="headerlink" href="#lab04-mcp-resources-lab-uri-design-best-practices" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Use descriptive paths</strong>: <code>users/active</code> vs <code>u/a</code></li>
<li><strong>Include identifiers</strong>: <code>orders/123</code> vs <code>current-order</code></li>
<li><strong>Support hierarchies</strong>: <code>docs/api/v1/endpoints</code></li>
<li><strong>Use query parameters moderately</strong>: Prefer path segments</li>
<li><strong>Be consistent</strong>: Same patterns for similar resources</li>
</ol>
<hr />
<h2 id="lab04-mcp-resources-lab-implementing-static-resources">Implementing Static Resources<a class="headerlink" href="#lab04-mcp-resources-lab-implementing-static-resources" title="Permanent link">&para;</a></h2>
<p>Static resources represent fixed data that doesn&rsquo;t change or changes infrequently. They&rsquo;re perfect for documentation, configuration files, and reference data.</p>
<h3 id="lab04-mcp-resources-lab-complete-static-resource-server">Complete Static Resource Server<a class="headerlink" href="#lab04-mcp-resources-lab-complete-static-resource-server" title="Permanent link">&para;</a></h3>
<p>Here&rsquo;s a complete MCP server that exposes static resources:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab04-mcp-resources-lab-__codelineno-8-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#lab04-mcp-resources-lab-__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#lab04-mcp-resources-lab-__codelineno-8-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#lab04-mcp-resources-lab-__codelineno-8-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#lab04-mcp-resources-lab-__codelineno-8-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#lab04-mcp-resources-lab-__codelineno-8-6"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#lab04-mcp-resources-lab-__codelineno-8-7"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#lab04-mcp-resources-lab-__codelineno-8-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#lab04-mcp-resources-lab-__codelineno-8-9"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs/promises&#39;</span><span class="p">;</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#lab04-mcp-resources-lab-__codelineno-8-10"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;path&#39;</span><span class="p">;</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#lab04-mcp-resources-lab-__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#lab04-mcp-resources-lab-__codelineno-8-12"></a><span class="cm">/**</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#lab04-mcp-resources-lab-__codelineno-8-13"></a><span class="cm"> * MCP Server exposing static file resources</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#lab04-mcp-resources-lab-__codelineno-8-14"></a><span class="cm"> */</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#lab04-mcp-resources-lab-__codelineno-8-15"></a><span class="kd">class</span><span class="w"> </span><span class="nx">StaticResourceServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#lab04-mcp-resources-lab-__codelineno-8-16"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#lab04-mcp-resources-lab-__codelineno-8-17"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">resourceRoot</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#lab04-mcp-resources-lab-__codelineno-8-18"></a>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#lab04-mcp-resources-lab-__codelineno-8-19"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">resourceRoot</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./resources&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#lab04-mcp-resources-lab-__codelineno-8-20"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">resourceRoot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">resourceRoot</span><span class="p">);</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#lab04-mcp-resources-lab-__codelineno-8-21"></a>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#lab04-mcp-resources-lab-__codelineno-8-22"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#lab04-mcp-resources-lab-__codelineno-8-23"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#lab04-mcp-resources-lab-__codelineno-8-24"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;static-resource-server&quot;</span><span class="p">,</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#lab04-mcp-resources-lab-__codelineno-8-25"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#lab04-mcp-resources-lab-__codelineno-8-26"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#lab04-mcp-resources-lab-__codelineno-8-27"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#lab04-mcp-resources-lab-__codelineno-8-28"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#lab04-mcp-resources-lab-__codelineno-8-29"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#lab04-mcp-resources-lab-__codelineno-8-30"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#lab04-mcp-resources-lab-__codelineno-8-31"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#lab04-mcp-resources-lab-__codelineno-8-32"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#lab04-mcp-resources-lab-__codelineno-8-33"></a>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#lab04-mcp-resources-lab-__codelineno-8-34"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#lab04-mcp-resources-lab-__codelineno-8-35"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#lab04-mcp-resources-lab-__codelineno-8-36"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#lab04-mcp-resources-lab-__codelineno-8-37"></a>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#lab04-mcp-resources-lab-__codelineno-8-38"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#lab04-mcp-resources-lab-__codelineno-8-39"></a><span class="w">    </span><span class="c1">// List available resources</span>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#lab04-mcp-resources-lab-__codelineno-8-40"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#lab04-mcp-resources-lab-__codelineno-8-41"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">discoverResources</span><span class="p">();</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#lab04-mcp-resources-lab-__codelineno-8-42"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#lab04-mcp-resources-lab-__codelineno-8-43"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44" href="#lab04-mcp-resources-lab-__codelineno-8-44"></a>
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45" href="#lab04-mcp-resources-lab-__codelineno-8-45"></a><span class="w">    </span><span class="c1">// Read specific resource</span>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46" href="#lab04-mcp-resources-lab-__codelineno-8-46"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47" href="#lab04-mcp-resources-lab-__codelineno-8-47"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48" href="#lab04-mcp-resources-lab-__codelineno-8-48"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readResource</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49" href="#lab04-mcp-resources-lab-__codelineno-8-49"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50" href="#lab04-mcp-resources-lab-__codelineno-8-50"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51" href="#lab04-mcp-resources-lab-__codelineno-8-51"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52" href="#lab04-mcp-resources-lab-__codelineno-8-52"></a>
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53" href="#lab04-mcp-resources-lab-__codelineno-8-53"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">discoverResources</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54" href="#lab04-mcp-resources-lab-__codelineno-8-54"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55" href="#lab04-mcp-resources-lab-__codelineno-8-55"></a>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56" href="#lab04-mcp-resources-lab-__codelineno-8-56"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57" href="#lab04-mcp-resources-lab-__codelineno-8-57"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">walkDirectory</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resourceRoot</span><span class="p">);</span>
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58" href="#lab04-mcp-resources-lab-__codelineno-8-58"></a>
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59" href="#lab04-mcp-resources-lab-__codelineno-8-59"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">files</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60" href="#lab04-mcp-resources-lab-__codelineno-8-60"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">relativePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">relative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resourceRoot</span><span class="p">,</span><span class="w"> </span><span class="nx">file</span><span class="p">);</span>
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61" href="#lab04-mcp-resources-lab-__codelineno-8-61"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`file:///</span><span class="si">${</span><span class="nx">relativePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-8-62"><a id="__codelineno-8-62" name="__codelineno-8-62" href="#lab04-mcp-resources-lab-__codelineno-8-62"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">mimeType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getMimeType</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
</span><span id="__span-8-63"><a id="__codelineno-8-63" name="__codelineno-8-63" href="#lab04-mcp-resources-lab-__codelineno-8-63"></a>
</span><span id="__span-8-64"><a id="__codelineno-8-64" name="__codelineno-8-64" href="#lab04-mcp-resources-lab-__codelineno-8-64"></a><span class="w">        </span><span class="nx">resources</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-8-65"><a id="__codelineno-8-65" name="__codelineno-8-65" href="#lab04-mcp-resources-lab-__codelineno-8-65"></a><span class="w">          </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-8-66"><a id="__codelineno-8-66" name="__codelineno-8-66" href="#lab04-mcp-resources-lab-__codelineno-8-66"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">path.basename</span><span class="p">(</span><span class="nx">file</span><span class="p">),</span>
</span><span id="__span-8-67"><a id="__codelineno-8-67" name="__codelineno-8-67" href="#lab04-mcp-resources-lab-__codelineno-8-67"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Static file: </span><span class="si">${</span><span class="nx">relativePath</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-8-68"><a id="__codelineno-8-68" name="__codelineno-8-68" href="#lab04-mcp-resources-lab-__codelineno-8-68"></a><span class="w">          </span><span class="nx">mimeType</span><span class="p">,</span>
</span><span id="__span-8-69"><a id="__codelineno-8-69" name="__codelineno-8-69" href="#lab04-mcp-resources-lab-__codelineno-8-69"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-8-70"><a id="__codelineno-8-70" name="__codelineno-8-70" href="#lab04-mcp-resources-lab-__codelineno-8-70"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-8-71"><a id="__codelineno-8-71" name="__codelineno-8-71" href="#lab04-mcp-resources-lab-__codelineno-8-71"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-72"><a id="__codelineno-8-72" name="__codelineno-8-72" href="#lab04-mcp-resources-lab-__codelineno-8-72"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error discovering resources:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-8-73"><a id="__codelineno-8-73" name="__codelineno-8-73" href="#lab04-mcp-resources-lab-__codelineno-8-73"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-74"><a id="__codelineno-8-74" name="__codelineno-8-74" href="#lab04-mcp-resources-lab-__codelineno-8-74"></a>
</span><span id="__span-8-75"><a id="__codelineno-8-75" name="__codelineno-8-75" href="#lab04-mcp-resources-lab-__codelineno-8-75"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">resources</span><span class="p">;</span>
</span><span id="__span-8-76"><a id="__codelineno-8-76" name="__codelineno-8-76" href="#lab04-mcp-resources-lab-__codelineno-8-76"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-77"><a id="__codelineno-8-77" name="__codelineno-8-77" href="#lab04-mcp-resources-lab-__codelineno-8-77"></a>
</span><span id="__span-8-78"><a id="__codelineno-8-78" name="__codelineno-8-78" href="#lab04-mcp-resources-lab-__codelineno-8-78"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">readResource</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-79"><a id="__codelineno-8-79" name="__codelineno-8-79" href="#lab04-mcp-resources-lab-__codelineno-8-79"></a><span class="w">    </span><span class="c1">// Validate URI format</span>
</span><span id="__span-8-80"><a id="__codelineno-8-80" name="__codelineno-8-80" href="#lab04-mcp-resources-lab-__codelineno-8-80"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">uri</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;file:///&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-81"><a id="__codelineno-8-81" name="__codelineno-8-81" href="#lab04-mcp-resources-lab-__codelineno-8-81"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid URI format: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-8-82"><a id="__codelineno-8-82" name="__codelineno-8-82" href="#lab04-mcp-resources-lab-__codelineno-8-82"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-83"><a id="__codelineno-8-83" name="__codelineno-8-83" href="#lab04-mcp-resources-lab-__codelineno-8-83"></a>
</span><span id="__span-8-84"><a id="__codelineno-8-84" name="__codelineno-8-84" href="#lab04-mcp-resources-lab-__codelineno-8-84"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">relativePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;file:///&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span id="__span-8-85"><a id="__codelineno-8-85" name="__codelineno-8-85" href="#lab04-mcp-resources-lab-__codelineno-8-85"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resourceRoot</span><span class="p">,</span><span class="w"> </span><span class="nx">relativePath</span><span class="p">);</span>
</span><span id="__span-8-86"><a id="__codelineno-8-86" name="__codelineno-8-86" href="#lab04-mcp-resources-lab-__codelineno-8-86"></a>
</span><span id="__span-8-87"><a id="__codelineno-8-87" name="__codelineno-8-87" href="#lab04-mcp-resources-lab-__codelineno-8-87"></a><span class="w">    </span><span class="c1">// Security: Prevent directory traversal</span>
</span><span id="__span-8-88"><a id="__codelineno-8-88" name="__codelineno-8-88" href="#lab04-mcp-resources-lab-__codelineno-8-88"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">resolvedPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
</span><span id="__span-8-89"><a id="__codelineno-8-89" name="__codelineno-8-89" href="#lab04-mcp-resources-lab-__codelineno-8-89"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">resolvedPath</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resourceRoot</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-90"><a id="__codelineno-8-90" name="__codelineno-8-90" href="#lab04-mcp-resources-lab-__codelineno-8-90"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Access denied: path outside resource root&#39;</span><span class="p">);</span>
</span><span id="__span-8-91"><a id="__codelineno-8-91" name="__codelineno-8-91" href="#lab04-mcp-resources-lab-__codelineno-8-91"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-92"><a id="__codelineno-8-92" name="__codelineno-8-92" href="#lab04-mcp-resources-lab-__codelineno-8-92"></a>
</span><span id="__span-8-93"><a id="__codelineno-8-93" name="__codelineno-8-93" href="#lab04-mcp-resources-lab-__codelineno-8-93"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-94"><a id="__codelineno-8-94" name="__codelineno-8-94" href="#lab04-mcp-resources-lab-__codelineno-8-94"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span>
</span><span id="__span-8-95"><a id="__codelineno-8-95" name="__codelineno-8-95" href="#lab04-mcp-resources-lab-__codelineno-8-95"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">mimeType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getMimeType</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
</span><span id="__span-8-96"><a id="__codelineno-8-96" name="__codelineno-8-96" href="#lab04-mcp-resources-lab-__codelineno-8-96"></a>
</span><span id="__span-8-97"><a id="__codelineno-8-97" name="__codelineno-8-97" href="#lab04-mcp-resources-lab-__codelineno-8-97"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-98"><a id="__codelineno-8-98" name="__codelineno-8-98" href="#lab04-mcp-resources-lab-__codelineno-8-98"></a><span class="w">        </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-8-99"><a id="__codelineno-8-99" name="__codelineno-8-99" href="#lab04-mcp-resources-lab-__codelineno-8-99"></a><span class="w">        </span><span class="nx">mimeType</span><span class="p">,</span>
</span><span id="__span-8-100"><a id="__codelineno-8-100" name="__codelineno-8-100" href="#lab04-mcp-resources-lab-__codelineno-8-100"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">content</span><span class="p">,</span>
</span><span id="__span-8-101"><a id="__codelineno-8-101" name="__codelineno-8-101" href="#lab04-mcp-resources-lab-__codelineno-8-101"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-8-102"><a id="__codelineno-8-102" name="__codelineno-8-102" href="#lab04-mcp-resources-lab-__codelineno-8-102"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-103"><a id="__codelineno-8-103" name="__codelineno-8-103" href="#lab04-mcp-resources-lab-__codelineno-8-103"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Failed to read resource: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-8-104"><a id="__codelineno-8-104" name="__codelineno-8-104" href="#lab04-mcp-resources-lab-__codelineno-8-104"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-105"><a id="__codelineno-8-105" name="__codelineno-8-105" href="#lab04-mcp-resources-lab-__codelineno-8-105"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-106"><a id="__codelineno-8-106" name="__codelineno-8-106" href="#lab04-mcp-resources-lab-__codelineno-8-106"></a>
</span><span id="__span-8-107"><a id="__codelineno-8-107" name="__codelineno-8-107" href="#lab04-mcp-resources-lab-__codelineno-8-107"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">walkDirectory</span><span class="p">(</span><span class="nx">dir</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-108"><a id="__codelineno-8-108" name="__codelineno-8-108" href="#lab04-mcp-resources-lab-__codelineno-8-108"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">files</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-8-109"><a id="__codelineno-8-109" name="__codelineno-8-109" href="#lab04-mcp-resources-lab-__codelineno-8-109"></a>
</span><span id="__span-8-110"><a id="__codelineno-8-110" name="__codelineno-8-110" href="#lab04-mcp-resources-lab-__codelineno-8-110"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-111"><a id="__codelineno-8-111" name="__codelineno-8-111" href="#lab04-mcp-resources-lab-__codelineno-8-111"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">entries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readdir</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">withFileTypes</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-8-112"><a id="__codelineno-8-112" name="__codelineno-8-112" href="#lab04-mcp-resources-lab-__codelineno-8-112"></a>
</span><span id="__span-8-113"><a id="__codelineno-8-113" name="__codelineno-8-113" href="#lab04-mcp-resources-lab-__codelineno-8-113"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">entries</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-114"><a id="__codelineno-8-114" name="__codelineno-8-114" href="#lab04-mcp-resources-lab-__codelineno-8-114"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">fullPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span><span id="__span-8-115"><a id="__codelineno-8-115" name="__codelineno-8-115" href="#lab04-mcp-resources-lab-__codelineno-8-115"></a>
</span><span id="__span-8-116"><a id="__codelineno-8-116" name="__codelineno-8-116" href="#lab04-mcp-resources-lab-__codelineno-8-116"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">isDirectory</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-117"><a id="__codelineno-8-117" name="__codelineno-8-117" href="#lab04-mcp-resources-lab-__codelineno-8-117"></a><span class="w">          </span><span class="c1">// Skip hidden directories and node_modules</span>
</span><span id="__span-8-118"><a id="__codelineno-8-118" name="__codelineno-8-118" href="#lab04-mcp-resources-lab-__codelineno-8-118"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;node_modules&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-119"><a id="__codelineno-8-119" name="__codelineno-8-119" href="#lab04-mcp-resources-lab-__codelineno-8-119"></a><span class="w">            </span><span class="nx">files</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">walkDirectory</span><span class="p">(</span><span class="nx">fullPath</span><span class="p">));</span>
</span><span id="__span-8-120"><a id="__codelineno-8-120" name="__codelineno-8-120" href="#lab04-mcp-resources-lab-__codelineno-8-120"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-8-121"><a id="__codelineno-8-121" name="__codelineno-8-121" href="#lab04-mcp-resources-lab-__codelineno-8-121"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">isFile</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-122"><a id="__codelineno-8-122" name="__codelineno-8-122" href="#lab04-mcp-resources-lab-__codelineno-8-122"></a><span class="w">          </span><span class="c1">// Only include certain file types</span>
</span><span id="__span-8-123"><a id="__codelineno-8-123" name="__codelineno-8-123" href="#lab04-mcp-resources-lab-__codelineno-8-123"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span id="__span-8-124"><a id="__codelineno-8-124" name="__codelineno-8-124" href="#lab04-mcp-resources-lab-__codelineno-8-124"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="s1">&#39;.md&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.json&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.yaml&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.yml&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.js&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.ts&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.css&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.html&#39;</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">ext</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-125"><a id="__codelineno-8-125" name="__codelineno-8-125" href="#lab04-mcp-resources-lab-__codelineno-8-125"></a><span class="w">            </span><span class="nx">files</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fullPath</span><span class="p">);</span>
</span><span id="__span-8-126"><a id="__codelineno-8-126" name="__codelineno-8-126" href="#lab04-mcp-resources-lab-__codelineno-8-126"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-8-127"><a id="__codelineno-8-127" name="__codelineno-8-127" href="#lab04-mcp-resources-lab-__codelineno-8-127"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-8-128"><a id="__codelineno-8-128" name="__codelineno-8-128" href="#lab04-mcp-resources-lab-__codelineno-8-128"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-8-129"><a id="__codelineno-8-129" name="__codelineno-8-129" href="#lab04-mcp-resources-lab-__codelineno-8-129"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-130"><a id="__codelineno-8-130" name="__codelineno-8-130" href="#lab04-mcp-resources-lab-__codelineno-8-130"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Error walking directory </span><span class="si">${</span><span class="nx">dir</span><span class="si">}</span><span class="sb">:`</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-8-131"><a id="__codelineno-8-131" name="__codelineno-8-131" href="#lab04-mcp-resources-lab-__codelineno-8-131"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-132"><a id="__codelineno-8-132" name="__codelineno-8-132" href="#lab04-mcp-resources-lab-__codelineno-8-132"></a>
</span><span id="__span-8-133"><a id="__codelineno-8-133" name="__codelineno-8-133" href="#lab04-mcp-resources-lab-__codelineno-8-133"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">files</span><span class="p">;</span>
</span><span id="__span-8-134"><a id="__codelineno-8-134" name="__codelineno-8-134" href="#lab04-mcp-resources-lab-__codelineno-8-134"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-135"><a id="__codelineno-8-135" name="__codelineno-8-135" href="#lab04-mcp-resources-lab-__codelineno-8-135"></a>
</span><span id="__span-8-136"><a id="__codelineno-8-136" name="__codelineno-8-136" href="#lab04-mcp-resources-lab-__codelineno-8-136"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getMimeType</span><span class="p">(</span><span class="nx">filePath</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-137"><a id="__codelineno-8-137" name="__codelineno-8-137" href="#lab04-mcp-resources-lab-__codelineno-8-137"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">filePath</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span id="__span-8-138"><a id="__codelineno-8-138" name="__codelineno-8-138" href="#lab04-mcp-resources-lab-__codelineno-8-138"></a>
</span><span id="__span-8-139"><a id="__codelineno-8-139" name="__codelineno-8-139" href="#lab04-mcp-resources-lab-__codelineno-8-139"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mimeTypes</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-140"><a id="__codelineno-8-140" name="__codelineno-8-140" href="#lab04-mcp-resources-lab-__codelineno-8-140"></a><span class="w">      </span><span class="s1">&#39;.md&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text/markdown&#39;</span><span class="p">,</span>
</span><span id="__span-8-141"><a id="__codelineno-8-141" name="__codelineno-8-141" href="#lab04-mcp-resources-lab-__codelineno-8-141"></a><span class="w">      </span><span class="s1">&#39;.txt&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span>
</span><span id="__span-8-142"><a id="__codelineno-8-142" name="__codelineno-8-142" href="#lab04-mcp-resources-lab-__codelineno-8-142"></a><span class="w">      </span><span class="s1">&#39;.json&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
</span><span id="__span-8-143"><a id="__codelineno-8-143" name="__codelineno-8-143" href="#lab04-mcp-resources-lab-__codelineno-8-143"></a><span class="w">      </span><span class="s1">&#39;.yaml&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/yaml&#39;</span><span class="p">,</span>
</span><span id="__span-8-144"><a id="__codelineno-8-144" name="__codelineno-8-144" href="#lab04-mcp-resources-lab-__codelineno-8-144"></a><span class="w">      </span><span class="s1">&#39;.yml&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/yaml&#39;</span><span class="p">,</span>
</span><span id="__span-8-145"><a id="__codelineno-8-145" name="__codelineno-8-145" href="#lab04-mcp-resources-lab-__codelineno-8-145"></a><span class="w">      </span><span class="s1">&#39;.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/javascript&#39;</span><span class="p">,</span>
</span><span id="__span-8-146"><a id="__codelineno-8-146" name="__codelineno-8-146" href="#lab04-mcp-resources-lab-__codelineno-8-146"></a><span class="w">      </span><span class="s1">&#39;.ts&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/typescript&#39;</span><span class="p">,</span>
</span><span id="__span-8-147"><a id="__codelineno-8-147" name="__codelineno-8-147" href="#lab04-mcp-resources-lab-__codelineno-8-147"></a><span class="w">      </span><span class="s1">&#39;.css&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text/css&#39;</span><span class="p">,</span>
</span><span id="__span-8-148"><a id="__codelineno-8-148" name="__codelineno-8-148" href="#lab04-mcp-resources-lab-__codelineno-8-148"></a><span class="w">      </span><span class="s1">&#39;.html&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text/html&#39;</span><span class="p">,</span>
</span><span id="__span-8-149"><a id="__codelineno-8-149" name="__codelineno-8-149" href="#lab04-mcp-resources-lab-__codelineno-8-149"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-8-150"><a id="__codelineno-8-150" name="__codelineno-8-150" href="#lab04-mcp-resources-lab-__codelineno-8-150"></a>
</span><span id="__span-8-151"><a id="__codelineno-8-151" name="__codelineno-8-151" href="#lab04-mcp-resources-lab-__codelineno-8-151"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">mimeTypes</span><span class="p">[</span><span class="nx">ext</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;text/plain&#39;</span><span class="p">;</span>
</span><span id="__span-8-152"><a id="__codelineno-8-152" name="__codelineno-8-152" href="#lab04-mcp-resources-lab-__codelineno-8-152"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-153"><a id="__codelineno-8-153" name="__codelineno-8-153" href="#lab04-mcp-resources-lab-__codelineno-8-153"></a>
</span><span id="__span-8-154"><a id="__codelineno-8-154" name="__codelineno-8-154" href="#lab04-mcp-resources-lab-__codelineno-8-154"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-155"><a id="__codelineno-8-155" name="__codelineno-8-155" href="#lab04-mcp-resources-lab-__codelineno-8-155"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-156"><a id="__codelineno-8-156" name="__codelineno-8-156" href="#lab04-mcp-resources-lab-__codelineno-8-156"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-8-157"><a id="__codelineno-8-157" name="__codelineno-8-157" href="#lab04-mcp-resources-lab-__codelineno-8-157"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-8-158"><a id="__codelineno-8-158" name="__codelineno-8-158" href="#lab04-mcp-resources-lab-__codelineno-8-158"></a>
</span><span id="__span-8-159"><a id="__codelineno-8-159" name="__codelineno-8-159" href="#lab04-mcp-resources-lab-__codelineno-8-159"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-160"><a id="__codelineno-8-160" name="__codelineno-8-160" href="#lab04-mcp-resources-lab-__codelineno-8-160"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-8-161"><a id="__codelineno-8-161" name="__codelineno-8-161" href="#lab04-mcp-resources-lab-__codelineno-8-161"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-8-162"><a id="__codelineno-8-162" name="__codelineno-8-162" href="#lab04-mcp-resources-lab-__codelineno-8-162"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-8-163"><a id="__codelineno-8-163" name="__codelineno-8-163" href="#lab04-mcp-resources-lab-__codelineno-8-163"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-164"><a id="__codelineno-8-164" name="__codelineno-8-164" href="#lab04-mcp-resources-lab-__codelineno-8-164"></a>
</span><span id="__span-8-165"><a id="__codelineno-8-165" name="__codelineno-8-165" href="#lab04-mcp-resources-lab-__codelineno-8-165"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-166"><a id="__codelineno-8-166" name="__codelineno-8-166" href="#lab04-mcp-resources-lab-__codelineno-8-166"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-8-167"><a id="__codelineno-8-167" name="__codelineno-8-167" href="#lab04-mcp-resources-lab-__codelineno-8-167"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-8-168"><a id="__codelineno-8-168" name="__codelineno-8-168" href="#lab04-mcp-resources-lab-__codelineno-8-168"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Static Resource Server running on stdio (root: </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">resourceRoot</span><span class="si">}</span><span class="sb">)`</span><span class="p">);</span>
</span><span id="__span-8-169"><a id="__codelineno-8-169" name="__codelineno-8-169" href="#lab04-mcp-resources-lab-__codelineno-8-169"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-170"><a id="__codelineno-8-170" name="__codelineno-8-170" href="#lab04-mcp-resources-lab-__codelineno-8-170"></a><span class="p">}</span>
</span><span id="__span-8-171"><a id="__codelineno-8-171" name="__codelineno-8-171" href="#lab04-mcp-resources-lab-__codelineno-8-171"></a>
</span><span id="__span-8-172"><a id="__codelineno-8-172" name="__codelineno-8-172" href="#lab04-mcp-resources-lab-__codelineno-8-172"></a><span class="c1">// Main entry point</span>
</span><span id="__span-8-173"><a id="__codelineno-8-173" name="__codelineno-8-173" href="#lab04-mcp-resources-lab-__codelineno-8-173"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-174"><a id="__codelineno-8-174" name="__codelineno-8-174" href="#lab04-mcp-resources-lab-__codelineno-8-174"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StaticResourceServer</span><span class="p">();</span>
</span><span id="__span-8-175"><a id="__codelineno-8-175" name="__codelineno-8-175" href="#lab04-mcp-resources-lab-__codelineno-8-175"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-8-176"><a id="__codelineno-8-176" name="__codelineno-8-176" href="#lab04-mcp-resources-lab-__codelineno-8-176"></a><span class="p">}</span>
</span><span id="__span-8-177"><a id="__codelineno-8-177" name="__codelineno-8-177" href="#lab04-mcp-resources-lab-__codelineno-8-177"></a>
</span><span id="__span-8-178"><a id="__codelineno-8-178" name="__codelineno-8-178" href="#lab04-mcp-resources-lab-__codelineno-8-178"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-179"><a id="__codelineno-8-179" name="__codelineno-8-179" href="#lab04-mcp-resources-lab-__codelineno-8-179"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-8-180"><a id="__codelineno-8-180" name="__codelineno-8-180" href="#lab04-mcp-resources-lab-__codelineno-8-180"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-8-181"><a id="__codelineno-8-181" name="__codelineno-8-181" href="#lab04-mcp-resources-lab-__codelineno-8-181"></a><span class="p">});</span>
</span></code></pre></div>
<h3 id="lab04-mcp-resources-lab-testing-static-resources">Testing Static Resources<a class="headerlink" href="#lab04-mcp-resources-lab-testing-static-resources" title="Permanent link">&para;</a></h3>
<p><strong>Step 1: Create Test Resources</strong></p>
<p>First, let&rsquo;s create some test files that our static resource server can expose. These files will simulate a typical project structure with documentation, configuration, and general project files.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab04-mcp-resources-lab-__codelineno-9-1"></a><span class="c1"># Create the directory structure</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#lab04-mcp-resources-lab-__codelineno-9-2"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>resources/docs<span class="w"> </span>resources/config
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#lab04-mcp-resources-lab-__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#lab04-mcp-resources-lab-__codelineno-9-4"></a><span class="c1"># Create a markdown documentation file</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#lab04-mcp-resources-lab-__codelineno-9-5"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;# API Documentation\n\nThis is the API docs.&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>resources/docs/api.md
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#lab04-mcp-resources-lab-__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#lab04-mcp-resources-lab-__codelineno-9-7"></a><span class="c1"># Create a JSON configuration file</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#lab04-mcp-resources-lab-__codelineno-9-8"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;version&quot;: &quot;1.0.0&quot;, &quot;env&quot;: &quot;development&quot;}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>resources/config/settings.json
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#lab04-mcp-resources-lab-__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#lab04-mcp-resources-lab-__codelineno-9-10"></a><span class="c1"># Create a plain text README file</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#lab04-mcp-resources-lab-__codelineno-9-11"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Welcome to our project!&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>resources/README.txt
</span></code></pre></div>
<p><strong>What this creates:</strong></p>
<ul>
<li><code>resources/docs/api.md</code> - A markdown file with API documentation</li>
<li><code>resources/config/settings.json</code> - A JSON configuration file with version and environment info</li>
<li><code>resources/README.txt</code> - A plain text file with project information</li>
</ul>
<p><br></p>
<p><strong>Step 2: Start the Server</strong></p>
<p>Now start your MCP server using the MCP Inspector. </p>
<p>This will launch both your server and the testing interface:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab04-mcp-resources-lab-__codelineno-10-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><strong>What to expect:</strong></p>
<ul>
<li>The MCP Inspector window should open in your browser</li>
<li>Your server will start and connect via <code>stdio</code> transport</li>
<li>You should see connection confirmation in the terminal</li>
<li>The inspector interface will show tabs for Resources, Tools, etc.</li>
</ul>
<p><br></p>
<p><strong>Step 3: Test Resource Discovery</strong></p>
<p>In the MCP Inspector, navigate to the <strong>Resources</strong> tab to see what resources your server is exposing.</p>
<ul>
<li>
<p>The MCP Inspector should show resources like:</p>
<ul>
<li><code>file:///docs/api.md</code> - Your API documentation file</li>
<li><code>file:///config/settings.json</code> - Your configuration file</li>
<li><code>file:///README.txt</code> - Your project README</li>
</ul>
</li>
</ul>
<p><strong>What to verify:</strong></p>
<ul>
<li>All three resources should be listed</li>
<li>Each resource should have a descriptive name and description</li>
<li>MIME types should be correctly detected (text/markdown, application/json, text/plain)</li>
<li>URIs should follow the <code>file://</code> scheme with proper paths</li>
</ul>
<p><br></p>
<p><strong>Step 4: Test Resource Reading</strong></p>
<p>Click on each resource in the list to read its content and verify proper handling.</p>
<ul>
<li>
<p>Click on <code>file:///docs/api.md</code>:</p>
<ul>
<li>Should display: &ldquo;# API Documentation\n\nThis is the API docs.&rdquo;</li>
<li>MIME type should be: text/markdown</li>
</ul>
</li>
<li>
<p>Click on <code>file:///config/settings.json</code>:</p>
<ul>
<li>Should display: {&ldquo;version&rdquo;: &ldquo;1.0.0&rdquo;, &ldquo;env&rdquo;: &ldquo;development&rdquo;}</li>
<li>MIME type should be: application/json</li>
</ul>
</li>
<li>
<p>Click on <code>file:///README.txt</code>:</p>
<ul>
<li>Should display: &ldquo;Welcome to our project!&rdquo;</li>
<li>MIME type should be: text/plain</li>
</ul>
</li>
</ul>
<p><strong>Error Testing:</strong></p>
<ul>
<li>Try reading a non-existent resource like <code>file:///does-not-exist.txt</code></li>
<li>Should show an appropriate error message</li>
<li>Verify the server handles invalid URIs gracefully</li>
</ul>
<p><strong>What to learn:</strong></p>
<ul>
<li>Resources provide direct access to file content</li>
<li>MIME types help clients handle different content types</li>
<li>Error handling is important for robust resource servers</li>
<li>The inspector provides a complete testing environment</li>
</ul>
<hr />
<h2 id="lab04-mcp-resources-lab-implementing-dynamic-resources">Implementing Dynamic Resources<a class="headerlink" href="#lab04-mcp-resources-lab-implementing-dynamic-resources" title="Permanent link">&para;</a></h2>
<p>Dynamic resources generate content on-demand based on parameters or current state. They&rsquo;re useful for live data, computed views, and parameterized access.</p>
<h3 id="lab04-mcp-resources-lab-resource-templates">Resource Templates<a class="headerlink" href="#lab04-mcp-resources-lab-resource-templates" title="Permanent link">&para;</a></h3>
<p>Resource templates allow parameterized URIs using <code>{parameter}</code> syntax:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#lab04-mcp-resources-lab-__codelineno-11-1"></a><span class="c1">// Template definition</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#lab04-mcp-resources-lab-__codelineno-11-2"></a><span class="p">{</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#lab04-mcp-resources-lab-__codelineno-11-3"></a><span class="w">  </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://users/{userId}/profile&quot;</span><span class="p">,</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#lab04-mcp-resources-lab-__codelineno-11-4"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;User Profile&quot;</span><span class="p">,</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#lab04-mcp-resources-lab-__codelineno-11-5"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Profile data for a specific user&quot;</span><span class="p">,</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#lab04-mcp-resources-lab-__codelineno-11-6"></a><span class="w">  </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#lab04-mcp-resources-lab-__codelineno-11-7"></a><span class="p">}</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#lab04-mcp-resources-lab-__codelineno-11-8"></a>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#lab04-mcp-resources-lab-__codelineno-11-9"></a><span class="c1">// Generated URIs</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#lab04-mcp-resources-lab-__codelineno-11-10"></a><span class="s2">&quot;db://users/123/profile&quot;</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#lab04-mcp-resources-lab-__codelineno-11-11"></a><span class="s2">&quot;db://users/456/profile&quot;</span>
</span></code></pre></div>
<h3 id="lab04-mcp-resources-lab-complete-dynamic-resource-server">Complete Dynamic Resource Server<a class="headerlink" href="#lab04-mcp-resources-lab-complete-dynamic-resource-server" title="Permanent link">&para;</a></h3>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab04-mcp-resources-lab-__codelineno-12-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#lab04-mcp-resources-lab-__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#lab04-mcp-resources-lab-__codelineno-12-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#lab04-mcp-resources-lab-__codelineno-12-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#lab04-mcp-resources-lab-__codelineno-12-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#lab04-mcp-resources-lab-__codelineno-12-6"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#lab04-mcp-resources-lab-__codelineno-12-7"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#lab04-mcp-resources-lab-__codelineno-12-8"></a><span class="w">  </span><span class="nx">ListResourceTemplatesRequestSchema</span><span class="p">,</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#lab04-mcp-resources-lab-__codelineno-12-9"></a><span class="w">  </span><span class="nx">ResourceTemplate</span><span class="p">,</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#lab04-mcp-resources-lab-__codelineno-12-10"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#lab04-mcp-resources-lab-__codelineno-12-11"></a>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#lab04-mcp-resources-lab-__codelineno-12-12"></a><span class="cm">/**</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#lab04-mcp-resources-lab-__codelineno-12-13"></a><span class="cm"> * MCP Server with dynamic resources and templates</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#lab04-mcp-resources-lab-__codelineno-12-14"></a><span class="cm"> */</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#lab04-mcp-resources-lab-__codelineno-12-15"></a><span class="kd">class</span><span class="w"> </span><span class="nx">DynamicResourceServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#lab04-mcp-resources-lab-__codelineno-12-16"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#lab04-mcp-resources-lab-__codelineno-12-17"></a>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#lab04-mcp-resources-lab-__codelineno-12-18"></a><span class="w">  </span><span class="c1">// Mock data store</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#lab04-mcp-resources-lab-__codelineno-12-19"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#lab04-mcp-resources-lab-__codelineno-12-20"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Alice Johnson&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;alice@example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#lab04-mcp-resources-lab-__codelineno-12-21"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">2</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Bob Smith&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;bob@example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#lab04-mcp-resources-lab-__codelineno-12-22"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">3</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Charlie Brown&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;charlie@example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#lab04-mcp-resources-lab-__codelineno-12-23"></a><span class="w">  </span><span class="p">];</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#lab04-mcp-resources-lab-__codelineno-12-24"></a>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#lab04-mcp-resources-lab-__codelineno-12-25"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#lab04-mcp-resources-lab-__codelineno-12-26"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">999.99</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Electronics&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#lab04-mcp-resources-lab-__codelineno-12-27"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">2</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Book&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">19.99</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Education&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#lab04-mcp-resources-lab-__codelineno-12-28"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">3</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Coffee Mug&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">12.50</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Kitchen&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#lab04-mcp-resources-lab-__codelineno-12-29"></a><span class="w">  </span><span class="p">];</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#lab04-mcp-resources-lab-__codelineno-12-30"></a>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#lab04-mcp-resources-lab-__codelineno-12-31"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#lab04-mcp-resources-lab-__codelineno-12-32"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#lab04-mcp-resources-lab-__codelineno-12-33"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#lab04-mcp-resources-lab-__codelineno-12-34"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;dynamic-resource-server&quot;</span><span class="p">,</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#lab04-mcp-resources-lab-__codelineno-12-35"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#lab04-mcp-resources-lab-__codelineno-12-36"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#lab04-mcp-resources-lab-__codelineno-12-37"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#lab04-mcp-resources-lab-__codelineno-12-38"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#lab04-mcp-resources-lab-__codelineno-12-39"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#lab04-mcp-resources-lab-__codelineno-12-40"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41" href="#lab04-mcp-resources-lab-__codelineno-12-41"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42" href="#lab04-mcp-resources-lab-__codelineno-12-42"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43" href="#lab04-mcp-resources-lab-__codelineno-12-43"></a>
</span><span id="__span-12-44"><a id="__codelineno-12-44" name="__codelineno-12-44" href="#lab04-mcp-resources-lab-__codelineno-12-44"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-12-45"><a id="__codelineno-12-45" name="__codelineno-12-45" href="#lab04-mcp-resources-lab-__codelineno-12-45"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-12-46"><a id="__codelineno-12-46" name="__codelineno-12-46" href="#lab04-mcp-resources-lab-__codelineno-12-46"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-47"><a id="__codelineno-12-47" name="__codelineno-12-47" href="#lab04-mcp-resources-lab-__codelineno-12-47"></a>
</span><span id="__span-12-48"><a id="__codelineno-12-48" name="__codelineno-12-48" href="#lab04-mcp-resources-lab-__codelineno-12-48"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-49"><a id="__codelineno-12-49" name="__codelineno-12-49" href="#lab04-mcp-resources-lab-__codelineno-12-49"></a><span class="w">    </span><span class="c1">// List resource templates</span>
</span><span id="__span-12-50"><a id="__codelineno-12-50" name="__codelineno-12-50" href="#lab04-mcp-resources-lab-__codelineno-12-50"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourceTemplatesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-51"><a id="__codelineno-12-51" name="__codelineno-12-51" href="#lab04-mcp-resources-lab-__codelineno-12-51"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">templates</span><span class="o">:</span><span class="w"> </span><span class="kt">ResourceTemplate</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-12-52"><a id="__codelineno-12-52" name="__codelineno-12-52" href="#lab04-mcp-resources-lab-__codelineno-12-52"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-12-53"><a id="__codelineno-12-53" name="__codelineno-12-53" href="#lab04-mcp-resources-lab-__codelineno-12-53"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://users/{userId}/profile&quot;</span><span class="p">,</span>
</span><span id="__span-12-54"><a id="__codelineno-12-54" name="__codelineno-12-54" href="#lab04-mcp-resources-lab-__codelineno-12-54"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;User Profile&quot;</span><span class="p">,</span>
</span><span id="__span-12-55"><a id="__codelineno-12-55" name="__codelineno-12-55" href="#lab04-mcp-resources-lab-__codelineno-12-55"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Profile information for a specific user&quot;</span><span class="p">,</span>
</span><span id="__span-12-56"><a id="__codelineno-12-56" name="__codelineno-12-56" href="#lab04-mcp-resources-lab-__codelineno-12-56"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-57"><a id="__codelineno-12-57" name="__codelineno-12-57" href="#lab04-mcp-resources-lab-__codelineno-12-57"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-12-58"><a id="__codelineno-12-58" name="__codelineno-12-58" href="#lab04-mcp-resources-lab-__codelineno-12-58"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-12-59"><a id="__codelineno-12-59" name="__codelineno-12-59" href="#lab04-mcp-resources-lab-__codelineno-12-59"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://products/{productId}/details&quot;</span><span class="p">,</span>
</span><span id="__span-12-60"><a id="__codelineno-12-60" name="__codelineno-12-60" href="#lab04-mcp-resources-lab-__codelineno-12-60"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Product Details&quot;</span><span class="p">,</span>
</span><span id="__span-12-61"><a id="__codelineno-12-61" name="__codelineno-12-61" href="#lab04-mcp-resources-lab-__codelineno-12-61"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Detailed information about a product&quot;</span><span class="p">,</span>
</span><span id="__span-12-62"><a id="__codelineno-12-62" name="__codelineno-12-62" href="#lab04-mcp-resources-lab-__codelineno-12-62"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-63"><a id="__codelineno-12-63" name="__codelineno-12-63" href="#lab04-mcp-resources-lab-__codelineno-12-63"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-12-64"><a id="__codelineno-12-64" name="__codelineno-12-64" href="#lab04-mcp-resources-lab-__codelineno-12-64"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-12-65"><a id="__codelineno-12-65" name="__codelineno-12-65" href="#lab04-mcp-resources-lab-__codelineno-12-65"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://stats/{category}/summary&quot;</span><span class="p">,</span>
</span><span id="__span-12-66"><a id="__codelineno-12-66" name="__codelineno-12-66" href="#lab04-mcp-resources-lab-__codelineno-12-66"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Category Statistics&quot;</span><span class="p">,</span>
</span><span id="__span-12-67"><a id="__codelineno-12-67" name="__codelineno-12-67" href="#lab04-mcp-resources-lab-__codelineno-12-67"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Statistical summary for a product category&quot;</span><span class="p">,</span>
</span><span id="__span-12-68"><a id="__codelineno-12-68" name="__codelineno-12-68" href="#lab04-mcp-resources-lab-__codelineno-12-68"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-69"><a id="__codelineno-12-69" name="__codelineno-12-69" href="#lab04-mcp-resources-lab-__codelineno-12-69"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-12-70"><a id="__codelineno-12-70" name="__codelineno-12-70" href="#lab04-mcp-resources-lab-__codelineno-12-70"></a><span class="w">      </span><span class="p">];</span>
</span><span id="__span-12-71"><a id="__codelineno-12-71" name="__codelineno-12-71" href="#lab04-mcp-resources-lab-__codelineno-12-71"></a>
</span><span id="__span-12-72"><a id="__codelineno-12-72" name="__codelineno-12-72" href="#lab04-mcp-resources-lab-__codelineno-12-72"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resourceTemplates</span><span class="o">:</span><span class="w"> </span><span class="kt">templates</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-12-73"><a id="__codelineno-12-73" name="__codelineno-12-73" href="#lab04-mcp-resources-lab-__codelineno-12-73"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-12-74"><a id="__codelineno-12-74" name="__codelineno-12-74" href="#lab04-mcp-resources-lab-__codelineno-12-74"></a>
</span><span id="__span-12-75"><a id="__codelineno-12-75" name="__codelineno-12-75" href="#lab04-mcp-resources-lab-__codelineno-12-75"></a><span class="w">    </span><span class="c1">// List available resources (dynamic)</span>
</span><span id="__span-12-76"><a id="__codelineno-12-76" name="__codelineno-12-76" href="#lab04-mcp-resources-lab-__codelineno-12-76"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-77"><a id="__codelineno-12-77" name="__codelineno-12-77" href="#lab04-mcp-resources-lab-__codelineno-12-77"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-12-78"><a id="__codelineno-12-78" name="__codelineno-12-78" href="#lab04-mcp-resources-lab-__codelineno-12-78"></a>
</span><span id="__span-12-79"><a id="__codelineno-12-79" name="__codelineno-12-79" href="#lab04-mcp-resources-lab-__codelineno-12-79"></a><span class="w">      </span><span class="c1">// Add user resources</span>
</span><span id="__span-12-80"><a id="__codelineno-12-80" name="__codelineno-12-80" href="#lab04-mcp-resources-lab-__codelineno-12-80"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">users</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-81"><a id="__codelineno-12-81" name="__codelineno-12-81" href="#lab04-mcp-resources-lab-__codelineno-12-81"></a><span class="w">        </span><span class="nx">resources</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-12-82"><a id="__codelineno-12-82" name="__codelineno-12-82" href="#lab04-mcp-resources-lab-__codelineno-12-82"></a><span class="w">          </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://users/</span><span class="si">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">/profile`</span><span class="p">,</span>
</span><span id="__span-12-83"><a id="__codelineno-12-83" name="__codelineno-12-83" href="#lab04-mcp-resources-lab-__codelineno-12-83"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`User: </span><span class="si">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-12-84"><a id="__codelineno-12-84" name="__codelineno-12-84" href="#lab04-mcp-resources-lab-__codelineno-12-84"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Profile for </span><span class="si">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-12-85"><a id="__codelineno-12-85" name="__codelineno-12-85" href="#lab04-mcp-resources-lab-__codelineno-12-85"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-86"><a id="__codelineno-12-86" name="__codelineno-12-86" href="#lab04-mcp-resources-lab-__codelineno-12-86"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-12-87"><a id="__codelineno-12-87" name="__codelineno-12-87" href="#lab04-mcp-resources-lab-__codelineno-12-87"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-12-88"><a id="__codelineno-12-88" name="__codelineno-12-88" href="#lab04-mcp-resources-lab-__codelineno-12-88"></a>
</span><span id="__span-12-89"><a id="__codelineno-12-89" name="__codelineno-12-89" href="#lab04-mcp-resources-lab-__codelineno-12-89"></a><span class="w">      </span><span class="c1">// Add product resources</span>
</span><span id="__span-12-90"><a id="__codelineno-12-90" name="__codelineno-12-90" href="#lab04-mcp-resources-lab-__codelineno-12-90"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">products</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-91"><a id="__codelineno-12-91" name="__codelineno-12-91" href="#lab04-mcp-resources-lab-__codelineno-12-91"></a><span class="w">        </span><span class="nx">resources</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-12-92"><a id="__codelineno-12-92" name="__codelineno-12-92" href="#lab04-mcp-resources-lab-__codelineno-12-92"></a><span class="w">          </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://products/</span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">/details`</span><span class="p">,</span>
</span><span id="__span-12-93"><a id="__codelineno-12-93" name="__codelineno-12-93" href="#lab04-mcp-resources-lab-__codelineno-12-93"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`Product: </span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-12-94"><a id="__codelineno-12-94" name="__codelineno-12-94" href="#lab04-mcp-resources-lab-__codelineno-12-94"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="si">}</span><span class="sb"> - $</span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">price</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-12-95"><a id="__codelineno-12-95" name="__codelineno-12-95" href="#lab04-mcp-resources-lab-__codelineno-12-95"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-96"><a id="__codelineno-12-96" name="__codelineno-12-96" href="#lab04-mcp-resources-lab-__codelineno-12-96"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-12-97"><a id="__codelineno-12-97" name="__codelineno-12-97" href="#lab04-mcp-resources-lab-__codelineno-12-97"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-12-98"><a id="__codelineno-12-98" name="__codelineno-12-98" href="#lab04-mcp-resources-lab-__codelineno-12-98"></a>
</span><span id="__span-12-99"><a id="__codelineno-12-99" name="__codelineno-12-99" href="#lab04-mcp-resources-lab-__codelineno-12-99"></a><span class="w">      </span><span class="c1">// Add category stats</span>
</span><span id="__span-12-100"><a id="__codelineno-12-100" name="__codelineno-12-100" href="#lab04-mcp-resources-lab-__codelineno-12-100"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">categories</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="ow">new</span><span class="w"> </span><span class="nb">Set</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">category</span><span class="p">))];</span>
</span><span id="__span-12-101"><a id="__codelineno-12-101" name="__codelineno-12-101" href="#lab04-mcp-resources-lab-__codelineno-12-101"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">category</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">categories</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-102"><a id="__codelineno-12-102" name="__codelineno-12-102" href="#lab04-mcp-resources-lab-__codelineno-12-102"></a><span class="w">        </span><span class="nx">resources</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-12-103"><a id="__codelineno-12-103" name="__codelineno-12-103" href="#lab04-mcp-resources-lab-__codelineno-12-103"></a><span class="w">          </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://stats/</span><span class="si">${</span><span class="nx">category</span><span class="si">}</span><span class="sb">/summary`</span><span class="p">,</span>
</span><span id="__span-12-104"><a id="__codelineno-12-104" name="__codelineno-12-104" href="#lab04-mcp-resources-lab-__codelineno-12-104"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">category</span><span class="si">}</span><span class="sb"> Statistics`</span><span class="p">,</span>
</span><span id="__span-12-105"><a id="__codelineno-12-105" name="__codelineno-12-105" href="#lab04-mcp-resources-lab-__codelineno-12-105"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Summary statistics for </span><span class="si">${</span><span class="nx">category</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-12-106"><a id="__codelineno-12-106" name="__codelineno-12-106" href="#lab04-mcp-resources-lab-__codelineno-12-106"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-107"><a id="__codelineno-12-107" name="__codelineno-12-107" href="#lab04-mcp-resources-lab-__codelineno-12-107"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-12-108"><a id="__codelineno-12-108" name="__codelineno-12-108" href="#lab04-mcp-resources-lab-__codelineno-12-108"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-12-109"><a id="__codelineno-12-109" name="__codelineno-12-109" href="#lab04-mcp-resources-lab-__codelineno-12-109"></a>
</span><span id="__span-12-110"><a id="__codelineno-12-110" name="__codelineno-12-110" href="#lab04-mcp-resources-lab-__codelineno-12-110"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-12-111"><a id="__codelineno-12-111" name="__codelineno-12-111" href="#lab04-mcp-resources-lab-__codelineno-12-111"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-12-112"><a id="__codelineno-12-112" name="__codelineno-12-112" href="#lab04-mcp-resources-lab-__codelineno-12-112"></a>
</span><span id="__span-12-113"><a id="__codelineno-12-113" name="__codelineno-12-113" href="#lab04-mcp-resources-lab-__codelineno-12-113"></a><span class="w">    </span><span class="c1">// Read specific resource</span>
</span><span id="__span-12-114"><a id="__codelineno-12-114" name="__codelineno-12-114" href="#lab04-mcp-resources-lab-__codelineno-12-114"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-115"><a id="__codelineno-12-115" name="__codelineno-12-115" href="#lab04-mcp-resources-lab-__codelineno-12-115"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-12-116"><a id="__codelineno-12-116" name="__codelineno-12-116" href="#lab04-mcp-resources-lab-__codelineno-12-116"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateResourceContent</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-12-117"><a id="__codelineno-12-117" name="__codelineno-12-117" href="#lab04-mcp-resources-lab-__codelineno-12-117"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-12-118"><a id="__codelineno-12-118" name="__codelineno-12-118" href="#lab04-mcp-resources-lab-__codelineno-12-118"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-12-119"><a id="__codelineno-12-119" name="__codelineno-12-119" href="#lab04-mcp-resources-lab-__codelineno-12-119"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-120"><a id="__codelineno-12-120" name="__codelineno-12-120" href="#lab04-mcp-resources-lab-__codelineno-12-120"></a>
</span><span id="__span-12-121"><a id="__codelineno-12-121" name="__codelineno-12-121" href="#lab04-mcp-resources-lab-__codelineno-12-121"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">generateResourceContent</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-122"><a id="__codelineno-12-122" name="__codelineno-12-122" href="#lab04-mcp-resources-lab-__codelineno-12-122"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span><span id="__span-12-123"><a id="__codelineno-12-123" name="__codelineno-12-123" href="#lab04-mcp-resources-lab-__codelineno-12-123"></a>
</span><span id="__span-12-124"><a id="__codelineno-12-124" name="__codelineno-12-124" href="#lab04-mcp-resources-lab-__codelineno-12-124"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;db:&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-125"><a id="__codelineno-12-125" name="__codelineno-12-125" href="#lab04-mcp-resources-lab-__codelineno-12-125"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="mf">2</span><span class="p">];</span>
</span><span id="__span-12-126"><a id="__codelineno-12-126" name="__codelineno-12-126" href="#lab04-mcp-resources-lab-__codelineno-12-126"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="mf">3</span><span class="p">];</span>
</span><span id="__span-12-127"><a id="__codelineno-12-127" name="__codelineno-12-127" href="#lab04-mcp-resources-lab-__codelineno-12-127"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="mf">4</span><span class="p">];</span>
</span><span id="__span-12-128"><a id="__codelineno-12-128" name="__codelineno-12-128" href="#lab04-mcp-resources-lab-__codelineno-12-128"></a>
</span><span id="__span-12-129"><a id="__codelineno-12-129" name="__codelineno-12-129" href="#lab04-mcp-resources-lab-__codelineno-12-129"></a><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="kr">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-130"><a id="__codelineno-12-130" name="__codelineno-12-130" href="#lab04-mcp-resources-lab-__codelineno-12-130"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;users&#39;</span><span class="o">:</span>
</span><span id="__span-12-131"><a id="__codelineno-12-131" name="__codelineno-12-131" href="#lab04-mcp-resources-lab-__codelineno-12-131"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;profile&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-132"><a id="__codelineno-12-132" name="__codelineno-12-132" href="#lab04-mcp-resources-lab-__codelineno-12-132"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">u</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">u</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
</span><span id="__span-12-133"><a id="__codelineno-12-133" name="__codelineno-12-133" href="#lab04-mcp-resources-lab-__codelineno-12-133"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`User </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb"> not found`</span><span class="p">);</span>
</span><span id="__span-12-134"><a id="__codelineno-12-134" name="__codelineno-12-134" href="#lab04-mcp-resources-lab-__codelineno-12-134"></a>
</span><span id="__span-12-135"><a id="__codelineno-12-135" name="__codelineno-12-135" href="#lab04-mcp-resources-lab-__codelineno-12-135"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-136"><a id="__codelineno-12-136" name="__codelineno-12-136" href="#lab04-mcp-resources-lab-__codelineno-12-136"></a><span class="w">              </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-12-137"><a id="__codelineno-12-137" name="__codelineno-12-137" href="#lab04-mcp-resources-lab-__codelineno-12-137"></a><span class="w">              </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-138"><a id="__codelineno-12-138" name="__codelineno-12-138" href="#lab04-mcp-resources-lab-__codelineno-12-138"></a><span class="w">              </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-12-139"><a id="__codelineno-12-139" name="__codelineno-12-139" href="#lab04-mcp-resources-lab-__codelineno-12-139"></a><span class="w">                </span><span class="nx">user</span><span class="p">,</span>
</span><span id="__span-12-140"><a id="__codelineno-12-140" name="__codelineno-12-140" href="#lab04-mcp-resources-lab-__codelineno-12-140"></a><span class="w">                </span><span class="nx">metadata</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-141"><a id="__codelineno-12-141" name="__codelineno-12-141" href="#lab04-mcp-resources-lab-__codelineno-12-141"></a><span class="w">                  </span><span class="nx">lastUpdated</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-12-142"><a id="__codelineno-12-142" name="__codelineno-12-142" href="#lab04-mcp-resources-lab-__codelineno-12-142"></a><span class="w">                  </span><span class="nx">source</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;dynamic-resource-server&quot;</span>
</span><span id="__span-12-143"><a id="__codelineno-12-143" name="__codelineno-12-143" href="#lab04-mcp-resources-lab-__codelineno-12-143"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-12-144"><a id="__codelineno-12-144" name="__codelineno-12-144" href="#lab04-mcp-resources-lab-__codelineno-12-144"></a><span class="w">              </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-12-145"><a id="__codelineno-12-145" name="__codelineno-12-145" href="#lab04-mcp-resources-lab-__codelineno-12-145"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-12-146"><a id="__codelineno-12-146" name="__codelineno-12-146" href="#lab04-mcp-resources-lab-__codelineno-12-146"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-12-147"><a id="__codelineno-12-147" name="__codelineno-12-147" href="#lab04-mcp-resources-lab-__codelineno-12-147"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-12-148"><a id="__codelineno-12-148" name="__codelineno-12-148" href="#lab04-mcp-resources-lab-__codelineno-12-148"></a>
</span><span id="__span-12-149"><a id="__codelineno-12-149" name="__codelineno-12-149" href="#lab04-mcp-resources-lab-__codelineno-12-149"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;products&#39;</span><span class="o">:</span>
</span><span id="__span-12-150"><a id="__codelineno-12-150" name="__codelineno-12-150" href="#lab04-mcp-resources-lab-__codelineno-12-150"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;details&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-151"><a id="__codelineno-12-151" name="__codelineno-12-151" href="#lab04-mcp-resources-lab-__codelineno-12-151"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">products</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
</span><span id="__span-12-152"><a id="__codelineno-12-152" name="__codelineno-12-152" href="#lab04-mcp-resources-lab-__codelineno-12-152"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">product</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Product </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb"> not found`</span><span class="p">);</span>
</span><span id="__span-12-153"><a id="__codelineno-12-153" name="__codelineno-12-153" href="#lab04-mcp-resources-lab-__codelineno-12-153"></a>
</span><span id="__span-12-154"><a id="__codelineno-12-154" name="__codelineno-12-154" href="#lab04-mcp-resources-lab-__codelineno-12-154"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-155"><a id="__codelineno-12-155" name="__codelineno-12-155" href="#lab04-mcp-resources-lab-__codelineno-12-155"></a><span class="w">              </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-12-156"><a id="__codelineno-12-156" name="__codelineno-12-156" href="#lab04-mcp-resources-lab-__codelineno-12-156"></a><span class="w">              </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-157"><a id="__codelineno-12-157" name="__codelineno-12-157" href="#lab04-mcp-resources-lab-__codelineno-12-157"></a><span class="w">              </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-12-158"><a id="__codelineno-12-158" name="__codelineno-12-158" href="#lab04-mcp-resources-lab-__codelineno-12-158"></a><span class="w">                </span><span class="nx">product</span><span class="p">,</span>
</span><span id="__span-12-159"><a id="__codelineno-12-159" name="__codelineno-12-159" href="#lab04-mcp-resources-lab-__codelineno-12-159"></a><span class="w">                </span><span class="nx">metadata</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-160"><a id="__codelineno-12-160" name="__codelineno-12-160" href="#lab04-mcp-resources-lab-__codelineno-12-160"></a><span class="w">                  </span><span class="nx">lastUpdated</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-12-161"><a id="__codelineno-12-161" name="__codelineno-12-161" href="#lab04-mcp-resources-lab-__codelineno-12-161"></a><span class="w">                  </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.random</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.3</span><span class="w"> </span><span class="c1">// Simulate stock status</span>
</span><span id="__span-12-162"><a id="__codelineno-12-162" name="__codelineno-12-162" href="#lab04-mcp-resources-lab-__codelineno-12-162"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-12-163"><a id="__codelineno-12-163" name="__codelineno-12-163" href="#lab04-mcp-resources-lab-__codelineno-12-163"></a><span class="w">              </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-12-164"><a id="__codelineno-12-164" name="__codelineno-12-164" href="#lab04-mcp-resources-lab-__codelineno-12-164"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-12-165"><a id="__codelineno-12-165" name="__codelineno-12-165" href="#lab04-mcp-resources-lab-__codelineno-12-165"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-12-166"><a id="__codelineno-12-166" name="__codelineno-12-166" href="#lab04-mcp-resources-lab-__codelineno-12-166"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-12-167"><a id="__codelineno-12-167" name="__codelineno-12-167" href="#lab04-mcp-resources-lab-__codelineno-12-167"></a>
</span><span id="__span-12-168"><a id="__codelineno-12-168" name="__codelineno-12-168" href="#lab04-mcp-resources-lab-__codelineno-12-168"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;stats&#39;</span><span class="o">:</span>
</span><span id="__span-12-169"><a id="__codelineno-12-169" name="__codelineno-12-169" href="#lab04-mcp-resources-lab-__codelineno-12-169"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;summary&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-170"><a id="__codelineno-12-170" name="__codelineno-12-170" href="#lab04-mcp-resources-lab-__codelineno-12-170"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">id</span><span class="p">;</span>
</span><span id="__span-12-171"><a id="__codelineno-12-171" name="__codelineno-12-171" href="#lab04-mcp-resources-lab-__codelineno-12-171"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">categoryProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">products</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">category</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">category</span><span class="p">);</span>
</span><span id="__span-12-172"><a id="__codelineno-12-172" name="__codelineno-12-172" href="#lab04-mcp-resources-lab-__codelineno-12-172"></a>
</span><span id="__span-12-173"><a id="__codelineno-12-173" name="__codelineno-12-173" href="#lab04-mcp-resources-lab-__codelineno-12-173"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">categoryProducts</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-174"><a id="__codelineno-12-174" name="__codelineno-12-174" href="#lab04-mcp-resources-lab-__codelineno-12-174"></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Category &#39;</span><span class="si">${</span><span class="nx">category</span><span class="si">}</span><span class="sb">&#39; not found`</span><span class="p">);</span>
</span><span id="__span-12-175"><a id="__codelineno-12-175" name="__codelineno-12-175" href="#lab04-mcp-resources-lab-__codelineno-12-175"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-12-176"><a id="__codelineno-12-176" name="__codelineno-12-176" href="#lab04-mcp-resources-lab-__codelineno-12-176"></a>
</span><span id="__span-12-177"><a id="__codelineno-12-177" name="__codelineno-12-177" href="#lab04-mcp-resources-lab-__codelineno-12-177"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">stats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-178"><a id="__codelineno-12-178" name="__codelineno-12-178" href="#lab04-mcp-resources-lab-__codelineno-12-178"></a><span class="w">              </span><span class="nx">category</span><span class="p">,</span>
</span><span id="__span-12-179"><a id="__codelineno-12-179" name="__codelineno-12-179" href="#lab04-mcp-resources-lab-__codelineno-12-179"></a><span class="w">              </span><span class="nx">totalProducts</span><span class="o">:</span><span class="w"> </span><span class="kt">categoryProducts.length</span><span class="p">,</span>
</span><span id="__span-12-180"><a id="__codelineno-12-180" name="__codelineno-12-180" href="#lab04-mcp-resources-lab-__codelineno-12-180"></a><span class="w">              </span><span class="nx">averagePrice</span><span class="o">:</span><span class="w"> </span><span class="kt">categoryProducts.reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">price</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">categoryProducts</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
</span><span id="__span-12-181"><a id="__codelineno-12-181" name="__codelineno-12-181" href="#lab04-mcp-resources-lab-__codelineno-12-181"></a><span class="w">              </span><span class="nx">priceRange</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-182"><a id="__codelineno-12-182" name="__codelineno-12-182" href="#lab04-mcp-resources-lab-__codelineno-12-182"></a><span class="w">                </span><span class="nx">min</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.min</span><span class="p">(...</span><span class="nx">categoryProducts</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">price</span><span class="p">)),</span>
</span><span id="__span-12-183"><a id="__codelineno-12-183" name="__codelineno-12-183" href="#lab04-mcp-resources-lab-__codelineno-12-183"></a><span class="w">                </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.max</span><span class="p">(...</span><span class="nx">categoryProducts</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">price</span><span class="p">)),</span>
</span><span id="__span-12-184"><a id="__codelineno-12-184" name="__codelineno-12-184" href="#lab04-mcp-resources-lab-__codelineno-12-184"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-12-185"><a id="__codelineno-12-185" name="__codelineno-12-185" href="#lab04-mcp-resources-lab-__codelineno-12-185"></a><span class="w">              </span><span class="nx">generatedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-12-186"><a id="__codelineno-12-186" name="__codelineno-12-186" href="#lab04-mcp-resources-lab-__codelineno-12-186"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-12-187"><a id="__codelineno-12-187" name="__codelineno-12-187" href="#lab04-mcp-resources-lab-__codelineno-12-187"></a>
</span><span id="__span-12-188"><a id="__codelineno-12-188" name="__codelineno-12-188" href="#lab04-mcp-resources-lab-__codelineno-12-188"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-189"><a id="__codelineno-12-189" name="__codelineno-12-189" href="#lab04-mcp-resources-lab-__codelineno-12-189"></a><span class="w">              </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-12-190"><a id="__codelineno-12-190" name="__codelineno-12-190" href="#lab04-mcp-resources-lab-__codelineno-12-190"></a><span class="w">              </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-12-191"><a id="__codelineno-12-191" name="__codelineno-12-191" href="#lab04-mcp-resources-lab-__codelineno-12-191"></a><span class="w">              </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">stats</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-12-192"><a id="__codelineno-12-192" name="__codelineno-12-192" href="#lab04-mcp-resources-lab-__codelineno-12-192"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-12-193"><a id="__codelineno-12-193" name="__codelineno-12-193" href="#lab04-mcp-resources-lab-__codelineno-12-193"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-12-194"><a id="__codelineno-12-194" name="__codelineno-12-194" href="#lab04-mcp-resources-lab-__codelineno-12-194"></a><span class="w">          </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-12-195"><a id="__codelineno-12-195" name="__codelineno-12-195" href="#lab04-mcp-resources-lab-__codelineno-12-195"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-12-196"><a id="__codelineno-12-196" name="__codelineno-12-196" href="#lab04-mcp-resources-lab-__codelineno-12-196"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-197"><a id="__codelineno-12-197" name="__codelineno-12-197" href="#lab04-mcp-resources-lab-__codelineno-12-197"></a>
</span><span id="__span-12-198"><a id="__codelineno-12-198" name="__codelineno-12-198" href="#lab04-mcp-resources-lab-__codelineno-12-198"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown resource URI: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-12-199"><a id="__codelineno-12-199" name="__codelineno-12-199" href="#lab04-mcp-resources-lab-__codelineno-12-199"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-200"><a id="__codelineno-12-200" name="__codelineno-12-200" href="#lab04-mcp-resources-lab-__codelineno-12-200"></a>
</span><span id="__span-12-201"><a id="__codelineno-12-201" name="__codelineno-12-201" href="#lab04-mcp-resources-lab-__codelineno-12-201"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-202"><a id="__codelineno-12-202" name="__codelineno-12-202" href="#lab04-mcp-resources-lab-__codelineno-12-202"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-203"><a id="__codelineno-12-203" name="__codelineno-12-203" href="#lab04-mcp-resources-lab-__codelineno-12-203"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-12-204"><a id="__codelineno-12-204" name="__codelineno-12-204" href="#lab04-mcp-resources-lab-__codelineno-12-204"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-12-205"><a id="__codelineno-12-205" name="__codelineno-12-205" href="#lab04-mcp-resources-lab-__codelineno-12-205"></a>
</span><span id="__span-12-206"><a id="__codelineno-12-206" name="__codelineno-12-206" href="#lab04-mcp-resources-lab-__codelineno-12-206"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-207"><a id="__codelineno-12-207" name="__codelineno-12-207" href="#lab04-mcp-resources-lab-__codelineno-12-207"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-12-208"><a id="__codelineno-12-208" name="__codelineno-12-208" href="#lab04-mcp-resources-lab-__codelineno-12-208"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-12-209"><a id="__codelineno-12-209" name="__codelineno-12-209" href="#lab04-mcp-resources-lab-__codelineno-12-209"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-12-210"><a id="__codelineno-12-210" name="__codelineno-12-210" href="#lab04-mcp-resources-lab-__codelineno-12-210"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-211"><a id="__codelineno-12-211" name="__codelineno-12-211" href="#lab04-mcp-resources-lab-__codelineno-12-211"></a>
</span><span id="__span-12-212"><a id="__codelineno-12-212" name="__codelineno-12-212" href="#lab04-mcp-resources-lab-__codelineno-12-212"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-213"><a id="__codelineno-12-213" name="__codelineno-12-213" href="#lab04-mcp-resources-lab-__codelineno-12-213"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-12-214"><a id="__codelineno-12-214" name="__codelineno-12-214" href="#lab04-mcp-resources-lab-__codelineno-12-214"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-12-215"><a id="__codelineno-12-215" name="__codelineno-12-215" href="#lab04-mcp-resources-lab-__codelineno-12-215"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Dynamic Resource Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-12-216"><a id="__codelineno-12-216" name="__codelineno-12-216" href="#lab04-mcp-resources-lab-__codelineno-12-216"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-217"><a id="__codelineno-12-217" name="__codelineno-12-217" href="#lab04-mcp-resources-lab-__codelineno-12-217"></a><span class="p">}</span>
</span><span id="__span-12-218"><a id="__codelineno-12-218" name="__codelineno-12-218" href="#lab04-mcp-resources-lab-__codelineno-12-218"></a>
</span><span id="__span-12-219"><a id="__codelineno-12-219" name="__codelineno-12-219" href="#lab04-mcp-resources-lab-__codelineno-12-219"></a><span class="c1">// Main entry point</span>
</span><span id="__span-12-220"><a id="__codelineno-12-220" name="__codelineno-12-220" href="#lab04-mcp-resources-lab-__codelineno-12-220"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-221"><a id="__codelineno-12-221" name="__codelineno-12-221" href="#lab04-mcp-resources-lab-__codelineno-12-221"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DynamicResourceServer</span><span class="p">();</span>
</span><span id="__span-12-222"><a id="__codelineno-12-222" name="__codelineno-12-222" href="#lab04-mcp-resources-lab-__codelineno-12-222"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-12-223"><a id="__codelineno-12-223" name="__codelineno-12-223" href="#lab04-mcp-resources-lab-__codelineno-12-223"></a><span class="p">}</span>
</span><span id="__span-12-224"><a id="__codelineno-12-224" name="__codelineno-12-224" href="#lab04-mcp-resources-lab-__codelineno-12-224"></a>
</span><span id="__span-12-225"><a id="__codelineno-12-225" name="__codelineno-12-225" href="#lab04-mcp-resources-lab-__codelineno-12-225"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-226"><a id="__codelineno-12-226" name="__codelineno-12-226" href="#lab04-mcp-resources-lab-__codelineno-12-226"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-12-227"><a id="__codelineno-12-227" name="__codelineno-12-227" href="#lab04-mcp-resources-lab-__codelineno-12-227"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-12-228"><a id="__codelineno-12-228" name="__codelineno-12-228" href="#lab04-mcp-resources-lab-__codelineno-12-228"></a><span class="p">});</span>
</span></code></pre></div>
<h3 id="lab04-mcp-resources-lab-testing-dynamic-resources">Testing Dynamic Resources<a class="headerlink" href="#lab04-mcp-resources-lab-testing-dynamic-resources" title="Permanent link">&para;</a></h3>
<p><strong>Step 1: Start the Server</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab04-mcp-resources-lab-__codelineno-13-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><strong>Step 2: Test Resource Templates</strong></p>
<ul>
<li>Check that templates are listed: <code>db://users/{userId}/profile</code>, etc.</li>
</ul>
<p><strong>Step 3: Test Resource Discovery</strong></p>
<ul>
<li>Should show individual resources for users, products, and categories</li>
</ul>
<p><strong>Step 4: Test Resource Reading</strong></p>
<ul>
<li>Try <code>db://users/1/profile</code> - should return user data</li>
<li>Try <code>db://products/2/details</code> - should return product data</li>
<li>Try <code>db://stats/Electronics/summary</code> - should return category stats</li>
<li>Test invalid URIs to verify error handling</li>
</ul>
<hr />
<h2 id="lab04-mcp-resources-lab-resource-subscriptions-for-live-updates">Resource Subscriptions for Live Updates<a class="headerlink" href="#lab04-mcp-resources-lab-resource-subscriptions-for-live-updates" title="Permanent link">&para;</a></h2>
<p>Resource subscriptions enable real-time updates when resource content changes. This is essential for live data, monitoring dashboards, and collaborative environments.</p>
<h3 id="lab04-mcp-resources-lab-subscription-implementation">Subscription Implementation<a class="headerlink" href="#lab04-mcp-resources-lab-subscription-implementation" title="Permanent link">&para;</a></h3>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab04-mcp-resources-lab-__codelineno-14-1"></a><span class="c1">// Enable subscriptions in server capabilities</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#lab04-mcp-resources-lab-__codelineno-14-2"></a><span class="p">{</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#lab04-mcp-resources-lab-__codelineno-14-3"></a><span class="w">  </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#lab04-mcp-resources-lab-__codelineno-14-4"></a><span class="w">    </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#lab04-mcp-resources-lab-__codelineno-14-5"></a><span class="w">      </span><span class="nx">subscribe</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w">  </span><span class="c1">// Enable subscription support</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#lab04-mcp-resources-lab-__codelineno-14-6"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#lab04-mcp-resources-lab-__codelineno-14-7"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#lab04-mcp-resources-lab-__codelineno-14-8"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="lab04-mcp-resources-lab-complete-subscription-server">Complete Subscription Server<a class="headerlink" href="#lab04-mcp-resources-lab-complete-subscription-server" title="Permanent link">&para;</a></h3>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab04-mcp-resources-lab-__codelineno-15-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab04-mcp-resources-lab-__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#lab04-mcp-resources-lab-__codelineno-15-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#lab04-mcp-resources-lab-__codelineno-15-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#lab04-mcp-resources-lab-__codelineno-15-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#lab04-mcp-resources-lab-__codelineno-15-6"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#lab04-mcp-resources-lab-__codelineno-15-7"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#lab04-mcp-resources-lab-__codelineno-15-8"></a><span class="w">  </span><span class="nx">SubscribeRequestSchema</span><span class="p">,</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#lab04-mcp-resources-lab-__codelineno-15-9"></a><span class="w">  </span><span class="nx">UnsubscribeRequestSchema</span><span class="p">,</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#lab04-mcp-resources-lab-__codelineno-15-10"></a><span class="w">  </span><span class="nx">ResourceUpdatedNotificationSchema</span><span class="p">,</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#lab04-mcp-resources-lab-__codelineno-15-11"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#lab04-mcp-resources-lab-__codelineno-15-12"></a>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#lab04-mcp-resources-lab-__codelineno-15-13"></a><span class="cm">/**</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#lab04-mcp-resources-lab-__codelineno-15-14"></a><span class="cm"> * MCP Server with resource subscriptions for live updates</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#lab04-mcp-resources-lab-__codelineno-15-15"></a><span class="cm"> */</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#lab04-mcp-resources-lab-__codelineno-15-16"></a><span class="kd">class</span><span class="w"> </span><span class="nx">SubscriptionResourceServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#lab04-mcp-resources-lab-__codelineno-15-17"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#lab04-mcp-resources-lab-__codelineno-15-18"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">subscribers</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nb">Set</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span><span class="w"> </span><span class="c1">// uri -&gt; sessionIds</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#lab04-mcp-resources-lab-__codelineno-15-19"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">updateInterval</span><span class="o">:</span><span class="w"> </span><span class="kt">NodeJS.Timeout</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#lab04-mcp-resources-lab-__codelineno-15-20"></a>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#lab04-mcp-resources-lab-__codelineno-15-21"></a><span class="w">  </span><span class="c1">// Simulated live data</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#lab04-mcp-resources-lab-__codelineno-15-22"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#lab04-mcp-resources-lab-__codelineno-15-23"></a><span class="w">    </span><span class="nx">activeUsers</span><span class="o">:</span><span class="w"> </span><span class="kt">42</span><span class="p">,</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#lab04-mcp-resources-lab-__codelineno-15-24"></a><span class="w">    </span><span class="nx">serverLoad</span><span class="o">:</span><span class="w"> </span><span class="kt">0.65</span><span class="p">,</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#lab04-mcp-resources-lab-__codelineno-15-25"></a><span class="w">    </span><span class="nx">responseTime</span><span class="o">:</span><span class="w"> </span><span class="kt">120</span><span class="p">,</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#lab04-mcp-resources-lab-__codelineno-15-26"></a><span class="w">    </span><span class="nx">errorRate</span><span class="o">:</span><span class="w"> </span><span class="kt">0.02</span><span class="p">,</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#lab04-mcp-resources-lab-__codelineno-15-27"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#lab04-mcp-resources-lab-__codelineno-15-28"></a>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#lab04-mcp-resources-lab-__codelineno-15-29"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#lab04-mcp-resources-lab-__codelineno-15-30"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#lab04-mcp-resources-lab-__codelineno-15-31"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#lab04-mcp-resources-lab-__codelineno-15-32"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;subscription-resource-server&quot;</span><span class="p">,</span>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#lab04-mcp-resources-lab-__codelineno-15-33"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#lab04-mcp-resources-lab-__codelineno-15-34"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#lab04-mcp-resources-lab-__codelineno-15-35"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#lab04-mcp-resources-lab-__codelineno-15-36"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#lab04-mcp-resources-lab-__codelineno-15-37"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#lab04-mcp-resources-lab-__codelineno-15-38"></a><span class="w">            </span><span class="nx">subscribe</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39" href="#lab04-mcp-resources-lab-__codelineno-15-39"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40" href="#lab04-mcp-resources-lab-__codelineno-15-40"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41" href="#lab04-mcp-resources-lab-__codelineno-15-41"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42" href="#lab04-mcp-resources-lab-__codelineno-15-42"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-15-43"><a id="__codelineno-15-43" name="__codelineno-15-43" href="#lab04-mcp-resources-lab-__codelineno-15-43"></a>
</span><span id="__span-15-44"><a id="__codelineno-15-44" name="__codelineno-15-44" href="#lab04-mcp-resources-lab-__codelineno-15-44"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-15-45"><a id="__codelineno-15-45" name="__codelineno-15-45" href="#lab04-mcp-resources-lab-__codelineno-15-45"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-15-46"><a id="__codelineno-15-46" name="__codelineno-15-46" href="#lab04-mcp-resources-lab-__codelineno-15-46"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">startMetricsSimulation</span><span class="p">();</span>
</span><span id="__span-15-47"><a id="__codelineno-15-47" name="__codelineno-15-47" href="#lab04-mcp-resources-lab-__codelineno-15-47"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-48"><a id="__codelineno-15-48" name="__codelineno-15-48" href="#lab04-mcp-resources-lab-__codelineno-15-48"></a>
</span><span id="__span-15-49"><a id="__codelineno-15-49" name="__codelineno-15-49" href="#lab04-mcp-resources-lab-__codelineno-15-49"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-50"><a id="__codelineno-15-50" name="__codelineno-15-50" href="#lab04-mcp-resources-lab-__codelineno-15-50"></a><span class="w">    </span><span class="c1">// List resources</span>
</span><span id="__span-15-51"><a id="__codelineno-15-51" name="__codelineno-15-51" href="#lab04-mcp-resources-lab-__codelineno-15-51"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-52"><a id="__codelineno-15-52" name="__codelineno-15-52" href="#lab04-mcp-resources-lab-__codelineno-15-52"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-53"><a id="__codelineno-15-53" name="__codelineno-15-53" href="#lab04-mcp-resources-lab-__codelineno-15-53"></a><span class="w">        </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-15-54"><a id="__codelineno-15-54" name="__codelineno-15-54" href="#lab04-mcp-resources-lab-__codelineno-15-54"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-15-55"><a id="__codelineno-15-55" name="__codelineno-15-55" href="#lab04-mcp-resources-lab-__codelineno-15-55"></a><span class="w">            </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;metrics://server/active-users&quot;</span><span class="p">,</span>
</span><span id="__span-15-56"><a id="__codelineno-15-56" name="__codelineno-15-56" href="#lab04-mcp-resources-lab-__codelineno-15-56"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Active Users&quot;</span><span class="p">,</span>
</span><span id="__span-15-57"><a id="__codelineno-15-57" name="__codelineno-15-57" href="#lab04-mcp-resources-lab-__codelineno-15-57"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Current number of active users&quot;</span><span class="p">,</span>
</span><span id="__span-15-58"><a id="__codelineno-15-58" name="__codelineno-15-58" href="#lab04-mcp-resources-lab-__codelineno-15-58"></a><span class="w">            </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-15-59"><a id="__codelineno-15-59" name="__codelineno-15-59" href="#lab04-mcp-resources-lab-__codelineno-15-59"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-15-60"><a id="__codelineno-15-60" name="__codelineno-15-60" href="#lab04-mcp-resources-lab-__codelineno-15-60"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-15-61"><a id="__codelineno-15-61" name="__codelineno-15-61" href="#lab04-mcp-resources-lab-__codelineno-15-61"></a><span class="w">            </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;metrics://server/load&quot;</span><span class="p">,</span>
</span><span id="__span-15-62"><a id="__codelineno-15-62" name="__codelineno-15-62" href="#lab04-mcp-resources-lab-__codelineno-15-62"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Server Load&quot;</span><span class="p">,</span>
</span><span id="__span-15-63"><a id="__codelineno-15-63" name="__codelineno-15-63" href="#lab04-mcp-resources-lab-__codelineno-15-63"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Current server load percentage&quot;</span><span class="p">,</span>
</span><span id="__span-15-64"><a id="__codelineno-15-64" name="__codelineno-15-64" href="#lab04-mcp-resources-lab-__codelineno-15-64"></a><span class="w">            </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-15-65"><a id="__codelineno-15-65" name="__codelineno-15-65" href="#lab04-mcp-resources-lab-__codelineno-15-65"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-15-66"><a id="__codelineno-15-66" name="__codelineno-15-66" href="#lab04-mcp-resources-lab-__codelineno-15-66"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-15-67"><a id="__codelineno-15-67" name="__codelineno-15-67" href="#lab04-mcp-resources-lab-__codelineno-15-67"></a><span class="w">            </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;metrics://server/response-time&quot;</span><span class="p">,</span>
</span><span id="__span-15-68"><a id="__codelineno-15-68" name="__codelineno-15-68" href="#lab04-mcp-resources-lab-__codelineno-15-68"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Response Time&quot;</span><span class="p">,</span>
</span><span id="__span-15-69"><a id="__codelineno-15-69" name="__codelineno-15-69" href="#lab04-mcp-resources-lab-__codelineno-15-69"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Average response time in milliseconds&quot;</span><span class="p">,</span>
</span><span id="__span-15-70"><a id="__codelineno-15-70" name="__codelineno-15-70" href="#lab04-mcp-resources-lab-__codelineno-15-70"></a><span class="w">            </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-15-71"><a id="__codelineno-15-71" name="__codelineno-15-71" href="#lab04-mcp-resources-lab-__codelineno-15-71"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-15-72"><a id="__codelineno-15-72" name="__codelineno-15-72" href="#lab04-mcp-resources-lab-__codelineno-15-72"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-15-73"><a id="__codelineno-15-73" name="__codelineno-15-73" href="#lab04-mcp-resources-lab-__codelineno-15-73"></a><span class="w">            </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;metrics://server/error-rate&quot;</span><span class="p">,</span>
</span><span id="__span-15-74"><a id="__codelineno-15-74" name="__codelineno-15-74" href="#lab04-mcp-resources-lab-__codelineno-15-74"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Error Rate&quot;</span><span class="p">,</span>
</span><span id="__span-15-75"><a id="__codelineno-15-75" name="__codelineno-15-75" href="#lab04-mcp-resources-lab-__codelineno-15-75"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Current error rate percentage&quot;</span><span class="p">,</span>
</span><span id="__span-15-76"><a id="__codelineno-15-76" name="__codelineno-15-76" href="#lab04-mcp-resources-lab-__codelineno-15-76"></a><span class="w">            </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-15-77"><a id="__codelineno-15-77" name="__codelineno-15-77" href="#lab04-mcp-resources-lab-__codelineno-15-77"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-15-78"><a id="__codelineno-15-78" name="__codelineno-15-78" href="#lab04-mcp-resources-lab-__codelineno-15-78"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-15-79"><a id="__codelineno-15-79" name="__codelineno-15-79" href="#lab04-mcp-resources-lab-__codelineno-15-79"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-15-80"><a id="__codelineno-15-80" name="__codelineno-15-80" href="#lab04-mcp-resources-lab-__codelineno-15-80"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-15-81"><a id="__codelineno-15-81" name="__codelineno-15-81" href="#lab04-mcp-resources-lab-__codelineno-15-81"></a>
</span><span id="__span-15-82"><a id="__codelineno-15-82" name="__codelineno-15-82" href="#lab04-mcp-resources-lab-__codelineno-15-82"></a><span class="w">    </span><span class="c1">// Read resource</span>
</span><span id="__span-15-83"><a id="__codelineno-15-83" name="__codelineno-15-83" href="#lab04-mcp-resources-lab-__codelineno-15-83"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-84"><a id="__codelineno-15-84" name="__codelineno-15-84" href="#lab04-mcp-resources-lab-__codelineno-15-84"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-15-85"><a id="__codelineno-15-85" name="__codelineno-15-85" href="#lab04-mcp-resources-lab-__codelineno-15-85"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getMetricContent</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-15-86"><a id="__codelineno-15-86" name="__codelineno-15-86" href="#lab04-mcp-resources-lab-__codelineno-15-86"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-15-87"><a id="__codelineno-15-87" name="__codelineno-15-87" href="#lab04-mcp-resources-lab-__codelineno-15-87"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-15-88"><a id="__codelineno-15-88" name="__codelineno-15-88" href="#lab04-mcp-resources-lab-__codelineno-15-88"></a>
</span><span id="__span-15-89"><a id="__codelineno-15-89" name="__codelineno-15-89" href="#lab04-mcp-resources-lab-__codelineno-15-89"></a><span class="w">    </span><span class="c1">// Subscribe to resource updates</span>
</span><span id="__span-15-90"><a id="__codelineno-15-90" name="__codelineno-15-90" href="#lab04-mcp-resources-lab-__codelineno-15-90"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">SubscribeRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-91"><a id="__codelineno-15-91" name="__codelineno-15-91" href="#lab04-mcp-resources-lab-__codelineno-15-91"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-15-92"><a id="__codelineno-15-92" name="__codelineno-15-92" href="#lab04-mcp-resources-lab-__codelineno-15-92"></a>
</span><span id="__span-15-93"><a id="__codelineno-15-93" name="__codelineno-15-93" href="#lab04-mcp-resources-lab-__codelineno-15-93"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">uri</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-94"><a id="__codelineno-15-94" name="__codelineno-15-94" href="#lab04-mcp-resources-lab-__codelineno-15-94"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">uri</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Set</span><span class="p">());</span>
</span><span id="__span-15-95"><a id="__codelineno-15-95" name="__codelineno-15-95" href="#lab04-mcp-resources-lab-__codelineno-15-95"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-15-96"><a id="__codelineno-15-96" name="__codelineno-15-96" href="#lab04-mcp-resources-lab-__codelineno-15-96"></a>
</span><span id="__span-15-97"><a id="__codelineno-15-97" name="__codelineno-15-97" href="#lab04-mcp-resources-lab-__codelineno-15-97"></a><span class="w">      </span><span class="c1">// In a real implementation, you&#39;d get the session ID from the request</span>
</span><span id="__span-15-98"><a id="__codelineno-15-98" name="__codelineno-15-98" href="#lab04-mcp-resources-lab-__codelineno-15-98"></a><span class="w">      </span><span class="c1">// For this example, we&#39;ll use a mock session ID</span>
</span><span id="__span-15-99"><a id="__codelineno-15-99" name="__codelineno-15-99" href="#lab04-mcp-resources-lab-__codelineno-15-99"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">sessionId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;mock-session&quot;</span><span class="p">;</span>
</span><span id="__span-15-100"><a id="__codelineno-15-100" name="__codelineno-15-100" href="#lab04-mcp-resources-lab-__codelineno-15-100"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">uri</span><span class="p">)</span><span class="o">!</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">sessionId</span><span class="p">);</span>
</span><span id="__span-15-101"><a id="__codelineno-15-101" name="__codelineno-15-101" href="#lab04-mcp-resources-lab-__codelineno-15-101"></a>
</span><span id="__span-15-102"><a id="__codelineno-15-102" name="__codelineno-15-102" href="#lab04-mcp-resources-lab-__codelineno-15-102"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Subscribed to </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb"> (session: </span><span class="si">${</span><span class="nx">sessionId</span><span class="si">}</span><span class="sb">)`</span><span class="p">);</span>
</span><span id="__span-15-103"><a id="__codelineno-15-103" name="__codelineno-15-103" href="#lab04-mcp-resources-lab-__codelineno-15-103"></a>
</span><span id="__span-15-104"><a id="__codelineno-15-104" name="__codelineno-15-104" href="#lab04-mcp-resources-lab-__codelineno-15-104"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-15-105"><a id="__codelineno-15-105" name="__codelineno-15-105" href="#lab04-mcp-resources-lab-__codelineno-15-105"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-15-106"><a id="__codelineno-15-106" name="__codelineno-15-106" href="#lab04-mcp-resources-lab-__codelineno-15-106"></a>
</span><span id="__span-15-107"><a id="__codelineno-15-107" name="__codelineno-15-107" href="#lab04-mcp-resources-lab-__codelineno-15-107"></a><span class="w">    </span><span class="c1">// Unsubscribe from resource updates</span>
</span><span id="__span-15-108"><a id="__codelineno-15-108" name="__codelineno-15-108" href="#lab04-mcp-resources-lab-__codelineno-15-108"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">UnsubscribeRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-109"><a id="__codelineno-15-109" name="__codelineno-15-109" href="#lab04-mcp-resources-lab-__codelineno-15-109"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-15-110"><a id="__codelineno-15-110" name="__codelineno-15-110" href="#lab04-mcp-resources-lab-__codelineno-15-110"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">sessionId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;mock-session&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Would come from request in real implementation</span>
</span><span id="__span-15-111"><a id="__codelineno-15-111" name="__codelineno-15-111" href="#lab04-mcp-resources-lab-__codelineno-15-111"></a>
</span><span id="__span-15-112"><a id="__codelineno-15-112" name="__codelineno-15-112" href="#lab04-mcp-resources-lab-__codelineno-15-112"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">uri</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-113"><a id="__codelineno-15-113" name="__codelineno-15-113" href="#lab04-mcp-resources-lab-__codelineno-15-113"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">uri</span><span class="p">)</span><span class="o">!</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">sessionId</span><span class="p">);</span>
</span><span id="__span-15-114"><a id="__codelineno-15-114" name="__codelineno-15-114" href="#lab04-mcp-resources-lab-__codelineno-15-114"></a>
</span><span id="__span-15-115"><a id="__codelineno-15-115" name="__codelineno-15-115" href="#lab04-mcp-resources-lab-__codelineno-15-115"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">uri</span><span class="p">)</span><span class="o">!</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-116"><a id="__codelineno-15-116" name="__codelineno-15-116" href="#lab04-mcp-resources-lab-__codelineno-15-116"></a><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-15-117"><a id="__codelineno-15-117" name="__codelineno-15-117" href="#lab04-mcp-resources-lab-__codelineno-15-117"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-15-118"><a id="__codelineno-15-118" name="__codelineno-15-118" href="#lab04-mcp-resources-lab-__codelineno-15-118"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-15-119"><a id="__codelineno-15-119" name="__codelineno-15-119" href="#lab04-mcp-resources-lab-__codelineno-15-119"></a>
</span><span id="__span-15-120"><a id="__codelineno-15-120" name="__codelineno-15-120" href="#lab04-mcp-resources-lab-__codelineno-15-120"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Unsubscribed from </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb"> (session: </span><span class="si">${</span><span class="nx">sessionId</span><span class="si">}</span><span class="sb">)`</span><span class="p">);</span>
</span><span id="__span-15-121"><a id="__codelineno-15-121" name="__codelineno-15-121" href="#lab04-mcp-resources-lab-__codelineno-15-121"></a>
</span><span id="__span-15-122"><a id="__codelineno-15-122" name="__codelineno-15-122" href="#lab04-mcp-resources-lab-__codelineno-15-122"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-15-123"><a id="__codelineno-15-123" name="__codelineno-15-123" href="#lab04-mcp-resources-lab-__codelineno-15-123"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-15-124"><a id="__codelineno-15-124" name="__codelineno-15-124" href="#lab04-mcp-resources-lab-__codelineno-15-124"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-125"><a id="__codelineno-15-125" name="__codelineno-15-125" href="#lab04-mcp-resources-lab-__codelineno-15-125"></a>
</span><span id="__span-15-126"><a id="__codelineno-15-126" name="__codelineno-15-126" href="#lab04-mcp-resources-lab-__codelineno-15-126"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getMetricContent</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-127"><a id="__codelineno-15-127" name="__codelineno-15-127" href="#lab04-mcp-resources-lab-__codelineno-15-127"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">metricName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">).</span><span class="nx">pop</span><span class="p">();</span>
</span><span id="__span-15-128"><a id="__codelineno-15-128" name="__codelineno-15-128" href="#lab04-mcp-resources-lab-__codelineno-15-128"></a>
</span><span id="__span-15-129"><a id="__codelineno-15-129" name="__codelineno-15-129" href="#lab04-mcp-resources-lab-__codelineno-15-129"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">metricName</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="p">(</span><span class="nx">metricName</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">metrics</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-130"><a id="__codelineno-15-130" name="__codelineno-15-130" href="#lab04-mcp-resources-lab-__codelineno-15-130"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown metric: </span><span class="si">${</span><span class="nx">metricName</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-15-131"><a id="__codelineno-15-131" name="__codelineno-15-131" href="#lab04-mcp-resources-lab-__codelineno-15-131"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-132"><a id="__codelineno-15-132" name="__codelineno-15-132" href="#lab04-mcp-resources-lab-__codelineno-15-132"></a>
</span><span id="__span-15-133"><a id="__codelineno-15-133" name="__codelineno-15-133" href="#lab04-mcp-resources-lab-__codelineno-15-133"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">metrics</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">)[</span><span class="nx">metricName</span><span class="p">];</span>
</span><span id="__span-15-134"><a id="__codelineno-15-134" name="__codelineno-15-134" href="#lab04-mcp-resources-lab-__codelineno-15-134"></a>
</span><span id="__span-15-135"><a id="__codelineno-15-135" name="__codelineno-15-135" href="#lab04-mcp-resources-lab-__codelineno-15-135"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-136"><a id="__codelineno-15-136" name="__codelineno-15-136" href="#lab04-mcp-resources-lab-__codelineno-15-136"></a><span class="w">      </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-15-137"><a id="__codelineno-15-137" name="__codelineno-15-137" href="#lab04-mcp-resources-lab-__codelineno-15-137"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-15-138"><a id="__codelineno-15-138" name="__codelineno-15-138" href="#lab04-mcp-resources-lab-__codelineno-15-138"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-15-139"><a id="__codelineno-15-139" name="__codelineno-15-139" href="#lab04-mcp-resources-lab-__codelineno-15-139"></a><span class="w">        </span><span class="nx">metric</span><span class="o">:</span><span class="w"> </span><span class="kt">metricName</span><span class="p">,</span>
</span><span id="__span-15-140"><a id="__codelineno-15-140" name="__codelineno-15-140" href="#lab04-mcp-resources-lab-__codelineno-15-140"></a><span class="w">        </span><span class="nx">value</span><span class="p">,</span>
</span><span id="__span-15-141"><a id="__codelineno-15-141" name="__codelineno-15-141" href="#lab04-mcp-resources-lab-__codelineno-15-141"></a><span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-15-142"><a id="__codelineno-15-142" name="__codelineno-15-142" href="#lab04-mcp-resources-lab-__codelineno-15-142"></a><span class="w">        </span><span class="nx">unit</span><span class="o">:</span><span class="w"> </span><span class="kt">this.getMetricUnit</span><span class="p">(</span><span class="nx">metricName</span><span class="p">),</span>
</span><span id="__span-15-143"><a id="__codelineno-15-143" name="__codelineno-15-143" href="#lab04-mcp-resources-lab-__codelineno-15-143"></a><span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-15-144"><a id="__codelineno-15-144" name="__codelineno-15-144" href="#lab04-mcp-resources-lab-__codelineno-15-144"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-15-145"><a id="__codelineno-15-145" name="__codelineno-15-145" href="#lab04-mcp-resources-lab-__codelineno-15-145"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-146"><a id="__codelineno-15-146" name="__codelineno-15-146" href="#lab04-mcp-resources-lab-__codelineno-15-146"></a>
</span><span id="__span-15-147"><a id="__codelineno-15-147" name="__codelineno-15-147" href="#lab04-mcp-resources-lab-__codelineno-15-147"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getMetricUnit</span><span class="p">(</span><span class="nx">metricName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-148"><a id="__codelineno-15-148" name="__codelineno-15-148" href="#lab04-mcp-resources-lab-__codelineno-15-148"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">units</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-149"><a id="__codelineno-15-149" name="__codelineno-15-149" href="#lab04-mcp-resources-lab-__codelineno-15-149"></a><span class="w">      </span><span class="nx">activeUsers</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;users&quot;</span><span class="p">,</span>
</span><span id="__span-15-150"><a id="__codelineno-15-150" name="__codelineno-15-150" href="#lab04-mcp-resources-lab-__codelineno-15-150"></a><span class="w">      </span><span class="nx">serverLoad</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;percentage&quot;</span><span class="p">,</span>
</span><span id="__span-15-151"><a id="__codelineno-15-151" name="__codelineno-15-151" href="#lab04-mcp-resources-lab-__codelineno-15-151"></a><span class="w">      </span><span class="nx">responseTime</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;milliseconds&quot;</span><span class="p">,</span>
</span><span id="__span-15-152"><a id="__codelineno-15-152" name="__codelineno-15-152" href="#lab04-mcp-resources-lab-__codelineno-15-152"></a><span class="w">      </span><span class="nx">errorRate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;percentage&quot;</span><span class="p">,</span>
</span><span id="__span-15-153"><a id="__codelineno-15-153" name="__codelineno-15-153" href="#lab04-mcp-resources-lab-__codelineno-15-153"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-15-154"><a id="__codelineno-15-154" name="__codelineno-15-154" href="#lab04-mcp-resources-lab-__codelineno-15-154"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">units</span><span class="p">[</span><span class="nx">metricName</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;unit&quot;</span><span class="p">;</span>
</span><span id="__span-15-155"><a id="__codelineno-15-155" name="__codelineno-15-155" href="#lab04-mcp-resources-lab-__codelineno-15-155"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-156"><a id="__codelineno-15-156" name="__codelineno-15-156" href="#lab04-mcp-resources-lab-__codelineno-15-156"></a>
</span><span id="__span-15-157"><a id="__codelineno-15-157" name="__codelineno-15-157" href="#lab04-mcp-resources-lab-__codelineno-15-157"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">startMetricsSimulation</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-158"><a id="__codelineno-15-158" name="__codelineno-15-158" href="#lab04-mcp-resources-lab-__codelineno-15-158"></a><span class="w">    </span><span class="c1">// Simulate changing metrics every 5 seconds</span>
</span><span id="__span-15-159"><a id="__codelineno-15-159" name="__codelineno-15-159" href="#lab04-mcp-resources-lab-__codelineno-15-159"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">updateInterval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setInterval</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-160"><a id="__codelineno-15-160" name="__codelineno-15-160" href="#lab04-mcp-resources-lab-__codelineno-15-160"></a><span class="w">      </span><span class="c1">// Randomly update metrics</span>
</span><span id="__span-15-161"><a id="__codelineno-15-161" name="__codelineno-15-161" href="#lab04-mcp-resources-lab-__codelineno-15-161"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">activeUsers</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">10</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">5</span><span class="p">;</span>
</span><span id="__span-15-162"><a id="__codelineno-15-162" name="__codelineno-15-162" href="#lab04-mcp-resources-lab-__codelineno-15-162"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">activeUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">activeUsers</span><span class="p">);</span>
</span><span id="__span-15-163"><a id="__codelineno-15-163" name="__codelineno-15-163" href="#lab04-mcp-resources-lab-__codelineno-15-163"></a>
</span><span id="__span-15-164"><a id="__codelineno-15-164" name="__codelineno-15-164" href="#lab04-mcp-resources-lab-__codelineno-15-164"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">serverLoad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.3</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0.3 to 0.8</span>
</span><span id="__span-15-165"><a id="__codelineno-15-165" name="__codelineno-15-165" href="#lab04-mcp-resources-lab-__codelineno-15-165"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">responseTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span><span class="w"> </span><span class="c1">// 100-200ms</span>
</span><span id="__span-15-166"><a id="__codelineno-15-166" name="__codelineno-15-166" href="#lab04-mcp-resources-lab-__codelineno-15-166"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">errorRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.05</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0-5%</span>
</span><span id="__span-15-167"><a id="__codelineno-15-167" name="__codelineno-15-167" href="#lab04-mcp-resources-lab-__codelineno-15-167"></a>
</span><span id="__span-15-168"><a id="__codelineno-15-168" name="__codelineno-15-168" href="#lab04-mcp-resources-lab-__codelineno-15-168"></a><span class="w">      </span><span class="c1">// Notify subscribers of updates</span>
</span><span id="__span-15-169"><a id="__codelineno-15-169" name="__codelineno-15-169" href="#lab04-mcp-resources-lab-__codelineno-15-169"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">notifySubscribers</span><span class="p">();</span>
</span><span id="__span-15-170"><a id="__codelineno-15-170" name="__codelineno-15-170" href="#lab04-mcp-resources-lab-__codelineno-15-170"></a><span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mf">5000</span><span class="p">);</span>
</span><span id="__span-15-171"><a id="__codelineno-15-171" name="__codelineno-15-171" href="#lab04-mcp-resources-lab-__codelineno-15-171"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-172"><a id="__codelineno-15-172" name="__codelineno-15-172" href="#lab04-mcp-resources-lab-__codelineno-15-172"></a>
</span><span id="__span-15-173"><a id="__codelineno-15-173" name="__codelineno-15-173" href="#lab04-mcp-resources-lab-__codelineno-15-173"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">notifySubscribers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-174"><a id="__codelineno-15-174" name="__codelineno-15-174" href="#lab04-mcp-resources-lab-__codelineno-15-174"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">uri</span><span class="p">,</span><span class="w"> </span><span class="nx">sessionIds</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-175"><a id="__codelineno-15-175" name="__codelineno-15-175" href="#lab04-mcp-resources-lab-__codelineno-15-175"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">sessionIds</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-176"><a id="__codelineno-15-176" name="__codelineno-15-176" href="#lab04-mcp-resources-lab-__codelineno-15-176"></a><span class="w">        </span><span class="c1">// Send notification to all subscribers of this resource</span>
</span><span id="__span-15-177"><a id="__codelineno-15-177" name="__codelineno-15-177" href="#lab04-mcp-resources-lab-__codelineno-15-177"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">notification</span><span class="p">(</span><span class="nx">ResourceUpdatedNotificationSchema</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-178"><a id="__codelineno-15-178" name="__codelineno-15-178" href="#lab04-mcp-resources-lab-__codelineno-15-178"></a><span class="w">          </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-15-179"><a id="__codelineno-15-179" name="__codelineno-15-179" href="#lab04-mcp-resources-lab-__codelineno-15-179"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-15-180"><a id="__codelineno-15-180" name="__codelineno-15-180" href="#lab04-mcp-resources-lab-__codelineno-15-180"></a>
</span><span id="__span-15-181"><a id="__codelineno-15-181" name="__codelineno-15-181" href="#lab04-mcp-resources-lab-__codelineno-15-181"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Notified </span><span class="si">${</span><span class="nx">sessionIds</span><span class="p">.</span><span class="nx">size</span><span class="si">}</span><span class="sb"> subscribers of </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb"> update`</span><span class="p">);</span>
</span><span id="__span-15-182"><a id="__codelineno-15-182" name="__codelineno-15-182" href="#lab04-mcp-resources-lab-__codelineno-15-182"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-15-183"><a id="__codelineno-15-183" name="__codelineno-15-183" href="#lab04-mcp-resources-lab-__codelineno-15-183"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-184"><a id="__codelineno-15-184" name="__codelineno-15-184" href="#lab04-mcp-resources-lab-__codelineno-15-184"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-185"><a id="__codelineno-15-185" name="__codelineno-15-185" href="#lab04-mcp-resources-lab-__codelineno-15-185"></a>
</span><span id="__span-15-186"><a id="__codelineno-15-186" name="__codelineno-15-186" href="#lab04-mcp-resources-lab-__codelineno-15-186"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-187"><a id="__codelineno-15-187" name="__codelineno-15-187" href="#lab04-mcp-resources-lab-__codelineno-15-187"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-188"><a id="__codelineno-15-188" name="__codelineno-15-188" href="#lab04-mcp-resources-lab-__codelineno-15-188"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-15-189"><a id="__codelineno-15-189" name="__codelineno-15-189" href="#lab04-mcp-resources-lab-__codelineno-15-189"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-15-190"><a id="__codelineno-15-190" name="__codelineno-15-190" href="#lab04-mcp-resources-lab-__codelineno-15-190"></a>
</span><span id="__span-15-191"><a id="__codelineno-15-191" name="__codelineno-15-191" href="#lab04-mcp-resources-lab-__codelineno-15-191"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-192"><a id="__codelineno-15-192" name="__codelineno-15-192" href="#lab04-mcp-resources-lab-__codelineno-15-192"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">updateInterval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-193"><a id="__codelineno-15-193" name="__codelineno-15-193" href="#lab04-mcp-resources-lab-__codelineno-15-193"></a><span class="w">        </span><span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">updateInterval</span><span class="p">);</span>
</span><span id="__span-15-194"><a id="__codelineno-15-194" name="__codelineno-15-194" href="#lab04-mcp-resources-lab-__codelineno-15-194"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-15-195"><a id="__codelineno-15-195" name="__codelineno-15-195" href="#lab04-mcp-resources-lab-__codelineno-15-195"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-15-196"><a id="__codelineno-15-196" name="__codelineno-15-196" href="#lab04-mcp-resources-lab-__codelineno-15-196"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-15-197"><a id="__codelineno-15-197" name="__codelineno-15-197" href="#lab04-mcp-resources-lab-__codelineno-15-197"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-15-198"><a id="__codelineno-15-198" name="__codelineno-15-198" href="#lab04-mcp-resources-lab-__codelineno-15-198"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-199"><a id="__codelineno-15-199" name="__codelineno-15-199" href="#lab04-mcp-resources-lab-__codelineno-15-199"></a>
</span><span id="__span-15-200"><a id="__codelineno-15-200" name="__codelineno-15-200" href="#lab04-mcp-resources-lab-__codelineno-15-200"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-201"><a id="__codelineno-15-201" name="__codelineno-15-201" href="#lab04-mcp-resources-lab-__codelineno-15-201"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-15-202"><a id="__codelineno-15-202" name="__codelineno-15-202" href="#lab04-mcp-resources-lab-__codelineno-15-202"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-15-203"><a id="__codelineno-15-203" name="__codelineno-15-203" href="#lab04-mcp-resources-lab-__codelineno-15-203"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Subscription Resource Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-15-204"><a id="__codelineno-15-204" name="__codelineno-15-204" href="#lab04-mcp-resources-lab-__codelineno-15-204"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-205"><a id="__codelineno-15-205" name="__codelineno-15-205" href="#lab04-mcp-resources-lab-__codelineno-15-205"></a><span class="p">}</span>
</span><span id="__span-15-206"><a id="__codelineno-15-206" name="__codelineno-15-206" href="#lab04-mcp-resources-lab-__codelineno-15-206"></a>
</span><span id="__span-15-207"><a id="__codelineno-15-207" name="__codelineno-15-207" href="#lab04-mcp-resources-lab-__codelineno-15-207"></a><span class="c1">// Main entry point</span>
</span><span id="__span-15-208"><a id="__codelineno-15-208" name="__codelineno-15-208" href="#lab04-mcp-resources-lab-__codelineno-15-208"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-209"><a id="__codelineno-15-209" name="__codelineno-15-209" href="#lab04-mcp-resources-lab-__codelineno-15-209"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">SubscriptionResourceServer</span><span class="p">();</span>
</span><span id="__span-15-210"><a id="__codelineno-15-210" name="__codelineno-15-210" href="#lab04-mcp-resources-lab-__codelineno-15-210"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-15-211"><a id="__codelineno-15-211" name="__codelineno-15-211" href="#lab04-mcp-resources-lab-__codelineno-15-211"></a><span class="p">}</span>
</span><span id="__span-15-212"><a id="__codelineno-15-212" name="__codelineno-15-212" href="#lab04-mcp-resources-lab-__codelineno-15-212"></a>
</span><span id="__span-15-213"><a id="__codelineno-15-213" name="__codelineno-15-213" href="#lab04-mcp-resources-lab-__codelineno-15-213"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-214"><a id="__codelineno-15-214" name="__codelineno-15-214" href="#lab04-mcp-resources-lab-__codelineno-15-214"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-15-215"><a id="__codelineno-15-215" name="__codelineno-15-215" href="#lab04-mcp-resources-lab-__codelineno-15-215"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-15-216"><a id="__codelineno-15-216" name="__codelineno-15-216" href="#lab04-mcp-resources-lab-__codelineno-15-216"></a><span class="p">});</span>
</span></code></pre></div>
<h3 id="lab04-mcp-resources-lab-testing-subscriptions">Testing Subscriptions<a class="headerlink" href="#lab04-mcp-resources-lab-testing-subscriptions" title="Permanent link">&para;</a></h3>
<p><strong>Step 1: Start the Server</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#lab04-mcp-resources-lab-__codelineno-16-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><strong>Step 2: Test Basic Resource Reading</strong></p>
<ul>
<li>Read metrics like <code>metrics://server/active-users</code></li>
<li>Verify they return current values</li>
</ul>
<p><strong>Step 3: Test Subscriptions</strong></p>
<ul>
<li>
<p>Subscribe to a metric resource:</p>
<ul>
<li>In the MCP Inspector Resources tab, find a metric resource (e.g., <code>metrics://server/active-users</code>)</li>
<li>Click the &ldquo;Subscribe&rdquo; button next to the resource</li>
<li>You should see a confirmation that subscription was successful</li>
</ul>
</li>
<li>
<p>Watch the MCP Inspector for update notifications every 5 seconds:</p>
<ul>
<li>Keep the Resources tab open</li>
<li>Look for notification messages in the inspector interface</li>
<li>The metric values should update automatically every 5 seconds</li>
<li>You can also check the console/logs for subscription update messages</li>
</ul>
</li>
<li>
<p>Unsubscribe and verify notifications stop:</p>
<ul>
<li>Click the &ldquo;Unsubscribe&rdquo; button for the same resource</li>
<li>Confirm that update notifications cease</li>
<li>The metric values should stop updating in the interface</li>
</ul>
</li>
</ul>
<hr />
<h2 id="lab04-mcp-resources-lab-security-and-access-control">Security and Access Control<a class="headerlink" href="#lab04-mcp-resources-lab-security-and-access-control" title="Permanent link">&para;</a></h2>
<p>Resource security is critical, especially when exposing sensitive data or system information.</p>
<h3 id="lab04-mcp-resources-lab-access-control-patterns">Access Control Patterns<a class="headerlink" href="#lab04-mcp-resources-lab-access-control-patterns" title="Permanent link">&para;</a></h3>
<h4 id="lab04-mcp-resources-lab-1-path-based-authorization">1. Path-Based Authorization<a class="headerlink" href="#lab04-mcp-resources-lab-1-path-based-authorization" title="Permanent link">&para;</a></h4>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab04-mcp-resources-lab-__codelineno-17-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">checkResourceAccess</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">userId?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#lab04-mcp-resources-lab-__codelineno-17-2"></a><span class="w">  </span><span class="c1">// Allow access to own profile</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#lab04-mcp-resources-lab-__codelineno-17-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="sb">`users/</span><span class="si">${</span><span class="nx">userId</span><span class="si">}</span><span class="sb">/`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#lab04-mcp-resources-lab-__codelineno-17-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#lab04-mcp-resources-lab-__codelineno-17-5"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#lab04-mcp-resources-lab-__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#lab04-mcp-resources-lab-__codelineno-17-7"></a><span class="w">  </span><span class="c1">// Restrict admin resources</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#lab04-mcp-resources-lab-__codelineno-17-8"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isAdmin</span><span class="p">(</span><span class="nx">userId</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#lab04-mcp-resources-lab-__codelineno-17-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#lab04-mcp-resources-lab-__codelineno-17-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#lab04-mcp-resources-lab-__codelineno-17-11"></a>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#lab04-mcp-resources-lab-__codelineno-17-12"></a><span class="w">  </span><span class="c1">// Public resources</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#lab04-mcp-resources-lab-__codelineno-17-13"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;public/&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#lab04-mcp-resources-lab-__codelineno-17-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#lab04-mcp-resources-lab-__codelineno-17-15"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#lab04-mcp-resources-lab-__codelineno-17-16"></a>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#lab04-mcp-resources-lab-__codelineno-17-17"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#lab04-mcp-resources-lab-__codelineno-17-18"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>How it works:</strong> This method checks if a user has permission to access a resource based on the URI path. It grants access to user-specific resources (like their own profile), restricts admin-only resources unless the user has admin privileges, allows public resources for everyone, and denies access by default for any other paths.</p>
<p><br></p>
<h4 id="lab04-mcp-resources-lab-2-content-filtering">2. Content Filtering<a class="headerlink" href="#lab04-mcp-resources-lab-2-content-filtering" title="Permanent link">&para;</a></h4>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab04-mcp-resources-lab-__codelineno-18-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">filterSensitiveContent</span><span class="p">(</span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">,</span><span class="w"> </span><span class="nx">userRole</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#lab04-mcp-resources-lab-__codelineno-18-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">userRole</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#lab04-mcp-resources-lab-__codelineno-18-3"></a><span class="w">    </span><span class="c1">// Remove sensitive fields for non-admin users</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#lab04-mcp-resources-lab-__codelineno-18-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">password</span><span class="p">,</span><span class="w"> </span><span class="nx">ssn</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">filtered</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">content</span><span class="p">;</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#lab04-mcp-resources-lab-__codelineno-18-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filtered</span><span class="p">;</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#lab04-mcp-resources-lab-__codelineno-18-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#lab04-mcp-resources-lab-__codelineno-18-7"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">content</span><span class="p">;</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#lab04-mcp-resources-lab-__codelineno-18-8"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>How it works:</strong> This function removes sensitive information from resource content based on user roles. For non-admin users, it uses object destructuring to exclude sensitive fields like passwords and social security numbers, returning a filtered version of the data. Admin users see the complete, unfiltered content.</p>
<p><br></p>
<h4 id="lab04-mcp-resources-lab-3-rate-limiting">3. Rate Limiting<a class="headerlink" href="#lab04-mcp-resources-lab-3-rate-limiting" title="Permanent link">&para;</a></h4>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#lab04-mcp-resources-lab-__codelineno-19-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">rateLimiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">resetTime</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#lab04-mcp-resources-lab-__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#lab04-mcp-resources-lab-__codelineno-19-3"></a><span class="k">private</span><span class="w"> </span><span class="nx">checkRateLimit</span><span class="p">(</span><span class="nx">identifier</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">maxRequests</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#lab04-mcp-resources-lab-__codelineno-19-4"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#lab04-mcp-resources-lab-__codelineno-19-5"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">windowMs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">60000</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1 minute</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#lab04-mcp-resources-lab-__codelineno-19-6"></a>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#lab04-mcp-resources-lab-__codelineno-19-7"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">record</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">rateLimiter</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">identifier</span><span class="p">);</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#lab04-mcp-resources-lab-__codelineno-19-8"></a>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#lab04-mcp-resources-lab-__codelineno-19-9"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">record</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">now</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">record</span><span class="p">.</span><span class="nx">resetTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#lab04-mcp-resources-lab-__codelineno-19-10"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">rateLimiter</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">identifier</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span><span class="w"> </span><span class="nx">resetTime</span><span class="o">:</span><span class="w"> </span><span class="kt">now</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">windowMs</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#lab04-mcp-resources-lab-__codelineno-19-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#lab04-mcp-resources-lab-__codelineno-19-12"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#lab04-mcp-resources-lab-__codelineno-19-13"></a>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#lab04-mcp-resources-lab-__codelineno-19-14"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">record</span><span class="p">.</span><span class="nx">count</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">maxRequests</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#lab04-mcp-resources-lab-__codelineno-19-15"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#lab04-mcp-resources-lab-__codelineno-19-16"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#lab04-mcp-resources-lab-__codelineno-19-17"></a>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#lab04-mcp-resources-lab-__codelineno-19-18"></a><span class="w">  </span><span class="nx">record</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#lab04-mcp-resources-lab-__codelineno-19-19"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#lab04-mcp-resources-lab-__codelineno-19-20"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>How it works:</strong> This implements a sliding window rate limiter using a Map to track request counts per identifier (like user ID or IP address). It allows up to <code>maxRequests</code> (default 100) within a 1-minute window. When the limit is exceeded, it returns false to block the request. The window resets automatically after the time period expires.</p>
<hr />
<h2 id="lab04-mcp-resources-lab-combining-resources-with-tools">Combining Resources with Tools<a class="headerlink" href="#lab04-mcp-resources-lab-combining-resources-with-tools" title="Permanent link">&para;</a></h2>
<p><strong>The most powerful MCP servers combine resources and tools to provide a comprehensive functionality!</strong></p>
<h3 id="lab04-mcp-resources-lab-complete-hybrid-server">Complete Hybrid Server<a class="headerlink" href="#lab04-mcp-resources-lab-complete-hybrid-server" title="Permanent link">&para;</a></h3>
<p>The following example demonstrates a server that combines both resources and tools, showing how they work together to provide comprehensive functionality. </p>
<p>The server maintains a document store that can be both read as resources and modified through tools.</p>
<div class="language-typescript highlight"><span class="filename">Hybrid Server Class</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#lab04-mcp-resources-lab-__codelineno-20-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#lab04-mcp-resources-lab-__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#lab04-mcp-resources-lab-__codelineno-20-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#lab04-mcp-resources-lab-__codelineno-20-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#lab04-mcp-resources-lab-__codelineno-20-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#lab04-mcp-resources-lab-__codelineno-20-6"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#lab04-mcp-resources-lab-__codelineno-20-7"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#lab04-mcp-resources-lab-__codelineno-20-8"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#lab04-mcp-resources-lab-__codelineno-20-9"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#lab04-mcp-resources-lab-__codelineno-20-10"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#lab04-mcp-resources-lab-__codelineno-20-11"></a>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#lab04-mcp-resources-lab-__codelineno-20-12"></a><span class="cm">/**</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#lab04-mcp-resources-lab-__codelineno-20-13"></a><span class="cm"> * MCP Server combining resources and tools</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#lab04-mcp-resources-lab-__codelineno-20-14"></a><span class="cm"> */</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#lab04-mcp-resources-lab-__codelineno-20-15"></a><span class="kd">class</span><span class="w"> </span><span class="nx">HybridServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#lab04-mcp-resources-lab-__codelineno-20-16"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#lab04-mcp-resources-lab-__codelineno-20-17"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">documents</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#lab04-mcp-resources-lab-__codelineno-20-18"></a>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#lab04-mcp-resources-lab-__codelineno-20-19"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#lab04-mcp-resources-lab-__codelineno-20-20"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#lab04-mcp-resources-lab-__codelineno-20-21"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#lab04-mcp-resources-lab-__codelineno-20-22"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hybrid-server&quot;</span><span class="p">,</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#lab04-mcp-resources-lab-__codelineno-20-23"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#lab04-mcp-resources-lab-__codelineno-20-24"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#lab04-mcp-resources-lab-__codelineno-20-25"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#lab04-mcp-resources-lab-__codelineno-20-26"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#lab04-mcp-resources-lab-__codelineno-20-27"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span><span class="w">  </span><span class="c1">// Enable resource capabilities</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#lab04-mcp-resources-lab-__codelineno-20-28"></a><span class="w">          </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span><span class="w">      </span><span class="c1">// Enable tool capabilities</span>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#lab04-mcp-resources-lab-__codelineno-20-29"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#lab04-mcp-resources-lab-__codelineno-20-30"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#lab04-mcp-resources-lab-__codelineno-20-31"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#lab04-mcp-resources-lab-__codelineno-20-32"></a>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33" href="#lab04-mcp-resources-lab-__codelineno-20-33"></a><span class="w">    </span><span class="c1">// Initialize some sample documents</span>
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34" href="#lab04-mcp-resources-lab-__codelineno-20-34"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;doc1&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35" href="#lab04-mcp-resources-lab-__codelineno-20-35"></a><span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;doc1&quot;</span><span class="p">,</span>
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36" href="#lab04-mcp-resources-lab-__codelineno-20-36"></a><span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Getting Started Guide&quot;</span><span class="p">,</span>
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37" href="#lab04-mcp-resources-lab-__codelineno-20-37"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;This is a comprehensive guide to getting started...&quot;</span><span class="p">,</span>
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38" href="#lab04-mcp-resources-lab-__codelineno-20-38"></a><span class="w">      </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;tutorial&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;beginner&quot;</span><span class="p">],</span>
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39" href="#lab04-mcp-resources-lab-__codelineno-20-39"></a><span class="w">      </span><span class="nx">created</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40" href="#lab04-mcp-resources-lab-__codelineno-20-40"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41" href="#lab04-mcp-resources-lab-__codelineno-20-41"></a>
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42" href="#lab04-mcp-resources-lab-__codelineno-20-42"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43" href="#lab04-mcp-resources-lab-__codelineno-20-43"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-20-44"><a id="__codelineno-20-44" name="__codelineno-20-44" href="#lab04-mcp-resources-lab-__codelineno-20-44"></a><span class="w">  </span><span class="p">}</span>
</span></code></pre></div>
<p><strong>Key setup points:</strong></p>
<ul>
<li>The server declares both <code>resources: {}</code> and <code>tools: {}</code> capabilities</li>
<li>A Map is used to store documents in memory</li>
<li>Sample data is initialized to demonstrate functionality</li>
</ul>
<p><br></p>
<div class="language-typescript highlight"><span class="filename">Setup Handlers Method</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#lab04-mcp-resources-lab-__codelineno-21-1"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#lab04-mcp-resources-lab-__codelineno-21-2"></a><span class="w">    </span><span class="c1">// Resource handlers - provide read-only access to documents</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#lab04-mcp-resources-lab-__codelineno-21-3"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#lab04-mcp-resources-lab-__codelineno-21-4"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">entries</span><span class="p">()).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">doc</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#lab04-mcp-resources-lab-__codelineno-21-5"></a><span class="w">        </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`docs://documents/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#lab04-mcp-resources-lab-__codelineno-21-6"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">doc.title</span><span class="p">,</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#lab04-mcp-resources-lab-__codelineno-21-7"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Document: </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#lab04-mcp-resources-lab-__codelineno-21-8"></a><span class="w">        </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#lab04-mcp-resources-lab-__codelineno-21-9"></a><span class="w">      </span><span class="p">}));</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#lab04-mcp-resources-lab-__codelineno-21-10"></a>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#lab04-mcp-resources-lab-__codelineno-21-11"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#lab04-mcp-resources-lab-__codelineno-21-12"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#lab04-mcp-resources-lab-__codelineno-21-13"></a>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#lab04-mcp-resources-lab-__codelineno-21-14"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#lab04-mcp-resources-lab-__codelineno-21-15"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#lab04-mcp-resources-lab-__codelineno-21-16"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readDocument</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#lab04-mcp-resources-lab-__codelineno-21-17"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#lab04-mcp-resources-lab-__codelineno-21-18"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#lab04-mcp-resources-lab-__codelineno-21-19"></a>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#lab04-mcp-resources-lab-__codelineno-21-20"></a><span class="w">    </span><span class="c1">// Tool handlers - provide write operations for documents</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#lab04-mcp-resources-lab-__codelineno-21-21"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#lab04-mcp-resources-lab-__codelineno-21-22"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#lab04-mcp-resources-lab-__codelineno-21-23"></a><span class="w">        </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#lab04-mcp-resources-lab-__codelineno-21-24"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#lab04-mcp-resources-lab-__codelineno-21-25"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;create_document&quot;</span><span class="p">,</span>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#lab04-mcp-resources-lab-__codelineno-21-26"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Create a new document&quot;</span><span class="p">,</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#lab04-mcp-resources-lab-__codelineno-21-27"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#lab04-mcp-resources-lab-__codelineno-21-28"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#lab04-mcp-resources-lab-__codelineno-21-29"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#lab04-mcp-resources-lab-__codelineno-21-30"></a><span class="w">                </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-31"><a id="__codelineno-21-31" name="__codelineno-21-31" href="#lab04-mcp-resources-lab-__codelineno-21-31"></a><span class="w">                </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-32"><a id="__codelineno-21-32" name="__codelineno-21-32" href="#lab04-mcp-resources-lab-__codelineno-21-32"></a><span class="w">                </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-33"><a id="__codelineno-21-33" name="__codelineno-21-33" href="#lab04-mcp-resources-lab-__codelineno-21-33"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-21-34"><a id="__codelineno-21-34" name="__codelineno-21-34" href="#lab04-mcp-resources-lab-__codelineno-21-34"></a><span class="w">                  </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-35"><a id="__codelineno-21-35" name="__codelineno-21-35" href="#lab04-mcp-resources-lab-__codelineno-21-35"></a><span class="w">                  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
</span><span id="__span-21-36"><a id="__codelineno-21-36" name="__codelineno-21-36" href="#lab04-mcp-resources-lab-__codelineno-21-36"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-21-37"><a id="__codelineno-21-37" name="__codelineno-21-37" href="#lab04-mcp-resources-lab-__codelineno-21-37"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-21-38"><a id="__codelineno-21-38" name="__codelineno-21-38" href="#lab04-mcp-resources-lab-__codelineno-21-38"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;content&quot;</span><span class="p">],</span>
</span><span id="__span-21-39"><a id="__codelineno-21-39" name="__codelineno-21-39" href="#lab04-mcp-resources-lab-__codelineno-21-39"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-21-40"><a id="__codelineno-21-40" name="__codelineno-21-40" href="#lab04-mcp-resources-lab-__codelineno-21-40"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-21-41"><a id="__codelineno-21-41" name="__codelineno-21-41" href="#lab04-mcp-resources-lab-__codelineno-21-41"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-21-42"><a id="__codelineno-21-42" name="__codelineno-21-42" href="#lab04-mcp-resources-lab-__codelineno-21-42"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;search_documents&quot;</span><span class="p">,</span>
</span><span id="__span-21-43"><a id="__codelineno-21-43" name="__codelineno-21-43" href="#lab04-mcp-resources-lab-__codelineno-21-43"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Search documents by content or tags&quot;</span><span class="p">,</span>
</span><span id="__span-21-44"><a id="__codelineno-21-44" name="__codelineno-21-44" href="#lab04-mcp-resources-lab-__codelineno-21-44"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-45"><a id="__codelineno-21-45" name="__codelineno-21-45" href="#lab04-mcp-resources-lab-__codelineno-21-45"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-21-46"><a id="__codelineno-21-46" name="__codelineno-21-46" href="#lab04-mcp-resources-lab-__codelineno-21-46"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-47"><a id="__codelineno-21-47" name="__codelineno-21-47" href="#lab04-mcp-resources-lab-__codelineno-21-47"></a><span class="w">                </span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-48"><a id="__codelineno-21-48" name="__codelineno-21-48" href="#lab04-mcp-resources-lab-__codelineno-21-48"></a><span class="w">                </span><span class="nx">tag</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-49"><a id="__codelineno-21-49" name="__codelineno-21-49" href="#lab04-mcp-resources-lab-__codelineno-21-49"></a><span class="w">                </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">10</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-50"><a id="__codelineno-21-50" name="__codelineno-21-50" href="#lab04-mcp-resources-lab-__codelineno-21-50"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-21-51"><a id="__codelineno-21-51" name="__codelineno-21-51" href="#lab04-mcp-resources-lab-__codelineno-21-51"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-21-52"><a id="__codelineno-21-52" name="__codelineno-21-52" href="#lab04-mcp-resources-lab-__codelineno-21-52"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-21-53"><a id="__codelineno-21-53" name="__codelineno-21-53" href="#lab04-mcp-resources-lab-__codelineno-21-53"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-21-54"><a id="__codelineno-21-54" name="__codelineno-21-54" href="#lab04-mcp-resources-lab-__codelineno-21-54"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;update_document&quot;</span><span class="p">,</span>
</span><span id="__span-21-55"><a id="__codelineno-21-55" name="__codelineno-21-55" href="#lab04-mcp-resources-lab-__codelineno-21-55"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Update an existing document&quot;</span><span class="p">,</span>
</span><span id="__span-21-56"><a id="__codelineno-21-56" name="__codelineno-21-56" href="#lab04-mcp-resources-lab-__codelineno-21-56"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-57"><a id="__codelineno-21-57" name="__codelineno-21-57" href="#lab04-mcp-resources-lab-__codelineno-21-57"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-21-58"><a id="__codelineno-21-58" name="__codelineno-21-58" href="#lab04-mcp-resources-lab-__codelineno-21-58"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-59"><a id="__codelineno-21-59" name="__codelineno-21-59" href="#lab04-mcp-resources-lab-__codelineno-21-59"></a><span class="w">                </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-60"><a id="__codelineno-21-60" name="__codelineno-21-60" href="#lab04-mcp-resources-lab-__codelineno-21-60"></a><span class="w">                </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-61"><a id="__codelineno-21-61" name="__codelineno-21-61" href="#lab04-mcp-resources-lab-__codelineno-21-61"></a><span class="w">                </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-62"><a id="__codelineno-21-62" name="__codelineno-21-62" href="#lab04-mcp-resources-lab-__codelineno-21-62"></a><span class="w">                </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-63"><a id="__codelineno-21-63" name="__codelineno-21-63" href="#lab04-mcp-resources-lab-__codelineno-21-63"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-21-64"><a id="__codelineno-21-64" name="__codelineno-21-64" href="#lab04-mcp-resources-lab-__codelineno-21-64"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
</span><span id="__span-21-65"><a id="__codelineno-21-65" name="__codelineno-21-65" href="#lab04-mcp-resources-lab-__codelineno-21-65"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-21-66"><a id="__codelineno-21-66" name="__codelineno-21-66" href="#lab04-mcp-resources-lab-__codelineno-21-66"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-21-67"><a id="__codelineno-21-67" name="__codelineno-21-67" href="#lab04-mcp-resources-lab-__codelineno-21-67"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-21-68"><a id="__codelineno-21-68" name="__codelineno-21-68" href="#lab04-mcp-resources-lab-__codelineno-21-68"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-21-69"><a id="__codelineno-21-69" name="__codelineno-21-69" href="#lab04-mcp-resources-lab-__codelineno-21-69"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-21-70"><a id="__codelineno-21-70" name="__codelineno-21-70" href="#lab04-mcp-resources-lab-__codelineno-21-70"></a>
</span><span id="__span-21-71"><a id="__codelineno-21-71" name="__codelineno-21-71" href="#lab04-mcp-resources-lab-__codelineno-21-71"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">CallToolRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-72"><a id="__codelineno-21-72" name="__codelineno-21-72" href="#lab04-mcp-resources-lab-__codelineno-21-72"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-21-73"><a id="__codelineno-21-73" name="__codelineno-21-73" href="#lab04-mcp-resources-lab-__codelineno-21-73"></a>
</span><span id="__span-21-74"><a id="__codelineno-21-74" name="__codelineno-21-74" href="#lab04-mcp-resources-lab-__codelineno-21-74"></a><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-75"><a id="__codelineno-21-75" name="__codelineno-21-75" href="#lab04-mcp-resources-lab-__codelineno-21-75"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;create_document&quot;</span><span class="o">:</span>
</span><span id="__span-21-76"><a id="__codelineno-21-76" name="__codelineno-21-76" href="#lab04-mcp-resources-lab-__codelineno-21-76"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createDocument</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-21-77"><a id="__codelineno-21-77" name="__codelineno-21-77" href="#lab04-mcp-resources-lab-__codelineno-21-77"></a>
</span><span id="__span-21-78"><a id="__codelineno-21-78" name="__codelineno-21-78" href="#lab04-mcp-resources-lab-__codelineno-21-78"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;search_documents&quot;</span><span class="o">:</span>
</span><span id="__span-21-79"><a id="__codelineno-21-79" name="__codelineno-21-79" href="#lab04-mcp-resources-lab-__codelineno-21-79"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">searchDocuments</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-21-80"><a id="__codelineno-21-80" name="__codelineno-21-80" href="#lab04-mcp-resources-lab-__codelineno-21-80"></a>
</span><span id="__span-21-81"><a id="__codelineno-21-81" name="__codelineno-21-81" href="#lab04-mcp-resources-lab-__codelineno-21-81"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;update_document&quot;</span><span class="o">:</span>
</span><span id="__span-21-82"><a id="__codelineno-21-82" name="__codelineno-21-82" href="#lab04-mcp-resources-lab-__codelineno-21-82"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">updateDocument</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-21-83"><a id="__codelineno-21-83" name="__codelineno-21-83" href="#lab04-mcp-resources-lab-__codelineno-21-83"></a>
</span><span id="__span-21-84"><a id="__codelineno-21-84" name="__codelineno-21-84" href="#lab04-mcp-resources-lab-__codelineno-21-84"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-21-85"><a id="__codelineno-21-85" name="__codelineno-21-85" href="#lab04-mcp-resources-lab-__codelineno-21-85"></a><span class="w">          </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-21-86"><a id="__codelineno-21-86" name="__codelineno-21-86" href="#lab04-mcp-resources-lab-__codelineno-21-86"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-21-87"><a id="__codelineno-21-87" name="__codelineno-21-87" href="#lab04-mcp-resources-lab-__codelineno-21-87"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-21-88"><a id="__codelineno-21-88" name="__codelineno-21-88" href="#lab04-mcp-resources-lab-__codelineno-21-88"></a><span class="w">  </span><span class="p">}</span>
</span></code></pre></div>
<p><strong>Resource vs Tool handlers:</strong></p>
<ul>
<li><strong>Resources</strong> expose existing documents for reading (<code>docs://documents/{id}</code>)</li>
<li><strong>Tools</strong> provide operations to create, search, and update documents</li>
<li>Resources are passive (read-only), tools are active (perform actions)</li>
</ul>
<p><br></p>
<div class="language-typescript highlight"><span class="filename">Read Document Method</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#lab04-mcp-resources-lab-__codelineno-22-1"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">readDocument</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#lab04-mcp-resources-lab-__codelineno-22-2"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^docs:\/\/documents\/(.+)$/</span><span class="p">);</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#lab04-mcp-resources-lab-__codelineno-22-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid document URI: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#lab04-mcp-resources-lab-__codelineno-22-4"></a>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#lab04-mcp-resources-lab-__codelineno-22-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#lab04-mcp-resources-lab-__codelineno-22-6"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#lab04-mcp-resources-lab-__codelineno-22-7"></a>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#lab04-mcp-resources-lab-__codelineno-22-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">doc</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Document not found: </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#lab04-mcp-resources-lab-__codelineno-22-9"></a>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#lab04-mcp-resources-lab-__codelineno-22-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#lab04-mcp-resources-lab-__codelineno-22-11"></a><span class="w">      </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#lab04-mcp-resources-lab-__codelineno-22-12"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#lab04-mcp-resources-lab-__codelineno-22-13"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#lab04-mcp-resources-lab-__codelineno-22-14"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#lab04-mcp-resources-lab-__codelineno-22-15"></a><span class="w">  </span><span class="p">}</span>
</span></code></pre></div>
<p><strong>Resource reading:</strong> Parses the URI to extract the document ID, retrieves the document from the Map, and returns it as JSON content.</p>
<p><br></p>
<div class="language-typescript highlight"><span class="filename">Create Document Method</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#lab04-mcp-resources-lab-__codelineno-23-1"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">createDocument</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#lab04-mcp-resources-lab-__codelineno-23-2"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`doc</span><span class="si">${</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#lab04-mcp-resources-lab-__codelineno-23-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#lab04-mcp-resources-lab-__codelineno-23-4"></a><span class="w">      </span><span class="nx">id</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#lab04-mcp-resources-lab-__codelineno-23-5"></a><span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">args.title</span><span class="p">,</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#lab04-mcp-resources-lab-__codelineno-23-6"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="kt">args.content</span><span class="p">,</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#lab04-mcp-resources-lab-__codelineno-23-7"></a><span class="w">      </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="kt">args.tags</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[],</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#lab04-mcp-resources-lab-__codelineno-23-8"></a><span class="w">      </span><span class="nx">created</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#lab04-mcp-resources-lab-__codelineno-23-9"></a><span class="w">      </span><span class="nx">modified</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#lab04-mcp-resources-lab-__codelineno-23-10"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#lab04-mcp-resources-lab-__codelineno-23-11"></a>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#lab04-mcp-resources-lab-__codelineno-23-12"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">doc</span><span class="p">);</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#lab04-mcp-resources-lab-__codelineno-23-13"></a>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#lab04-mcp-resources-lab-__codelineno-23-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#lab04-mcp-resources-lab-__codelineno-23-15"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#lab04-mcp-resources-lab-__codelineno-23-16"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#lab04-mcp-resources-lab-__codelineno-23-17"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#lab04-mcp-resources-lab-__codelineno-23-18"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Document created successfully!\n\nID: </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">\nTitle: </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">\nURI: docs://documents/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#lab04-mcp-resources-lab-__codelineno-23-19"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#lab04-mcp-resources-lab-__codelineno-23-20"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#lab04-mcp-resources-lab-__codelineno-23-21"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#lab04-mcp-resources-lab-__codelineno-23-22"></a><span class="w">  </span><span class="p">}</span>
</span></code></pre></div>
<p><strong>Tool implementation:</strong> Creates a new document with a timestamp-based ID, stores it in the Map, and returns success information including the new document&rsquo;s URI.</p>
<p><br></p>
<div class="language-typescript highlight"><span class="filename">Search Documents Method</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#lab04-mcp-resources-lab-__codelineno-24-1"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">searchDocuments</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#lab04-mcp-resources-lab-__codelineno-24-2"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">values</span><span class="p">());</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#lab04-mcp-resources-lab-__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#lab04-mcp-resources-lab-__codelineno-24-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">query</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#lab04-mcp-resources-lab-__codelineno-24-5"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#lab04-mcp-resources-lab-__codelineno-24-6"></a><span class="w">      </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">results</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">doc</span><span class="w"> </span><span class="p">=&gt;</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#lab04-mcp-resources-lab-__codelineno-24-7"></a><span class="w">        </span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#lab04-mcp-resources-lab-__codelineno-24-8"></a><span class="w">        </span><span class="nx">doc</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#lab04-mcp-resources-lab-__codelineno-24-9"></a><span class="w">      </span><span class="p">);</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#lab04-mcp-resources-lab-__codelineno-24-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#lab04-mcp-resources-lab-__codelineno-24-11"></a>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#lab04-mcp-resources-lab-__codelineno-24-12"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">tag</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#lab04-mcp-resources-lab-__codelineno-24-13"></a><span class="w">      </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">results</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">doc</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">tags</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">tag</span><span class="p">));</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#lab04-mcp-resources-lab-__codelineno-24-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#lab04-mcp-resources-lab-__codelineno-24-15"></a>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#lab04-mcp-resources-lab-__codelineno-24-16"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">limit</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#lab04-mcp-resources-lab-__codelineno-24-17"></a><span class="w">    </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">results</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">limit</span><span class="p">);</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#lab04-mcp-resources-lab-__codelineno-24-18"></a>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#lab04-mcp-resources-lab-__codelineno-24-19"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">results</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">doc</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#lab04-mcp-resources-lab-__codelineno-24-20"></a><span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">doc.id</span><span class="p">,</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#lab04-mcp-resources-lab-__codelineno-24-21"></a><span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">doc.title</span><span class="p">,</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#lab04-mcp-resources-lab-__codelineno-24-22"></a><span class="w">      </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="kt">doc.tags</span><span class="p">,</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#lab04-mcp-resources-lab-__codelineno-24-23"></a><span class="w">      </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`docs://documents/</span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#lab04-mcp-resources-lab-__codelineno-24-24"></a><span class="w">    </span><span class="p">}));</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#lab04-mcp-resources-lab-__codelineno-24-25"></a>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#lab04-mcp-resources-lab-__codelineno-24-26"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#lab04-mcp-resources-lab-__codelineno-24-27"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#lab04-mcp-resources-lab-__codelineno-24-28"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29" href="#lab04-mcp-resources-lab-__codelineno-24-29"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30" href="#lab04-mcp-resources-lab-__codelineno-24-30"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Found </span><span class="si">${</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb"> documents:\n\n</span><span class="si">${</span><span class="nx">formatted</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">doc</span><span class="w"> </span><span class="p">=&gt;</span>
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31" href="#lab04-mcp-resources-lab-__codelineno-24-31"></a><span class="w">            </span><span class="sb">`📄 </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb"> (</span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">tags</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">)\n   URI: </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32" href="#lab04-mcp-resources-lab-__codelineno-24-32"></a><span class="w">          </span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n\n&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33" href="#lab04-mcp-resources-lab-__codelineno-24-33"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34" href="#lab04-mcp-resources-lab-__codelineno-24-34"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35" href="#lab04-mcp-resources-lab-__codelineno-24-35"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36" href="#lab04-mcp-resources-lab-__codelineno-24-36"></a><span class="w">  </span><span class="p">}</span>
</span></code></pre></div>
<p><strong>Search tool:</strong> Filters documents by query string or tag, limits results, and returns formatted text output with document URIs for easy access.</p>
<p><br></p>
<div class="language-typescript highlight"><span class="filename">Update Document Method</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#lab04-mcp-resources-lab-__codelineno-25-1"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">updateDocument</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#lab04-mcp-resources-lab-__codelineno-25-2"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#lab04-mcp-resources-lab-__codelineno-25-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">doc</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Document not found: </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#lab04-mcp-resources-lab-__codelineno-25-4"></a>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#lab04-mcp-resources-lab-__codelineno-25-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#lab04-mcp-resources-lab-__codelineno-25-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">content</span><span class="p">)</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#lab04-mcp-resources-lab-__codelineno-25-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">tags</span><span class="p">)</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">tags</span><span class="p">;</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#lab04-mcp-resources-lab-__codelineno-25-8"></a><span class="w">    </span><span class="nx">doc</span><span class="p">.</span><span class="nx">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">();</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#lab04-mcp-resources-lab-__codelineno-25-9"></a>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#lab04-mcp-resources-lab-__codelineno-25-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#lab04-mcp-resources-lab-__codelineno-25-11"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#lab04-mcp-resources-lab-__codelineno-25-12"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#lab04-mcp-resources-lab-__codelineno-25-13"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#lab04-mcp-resources-lab-__codelineno-25-14"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Document updated successfully!\n\nID: </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">\nTitle: </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">\nModified: </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">modified</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#lab04-mcp-resources-lab-__codelineno-25-15"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#lab04-mcp-resources-lab-__codelineno-25-16"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#lab04-mcp-resources-lab-__codelineno-25-17"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#lab04-mcp-resources-lab-__codelineno-25-18"></a><span class="w">  </span><span class="p">}</span>
</span></code></pre></div>
<p><strong>Update tool:</strong> Modifies existing document fields and updates the modification timestamp, providing feedback about the changes made.</p>
<p><br></p>
<p><strong>How resources and tools complement each other:</strong></p>
<ul>
<li><strong>Resources</strong> provide passive access: LLMs can read documents at <code>docs://documents/{id}</code></li>
<li><strong>Tools</strong> enable active operations: LLMs can create, search, and update documents</li>
<li><strong>Integration</strong>: Tools can reference resources in their responses (e.g., &ldquo;Read the new document at docs://documents/123&rdquo;)</li>
<li><strong>Workflow</strong>: Create documents with tools, then read them as resources for context</li>
</ul>
<hr />
<h2 id="lab04-mcp-resources-lab-hands-on-exercises">Hands-On Exercises<a class="headerlink" href="#lab04-mcp-resources-lab-hands-on-exercises" title="Permanent link">&para;</a></h2>
<h3 id="lab04-mcp-resources-lab-exercise-1-file-system-resource-server">Exercise 1: File System Resource Server<a class="headerlink" href="#lab04-mcp-resources-lab-exercise-1-file-system-resource-server" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Exposes a directory as MCP resources</li>
<li>Supports different file types (text, JSON, Markdown)</li>
<li>Implements proper security (no directory traversal)</li>
<li>Includes file metadata (size, modified date)</li>
</ul>
<details>
<summary>💡 Solution: File System Resource Server</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#lab04-mcp-resources-lab-__codelineno-26-1"></a><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#lab04-mcp-resources-lab-__codelineno-26-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;create_file_resource_server&quot;</span><span class="p">,</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#lab04-mcp-resources-lab-__codelineno-26-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Create an MCP server that exposes a directory as resources&quot;</span><span class="p">,</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#lab04-mcp-resources-lab-__codelineno-26-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#lab04-mcp-resources-lab-__codelineno-26-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#lab04-mcp-resources-lab-__codelineno-26-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#lab04-mcp-resources-lab-__codelineno-26-7"></a><span class="w">      </span><span class="nx">directory</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#lab04-mcp-resources-lab-__codelineno-26-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#lab04-mcp-resources-lab-__codelineno-26-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Directory path to expose as resources&quot;</span><span class="p">,</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#lab04-mcp-resources-lab-__codelineno-26-10"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;./files&quot;</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#lab04-mcp-resources-lab-__codelineno-26-11"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#lab04-mcp-resources-lab-__codelineno-26-12"></a><span class="w">      </span><span class="nx">allowedExtensions</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#lab04-mcp-resources-lab-__codelineno-26-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#lab04-mcp-resources-lab-__codelineno-26-14"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;File extensions to include&quot;</span><span class="p">,</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#lab04-mcp-resources-lab-__codelineno-26-15"></a><span class="w">        </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#lab04-mcp-resources-lab-__codelineno-26-16"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;.md&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.yaml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.yml&quot;</span><span class="p">]</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#lab04-mcp-resources-lab-__codelineno-26-17"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#lab04-mcp-resources-lab-__codelineno-26-18"></a><span class="w">      </span><span class="nx">maxFileSize</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#lab04-mcp-resources-lab-__codelineno-26-19"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#lab04-mcp-resources-lab-__codelineno-26-20"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum file size in bytes&quot;</span><span class="p">,</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#lab04-mcp-resources-lab-__codelineno-26-21"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">1048576</span>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#lab04-mcp-resources-lab-__codelineno-26-22"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#lab04-mcp-resources-lab-__codelineno-26-23"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#lab04-mcp-resources-lab-__codelineno-26-24"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;directory&quot;</span><span class="p">]</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#lab04-mcp-resources-lab-__codelineno-26-25"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#lab04-mcp-resources-lab-__codelineno-26-26"></a><span class="p">}</span>
</span></code></pre></div>

Implementation:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#lab04-mcp-resources-lab-__codelineno-27-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#lab04-mcp-resources-lab-__codelineno-27-2"></a>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#lab04-mcp-resources-lab-__codelineno-27-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#lab04-mcp-resources-lab-__codelineno-27-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#lab04-mcp-resources-lab-__codelineno-27-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#lab04-mcp-resources-lab-__codelineno-27-6"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#lab04-mcp-resources-lab-__codelineno-27-7"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#lab04-mcp-resources-lab-__codelineno-27-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#lab04-mcp-resources-lab-__codelineno-27-9"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs/promises&#39;</span><span class="p">;</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#lab04-mcp-resources-lab-__codelineno-27-10"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;path&#39;</span><span class="p">;</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#lab04-mcp-resources-lab-__codelineno-27-11"></a>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#lab04-mcp-resources-lab-__codelineno-27-12"></a><span class="kd">class</span><span class="w"> </span><span class="nx">FileSystemResourceServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#lab04-mcp-resources-lab-__codelineno-27-13"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#lab04-mcp-resources-lab-__codelineno-27-14"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">rootDir</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#lab04-mcp-resources-lab-__codelineno-27-15"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">allowedExtensions</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#lab04-mcp-resources-lab-__codelineno-27-16"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">maxFileSize</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#lab04-mcp-resources-lab-__codelineno-27-17"></a>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#lab04-mcp-resources-lab-__codelineno-27-18"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">rootDir</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./files&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">allowedExtensions</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;.md&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.json&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.yaml&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.yml&#39;</span><span class="p">],</span><span class="w"> </span><span class="nx">maxFileSize</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1048576</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#lab04-mcp-resources-lab-__codelineno-27-19"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">rootDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">rootDir</span><span class="p">);</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#lab04-mcp-resources-lab-__codelineno-27-20"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">allowedExtensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">allowedExtensions</span><span class="p">;</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#lab04-mcp-resources-lab-__codelineno-27-21"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">maxFileSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">maxFileSize</span><span class="p">;</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#lab04-mcp-resources-lab-__codelineno-27-22"></a>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#lab04-mcp-resources-lab-__codelineno-27-23"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24" href="#lab04-mcp-resources-lab-__codelineno-27-24"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-27-25"><a id="__codelineno-27-25" name="__codelineno-27-25" href="#lab04-mcp-resources-lab-__codelineno-27-25"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;filesystem-resource-server&quot;</span><span class="p">,</span>
</span><span id="__span-27-26"><a id="__codelineno-27-26" name="__codelineno-27-26" href="#lab04-mcp-resources-lab-__codelineno-27-26"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-27-27"><a id="__codelineno-27-27" name="__codelineno-27-27" href="#lab04-mcp-resources-lab-__codelineno-27-27"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-27-28"><a id="__codelineno-27-28" name="__codelineno-27-28" href="#lab04-mcp-resources-lab-__codelineno-27-28"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-27-29"><a id="__codelineno-27-29" name="__codelineno-27-29" href="#lab04-mcp-resources-lab-__codelineno-27-29"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-30"><a id="__codelineno-27-30" name="__codelineno-27-30" href="#lab04-mcp-resources-lab-__codelineno-27-30"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-27-31"><a id="__codelineno-27-31" name="__codelineno-27-31" href="#lab04-mcp-resources-lab-__codelineno-27-31"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-27-32"><a id="__codelineno-27-32" name="__codelineno-27-32" href="#lab04-mcp-resources-lab-__codelineno-27-32"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-27-33"><a id="__codelineno-27-33" name="__codelineno-27-33" href="#lab04-mcp-resources-lab-__codelineno-27-33"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-27-34"><a id="__codelineno-27-34" name="__codelineno-27-34" href="#lab04-mcp-resources-lab-__codelineno-27-34"></a>
</span><span id="__span-27-35"><a id="__codelineno-27-35" name="__codelineno-27-35" href="#lab04-mcp-resources-lab-__codelineno-27-35"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-27-36"><a id="__codelineno-27-36" name="__codelineno-27-36" href="#lab04-mcp-resources-lab-__codelineno-27-36"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-27-37"><a id="__codelineno-27-37" name="__codelineno-27-37" href="#lab04-mcp-resources-lab-__codelineno-27-37"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-38"><a id="__codelineno-27-38" name="__codelineno-27-38" href="#lab04-mcp-resources-lab-__codelineno-27-38"></a>
</span><span id="__span-27-39"><a id="__codelineno-27-39" name="__codelineno-27-39" href="#lab04-mcp-resources-lab-__codelineno-27-39"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-40"><a id="__codelineno-27-40" name="__codelineno-27-40" href="#lab04-mcp-resources-lab-__codelineno-27-40"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-41"><a id="__codelineno-27-41" name="__codelineno-27-41" href="#lab04-mcp-resources-lab-__codelineno-27-41"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">discoverFiles</span><span class="p">();</span>
</span><span id="__span-27-42"><a id="__codelineno-27-42" name="__codelineno-27-42" href="#lab04-mcp-resources-lab-__codelineno-27-42"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-27-43"><a id="__codelineno-27-43" name="__codelineno-27-43" href="#lab04-mcp-resources-lab-__codelineno-27-43"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-27-44"><a id="__codelineno-27-44" name="__codelineno-27-44" href="#lab04-mcp-resources-lab-__codelineno-27-44"></a>
</span><span id="__span-27-45"><a id="__codelineno-27-45" name="__codelineno-27-45" href="#lab04-mcp-resources-lab-__codelineno-27-45"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-46"><a id="__codelineno-27-46" name="__codelineno-27-46" href="#lab04-mcp-resources-lab-__codelineno-27-46"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-27-47"><a id="__codelineno-27-47" name="__codelineno-27-47" href="#lab04-mcp-resources-lab-__codelineno-27-47"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-27-48"><a id="__codelineno-27-48" name="__codelineno-27-48" href="#lab04-mcp-resources-lab-__codelineno-27-48"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-27-49"><a id="__codelineno-27-49" name="__codelineno-27-49" href="#lab04-mcp-resources-lab-__codelineno-27-49"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-27-50"><a id="__codelineno-27-50" name="__codelineno-27-50" href="#lab04-mcp-resources-lab-__codelineno-27-50"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-51"><a id="__codelineno-27-51" name="__codelineno-27-51" href="#lab04-mcp-resources-lab-__codelineno-27-51"></a>
</span><span id="__span-27-52"><a id="__codelineno-27-52" name="__codelineno-27-52" href="#lab04-mcp-resources-lab-__codelineno-27-52"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">discoverFiles</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-53"><a id="__codelineno-27-53" name="__codelineno-27-53" href="#lab04-mcp-resources-lab-__codelineno-27-53"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-27-54"><a id="__codelineno-27-54" name="__codelineno-27-54" href="#lab04-mcp-resources-lab-__codelineno-27-54"></a>
</span><span id="__span-27-55"><a id="__codelineno-27-55" name="__codelineno-27-55" href="#lab04-mcp-resources-lab-__codelineno-27-55"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-56"><a id="__codelineno-27-56" name="__codelineno-27-56" href="#lab04-mcp-resources-lab-__codelineno-27-56"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">walkDirectory</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rootDir</span><span class="p">);</span>
</span><span id="__span-27-57"><a id="__codelineno-27-57" name="__codelineno-27-57" href="#lab04-mcp-resources-lab-__codelineno-27-57"></a>
</span><span id="__span-27-58"><a id="__codelineno-27-58" name="__codelineno-27-58" href="#lab04-mcp-resources-lab-__codelineno-27-58"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">files</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-59"><a id="__codelineno-27-59" name="__codelineno-27-59" href="#lab04-mcp-resources-lab-__codelineno-27-59"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">relativePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">relative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rootDir</span><span class="p">,</span><span class="w"> </span><span class="nx">file</span><span class="p">);</span>
</span><span id="__span-27-60"><a id="__codelineno-27-60" name="__codelineno-27-60" href="#lab04-mcp-resources-lab-__codelineno-27-60"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`file:///</span><span class="si">${</span><span class="nx">relativePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-27-61"><a id="__codelineno-27-61" name="__codelineno-27-61" href="#lab04-mcp-resources-lab-__codelineno-27-61"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">stats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
</span><span id="__span-27-62"><a id="__codelineno-27-62" name="__codelineno-27-62" href="#lab04-mcp-resources-lab-__codelineno-27-62"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">mimeType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getMimeType</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
</span><span id="__span-27-63"><a id="__codelineno-27-63" name="__codelineno-27-63" href="#lab04-mcp-resources-lab-__codelineno-27-63"></a>
</span><span id="__span-27-64"><a id="__codelineno-27-64" name="__codelineno-27-64" href="#lab04-mcp-resources-lab-__codelineno-27-64"></a><span class="w">        </span><span class="nx">resources</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-27-65"><a id="__codelineno-27-65" name="__codelineno-27-65" href="#lab04-mcp-resources-lab-__codelineno-27-65"></a><span class="w">          </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-27-66"><a id="__codelineno-27-66" name="__codelineno-27-66" href="#lab04-mcp-resources-lab-__codelineno-27-66"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">path.basename</span><span class="p">(</span><span class="nx">file</span><span class="p">),</span>
</span><span id="__span-27-67"><a id="__codelineno-27-67" name="__codelineno-27-67" href="#lab04-mcp-resources-lab-__codelineno-27-67"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`File: </span><span class="si">${</span><span class="nx">relativePath</span><span class="si">}</span><span class="sb"> (</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">formatFileSize</span><span class="p">(</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="p">)</span><span class="si">}</span><span class="sb">)`</span><span class="p">,</span>
</span><span id="__span-27-68"><a id="__codelineno-27-68" name="__codelineno-27-68" href="#lab04-mcp-resources-lab-__codelineno-27-68"></a><span class="w">          </span><span class="nx">mimeType</span><span class="p">,</span>
</span><span id="__span-27-69"><a id="__codelineno-27-69" name="__codelineno-27-69" href="#lab04-mcp-resources-lab-__codelineno-27-69"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-27-70"><a id="__codelineno-27-70" name="__codelineno-27-70" href="#lab04-mcp-resources-lab-__codelineno-27-70"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-27-71"><a id="__codelineno-27-71" name="__codelineno-27-71" href="#lab04-mcp-resources-lab-__codelineno-27-71"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-72"><a id="__codelineno-27-72" name="__codelineno-27-72" href="#lab04-mcp-resources-lab-__codelineno-27-72"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error discovering files:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-27-73"><a id="__codelineno-27-73" name="__codelineno-27-73" href="#lab04-mcp-resources-lab-__codelineno-27-73"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-74"><a id="__codelineno-27-74" name="__codelineno-27-74" href="#lab04-mcp-resources-lab-__codelineno-27-74"></a>
</span><span id="__span-27-75"><a id="__codelineno-27-75" name="__codelineno-27-75" href="#lab04-mcp-resources-lab-__codelineno-27-75"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">resources</span><span class="p">;</span>
</span><span id="__span-27-76"><a id="__codelineno-27-76" name="__codelineno-27-76" href="#lab04-mcp-resources-lab-__codelineno-27-76"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-77"><a id="__codelineno-27-77" name="__codelineno-27-77" href="#lab04-mcp-resources-lab-__codelineno-27-77"></a>
</span><span id="__span-27-78"><a id="__codelineno-27-78" name="__codelineno-27-78" href="#lab04-mcp-resources-lab-__codelineno-27-78"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">readFile</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-79"><a id="__codelineno-27-79" name="__codelineno-27-79" href="#lab04-mcp-resources-lab-__codelineno-27-79"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">uri</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;file:///&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-80"><a id="__codelineno-27-80" name="__codelineno-27-80" href="#lab04-mcp-resources-lab-__codelineno-27-80"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid URI format: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-27-81"><a id="__codelineno-27-81" name="__codelineno-27-81" href="#lab04-mcp-resources-lab-__codelineno-27-81"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-82"><a id="__codelineno-27-82" name="__codelineno-27-82" href="#lab04-mcp-resources-lab-__codelineno-27-82"></a>
</span><span id="__span-27-83"><a id="__codelineno-27-83" name="__codelineno-27-83" href="#lab04-mcp-resources-lab-__codelineno-27-83"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">relativePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;file:///&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span id="__span-27-84"><a id="__codelineno-27-84" name="__codelineno-27-84" href="#lab04-mcp-resources-lab-__codelineno-27-84"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rootDir</span><span class="p">,</span><span class="w"> </span><span class="nx">relativePath</span><span class="p">);</span>
</span><span id="__span-27-85"><a id="__codelineno-27-85" name="__codelineno-27-85" href="#lab04-mcp-resources-lab-__codelineno-27-85"></a>
</span><span id="__span-27-86"><a id="__codelineno-27-86" name="__codelineno-27-86" href="#lab04-mcp-resources-lab-__codelineno-27-86"></a><span class="w">    </span><span class="c1">// Security: Prevent directory traversal</span>
</span><span id="__span-27-87"><a id="__codelineno-27-87" name="__codelineno-27-87" href="#lab04-mcp-resources-lab-__codelineno-27-87"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">resolvedPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
</span><span id="__span-27-88"><a id="__codelineno-27-88" name="__codelineno-27-88" href="#lab04-mcp-resources-lab-__codelineno-27-88"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">resolvedPath</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rootDir</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-89"><a id="__codelineno-27-89" name="__codelineno-27-89" href="#lab04-mcp-resources-lab-__codelineno-27-89"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Access denied: path outside allowed directory&#39;</span><span class="p">);</span>
</span><span id="__span-27-90"><a id="__codelineno-27-90" name="__codelineno-27-90" href="#lab04-mcp-resources-lab-__codelineno-27-90"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-91"><a id="__codelineno-27-91" name="__codelineno-27-91" href="#lab04-mcp-resources-lab-__codelineno-27-91"></a>
</span><span id="__span-27-92"><a id="__codelineno-27-92" name="__codelineno-27-92" href="#lab04-mcp-resources-lab-__codelineno-27-92"></a><span class="w">    </span><span class="c1">// Check if file extension is allowed</span>
</span><span id="__span-27-93"><a id="__codelineno-27-93" name="__codelineno-27-93" href="#lab04-mcp-resources-lab-__codelineno-27-93"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">filePath</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span id="__span-27-94"><a id="__codelineno-27-94" name="__codelineno-27-94" href="#lab04-mcp-resources-lab-__codelineno-27-94"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedExtensions</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">ext</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-95"><a id="__codelineno-27-95" name="__codelineno-27-95" href="#lab04-mcp-resources-lab-__codelineno-27-95"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`File type not allowed: </span><span class="si">${</span><span class="nx">ext</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-27-96"><a id="__codelineno-27-96" name="__codelineno-27-96" href="#lab04-mcp-resources-lab-__codelineno-27-96"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-97"><a id="__codelineno-27-97" name="__codelineno-27-97" href="#lab04-mcp-resources-lab-__codelineno-27-97"></a>
</span><span id="__span-27-98"><a id="__codelineno-27-98" name="__codelineno-27-98" href="#lab04-mcp-resources-lab-__codelineno-27-98"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-99"><a id="__codelineno-27-99" name="__codelineno-27-99" href="#lab04-mcp-resources-lab-__codelineno-27-99"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">stats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
</span><span id="__span-27-100"><a id="__codelineno-27-100" name="__codelineno-27-100" href="#lab04-mcp-resources-lab-__codelineno-27-100"></a>
</span><span id="__span-27-101"><a id="__codelineno-27-101" name="__codelineno-27-101" href="#lab04-mcp-resources-lab-__codelineno-27-101"></a><span class="w">      </span><span class="c1">// Check file size</span>
</span><span id="__span-27-102"><a id="__codelineno-27-102" name="__codelineno-27-102" href="#lab04-mcp-resources-lab-__codelineno-27-102"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">maxFileSize</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-103"><a id="__codelineno-27-103" name="__codelineno-27-103" href="#lab04-mcp-resources-lab-__codelineno-27-103"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`File too large: </span><span class="si">${</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="si">}</span><span class="sb"> bytes (max: </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">maxFileSize</span><span class="si">}</span><span class="sb">)`</span><span class="p">);</span>
</span><span id="__span-27-104"><a id="__codelineno-27-104" name="__codelineno-27-104" href="#lab04-mcp-resources-lab-__codelineno-27-104"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-27-105"><a id="__codelineno-27-105" name="__codelineno-27-105" href="#lab04-mcp-resources-lab-__codelineno-27-105"></a>
</span><span id="__span-27-106"><a id="__codelineno-27-106" name="__codelineno-27-106" href="#lab04-mcp-resources-lab-__codelineno-27-106"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span>
</span><span id="__span-27-107"><a id="__codelineno-27-107" name="__codelineno-27-107" href="#lab04-mcp-resources-lab-__codelineno-27-107"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">mimeType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getMimeType</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
</span><span id="__span-27-108"><a id="__codelineno-27-108" name="__codelineno-27-108" href="#lab04-mcp-resources-lab-__codelineno-27-108"></a>
</span><span id="__span-27-109"><a id="__codelineno-27-109" name="__codelineno-27-109" href="#lab04-mcp-resources-lab-__codelineno-27-109"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-110"><a id="__codelineno-27-110" name="__codelineno-27-110" href="#lab04-mcp-resources-lab-__codelineno-27-110"></a><span class="w">        </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-27-111"><a id="__codelineno-27-111" name="__codelineno-27-111" href="#lab04-mcp-resources-lab-__codelineno-27-111"></a><span class="w">        </span><span class="nx">mimeType</span><span class="p">,</span>
</span><span id="__span-27-112"><a id="__codelineno-27-112" name="__codelineno-27-112" href="#lab04-mcp-resources-lab-__codelineno-27-112"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">content</span><span class="p">,</span>
</span><span id="__span-27-113"><a id="__codelineno-27-113" name="__codelineno-27-113" href="#lab04-mcp-resources-lab-__codelineno-27-113"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-27-114"><a id="__codelineno-27-114" name="__codelineno-27-114" href="#lab04-mcp-resources-lab-__codelineno-27-114"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-115"><a id="__codelineno-27-115" name="__codelineno-27-115" href="#lab04-mcp-resources-lab-__codelineno-27-115"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Failed to read file: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-27-116"><a id="__codelineno-27-116" name="__codelineno-27-116" href="#lab04-mcp-resources-lab-__codelineno-27-116"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-117"><a id="__codelineno-27-117" name="__codelineno-27-117" href="#lab04-mcp-resources-lab-__codelineno-27-117"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-118"><a id="__codelineno-27-118" name="__codelineno-27-118" href="#lab04-mcp-resources-lab-__codelineno-27-118"></a>
</span><span id="__span-27-119"><a id="__codelineno-27-119" name="__codelineno-27-119" href="#lab04-mcp-resources-lab-__codelineno-27-119"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">walkDirectory</span><span class="p">(</span><span class="nx">dir</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-120"><a id="__codelineno-27-120" name="__codelineno-27-120" href="#lab04-mcp-resources-lab-__codelineno-27-120"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">files</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-27-121"><a id="__codelineno-27-121" name="__codelineno-27-121" href="#lab04-mcp-resources-lab-__codelineno-27-121"></a>
</span><span id="__span-27-122"><a id="__codelineno-27-122" name="__codelineno-27-122" href="#lab04-mcp-resources-lab-__codelineno-27-122"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-123"><a id="__codelineno-27-123" name="__codelineno-27-123" href="#lab04-mcp-resources-lab-__codelineno-27-123"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">entries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readdir</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">withFileTypes</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-27-124"><a id="__codelineno-27-124" name="__codelineno-27-124" href="#lab04-mcp-resources-lab-__codelineno-27-124"></a>
</span><span id="__span-27-125"><a id="__codelineno-27-125" name="__codelineno-27-125" href="#lab04-mcp-resources-lab-__codelineno-27-125"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">entries</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-126"><a id="__codelineno-27-126" name="__codelineno-27-126" href="#lab04-mcp-resources-lab-__codelineno-27-126"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">fullPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span><span id="__span-27-127"><a id="__codelineno-27-127" name="__codelineno-27-127" href="#lab04-mcp-resources-lab-__codelineno-27-127"></a>
</span><span id="__span-27-128"><a id="__codelineno-27-128" name="__codelineno-27-128" href="#lab04-mcp-resources-lab-__codelineno-27-128"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">isDirectory</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-129"><a id="__codelineno-27-129" name="__codelineno-27-129" href="#lab04-mcp-resources-lab-__codelineno-27-129"></a><span class="w">          </span><span class="c1">// Skip hidden directories</span>
</span><span id="__span-27-130"><a id="__codelineno-27-130" name="__codelineno-27-130" href="#lab04-mcp-resources-lab-__codelineno-27-130"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-131"><a id="__codelineno-27-131" name="__codelineno-27-131" href="#lab04-mcp-resources-lab-__codelineno-27-131"></a><span class="w">            </span><span class="nx">files</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">walkDirectory</span><span class="p">(</span><span class="nx">fullPath</span><span class="p">));</span>
</span><span id="__span-27-132"><a id="__codelineno-27-132" name="__codelineno-27-132" href="#lab04-mcp-resources-lab-__codelineno-27-132"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-27-133"><a id="__codelineno-27-133" name="__codelineno-27-133" href="#lab04-mcp-resources-lab-__codelineno-27-133"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">isFile</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-134"><a id="__codelineno-27-134" name="__codelineno-27-134" href="#lab04-mcp-resources-lab-__codelineno-27-134"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span id="__span-27-135"><a id="__codelineno-27-135" name="__codelineno-27-135" href="#lab04-mcp-resources-lab-__codelineno-27-135"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedExtensions</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">ext</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-136"><a id="__codelineno-27-136" name="__codelineno-27-136" href="#lab04-mcp-resources-lab-__codelineno-27-136"></a><span class="w">            </span><span class="nx">files</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fullPath</span><span class="p">);</span>
</span><span id="__span-27-137"><a id="__codelineno-27-137" name="__codelineno-27-137" href="#lab04-mcp-resources-lab-__codelineno-27-137"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-27-138"><a id="__codelineno-27-138" name="__codelineno-27-138" href="#lab04-mcp-resources-lab-__codelineno-27-138"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-27-139"><a id="__codelineno-27-139" name="__codelineno-27-139" href="#lab04-mcp-resources-lab-__codelineno-27-139"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-27-140"><a id="__codelineno-27-140" name="__codelineno-27-140" href="#lab04-mcp-resources-lab-__codelineno-27-140"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-141"><a id="__codelineno-27-141" name="__codelineno-27-141" href="#lab04-mcp-resources-lab-__codelineno-27-141"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Error walking directory </span><span class="si">${</span><span class="nx">dir</span><span class="si">}</span><span class="sb">:`</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-27-142"><a id="__codelineno-27-142" name="__codelineno-27-142" href="#lab04-mcp-resources-lab-__codelineno-27-142"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-143"><a id="__codelineno-27-143" name="__codelineno-27-143" href="#lab04-mcp-resources-lab-__codelineno-27-143"></a>
</span><span id="__span-27-144"><a id="__codelineno-27-144" name="__codelineno-27-144" href="#lab04-mcp-resources-lab-__codelineno-27-144"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">files</span><span class="p">;</span>
</span><span id="__span-27-145"><a id="__codelineno-27-145" name="__codelineno-27-145" href="#lab04-mcp-resources-lab-__codelineno-27-145"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-146"><a id="__codelineno-27-146" name="__codelineno-27-146" href="#lab04-mcp-resources-lab-__codelineno-27-146"></a>
</span><span id="__span-27-147"><a id="__codelineno-27-147" name="__codelineno-27-147" href="#lab04-mcp-resources-lab-__codelineno-27-147"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getMimeType</span><span class="p">(</span><span class="nx">filePath</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-148"><a id="__codelineno-27-148" name="__codelineno-27-148" href="#lab04-mcp-resources-lab-__codelineno-27-148"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">filePath</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span id="__span-27-149"><a id="__codelineno-27-149" name="__codelineno-27-149" href="#lab04-mcp-resources-lab-__codelineno-27-149"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mimeTypes</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-150"><a id="__codelineno-27-150" name="__codelineno-27-150" href="#lab04-mcp-resources-lab-__codelineno-27-150"></a><span class="w">      </span><span class="s1">&#39;.md&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text/markdown&#39;</span><span class="p">,</span>
</span><span id="__span-27-151"><a id="__codelineno-27-151" name="__codelineno-27-151" href="#lab04-mcp-resources-lab-__codelineno-27-151"></a><span class="w">      </span><span class="s1">&#39;.txt&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span>
</span><span id="__span-27-152"><a id="__codelineno-27-152" name="__codelineno-27-152" href="#lab04-mcp-resources-lab-__codelineno-27-152"></a><span class="w">      </span><span class="s1">&#39;.json&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
</span><span id="__span-27-153"><a id="__codelineno-27-153" name="__codelineno-27-153" href="#lab04-mcp-resources-lab-__codelineno-27-153"></a><span class="w">      </span><span class="s1">&#39;.yaml&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/yaml&#39;</span><span class="p">,</span>
</span><span id="__span-27-154"><a id="__codelineno-27-154" name="__codelineno-27-154" href="#lab04-mcp-resources-lab-__codelineno-27-154"></a><span class="w">      </span><span class="s1">&#39;.yml&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/yaml&#39;</span><span class="p">,</span>
</span><span id="__span-27-155"><a id="__codelineno-27-155" name="__codelineno-27-155" href="#lab04-mcp-resources-lab-__codelineno-27-155"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-27-156"><a id="__codelineno-27-156" name="__codelineno-27-156" href="#lab04-mcp-resources-lab-__codelineno-27-156"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">mimeTypes</span><span class="p">[</span><span class="nx">ext</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;text/plain&#39;</span><span class="p">;</span>
</span><span id="__span-27-157"><a id="__codelineno-27-157" name="__codelineno-27-157" href="#lab04-mcp-resources-lab-__codelineno-27-157"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-158"><a id="__codelineno-27-158" name="__codelineno-27-158" href="#lab04-mcp-resources-lab-__codelineno-27-158"></a>
</span><span id="__span-27-159"><a id="__codelineno-27-159" name="__codelineno-27-159" href="#lab04-mcp-resources-lab-__codelineno-27-159"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">formatFileSize</span><span class="p">(</span><span class="nx">bytes</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-160"><a id="__codelineno-27-160" name="__codelineno-27-160" href="#lab04-mcp-resources-lab-__codelineno-27-160"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;KB&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MB&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GB&#39;</span><span class="p">];</span>
</span><span id="__span-27-161"><a id="__codelineno-27-161" name="__codelineno-27-161" href="#lab04-mcp-resources-lab-__codelineno-27-161"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bytes</span><span class="p">;</span>
</span><span id="__span-27-162"><a id="__codelineno-27-162" name="__codelineno-27-162" href="#lab04-mcp-resources-lab-__codelineno-27-162"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">unitIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-27-163"><a id="__codelineno-27-163" name="__codelineno-27-163" href="#lab04-mcp-resources-lab-__codelineno-27-163"></a>
</span><span id="__span-27-164"><a id="__codelineno-27-164" name="__codelineno-27-164" href="#lab04-mcp-resources-lab-__codelineno-27-164"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">size</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1024</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">unitIndex</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">units</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-165"><a id="__codelineno-27-165" name="__codelineno-27-165" href="#lab04-mcp-resources-lab-__codelineno-27-165"></a><span class="w">      </span><span class="nx">size</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mf">1024</span><span class="p">;</span>
</span><span id="__span-27-166"><a id="__codelineno-27-166" name="__codelineno-27-166" href="#lab04-mcp-resources-lab-__codelineno-27-166"></a><span class="w">      </span><span class="nx">unitIndex</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-27-167"><a id="__codelineno-27-167" name="__codelineno-27-167" href="#lab04-mcp-resources-lab-__codelineno-27-167"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-168"><a id="__codelineno-27-168" name="__codelineno-27-168" href="#lab04-mcp-resources-lab-__codelineno-27-168"></a>
</span><span id="__span-27-169"><a id="__codelineno-27-169" name="__codelineno-27-169" href="#lab04-mcp-resources-lab-__codelineno-27-169"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">size</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="si">}</span><span class="sb"> </span><span class="si">${</span><span class="nx">units</span><span class="p">[</span><span class="nx">unitIndex</span><span class="p">]</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-27-170"><a id="__codelineno-27-170" name="__codelineno-27-170" href="#lab04-mcp-resources-lab-__codelineno-27-170"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-171"><a id="__codelineno-27-171" name="__codelineno-27-171" href="#lab04-mcp-resources-lab-__codelineno-27-171"></a>
</span><span id="__span-27-172"><a id="__codelineno-27-172" name="__codelineno-27-172" href="#lab04-mcp-resources-lab-__codelineno-27-172"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-173"><a id="__codelineno-27-173" name="__codelineno-27-173" href="#lab04-mcp-resources-lab-__codelineno-27-173"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-174"><a id="__codelineno-27-174" name="__codelineno-27-174" href="#lab04-mcp-resources-lab-__codelineno-27-174"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-27-175"><a id="__codelineno-27-175" name="__codelineno-27-175" href="#lab04-mcp-resources-lab-__codelineno-27-175"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-27-176"><a id="__codelineno-27-176" name="__codelineno-27-176" href="#lab04-mcp-resources-lab-__codelineno-27-176"></a>
</span><span id="__span-27-177"><a id="__codelineno-27-177" name="__codelineno-27-177" href="#lab04-mcp-resources-lab-__codelineno-27-177"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-178"><a id="__codelineno-27-178" name="__codelineno-27-178" href="#lab04-mcp-resources-lab-__codelineno-27-178"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-27-179"><a id="__codelineno-27-179" name="__codelineno-27-179" href="#lab04-mcp-resources-lab-__codelineno-27-179"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-27-180"><a id="__codelineno-27-180" name="__codelineno-27-180" href="#lab04-mcp-resources-lab-__codelineno-27-180"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-27-181"><a id="__codelineno-27-181" name="__codelineno-27-181" href="#lab04-mcp-resources-lab-__codelineno-27-181"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-182"><a id="__codelineno-27-182" name="__codelineno-27-182" href="#lab04-mcp-resources-lab-__codelineno-27-182"></a>
</span><span id="__span-27-183"><a id="__codelineno-27-183" name="__codelineno-27-183" href="#lab04-mcp-resources-lab-__codelineno-27-183"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-184"><a id="__codelineno-27-184" name="__codelineno-27-184" href="#lab04-mcp-resources-lab-__codelineno-27-184"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-27-185"><a id="__codelineno-27-185" name="__codelineno-27-185" href="#lab04-mcp-resources-lab-__codelineno-27-185"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-27-186"><a id="__codelineno-27-186" name="__codelineno-27-186" href="#lab04-mcp-resources-lab-__codelineno-27-186"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`File System Resource Server running (root: </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">rootDir</span><span class="si">}</span><span class="sb">)`</span><span class="p">);</span>
</span><span id="__span-27-187"><a id="__codelineno-27-187" name="__codelineno-27-187" href="#lab04-mcp-resources-lab-__codelineno-27-187"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-188"><a id="__codelineno-27-188" name="__codelineno-27-188" href="#lab04-mcp-resources-lab-__codelineno-27-188"></a><span class="p">}</span>
</span><span id="__span-27-189"><a id="__codelineno-27-189" name="__codelineno-27-189" href="#lab04-mcp-resources-lab-__codelineno-27-189"></a>
</span><span id="__span-27-190"><a id="__codelineno-27-190" name="__codelineno-27-190" href="#lab04-mcp-resources-lab-__codelineno-27-190"></a><span class="c1">// Main entry point</span>
</span><span id="__span-27-191"><a id="__codelineno-27-191" name="__codelineno-27-191" href="#lab04-mcp-resources-lab-__codelineno-27-191"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-192"><a id="__codelineno-27-192" name="__codelineno-27-192" href="#lab04-mcp-resources-lab-__codelineno-27-192"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">FileSystemResourceServer</span><span class="p">();</span>
</span><span id="__span-27-193"><a id="__codelineno-27-193" name="__codelineno-27-193" href="#lab04-mcp-resources-lab-__codelineno-27-193"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-27-194"><a id="__codelineno-27-194" name="__codelineno-27-194" href="#lab04-mcp-resources-lab-__codelineno-27-194"></a><span class="p">}</span>
</span><span id="__span-27-195"><a id="__codelineno-27-195" name="__codelineno-27-195" href="#lab04-mcp-resources-lab-__codelineno-27-195"></a>
</span><span id="__span-27-196"><a id="__codelineno-27-196" name="__codelineno-27-196" href="#lab04-mcp-resources-lab-__codelineno-27-196"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-197"><a id="__codelineno-27-197" name="__codelineno-27-197" href="#lab04-mcp-resources-lab-__codelineno-27-197"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-27-198"><a id="__codelineno-27-198" name="__codelineno-27-198" href="#lab04-mcp-resources-lab-__codelineno-27-198"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-27-199"><a id="__codelineno-27-199" name="__codelineno-27-199" href="#lab04-mcp-resources-lab-__codelineno-27-199"></a><span class="p">});</span>
</span></code></pre></div>

Testing - Create test files and test the server:

<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#lab04-mcp-resources-lab-__codelineno-28-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>files/docs<span class="w"> </span>files/data
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#lab04-mcp-resources-lab-__codelineno-28-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;# API Documentation&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>files/docs/api.md
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#lab04-mcp-resources-lab-__codelineno-28-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;version&quot;: &quot;1.0.0&quot;}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>files/data/config.json
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#lab04-mcp-resources-lab-__codelineno-28-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Simple text file&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>files/docs/notes.txt
</span></code></pre></div>

Test with MCP Inspector to verify file discovery and reading.

</details>

<h3 id="lab04-mcp-resources-lab-exercise-2-rest-api-resource-server">Exercise 2: REST API Resource Server<a class="headerlink" href="#lab04-mcp-resources-lab-exercise-2-rest-api-resource-server" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Exposes REST API endpoints as resources</li>
<li>Supports query parameters in URIs</li>
<li>Handles authentication and rate limiting</li>
<li>Caches responses appropriately</li>
</ul>
<details>
<summary>💡 Solution: REST API Resource Server</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#lab04-mcp-resources-lab-__codelineno-29-1"></a><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#lab04-mcp-resources-lab-__codelineno-29-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;create_api_resource_server&quot;</span><span class="p">,</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#lab04-mcp-resources-lab-__codelineno-29-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Create an MCP server that exposes REST API endpoints as resources&quot;</span><span class="p">,</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#lab04-mcp-resources-lab-__codelineno-29-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#lab04-mcp-resources-lab-__codelineno-29-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#lab04-mcp-resources-lab-__codelineno-29-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#lab04-mcp-resources-lab-__codelineno-29-7"></a><span class="w">      </span><span class="nx">baseUrl</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#lab04-mcp-resources-lab-__codelineno-29-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#lab04-mcp-resources-lab-__codelineno-29-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Base URL of the API to expose&quot;</span><span class="p">,</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#lab04-mcp-resources-lab-__codelineno-29-10"></a><span class="w">        </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;uri&quot;</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#lab04-mcp-resources-lab-__codelineno-29-11"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#lab04-mcp-resources-lab-__codelineno-29-12"></a><span class="w">      </span><span class="nx">apiKey</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#lab04-mcp-resources-lab-__codelineno-29-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#lab04-mcp-resources-lab-__codelineno-29-14"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;API key for authentication&quot;</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#lab04-mcp-resources-lab-__codelineno-29-15"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#lab04-mcp-resources-lab-__codelineno-29-16"></a><span class="w">      </span><span class="nx">cacheEnabled</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#lab04-mcp-resources-lab-__codelineno-29-17"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#lab04-mcp-resources-lab-__codelineno-29-18"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Enable response caching&quot;</span><span class="p">,</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#lab04-mcp-resources-lab-__codelineno-29-19"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#lab04-mcp-resources-lab-__codelineno-29-20"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21" href="#lab04-mcp-resources-lab-__codelineno-29-21"></a><span class="w">      </span><span class="nx">cacheTTL</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22" href="#lab04-mcp-resources-lab-__codelineno-29-22"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23" href="#lab04-mcp-resources-lab-__codelineno-29-23"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Cache TTL in seconds&quot;</span><span class="p">,</span>
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24" href="#lab04-mcp-resources-lab-__codelineno-29-24"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">300</span>
</span><span id="__span-29-25"><a id="__codelineno-29-25" name="__codelineno-29-25" href="#lab04-mcp-resources-lab-__codelineno-29-25"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-29-26"><a id="__codelineno-29-26" name="__codelineno-29-26" href="#lab04-mcp-resources-lab-__codelineno-29-26"></a><span class="w">      </span><span class="nx">rateLimit</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-27"><a id="__codelineno-29-27" name="__codelineno-29-27" href="#lab04-mcp-resources-lab-__codelineno-29-27"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-29-28"><a id="__codelineno-29-28" name="__codelineno-29-28" href="#lab04-mcp-resources-lab-__codelineno-29-28"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Requests per minute limit&quot;</span><span class="p">,</span>
</span><span id="__span-29-29"><a id="__codelineno-29-29" name="__codelineno-29-29" href="#lab04-mcp-resources-lab-__codelineno-29-29"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">60</span>
</span><span id="__span-29-30"><a id="__codelineno-29-30" name="__codelineno-29-30" href="#lab04-mcp-resources-lab-__codelineno-29-30"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-29-31"><a id="__codelineno-29-31" name="__codelineno-29-31" href="#lab04-mcp-resources-lab-__codelineno-29-31"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-29-32"><a id="__codelineno-29-32" name="__codelineno-29-32" href="#lab04-mcp-resources-lab-__codelineno-29-32"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;baseUrl&quot;</span><span class="p">]</span>
</span><span id="__span-29-33"><a id="__codelineno-29-33" name="__codelineno-29-33" href="#lab04-mcp-resources-lab-__codelineno-29-33"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-29-34"><a id="__codelineno-29-34" name="__codelineno-29-34" href="#lab04-mcp-resources-lab-__codelineno-29-34"></a><span class="p">}</span>
</span></code></pre></div>

Implementation

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#lab04-mcp-resources-lab-__codelineno-30-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#lab04-mcp-resources-lab-__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#lab04-mcp-resources-lab-__codelineno-30-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#lab04-mcp-resources-lab-__codelineno-30-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#lab04-mcp-resources-lab-__codelineno-30-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#lab04-mcp-resources-lab-__codelineno-30-6"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#lab04-mcp-resources-lab-__codelineno-30-7"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#lab04-mcp-resources-lab-__codelineno-30-8"></a><span class="w">  </span><span class="nx">ListResourceTemplatesRequestSchema</span><span class="p">,</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#lab04-mcp-resources-lab-__codelineno-30-9"></a><span class="w">  </span><span class="nx">ResourceTemplate</span><span class="p">,</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#lab04-mcp-resources-lab-__codelineno-30-10"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#lab04-mcp-resources-lab-__codelineno-30-11"></a><span class="k">import</span><span class="w"> </span><span class="nx">axios</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">AxiosResponse</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;axios&#39;</span><span class="p">;</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#lab04-mcp-resources-lab-__codelineno-30-12"></a>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#lab04-mcp-resources-lab-__codelineno-30-13"></a><span class="kd">interface</span><span class="w"> </span><span class="nx">CacheEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#lab04-mcp-resources-lab-__codelineno-30-14"></a><span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#lab04-mcp-resources-lab-__codelineno-30-15"></a><span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#lab04-mcp-resources-lab-__codelineno-30-16"></a><span class="w">  </span><span class="nx">ttl</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#lab04-mcp-resources-lab-__codelineno-30-17"></a><span class="p">}</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#lab04-mcp-resources-lab-__codelineno-30-18"></a>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#lab04-mcp-resources-lab-__codelineno-30-19"></a><span class="kd">class</span><span class="w"> </span><span class="nx">APIResourceServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#lab04-mcp-resources-lab-__codelineno-30-20"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#lab04-mcp-resources-lab-__codelineno-30-21"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">baseUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#lab04-mcp-resources-lab-__codelineno-30-22"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">apiKey?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#lab04-mcp-resources-lab-__codelineno-30-23"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cache</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">CacheEntry</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#lab04-mcp-resources-lab-__codelineno-30-24"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cacheEnabled</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#lab04-mcp-resources-lab-__codelineno-30-25"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cacheTTL</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#lab04-mcp-resources-lab-__codelineno-30-26"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">rateLimit</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27" href="#lab04-mcp-resources-lab-__codelineno-30-27"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">requestCounts</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">resetTime</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28" href="#lab04-mcp-resources-lab-__codelineno-30-28"></a>
</span><span id="__span-30-29"><a id="__codelineno-30-29" name="__codelineno-30-29" href="#lab04-mcp-resources-lab-__codelineno-30-29"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">baseUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">apiKey?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">cacheEnabled</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">cacheTTL</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">300</span><span class="p">,</span><span class="w"> </span><span class="nx">rateLimit</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">60</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-30"><a id="__codelineno-30-30" name="__codelineno-30-30" href="#lab04-mcp-resources-lab-__codelineno-30-30"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">baseUrl</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\/$/</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Remove trailing slash</span>
</span><span id="__span-30-31"><a id="__codelineno-30-31" name="__codelineno-30-31" href="#lab04-mcp-resources-lab-__codelineno-30-31"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">apiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">apiKey</span><span class="p">;</span>
</span><span id="__span-30-32"><a id="__codelineno-30-32" name="__codelineno-30-32" href="#lab04-mcp-resources-lab-__codelineno-30-32"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">cacheEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cacheEnabled</span><span class="p">;</span>
</span><span id="__span-30-33"><a id="__codelineno-30-33" name="__codelineno-30-33" href="#lab04-mcp-resources-lab-__codelineno-30-33"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">cacheTTL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cacheTTL</span><span class="p">;</span>
</span><span id="__span-30-34"><a id="__codelineno-30-34" name="__codelineno-30-34" href="#lab04-mcp-resources-lab-__codelineno-30-34"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">rateLimit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rateLimit</span><span class="p">;</span>
</span><span id="__span-30-35"><a id="__codelineno-30-35" name="__codelineno-30-35" href="#lab04-mcp-resources-lab-__codelineno-30-35"></a>
</span><span id="__span-30-36"><a id="__codelineno-30-36" name="__codelineno-30-36" href="#lab04-mcp-resources-lab-__codelineno-30-36"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-30-37"><a id="__codelineno-30-37" name="__codelineno-30-37" href="#lab04-mcp-resources-lab-__codelineno-30-37"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-30-38"><a id="__codelineno-30-38" name="__codelineno-30-38" href="#lab04-mcp-resources-lab-__codelineno-30-38"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api-resource-server&quot;</span><span class="p">,</span>
</span><span id="__span-30-39"><a id="__codelineno-30-39" name="__codelineno-30-39" href="#lab04-mcp-resources-lab-__codelineno-30-39"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-30-40"><a id="__codelineno-30-40" name="__codelineno-30-40" href="#lab04-mcp-resources-lab-__codelineno-30-40"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-30-41"><a id="__codelineno-30-41" name="__codelineno-30-41" href="#lab04-mcp-resources-lab-__codelineno-30-41"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-30-42"><a id="__codelineno-30-42" name="__codelineno-30-42" href="#lab04-mcp-resources-lab-__codelineno-30-42"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-43"><a id="__codelineno-30-43" name="__codelineno-30-43" href="#lab04-mcp-resources-lab-__codelineno-30-43"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-30-44"><a id="__codelineno-30-44" name="__codelineno-30-44" href="#lab04-mcp-resources-lab-__codelineno-30-44"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-30-45"><a id="__codelineno-30-45" name="__codelineno-30-45" href="#lab04-mcp-resources-lab-__codelineno-30-45"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-30-46"><a id="__codelineno-30-46" name="__codelineno-30-46" href="#lab04-mcp-resources-lab-__codelineno-30-46"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-30-47"><a id="__codelineno-30-47" name="__codelineno-30-47" href="#lab04-mcp-resources-lab-__codelineno-30-47"></a>
</span><span id="__span-30-48"><a id="__codelineno-30-48" name="__codelineno-30-48" href="#lab04-mcp-resources-lab-__codelineno-30-48"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-30-49"><a id="__codelineno-30-49" name="__codelineno-30-49" href="#lab04-mcp-resources-lab-__codelineno-30-49"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-30-50"><a id="__codelineno-30-50" name="__codelineno-30-50" href="#lab04-mcp-resources-lab-__codelineno-30-50"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">startCacheCleanup</span><span class="p">();</span>
</span><span id="__span-30-51"><a id="__codelineno-30-51" name="__codelineno-30-51" href="#lab04-mcp-resources-lab-__codelineno-30-51"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-52"><a id="__codelineno-30-52" name="__codelineno-30-52" href="#lab04-mcp-resources-lab-__codelineno-30-52"></a>
</span><span id="__span-30-53"><a id="__codelineno-30-53" name="__codelineno-30-53" href="#lab04-mcp-resources-lab-__codelineno-30-53"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-54"><a id="__codelineno-30-54" name="__codelineno-30-54" href="#lab04-mcp-resources-lab-__codelineno-30-54"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourceTemplatesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-55"><a id="__codelineno-30-55" name="__codelineno-30-55" href="#lab04-mcp-resources-lab-__codelineno-30-55"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">templates</span><span class="o">:</span><span class="w"> </span><span class="kt">ResourceTemplate</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-30-56"><a id="__codelineno-30-56" name="__codelineno-30-56" href="#lab04-mcp-resources-lab-__codelineno-30-56"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-30-57"><a id="__codelineno-30-57" name="__codelineno-30-57" href="#lab04-mcp-resources-lab-__codelineno-30-57"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://users/{userId}&quot;</span><span class="p">,</span>
</span><span id="__span-30-58"><a id="__codelineno-30-58" name="__codelineno-30-58" href="#lab04-mcp-resources-lab-__codelineno-30-58"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;User Profile&quot;</span><span class="p">,</span>
</span><span id="__span-30-59"><a id="__codelineno-30-59" name="__codelineno-30-59" href="#lab04-mcp-resources-lab-__codelineno-30-59"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;User profile data from API&quot;</span><span class="p">,</span>
</span><span id="__span-30-60"><a id="__codelineno-30-60" name="__codelineno-30-60" href="#lab04-mcp-resources-lab-__codelineno-30-60"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-30-61"><a id="__codelineno-30-61" name="__codelineno-30-61" href="#lab04-mcp-resources-lab-__codelineno-30-61"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-30-62"><a id="__codelineno-30-62" name="__codelineno-30-62" href="#lab04-mcp-resources-lab-__codelineno-30-62"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-30-63"><a id="__codelineno-30-63" name="__codelineno-30-63" href="#lab04-mcp-resources-lab-__codelineno-30-63"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://posts/{postId}&quot;</span><span class="p">,</span>
</span><span id="__span-30-64"><a id="__codelineno-30-64" name="__codelineno-30-64" href="#lab04-mcp-resources-lab-__codelineno-30-64"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Post Details&quot;</span><span class="p">,</span>
</span><span id="__span-30-65"><a id="__codelineno-30-65" name="__codelineno-30-65" href="#lab04-mcp-resources-lab-__codelineno-30-65"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Post details from API&quot;</span><span class="p">,</span>
</span><span id="__span-30-66"><a id="__codelineno-30-66" name="__codelineno-30-66" href="#lab04-mcp-resources-lab-__codelineno-30-66"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-30-67"><a id="__codelineno-30-67" name="__codelineno-30-67" href="#lab04-mcp-resources-lab-__codelineno-30-67"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-30-68"><a id="__codelineno-30-68" name="__codelineno-30-68" href="#lab04-mcp-resources-lab-__codelineno-30-68"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-30-69"><a id="__codelineno-30-69" name="__codelineno-30-69" href="#lab04-mcp-resources-lab-__codelineno-30-69"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://search?q={query}&amp;type={type}&quot;</span><span class="p">,</span>
</span><span id="__span-30-70"><a id="__codelineno-30-70" name="__codelineno-30-70" href="#lab04-mcp-resources-lab-__codelineno-30-70"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Search Results&quot;</span><span class="p">,</span>
</span><span id="__span-30-71"><a id="__codelineno-30-71" name="__codelineno-30-71" href="#lab04-mcp-resources-lab-__codelineno-30-71"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Search API results&quot;</span><span class="p">,</span>
</span><span id="__span-30-72"><a id="__codelineno-30-72" name="__codelineno-30-72" href="#lab04-mcp-resources-lab-__codelineno-30-72"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-30-73"><a id="__codelineno-30-73" name="__codelineno-30-73" href="#lab04-mcp-resources-lab-__codelineno-30-73"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-30-74"><a id="__codelineno-30-74" name="__codelineno-30-74" href="#lab04-mcp-resources-lab-__codelineno-30-74"></a><span class="w">      </span><span class="p">];</span>
</span><span id="__span-30-75"><a id="__codelineno-30-75" name="__codelineno-30-75" href="#lab04-mcp-resources-lab-__codelineno-30-75"></a>
</span><span id="__span-30-76"><a id="__codelineno-30-76" name="__codelineno-30-76" href="#lab04-mcp-resources-lab-__codelineno-30-76"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resourceTemplates</span><span class="o">:</span><span class="w"> </span><span class="kt">templates</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-30-77"><a id="__codelineno-30-77" name="__codelineno-30-77" href="#lab04-mcp-resources-lab-__codelineno-30-77"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-30-78"><a id="__codelineno-30-78" name="__codelineno-30-78" href="#lab04-mcp-resources-lab-__codelineno-30-78"></a>
</span><span id="__span-30-79"><a id="__codelineno-30-79" name="__codelineno-30-79" href="#lab04-mcp-resources-lab-__codelineno-30-79"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-80"><a id="__codelineno-30-80" name="__codelineno-30-80" href="#lab04-mcp-resources-lab-__codelineno-30-80"></a><span class="w">      </span><span class="c1">// For demonstration, we&#39;ll provide some example resources</span>
</span><span id="__span-30-81"><a id="__codelineno-30-81" name="__codelineno-30-81" href="#lab04-mcp-resources-lab-__codelineno-30-81"></a><span class="w">      </span><span class="c1">// In a real implementation, you might fetch these from the API</span>
</span><span id="__span-30-82"><a id="__codelineno-30-82" name="__codelineno-30-82" href="#lab04-mcp-resources-lab-__codelineno-30-82"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-30-83"><a id="__codelineno-30-83" name="__codelineno-30-83" href="#lab04-mcp-resources-lab-__codelineno-30-83"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-30-84"><a id="__codelineno-30-84" name="__codelineno-30-84" href="#lab04-mcp-resources-lab-__codelineno-30-84"></a><span class="w">          </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://status&quot;</span><span class="p">,</span>
</span><span id="__span-30-85"><a id="__codelineno-30-85" name="__codelineno-30-85" href="#lab04-mcp-resources-lab-__codelineno-30-85"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;API Status&quot;</span><span class="p">,</span>
</span><span id="__span-30-86"><a id="__codelineno-30-86" name="__codelineno-30-86" href="#lab04-mcp-resources-lab-__codelineno-30-86"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Current API status and health&quot;</span><span class="p">,</span>
</span><span id="__span-30-87"><a id="__codelineno-30-87" name="__codelineno-30-87" href="#lab04-mcp-resources-lab-__codelineno-30-87"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-30-88"><a id="__codelineno-30-88" name="__codelineno-30-88" href="#lab04-mcp-resources-lab-__codelineno-30-88"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-30-89"><a id="__codelineno-30-89" name="__codelineno-30-89" href="#lab04-mcp-resources-lab-__codelineno-30-89"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-30-90"><a id="__codelineno-30-90" name="__codelineno-30-90" href="#lab04-mcp-resources-lab-__codelineno-30-90"></a><span class="w">          </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://info&quot;</span><span class="p">,</span>
</span><span id="__span-30-91"><a id="__codelineno-30-91" name="__codelineno-30-91" href="#lab04-mcp-resources-lab-__codelineno-30-91"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;API Information&quot;</span><span class="p">,</span>
</span><span id="__span-30-92"><a id="__codelineno-30-92" name="__codelineno-30-92" href="#lab04-mcp-resources-lab-__codelineno-30-92"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;API metadata and capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-30-93"><a id="__codelineno-30-93" name="__codelineno-30-93" href="#lab04-mcp-resources-lab-__codelineno-30-93"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-30-94"><a id="__codelineno-30-94" name="__codelineno-30-94" href="#lab04-mcp-resources-lab-__codelineno-30-94"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-30-95"><a id="__codelineno-30-95" name="__codelineno-30-95" href="#lab04-mcp-resources-lab-__codelineno-30-95"></a><span class="w">      </span><span class="p">];</span>
</span><span id="__span-30-96"><a id="__codelineno-30-96" name="__codelineno-30-96" href="#lab04-mcp-resources-lab-__codelineno-30-96"></a>
</span><span id="__span-30-97"><a id="__codelineno-30-97" name="__codelineno-30-97" href="#lab04-mcp-resources-lab-__codelineno-30-97"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-30-98"><a id="__codelineno-30-98" name="__codelineno-30-98" href="#lab04-mcp-resources-lab-__codelineno-30-98"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-30-99"><a id="__codelineno-30-99" name="__codelineno-30-99" href="#lab04-mcp-resources-lab-__codelineno-30-99"></a>
</span><span id="__span-30-100"><a id="__codelineno-30-100" name="__codelineno-30-100" href="#lab04-mcp-resources-lab-__codelineno-30-100"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-101"><a id="__codelineno-30-101" name="__codelineno-30-101" href="#lab04-mcp-resources-lab-__codelineno-30-101"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-30-102"><a id="__codelineno-30-102" name="__codelineno-30-102" href="#lab04-mcp-resources-lab-__codelineno-30-102"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">fetchAPIResource</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-30-103"><a id="__codelineno-30-103" name="__codelineno-30-103" href="#lab04-mcp-resources-lab-__codelineno-30-103"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-30-104"><a id="__codelineno-30-104" name="__codelineno-30-104" href="#lab04-mcp-resources-lab-__codelineno-30-104"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-30-105"><a id="__codelineno-30-105" name="__codelineno-30-105" href="#lab04-mcp-resources-lab-__codelineno-30-105"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-106"><a id="__codelineno-30-106" name="__codelineno-30-106" href="#lab04-mcp-resources-lab-__codelineno-30-106"></a>
</span><span id="__span-30-107"><a id="__codelineno-30-107" name="__codelineno-30-107" href="#lab04-mcp-resources-lab-__codelineno-30-107"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">fetchAPIResource</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-108"><a id="__codelineno-30-108" name="__codelineno-30-108" href="#lab04-mcp-resources-lab-__codelineno-30-108"></a><span class="w">    </span><span class="c1">// Check rate limit</span>
</span><span id="__span-30-109"><a id="__codelineno-30-109" name="__codelineno-30-109" href="#lab04-mcp-resources-lab-__codelineno-30-109"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">checkRateLimit</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-110"><a id="__codelineno-30-110" name="__codelineno-30-110" href="#lab04-mcp-resources-lab-__codelineno-30-110"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Rate limit exceeded. Please try again later.&quot;</span><span class="p">);</span>
</span><span id="__span-30-111"><a id="__codelineno-30-111" name="__codelineno-30-111" href="#lab04-mcp-resources-lab-__codelineno-30-111"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-112"><a id="__codelineno-30-112" name="__codelineno-30-112" href="#lab04-mcp-resources-lab-__codelineno-30-112"></a>
</span><span id="__span-30-113"><a id="__codelineno-30-113" name="__codelineno-30-113" href="#lab04-mcp-resources-lab-__codelineno-30-113"></a><span class="w">    </span><span class="c1">// Check cache first</span>
</span><span id="__span-30-114"><a id="__codelineno-30-114" name="__codelineno-30-114" href="#lab04-mcp-resources-lab-__codelineno-30-114"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cacheEnabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-115"><a id="__codelineno-30-115" name="__codelineno-30-115" href="#lab04-mcp-resources-lab-__codelineno-30-115"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">cached</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getCached</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-30-116"><a id="__codelineno-30-116" name="__codelineno-30-116" href="#lab04-mcp-resources-lab-__codelineno-30-116"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">cached</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-117"><a id="__codelineno-30-117" name="__codelineno-30-117" href="#lab04-mcp-resources-lab-__codelineno-30-117"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-118"><a id="__codelineno-30-118" name="__codelineno-30-118" href="#lab04-mcp-resources-lab-__codelineno-30-118"></a><span class="w">          </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-30-119"><a id="__codelineno-30-119" name="__codelineno-30-119" href="#lab04-mcp-resources-lab-__codelineno-30-119"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-30-120"><a id="__codelineno-30-120" name="__codelineno-30-120" href="#lab04-mcp-resources-lab-__codelineno-30-120"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-30-121"><a id="__codelineno-30-121" name="__codelineno-30-121" href="#lab04-mcp-resources-lab-__codelineno-30-121"></a><span class="w">            </span><span class="p">...</span><span class="nx">cached</span><span class="p">,</span>
</span><span id="__span-30-122"><a id="__codelineno-30-122" name="__codelineno-30-122" href="#lab04-mcp-resources-lab-__codelineno-30-122"></a><span class="w">            </span><span class="nx">cached</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-30-123"><a id="__codelineno-30-123" name="__codelineno-30-123" href="#lab04-mcp-resources-lab-__codelineno-30-123"></a><span class="w">            </span><span class="nx">cacheAge</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">((</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">cached</span><span class="p">.</span><span class="nx">_cacheTimestamp</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000</span><span class="p">),</span>
</span><span id="__span-30-124"><a id="__codelineno-30-124" name="__codelineno-30-124" href="#lab04-mcp-resources-lab-__codelineno-30-124"></a><span class="w">          </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-30-125"><a id="__codelineno-30-125" name="__codelineno-30-125" href="#lab04-mcp-resources-lab-__codelineno-30-125"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-30-126"><a id="__codelineno-30-126" name="__codelineno-30-126" href="#lab04-mcp-resources-lab-__codelineno-30-126"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-30-127"><a id="__codelineno-30-127" name="__codelineno-30-127" href="#lab04-mcp-resources-lab-__codelineno-30-127"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-128"><a id="__codelineno-30-128" name="__codelineno-30-128" href="#lab04-mcp-resources-lab-__codelineno-30-128"></a>
</span><span id="__span-30-129"><a id="__codelineno-30-129" name="__codelineno-30-129" href="#lab04-mcp-resources-lab-__codelineno-30-129"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-130"><a id="__codelineno-30-130" name="__codelineno-30-130" href="#lab04-mcp-resources-lab-__codelineno-30-130"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">apiPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">uriToAPIPath</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-30-131"><a id="__codelineno-30-131" name="__codelineno-30-131" href="#lab04-mcp-resources-lab-__codelineno-30-131"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">baseUrl</span><span class="si">}${</span><span class="nx">apiPath</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-30-132"><a id="__codelineno-30-132" name="__codelineno-30-132" href="#lab04-mcp-resources-lab-__codelineno-30-132"></a>
</span><span id="__span-30-133"><a id="__codelineno-30-133" name="__codelineno-30-133" href="#lab04-mcp-resources-lab-__codelineno-30-133"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-134"><a id="__codelineno-30-134" name="__codelineno-30-134" href="#lab04-mcp-resources-lab-__codelineno-30-134"></a><span class="w">        </span><span class="s1">&#39;User-Agent&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MCP-API-Resource-Server/1.0&#39;</span><span class="p">,</span>
</span><span id="__span-30-135"><a id="__codelineno-30-135" name="__codelineno-30-135" href="#lab04-mcp-resources-lab-__codelineno-30-135"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-30-136"><a id="__codelineno-30-136" name="__codelineno-30-136" href="#lab04-mcp-resources-lab-__codelineno-30-136"></a>
</span><span id="__span-30-137"><a id="__codelineno-30-137" name="__codelineno-30-137" href="#lab04-mcp-resources-lab-__codelineno-30-137"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-138"><a id="__codelineno-30-138" name="__codelineno-30-138" href="#lab04-mcp-resources-lab-__codelineno-30-138"></a><span class="w">        </span><span class="nx">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`Bearer </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">apiKey</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-30-139"><a id="__codelineno-30-139" name="__codelineno-30-139" href="#lab04-mcp-resources-lab-__codelineno-30-139"></a><span class="w">        </span><span class="c1">// Or: headers[&#39;X-API-Key&#39;] = this.apiKey;</span>
</span><span id="__span-30-140"><a id="__codelineno-30-140" name="__codelineno-30-140" href="#lab04-mcp-resources-lab-__codelineno-30-140"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-30-141"><a id="__codelineno-30-141" name="__codelineno-30-141" href="#lab04-mcp-resources-lab-__codelineno-30-141"></a>
</span><span id="__span-30-142"><a id="__codelineno-30-142" name="__codelineno-30-142" href="#lab04-mcp-resources-lab-__codelineno-30-142"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="o">:</span><span class="w"> </span><span class="kt">AxiosResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-143"><a id="__codelineno-30-143" name="__codelineno-30-143" href="#lab04-mcp-resources-lab-__codelineno-30-143"></a><span class="w">        </span><span class="nx">headers</span><span class="p">,</span>
</span><span id="__span-30-144"><a id="__codelineno-30-144" name="__codelineno-30-144" href="#lab04-mcp-resources-lab-__codelineno-30-144"></a><span class="w">        </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="kt">10000</span><span class="p">,</span>
</span><span id="__span-30-145"><a id="__codelineno-30-145" name="__codelineno-30-145" href="#lab04-mcp-resources-lab-__codelineno-30-145"></a><span class="w">      </span><span class="p">});</span>
</span><span id="__span-30-146"><a id="__codelineno-30-146" name="__codelineno-30-146" href="#lab04-mcp-resources-lab-__codelineno-30-146"></a>
</span><span id="__span-30-147"><a id="__codelineno-30-147" name="__codelineno-30-147" href="#lab04-mcp-resources-lab-__codelineno-30-147"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-148"><a id="__codelineno-30-148" name="__codelineno-30-148" href="#lab04-mcp-resources-lab-__codelineno-30-148"></a><span class="w">        </span><span class="p">...</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
</span><span id="__span-30-149"><a id="__codelineno-30-149" name="__codelineno-30-149" href="#lab04-mcp-resources-lab-__codelineno-30-149"></a><span class="w">        </span><span class="nx">_metadata</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-150"><a id="__codelineno-30-150" name="__codelineno-30-150" href="#lab04-mcp-resources-lab-__codelineno-30-150"></a><span class="w">          </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="kt">response.status</span><span class="p">,</span>
</span><span id="__span-30-151"><a id="__codelineno-30-151" name="__codelineno-30-151" href="#lab04-mcp-resources-lab-__codelineno-30-151"></a><span class="w">          </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="kt">url</span><span class="p">,</span>
</span><span id="__span-30-152"><a id="__codelineno-30-152" name="__codelineno-30-152" href="#lab04-mcp-resources-lab-__codelineno-30-152"></a><span class="w">          </span><span class="nx">fetchedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span><span id="__span-30-153"><a id="__codelineno-30-153" name="__codelineno-30-153" href="#lab04-mcp-resources-lab-__codelineno-30-153"></a><span class="w">          </span><span class="nx">contentType</span><span class="o">:</span><span class="w"> </span><span class="kt">response.headers</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">],</span>
</span><span id="__span-30-154"><a id="__codelineno-30-154" name="__codelineno-30-154" href="#lab04-mcp-resources-lab-__codelineno-30-154"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-155"><a id="__codelineno-30-155" name="__codelineno-30-155" href="#lab04-mcp-resources-lab-__codelineno-30-155"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-30-156"><a id="__codelineno-30-156" name="__codelineno-30-156" href="#lab04-mcp-resources-lab-__codelineno-30-156"></a>
</span><span id="__span-30-157"><a id="__codelineno-30-157" name="__codelineno-30-157" href="#lab04-mcp-resources-lab-__codelineno-30-157"></a><span class="w">      </span><span class="c1">// Cache the response</span>
</span><span id="__span-30-158"><a id="__codelineno-30-158" name="__codelineno-30-158" href="#lab04-mcp-resources-lab-__codelineno-30-158"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cacheEnabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-159"><a id="__codelineno-30-159" name="__codelineno-30-159" href="#lab04-mcp-resources-lab-__codelineno-30-159"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">setCache</span><span class="p">(</span><span class="nx">uri</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-30-160"><a id="__codelineno-30-160" name="__codelineno-30-160" href="#lab04-mcp-resources-lab-__codelineno-30-160"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-30-161"><a id="__codelineno-30-161" name="__codelineno-30-161" href="#lab04-mcp-resources-lab-__codelineno-30-161"></a>
</span><span id="__span-30-162"><a id="__codelineno-30-162" name="__codelineno-30-162" href="#lab04-mcp-resources-lab-__codelineno-30-162"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-163"><a id="__codelineno-30-163" name="__codelineno-30-163" href="#lab04-mcp-resources-lab-__codelineno-30-163"></a><span class="w">        </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-30-164"><a id="__codelineno-30-164" name="__codelineno-30-164" href="#lab04-mcp-resources-lab-__codelineno-30-164"></a><span class="w">        </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-30-165"><a id="__codelineno-30-165" name="__codelineno-30-165" href="#lab04-mcp-resources-lab-__codelineno-30-165"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-30-166"><a id="__codelineno-30-166" name="__codelineno-30-166" href="#lab04-mcp-resources-lab-__codelineno-30-166"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-30-167"><a id="__codelineno-30-167" name="__codelineno-30-167" href="#lab04-mcp-resources-lab-__codelineno-30-167"></a>
</span><span id="__span-30-168"><a id="__codelineno-30-168" name="__codelineno-30-168" href="#lab04-mcp-resources-lab-__codelineno-30-168"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-169"><a id="__codelineno-30-169" name="__codelineno-30-169" href="#lab04-mcp-resources-lab-__codelineno-30-169"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">axios</span><span class="p">.</span><span class="nx">isAxiosError</span><span class="p">(</span><span class="nx">error</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-170"><a id="__codelineno-30-170" name="__codelineno-30-170" href="#lab04-mcp-resources-lab-__codelineno-30-170"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-171"><a id="__codelineno-30-171" name="__codelineno-30-171" href="#lab04-mcp-resources-lab-__codelineno-30-171"></a><span class="w">          </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`API Error </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-30-172"><a id="__codelineno-30-172" name="__codelineno-30-172" href="#lab04-mcp-resources-lab-__codelineno-30-172"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ECONNREFUSED&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-173"><a id="__codelineno-30-173" name="__codelineno-30-173" href="#lab04-mcp-resources-lab-__codelineno-30-173"></a><span class="w">          </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Cannot connect to API: </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">baseUrl</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-30-174"><a id="__codelineno-30-174" name="__codelineno-30-174" href="#lab04-mcp-resources-lab-__codelineno-30-174"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-175"><a id="__codelineno-30-175" name="__codelineno-30-175" href="#lab04-mcp-resources-lab-__codelineno-30-175"></a><span class="w">          </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Network error: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-30-176"><a id="__codelineno-30-176" name="__codelineno-30-176" href="#lab04-mcp-resources-lab-__codelineno-30-176"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-177"><a id="__codelineno-30-177" name="__codelineno-30-177" href="#lab04-mcp-resources-lab-__codelineno-30-177"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-178"><a id="__codelineno-30-178" name="__codelineno-30-178" href="#lab04-mcp-resources-lab-__codelineno-30-178"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Failed to fetch API resource: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-30-179"><a id="__codelineno-30-179" name="__codelineno-30-179" href="#lab04-mcp-resources-lab-__codelineno-30-179"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-30-180"><a id="__codelineno-30-180" name="__codelineno-30-180" href="#lab04-mcp-resources-lab-__codelineno-30-180"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-181"><a id="__codelineno-30-181" name="__codelineno-30-181" href="#lab04-mcp-resources-lab-__codelineno-30-181"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-182"><a id="__codelineno-30-182" name="__codelineno-30-182" href="#lab04-mcp-resources-lab-__codelineno-30-182"></a>
</span><span id="__span-30-183"><a id="__codelineno-30-183" name="__codelineno-30-183" href="#lab04-mcp-resources-lab-__codelineno-30-183"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">uriToAPIPath</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-184"><a id="__codelineno-30-184" name="__codelineno-30-184" href="#lab04-mcp-resources-lab-__codelineno-30-184"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">uri</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;api://&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-185"><a id="__codelineno-30-185" name="__codelineno-30-185" href="#lab04-mcp-resources-lab-__codelineno-30-185"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid API URI: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-30-186"><a id="__codelineno-30-186" name="__codelineno-30-186" href="#lab04-mcp-resources-lab-__codelineno-30-186"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-187"><a id="__codelineno-30-187" name="__codelineno-30-187" href="#lab04-mcp-resources-lab-__codelineno-30-187"></a>
</span><span id="__span-30-188"><a id="__codelineno-30-188" name="__codelineno-30-188" href="#lab04-mcp-resources-lab-__codelineno-30-188"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;api://&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span id="__span-30-189"><a id="__codelineno-30-189" name="__codelineno-30-189" href="#lab04-mcp-resources-lab-__codelineno-30-189"></a>
</span><span id="__span-30-190"><a id="__codelineno-30-190" name="__codelineno-30-190" href="#lab04-mcp-resources-lab-__codelineno-30-190"></a><span class="w">    </span><span class="c1">// Handle special cases</span>
</span><span id="__span-30-191"><a id="__codelineno-30-191" name="__codelineno-30-191" href="#lab04-mcp-resources-lab-__codelineno-30-191"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;status&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;/status&#39;</span><span class="p">;</span>
</span><span id="__span-30-192"><a id="__codelineno-30-192" name="__codelineno-30-192" href="#lab04-mcp-resources-lab-__codelineno-30-192"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;/info&#39;</span><span class="p">;</span>
</span><span id="__span-30-193"><a id="__codelineno-30-193" name="__codelineno-30-193" href="#lab04-mcp-resources-lab-__codelineno-30-193"></a>
</span><span id="__span-30-194"><a id="__codelineno-30-194" name="__codelineno-30-194" href="#lab04-mcp-resources-lab-__codelineno-30-194"></a><span class="w">    </span><span class="c1">// Handle template URIs</span>
</span><span id="__span-30-195"><a id="__codelineno-30-195" name="__codelineno-30-195" href="#lab04-mcp-resources-lab-__codelineno-30-195"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;users/&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-196"><a id="__codelineno-30-196" name="__codelineno-30-196" href="#lab04-mcp-resources-lab-__codelineno-30-196"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;users/&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span id="__span-30-197"><a id="__codelineno-30-197" name="__codelineno-30-197" href="#lab04-mcp-resources-lab-__codelineno-30-197"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="sb">`/users/</span><span class="si">${</span><span class="nx">userId</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-30-198"><a id="__codelineno-30-198" name="__codelineno-30-198" href="#lab04-mcp-resources-lab-__codelineno-30-198"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-199"><a id="__codelineno-30-199" name="__codelineno-30-199" href="#lab04-mcp-resources-lab-__codelineno-30-199"></a>
</span><span id="__span-30-200"><a id="__codelineno-30-200" name="__codelineno-30-200" href="#lab04-mcp-resources-lab-__codelineno-30-200"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;posts/&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-201"><a id="__codelineno-30-201" name="__codelineno-30-201" href="#lab04-mcp-resources-lab-__codelineno-30-201"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">postId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;posts/&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span id="__span-30-202"><a id="__codelineno-30-202" name="__codelineno-30-202" href="#lab04-mcp-resources-lab-__codelineno-30-202"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="sb">`/posts/</span><span class="si">${</span><span class="nx">postId</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-30-203"><a id="__codelineno-30-203" name="__codelineno-30-203" href="#lab04-mcp-resources-lab-__codelineno-30-203"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-204"><a id="__codelineno-30-204" name="__codelineno-30-204" href="#lab04-mcp-resources-lab-__codelineno-30-204"></a>
</span><span id="__span-30-205"><a id="__codelineno-30-205" name="__codelineno-30-205" href="#lab04-mcp-resources-lab-__codelineno-30-205"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;search?&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-206"><a id="__codelineno-30-206" name="__codelineno-30-206" href="#lab04-mcp-resources-lab-__codelineno-30-206"></a><span class="w">      </span><span class="c1">// Convert query parameters</span>
</span><span id="__span-30-207"><a id="__codelineno-30-207" name="__codelineno-30-207" href="#lab04-mcp-resources-lab-__codelineno-30-207"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">queryString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;search?&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span id="__span-30-208"><a id="__codelineno-30-208" name="__codelineno-30-208" href="#lab04-mcp-resources-lab-__codelineno-30-208"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="sb">`/search?</span><span class="si">${</span><span class="nx">queryString</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-30-209"><a id="__codelineno-30-209" name="__codelineno-30-209" href="#lab04-mcp-resources-lab-__codelineno-30-209"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-210"><a id="__codelineno-30-210" name="__codelineno-30-210" href="#lab04-mcp-resources-lab-__codelineno-30-210"></a>
</span><span id="__span-30-211"><a id="__codelineno-30-211" name="__codelineno-30-211" href="#lab04-mcp-resources-lab-__codelineno-30-211"></a><span class="w">    </span><span class="c1">// Default: use path as-is</span>
</span><span id="__span-30-212"><a id="__codelineno-30-212" name="__codelineno-30-212" href="#lab04-mcp-resources-lab-__codelineno-30-212"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`/</span><span class="si">${</span><span class="nx">path</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-30-213"><a id="__codelineno-30-213" name="__codelineno-30-213" href="#lab04-mcp-resources-lab-__codelineno-30-213"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-214"><a id="__codelineno-30-214" name="__codelineno-30-214" href="#lab04-mcp-resources-lab-__codelineno-30-214"></a>
</span><span id="__span-30-215"><a id="__codelineno-30-215" name="__codelineno-30-215" href="#lab04-mcp-resources-lab-__codelineno-30-215"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">checkRateLimit</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-216"><a id="__codelineno-30-216" name="__codelineno-30-216" href="#lab04-mcp-resources-lab-__codelineno-30-216"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
</span><span id="__span-30-217"><a id="__codelineno-30-217" name="__codelineno-30-217" href="#lab04-mcp-resources-lab-__codelineno-30-217"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">windowMs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">60000</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1 minute</span>
</span><span id="__span-30-218"><a id="__codelineno-30-218" name="__codelineno-30-218" href="#lab04-mcp-resources-lab-__codelineno-30-218"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;global&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// In a real app, use user/session ID</span>
</span><span id="__span-30-219"><a id="__codelineno-30-219" name="__codelineno-30-219" href="#lab04-mcp-resources-lab-__codelineno-30-219"></a>
</span><span id="__span-30-220"><a id="__codelineno-30-220" name="__codelineno-30-220" href="#lab04-mcp-resources-lab-__codelineno-30-220"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">record</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">requestCounts</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span><span id="__span-30-221"><a id="__codelineno-30-221" name="__codelineno-30-221" href="#lab04-mcp-resources-lab-__codelineno-30-221"></a>
</span><span id="__span-30-222"><a id="__codelineno-30-222" name="__codelineno-30-222" href="#lab04-mcp-resources-lab-__codelineno-30-222"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">record</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">now</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">record</span><span class="p">.</span><span class="nx">resetTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-223"><a id="__codelineno-30-223" name="__codelineno-30-223" href="#lab04-mcp-resources-lab-__codelineno-30-223"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">requestCounts</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span><span class="w"> </span><span class="nx">resetTime</span><span class="o">:</span><span class="w"> </span><span class="kt">now</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">windowMs</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-30-224"><a id="__codelineno-30-224" name="__codelineno-30-224" href="#lab04-mcp-resources-lab-__codelineno-30-224"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-30-225"><a id="__codelineno-30-225" name="__codelineno-30-225" href="#lab04-mcp-resources-lab-__codelineno-30-225"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-226"><a id="__codelineno-30-226" name="__codelineno-30-226" href="#lab04-mcp-resources-lab-__codelineno-30-226"></a>
</span><span id="__span-30-227"><a id="__codelineno-30-227" name="__codelineno-30-227" href="#lab04-mcp-resources-lab-__codelineno-30-227"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">record</span><span class="p">.</span><span class="nx">count</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">rateLimit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-228"><a id="__codelineno-30-228" name="__codelineno-30-228" href="#lab04-mcp-resources-lab-__codelineno-30-228"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-30-229"><a id="__codelineno-30-229" name="__codelineno-30-229" href="#lab04-mcp-resources-lab-__codelineno-30-229"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-230"><a id="__codelineno-30-230" name="__codelineno-30-230" href="#lab04-mcp-resources-lab-__codelineno-30-230"></a>
</span><span id="__span-30-231"><a id="__codelineno-30-231" name="__codelineno-30-231" href="#lab04-mcp-resources-lab-__codelineno-30-231"></a><span class="w">    </span><span class="nx">record</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-30-232"><a id="__codelineno-30-232" name="__codelineno-30-232" href="#lab04-mcp-resources-lab-__codelineno-30-232"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-30-233"><a id="__codelineno-30-233" name="__codelineno-30-233" href="#lab04-mcp-resources-lab-__codelineno-30-233"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-234"><a id="__codelineno-30-234" name="__codelineno-30-234" href="#lab04-mcp-resources-lab-__codelineno-30-234"></a>
</span><span id="__span-30-235"><a id="__codelineno-30-235" name="__codelineno-30-235" href="#lab04-mcp-resources-lab-__codelineno-30-235"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getCached</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-236"><a id="__codelineno-30-236" name="__codelineno-30-236" href="#lab04-mcp-resources-lab-__codelineno-30-236"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cached</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-30-237"><a id="__codelineno-30-237" name="__codelineno-30-237" href="#lab04-mcp-resources-lab-__codelineno-30-237"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">cached</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-30-238"><a id="__codelineno-30-238" name="__codelineno-30-238" href="#lab04-mcp-resources-lab-__codelineno-30-238"></a>
</span><span id="__span-30-239"><a id="__codelineno-30-239" name="__codelineno-30-239" href="#lab04-mcp-resources-lab-__codelineno-30-239"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">cached</span><span class="p">.</span><span class="nx">timestamp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">cached</span><span class="p">.</span><span class="nx">ttl</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-240"><a id="__codelineno-30-240" name="__codelineno-30-240" href="#lab04-mcp-resources-lab-__codelineno-30-240"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-30-241"><a id="__codelineno-30-241" name="__codelineno-30-241" href="#lab04-mcp-resources-lab-__codelineno-30-241"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-30-242"><a id="__codelineno-30-242" name="__codelineno-30-242" href="#lab04-mcp-resources-lab-__codelineno-30-242"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-243"><a id="__codelineno-30-243" name="__codelineno-30-243" href="#lab04-mcp-resources-lab-__codelineno-30-243"></a>
</span><span id="__span-30-244"><a id="__codelineno-30-244" name="__codelineno-30-244" href="#lab04-mcp-resources-lab-__codelineno-30-244"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">cached</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
</span><span id="__span-30-245"><a id="__codelineno-30-245" name="__codelineno-30-245" href="#lab04-mcp-resources-lab-__codelineno-30-245"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-246"><a id="__codelineno-30-246" name="__codelineno-30-246" href="#lab04-mcp-resources-lab-__codelineno-30-246"></a>
</span><span id="__span-30-247"><a id="__codelineno-30-247" name="__codelineno-30-247" href="#lab04-mcp-resources-lab-__codelineno-30-247"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setCache</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-248"><a id="__codelineno-30-248" name="__codelineno-30-248" href="#lab04-mcp-resources-lab-__codelineno-30-248"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">uri</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-249"><a id="__codelineno-30-249" name="__codelineno-30-249" href="#lab04-mcp-resources-lab-__codelineno-30-249"></a><span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="nx">_cacheTimestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">()</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-30-250"><a id="__codelineno-30-250" name="__codelineno-30-250" href="#lab04-mcp-resources-lab-__codelineno-30-250"></a><span class="w">      </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">(),</span>
</span><span id="__span-30-251"><a id="__codelineno-30-251" name="__codelineno-30-251" href="#lab04-mcp-resources-lab-__codelineno-30-251"></a><span class="w">      </span><span class="nx">ttl</span><span class="o">:</span><span class="w"> </span><span class="kt">this.cacheTTL</span><span class="p">,</span>
</span><span id="__span-30-252"><a id="__codelineno-30-252" name="__codelineno-30-252" href="#lab04-mcp-resources-lab-__codelineno-30-252"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-30-253"><a id="__codelineno-30-253" name="__codelineno-30-253" href="#lab04-mcp-resources-lab-__codelineno-30-253"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-254"><a id="__codelineno-30-254" name="__codelineno-30-254" href="#lab04-mcp-resources-lab-__codelineno-30-254"></a>
</span><span id="__span-30-255"><a id="__codelineno-30-255" name="__codelineno-30-255" href="#lab04-mcp-resources-lab-__codelineno-30-255"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">startCacheCleanup</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-256"><a id="__codelineno-30-256" name="__codelineno-30-256" href="#lab04-mcp-resources-lab-__codelineno-30-256"></a><span class="w">    </span><span class="c1">// Clean up expired cache entries every 5 minutes</span>
</span><span id="__span-30-257"><a id="__codelineno-30-257" name="__codelineno-30-257" href="#lab04-mcp-resources-lab-__codelineno-30-257"></a><span class="w">    </span><span class="nx">setInterval</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-258"><a id="__codelineno-30-258" name="__codelineno-30-258" href="#lab04-mcp-resources-lab-__codelineno-30-258"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
</span><span id="__span-30-259"><a id="__codelineno-30-259" name="__codelineno-30-259" href="#lab04-mcp-resources-lab-__codelineno-30-259"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">uri</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-260"><a id="__codelineno-30-260" name="__codelineno-30-260" href="#lab04-mcp-resources-lab-__codelineno-30-260"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">now</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">timestamp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">ttl</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-261"><a id="__codelineno-30-261" name="__codelineno-30-261" href="#lab04-mcp-resources-lab-__codelineno-30-261"></a><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-30-262"><a id="__codelineno-30-262" name="__codelineno-30-262" href="#lab04-mcp-resources-lab-__codelineno-30-262"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-263"><a id="__codelineno-30-263" name="__codelineno-30-263" href="#lab04-mcp-resources-lab-__codelineno-30-263"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-30-264"><a id="__codelineno-30-264" name="__codelineno-30-264" href="#lab04-mcp-resources-lab-__codelineno-30-264"></a><span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
</span><span id="__span-30-265"><a id="__codelineno-30-265" name="__codelineno-30-265" href="#lab04-mcp-resources-lab-__codelineno-30-265"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-266"><a id="__codelineno-30-266" name="__codelineno-30-266" href="#lab04-mcp-resources-lab-__codelineno-30-266"></a>
</span><span id="__span-30-267"><a id="__codelineno-30-267" name="__codelineno-30-267" href="#lab04-mcp-resources-lab-__codelineno-30-267"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-268"><a id="__codelineno-30-268" name="__codelineno-30-268" href="#lab04-mcp-resources-lab-__codelineno-30-268"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-269"><a id="__codelineno-30-269" name="__codelineno-30-269" href="#lab04-mcp-resources-lab-__codelineno-30-269"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-30-270"><a id="__codelineno-30-270" name="__codelineno-30-270" href="#lab04-mcp-resources-lab-__codelineno-30-270"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-30-271"><a id="__codelineno-30-271" name="__codelineno-30-271" href="#lab04-mcp-resources-lab-__codelineno-30-271"></a>
</span><span id="__span-30-272"><a id="__codelineno-30-272" name="__codelineno-30-272" href="#lab04-mcp-resources-lab-__codelineno-30-272"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-273"><a id="__codelineno-30-273" name="__codelineno-30-273" href="#lab04-mcp-resources-lab-__codelineno-30-273"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-30-274"><a id="__codelineno-30-274" name="__codelineno-30-274" href="#lab04-mcp-resources-lab-__codelineno-30-274"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-30-275"><a id="__codelineno-30-275" name="__codelineno-30-275" href="#lab04-mcp-resources-lab-__codelineno-30-275"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-30-276"><a id="__codelineno-30-276" name="__codelineno-30-276" href="#lab04-mcp-resources-lab-__codelineno-30-276"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-277"><a id="__codelineno-30-277" name="__codelineno-30-277" href="#lab04-mcp-resources-lab-__codelineno-30-277"></a>
</span><span id="__span-30-278"><a id="__codelineno-30-278" name="__codelineno-30-278" href="#lab04-mcp-resources-lab-__codelineno-30-278"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-279"><a id="__codelineno-30-279" name="__codelineno-30-279" href="#lab04-mcp-resources-lab-__codelineno-30-279"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-30-280"><a id="__codelineno-30-280" name="__codelineno-30-280" href="#lab04-mcp-resources-lab-__codelineno-30-280"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-30-281"><a id="__codelineno-30-281" name="__codelineno-30-281" href="#lab04-mcp-resources-lab-__codelineno-30-281"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`API Resource Server running (API: </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">baseUrl</span><span class="si">}</span><span class="sb">)`</span><span class="p">);</span>
</span><span id="__span-30-282"><a id="__codelineno-30-282" name="__codelineno-30-282" href="#lab04-mcp-resources-lab-__codelineno-30-282"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-283"><a id="__codelineno-30-283" name="__codelineno-30-283" href="#lab04-mcp-resources-lab-__codelineno-30-283"></a><span class="p">}</span>
</span><span id="__span-30-284"><a id="__codelineno-30-284" name="__codelineno-30-284" href="#lab04-mcp-resources-lab-__codelineno-30-284"></a>
</span><span id="__span-30-285"><a id="__codelineno-30-285" name="__codelineno-30-285" href="#lab04-mcp-resources-lab-__codelineno-30-285"></a><span class="c1">// Main entry point</span>
</span><span id="__span-30-286"><a id="__codelineno-30-286" name="__codelineno-30-286" href="#lab04-mcp-resources-lab-__codelineno-30-286"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-287"><a id="__codelineno-30-287" name="__codelineno-30-287" href="#lab04-mcp-resources-lab-__codelineno-30-287"></a><span class="w">  </span><span class="c1">// Example: JSONPlaceholder API</span>
</span><span id="__span-30-288"><a id="__codelineno-30-288" name="__codelineno-30-288" href="#lab04-mcp-resources-lab-__codelineno-30-288"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">APIResourceServer</span><span class="p">(</span><span class="s1">&#39;https://jsonplaceholder.typicode.com&#39;</span><span class="p">);</span>
</span><span id="__span-30-289"><a id="__codelineno-30-289" name="__codelineno-30-289" href="#lab04-mcp-resources-lab-__codelineno-30-289"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-30-290"><a id="__codelineno-30-290" name="__codelineno-30-290" href="#lab04-mcp-resources-lab-__codelineno-30-290"></a><span class="p">}</span>
</span><span id="__span-30-291"><a id="__codelineno-30-291" name="__codelineno-30-291" href="#lab04-mcp-resources-lab-__codelineno-30-291"></a>
</span><span id="__span-30-292"><a id="__codelineno-30-292" name="__codelineno-30-292" href="#lab04-mcp-resources-lab-__codelineno-30-292"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-293"><a id="__codelineno-30-293" name="__codelineno-30-293" href="#lab04-mcp-resources-lab-__codelineno-30-293"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-30-294"><a id="__codelineno-30-294" name="__codelineno-30-294" href="#lab04-mcp-resources-lab-__codelineno-30-294"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-30-295"><a id="__codelineno-30-295" name="__codelineno-30-295" href="#lab04-mcp-resources-lab-__codelineno-30-295"></a><span class="p">});</span>
</span></code></pre></div>

Testing - Test the server with the JSONPlaceholder API:

<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#lab04-mcp-resources-lab-__codelineno-31-1"></a><span class="c1"># Start the server</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#lab04-mcp-resources-lab-__codelineno-31-2"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>

Test these resources in the MCP Inspector:

<div class="language-javascript highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#lab04-mcp-resources-lab-__codelineno-32-1"></a><span class="c1">// API status</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#lab04-mcp-resources-lab-__codelineno-32-2"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://status&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#lab04-mcp-resources-lab-__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#lab04-mcp-resources-lab-__codelineno-32-4"></a><span class="c1">// API info</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#lab04-mcp-resources-lab-__codelineno-32-5"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://info&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#lab04-mcp-resources-lab-__codelineno-32-6"></a>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#lab04-mcp-resources-lab-__codelineno-32-7"></a><span class="c1">// User profiles (using templates)</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#lab04-mcp-resources-lab-__codelineno-32-8"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://users/1&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#lab04-mcp-resources-lab-__codelineno-32-9"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://users/2&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#lab04-mcp-resources-lab-__codelineno-32-10"></a>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#lab04-mcp-resources-lab-__codelineno-32-11"></a><span class="c1">// Posts</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#lab04-mcp-resources-lab-__codelineno-32-12"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://posts/1&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#lab04-mcp-resources-lab-__codelineno-32-13"></a>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#lab04-mcp-resources-lab-__codelineno-32-14"></a><span class="c1">// Search (if supported by API)</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#lab04-mcp-resources-lab-__codelineno-32-15"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;api://search?q=lorem&amp;type=post&quot;</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>

</details>

<h3 id="lab04-mcp-resources-lab-exercise-3-database-resource-server">Exercise 3: Database Resource Server<a class="headerlink" href="#lab04-mcp-resources-lab-exercise-3-database-resource-server" title="Permanent link">&para;</a></h3>
<p>Create a tool that:</p>
<ul>
<li>Exposes database tables as resources</li>
<li>Supports parameterized queries via URI templates</li>
<li>Implements read-only access for security</li>
<li>Provides metadata about table schemas</li>
</ul>
<details>
<summary>💡 Solution: Database Resource Server</summary>

Tool Schema - Add this to your tools array:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#lab04-mcp-resources-lab-__codelineno-33-1"></a><span class="p">{</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#lab04-mcp-resources-lab-__codelineno-33-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;create_database_resource_server&quot;</span><span class="p">,</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#lab04-mcp-resources-lab-__codelineno-33-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Create an MCP server that exposes database tables as resources&quot;</span><span class="p">,</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#lab04-mcp-resources-lab-__codelineno-33-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#lab04-mcp-resources-lab-__codelineno-33-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#lab04-mcp-resources-lab-__codelineno-33-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#lab04-mcp-resources-lab-__codelineno-33-7"></a><span class="w">      </span><span class="nx">databasePath</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#lab04-mcp-resources-lab-__codelineno-33-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#lab04-mcp-resources-lab-__codelineno-33-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Path to SQLite database file&quot;</span><span class="p">,</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#lab04-mcp-resources-lab-__codelineno-33-10"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;./data.db&quot;</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#lab04-mcp-resources-lab-__codelineno-33-11"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#lab04-mcp-resources-lab-__codelineno-33-12"></a><span class="w">      </span><span class="nx">allowedTables</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#lab04-mcp-resources-lab-__codelineno-33-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#lab04-mcp-resources-lab-__codelineno-33-14"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Tables to expose as resources&quot;</span><span class="p">,</span>
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#lab04-mcp-resources-lab-__codelineno-33-15"></a><span class="w">        </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#lab04-mcp-resources-lab-__codelineno-33-16"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span>
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17" href="#lab04-mcp-resources-lab-__codelineno-33-17"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18" href="#lab04-mcp-resources-lab-__codelineno-33-18"></a><span class="w">      </span><span class="nx">readOnly</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-19"><a id="__codelineno-33-19" name="__codelineno-33-19" href="#lab04-mcp-resources-lab-__codelineno-33-19"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
</span><span id="__span-33-20"><a id="__codelineno-33-20" name="__codelineno-33-20" href="#lab04-mcp-resources-lab-__codelineno-33-20"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Enforce read-only access&quot;</span><span class="p">,</span>
</span><span id="__span-33-21"><a id="__codelineno-33-21" name="__codelineno-33-21" href="#lab04-mcp-resources-lab-__codelineno-33-21"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span>
</span><span id="__span-33-22"><a id="__codelineno-33-22" name="__codelineno-33-22" href="#lab04-mcp-resources-lab-__codelineno-33-22"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-33-23"><a id="__codelineno-33-23" name="__codelineno-33-23" href="#lab04-mcp-resources-lab-__codelineno-33-23"></a><span class="w">      </span><span class="nx">maxRows</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-24"><a id="__codelineno-33-24" name="__codelineno-33-24" href="#lab04-mcp-resources-lab-__codelineno-33-24"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-33-25"><a id="__codelineno-33-25" name="__codelineno-33-25" href="#lab04-mcp-resources-lab-__codelineno-33-25"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Maximum rows to return per query&quot;</span><span class="p">,</span>
</span><span id="__span-33-26"><a id="__codelineno-33-26" name="__codelineno-33-26" href="#lab04-mcp-resources-lab-__codelineno-33-26"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span>
</span><span id="__span-33-27"><a id="__codelineno-33-27" name="__codelineno-33-27" href="#lab04-mcp-resources-lab-__codelineno-33-27"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-33-28"><a id="__codelineno-33-28" name="__codelineno-33-28" href="#lab04-mcp-resources-lab-__codelineno-33-28"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-33-29"><a id="__codelineno-33-29" name="__codelineno-33-29" href="#lab04-mcp-resources-lab-__codelineno-33-29"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;databasePath&quot;</span><span class="p">]</span>
</span><span id="__span-33-30"><a id="__codelineno-33-30" name="__codelineno-33-30" href="#lab04-mcp-resources-lab-__codelineno-33-30"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-33-31"><a id="__codelineno-33-31" name="__codelineno-33-31" href="#lab04-mcp-resources-lab-__codelineno-33-31"></a><span class="p">}</span>
</span></code></pre></div>

Implementation

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#lab04-mcp-resources-lab-__codelineno-34-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#lab04-mcp-resources-lab-__codelineno-34-2"></a>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#lab04-mcp-resources-lab-__codelineno-34-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#lab04-mcp-resources-lab-__codelineno-34-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#lab04-mcp-resources-lab-__codelineno-34-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#lab04-mcp-resources-lab-__codelineno-34-6"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#lab04-mcp-resources-lab-__codelineno-34-7"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#lab04-mcp-resources-lab-__codelineno-34-8"></a><span class="w">  </span><span class="nx">ListResourceTemplatesRequestSchema</span><span class="p">,</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#lab04-mcp-resources-lab-__codelineno-34-9"></a><span class="w">  </span><span class="nx">ResourceTemplate</span><span class="p">,</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#lab04-mcp-resources-lab-__codelineno-34-10"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#lab04-mcp-resources-lab-__codelineno-34-11"></a><span class="k">import</span><span class="w"> </span><span class="nx">Database</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;better-sqlite3&#39;</span><span class="p">;</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#lab04-mcp-resources-lab-__codelineno-34-12"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs/promises&#39;</span><span class="p">;</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#lab04-mcp-resources-lab-__codelineno-34-13"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;path&#39;</span><span class="p">;</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#lab04-mcp-resources-lab-__codelineno-34-14"></a>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#lab04-mcp-resources-lab-__codelineno-34-15"></a><span class="kd">interface</span><span class="w"> </span><span class="nx">TableInfo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#lab04-mcp-resources-lab-__codelineno-34-16"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#lab04-mcp-resources-lab-__codelineno-34-17"></a><span class="w">  </span><span class="nx">columns</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#lab04-mcp-resources-lab-__codelineno-34-18"></a><span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#lab04-mcp-resources-lab-__codelineno-34-19"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#lab04-mcp-resources-lab-__codelineno-34-20"></a><span class="w">    </span><span class="nx">notnull</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#lab04-mcp-resources-lab-__codelineno-34-21"></a><span class="w">    </span><span class="nx">pk</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#lab04-mcp-resources-lab-__codelineno-34-22"></a><span class="w">  </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#lab04-mcp-resources-lab-__codelineno-34-23"></a><span class="w">  </span><span class="nx">rowCount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#lab04-mcp-resources-lab-__codelineno-34-24"></a><span class="p">}</span>
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#lab04-mcp-resources-lab-__codelineno-34-25"></a>
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#lab04-mcp-resources-lab-__codelineno-34-26"></a><span class="kd">class</span><span class="w"> </span><span class="nx">DatabaseResourceServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#lab04-mcp-resources-lab-__codelineno-34-27"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28" href="#lab04-mcp-resources-lab-__codelineno-34-28"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">dbPath</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
</span><span id="__span-34-29"><a id="__codelineno-34-29" name="__codelineno-34-29" href="#lab04-mcp-resources-lab-__codelineno-34-29"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">allowedTables</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
</span><span id="__span-34-30"><a id="__codelineno-34-30" name="__codelineno-34-30" href="#lab04-mcp-resources-lab-__codelineno-34-30"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">readOnly</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
</span><span id="__span-34-31"><a id="__codelineno-34-31" name="__codelineno-34-31" href="#lab04-mcp-resources-lab-__codelineno-34-31"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">maxRows</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</span><span id="__span-34-32"><a id="__codelineno-34-32" name="__codelineno-34-32" href="#lab04-mcp-resources-lab-__codelineno-34-32"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">db</span><span class="o">:</span><span class="w"> </span><span class="kt">Database.Database</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-34-33"><a id="__codelineno-34-33" name="__codelineno-34-33" href="#lab04-mcp-resources-lab-__codelineno-34-33"></a>
</span><span id="__span-34-34"><a id="__codelineno-34-34" name="__codelineno-34-34" href="#lab04-mcp-resources-lab-__codelineno-34-34"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">dbPath</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./data.db&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">allowedTables</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="nx">readOnly</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">maxRows</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-35"><a id="__codelineno-34-35" name="__codelineno-34-35" href="#lab04-mcp-resources-lab-__codelineno-34-35"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">dbPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">dbPath</span><span class="p">);</span>
</span><span id="__span-34-36"><a id="__codelineno-34-36" name="__codelineno-34-36" href="#lab04-mcp-resources-lab-__codelineno-34-36"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">allowedTables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">allowedTables</span><span class="p">;</span>
</span><span id="__span-34-37"><a id="__codelineno-34-37" name="__codelineno-34-37" href="#lab04-mcp-resources-lab-__codelineno-34-37"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">readOnly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">readOnly</span><span class="p">;</span>
</span><span id="__span-34-38"><a id="__codelineno-34-38" name="__codelineno-34-38" href="#lab04-mcp-resources-lab-__codelineno-34-38"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">maxRows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">maxRows</span><span class="p">;</span>
</span><span id="__span-34-39"><a id="__codelineno-34-39" name="__codelineno-34-39" href="#lab04-mcp-resources-lab-__codelineno-34-39"></a>
</span><span id="__span-34-40"><a id="__codelineno-34-40" name="__codelineno-34-40" href="#lab04-mcp-resources-lab-__codelineno-34-40"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-34-41"><a id="__codelineno-34-41" name="__codelineno-34-41" href="#lab04-mcp-resources-lab-__codelineno-34-41"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-34-42"><a id="__codelineno-34-42" name="__codelineno-34-42" href="#lab04-mcp-resources-lab-__codelineno-34-42"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;database-resource-server&quot;</span><span class="p">,</span>
</span><span id="__span-34-43"><a id="__codelineno-34-43" name="__codelineno-34-43" href="#lab04-mcp-resources-lab-__codelineno-34-43"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-34-44"><a id="__codelineno-34-44" name="__codelineno-34-44" href="#lab04-mcp-resources-lab-__codelineno-34-44"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-34-45"><a id="__codelineno-34-45" name="__codelineno-34-45" href="#lab04-mcp-resources-lab-__codelineno-34-45"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-34-46"><a id="__codelineno-34-46" name="__codelineno-34-46" href="#lab04-mcp-resources-lab-__codelineno-34-46"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-47"><a id="__codelineno-34-47" name="__codelineno-34-47" href="#lab04-mcp-resources-lab-__codelineno-34-47"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-34-48"><a id="__codelineno-34-48" name="__codelineno-34-48" href="#lab04-mcp-resources-lab-__codelineno-34-48"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-49"><a id="__codelineno-34-49" name="__codelineno-34-49" href="#lab04-mcp-resources-lab-__codelineno-34-49"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-34-50"><a id="__codelineno-34-50" name="__codelineno-34-50" href="#lab04-mcp-resources-lab-__codelineno-34-50"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-34-51"><a id="__codelineno-34-51" name="__codelineno-34-51" href="#lab04-mcp-resources-lab-__codelineno-34-51"></a>
</span><span id="__span-34-52"><a id="__codelineno-34-52" name="__codelineno-34-52" href="#lab04-mcp-resources-lab-__codelineno-34-52"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-34-53"><a id="__codelineno-34-53" name="__codelineno-34-53" href="#lab04-mcp-resources-lab-__codelineno-34-53"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-34-54"><a id="__codelineno-34-54" name="__codelineno-34-54" href="#lab04-mcp-resources-lab-__codelineno-34-54"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-55"><a id="__codelineno-34-55" name="__codelineno-34-55" href="#lab04-mcp-resources-lab-__codelineno-34-55"></a>
</span><span id="__span-34-56"><a id="__codelineno-34-56" name="__codelineno-34-56" href="#lab04-mcp-resources-lab-__codelineno-34-56"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-57"><a id="__codelineno-34-57" name="__codelineno-34-57" href="#lab04-mcp-resources-lab-__codelineno-34-57"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourceTemplatesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-58"><a id="__codelineno-34-58" name="__codelineno-34-58" href="#lab04-mcp-resources-lab-__codelineno-34-58"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">templates</span><span class="o">:</span><span class="w"> </span><span class="kt">ResourceTemplate</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-34-59"><a id="__codelineno-34-59" name="__codelineno-34-59" href="#lab04-mcp-resources-lab-__codelineno-34-59"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-34-60"><a id="__codelineno-34-60" name="__codelineno-34-60" href="#lab04-mcp-resources-lab-__codelineno-34-60"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/{tableName}/schema&quot;</span><span class="p">,</span>
</span><span id="__span-34-61"><a id="__codelineno-34-61" name="__codelineno-34-61" href="#lab04-mcp-resources-lab-__codelineno-34-61"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Table Schema&quot;</span><span class="p">,</span>
</span><span id="__span-34-62"><a id="__codelineno-34-62" name="__codelineno-34-62" href="#lab04-mcp-resources-lab-__codelineno-34-62"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Schema information for a database table&quot;</span><span class="p">,</span>
</span><span id="__span-34-63"><a id="__codelineno-34-63" name="__codelineno-34-63" href="#lab04-mcp-resources-lab-__codelineno-34-63"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-64"><a id="__codelineno-34-64" name="__codelineno-34-64" href="#lab04-mcp-resources-lab-__codelineno-34-64"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-65"><a id="__codelineno-34-65" name="__codelineno-34-65" href="#lab04-mcp-resources-lab-__codelineno-34-65"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-34-66"><a id="__codelineno-34-66" name="__codelineno-34-66" href="#lab04-mcp-resources-lab-__codelineno-34-66"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/{tableName}/data?limit={limit}&amp;offset={offset}&quot;</span><span class="p">,</span>
</span><span id="__span-34-67"><a id="__codelineno-34-67" name="__codelineno-34-67" href="#lab04-mcp-resources-lab-__codelineno-34-67"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Table Data&quot;</span><span class="p">,</span>
</span><span id="__span-34-68"><a id="__codelineno-34-68" name="__codelineno-34-68" href="#lab04-mcp-resources-lab-__codelineno-34-68"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Data from a database table with pagination&quot;</span><span class="p">,</span>
</span><span id="__span-34-69"><a id="__codelineno-34-69" name="__codelineno-34-69" href="#lab04-mcp-resources-lab-__codelineno-34-69"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-70"><a id="__codelineno-34-70" name="__codelineno-34-70" href="#lab04-mcp-resources-lab-__codelineno-34-70"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-71"><a id="__codelineno-34-71" name="__codelineno-34-71" href="#lab04-mcp-resources-lab-__codelineno-34-71"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-34-72"><a id="__codelineno-34-72" name="__codelineno-34-72" href="#lab04-mcp-resources-lab-__codelineno-34-72"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/{tableName}/records/{id}&quot;</span><span class="p">,</span>
</span><span id="__span-34-73"><a id="__codelineno-34-73" name="__codelineno-34-73" href="#lab04-mcp-resources-lab-__codelineno-34-73"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Table Record&quot;</span><span class="p">,</span>
</span><span id="__span-34-74"><a id="__codelineno-34-74" name="__codelineno-34-74" href="#lab04-mcp-resources-lab-__codelineno-34-74"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Specific record from a database table&quot;</span><span class="p">,</span>
</span><span id="__span-34-75"><a id="__codelineno-34-75" name="__codelineno-34-75" href="#lab04-mcp-resources-lab-__codelineno-34-75"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-76"><a id="__codelineno-34-76" name="__codelineno-34-76" href="#lab04-mcp-resources-lab-__codelineno-34-76"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-77"><a id="__codelineno-34-77" name="__codelineno-34-77" href="#lab04-mcp-resources-lab-__codelineno-34-77"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-34-78"><a id="__codelineno-34-78" name="__codelineno-34-78" href="#lab04-mcp-resources-lab-__codelineno-34-78"></a><span class="w">          </span><span class="nx">uriTemplate</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://query?sql={sql}&amp;params={params}&quot;</span><span class="p">,</span>
</span><span id="__span-34-79"><a id="__codelineno-34-79" name="__codelineno-34-79" href="#lab04-mcp-resources-lab-__codelineno-34-79"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Custom Query&quot;</span><span class="p">,</span>
</span><span id="__span-34-80"><a id="__codelineno-34-80" name="__codelineno-34-80" href="#lab04-mcp-resources-lab-__codelineno-34-80"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Execute a custom SELECT query&quot;</span><span class="p">,</span>
</span><span id="__span-34-81"><a id="__codelineno-34-81" name="__codelineno-34-81" href="#lab04-mcp-resources-lab-__codelineno-34-81"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-82"><a id="__codelineno-34-82" name="__codelineno-34-82" href="#lab04-mcp-resources-lab-__codelineno-34-82"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-83"><a id="__codelineno-34-83" name="__codelineno-34-83" href="#lab04-mcp-resources-lab-__codelineno-34-83"></a><span class="w">      </span><span class="p">];</span>
</span><span id="__span-34-84"><a id="__codelineno-34-84" name="__codelineno-34-84" href="#lab04-mcp-resources-lab-__codelineno-34-84"></a>
</span><span id="__span-34-85"><a id="__codelineno-34-85" name="__codelineno-34-85" href="#lab04-mcp-resources-lab-__codelineno-34-85"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resourceTemplates</span><span class="o">:</span><span class="w"> </span><span class="kt">templates</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-34-86"><a id="__codelineno-34-86" name="__codelineno-34-86" href="#lab04-mcp-resources-lab-__codelineno-34-86"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-34-87"><a id="__codelineno-34-87" name="__codelineno-34-87" href="#lab04-mcp-resources-lab-__codelineno-34-87"></a>
</span><span id="__span-34-88"><a id="__codelineno-34-88" name="__codelineno-34-88" href="#lab04-mcp-resources-lab-__codelineno-34-88"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-89"><a id="__codelineno-34-89" name="__codelineno-34-89" href="#lab04-mcp-resources-lab-__codelineno-34-89"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-34-90"><a id="__codelineno-34-90" name="__codelineno-34-90" href="#lab04-mcp-resources-lab-__codelineno-34-90"></a>
</span><span id="__span-34-91"><a id="__codelineno-34-91" name="__codelineno-34-91" href="#lab04-mcp-resources-lab-__codelineno-34-91"></a><span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-92"><a id="__codelineno-34-92" name="__codelineno-34-92" href="#lab04-mcp-resources-lab-__codelineno-34-92"></a><span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">ensureDatabase</span><span class="p">();</span>
</span><span id="__span-34-93"><a id="__codelineno-34-93" name="__codelineno-34-93" href="#lab04-mcp-resources-lab-__codelineno-34-93"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">tables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTableInfo</span><span class="p">();</span>
</span><span id="__span-34-94"><a id="__codelineno-34-94" name="__codelineno-34-94" href="#lab04-mcp-resources-lab-__codelineno-34-94"></a>
</span><span id="__span-34-95"><a id="__codelineno-34-95" name="__codelineno-34-95" href="#lab04-mcp-resources-lab-__codelineno-34-95"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">tables</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-96"><a id="__codelineno-34-96" name="__codelineno-34-96" href="#lab04-mcp-resources-lab-__codelineno-34-96"></a><span class="w">          </span><span class="c1">// Table schema resource</span>
</span><span id="__span-34-97"><a id="__codelineno-34-97" name="__codelineno-34-97" href="#lab04-mcp-resources-lab-__codelineno-34-97"></a><span class="w">          </span><span class="nx">resources</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-34-98"><a id="__codelineno-34-98" name="__codelineno-34-98" href="#lab04-mcp-resources-lab-__codelineno-34-98"></a><span class="w">            </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://tables/</span><span class="si">${</span><span class="nx">table</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">/schema`</span><span class="p">,</span>
</span><span id="__span-34-99"><a id="__codelineno-34-99" name="__codelineno-34-99" href="#lab04-mcp-resources-lab-__codelineno-34-99"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">table</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> Schema`</span><span class="p">,</span>
</span><span id="__span-34-100"><a id="__codelineno-34-100" name="__codelineno-34-100" href="#lab04-mcp-resources-lab-__codelineno-34-100"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Schema for table </span><span class="si">${</span><span class="nx">table</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> (</span><span class="si">${</span><span class="nx">table</span><span class="p">.</span><span class="nx">columns</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb"> columns)`</span><span class="p">,</span>
</span><span id="__span-34-101"><a id="__codelineno-34-101" name="__codelineno-34-101" href="#lab04-mcp-resources-lab-__codelineno-34-101"></a><span class="w">            </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-102"><a id="__codelineno-34-102" name="__codelineno-34-102" href="#lab04-mcp-resources-lab-__codelineno-34-102"></a><span class="w">          </span><span class="p">});</span>
</span><span id="__span-34-103"><a id="__codelineno-34-103" name="__codelineno-34-103" href="#lab04-mcp-resources-lab-__codelineno-34-103"></a>
</span><span id="__span-34-104"><a id="__codelineno-34-104" name="__codelineno-34-104" href="#lab04-mcp-resources-lab-__codelineno-34-104"></a><span class="w">          </span><span class="c1">// Table data resource</span>
</span><span id="__span-34-105"><a id="__codelineno-34-105" name="__codelineno-34-105" href="#lab04-mcp-resources-lab-__codelineno-34-105"></a><span class="w">          </span><span class="nx">resources</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-34-106"><a id="__codelineno-34-106" name="__codelineno-34-106" href="#lab04-mcp-resources-lab-__codelineno-34-106"></a><span class="w">            </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://tables/</span><span class="si">${</span><span class="nx">table</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">/data?limit=100`</span><span class="p">,</span>
</span><span id="__span-34-107"><a id="__codelineno-34-107" name="__codelineno-34-107" href="#lab04-mcp-resources-lab-__codelineno-34-107"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">table</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> Data`</span><span class="p">,</span>
</span><span id="__span-34-108"><a id="__codelineno-34-108" name="__codelineno-34-108" href="#lab04-mcp-resources-lab-__codelineno-34-108"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Data from table </span><span class="si">${</span><span class="nx">table</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> (</span><span class="si">${</span><span class="nx">table</span><span class="p">.</span><span class="nx">rowCount</span><span class="si">}</span><span class="sb"> rows)`</span><span class="p">,</span>
</span><span id="__span-34-109"><a id="__codelineno-34-109" name="__codelineno-34-109" href="#lab04-mcp-resources-lab-__codelineno-34-109"></a><span class="w">            </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-110"><a id="__codelineno-34-110" name="__codelineno-34-110" href="#lab04-mcp-resources-lab-__codelineno-34-110"></a><span class="w">          </span><span class="p">});</span>
</span><span id="__span-34-111"><a id="__codelineno-34-111" name="__codelineno-34-111" href="#lab04-mcp-resources-lab-__codelineno-34-111"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-34-112"><a id="__codelineno-34-112" name="__codelineno-34-112" href="#lab04-mcp-resources-lab-__codelineno-34-112"></a>
</span><span id="__span-34-113"><a id="__codelineno-34-113" name="__codelineno-34-113" href="#lab04-mcp-resources-lab-__codelineno-34-113"></a><span class="w">        </span><span class="c1">// Database info resource</span>
</span><span id="__span-34-114"><a id="__codelineno-34-114" name="__codelineno-34-114" href="#lab04-mcp-resources-lab-__codelineno-34-114"></a><span class="w">        </span><span class="nx">resources</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-34-115"><a id="__codelineno-34-115" name="__codelineno-34-115" href="#lab04-mcp-resources-lab-__codelineno-34-115"></a><span class="w">          </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://info&quot;</span><span class="p">,</span>
</span><span id="__span-34-116"><a id="__codelineno-34-116" name="__codelineno-34-116" href="#lab04-mcp-resources-lab-__codelineno-34-116"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Database Info&quot;</span><span class="p">,</span>
</span><span id="__span-34-117"><a id="__codelineno-34-117" name="__codelineno-34-117" href="#lab04-mcp-resources-lab-__codelineno-34-117"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Database metadata and statistics&quot;</span><span class="p">,</span>
</span><span id="__span-34-118"><a id="__codelineno-34-118" name="__codelineno-34-118" href="#lab04-mcp-resources-lab-__codelineno-34-118"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-119"><a id="__codelineno-34-119" name="__codelineno-34-119" href="#lab04-mcp-resources-lab-__codelineno-34-119"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-34-120"><a id="__codelineno-34-120" name="__codelineno-34-120" href="#lab04-mcp-resources-lab-__codelineno-34-120"></a>
</span><span id="__span-34-121"><a id="__codelineno-34-121" name="__codelineno-34-121" href="#lab04-mcp-resources-lab-__codelineno-34-121"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-122"><a id="__codelineno-34-122" name="__codelineno-34-122" href="#lab04-mcp-resources-lab-__codelineno-34-122"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error listing resources:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-34-123"><a id="__codelineno-34-123" name="__codelineno-34-123" href="#lab04-mcp-resources-lab-__codelineno-34-123"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-34-124"><a id="__codelineno-34-124" name="__codelineno-34-124" href="#lab04-mcp-resources-lab-__codelineno-34-124"></a>
</span><span id="__span-34-125"><a id="__codelineno-34-125" name="__codelineno-34-125" href="#lab04-mcp-resources-lab-__codelineno-34-125"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-34-126"><a id="__codelineno-34-126" name="__codelineno-34-126" href="#lab04-mcp-resources-lab-__codelineno-34-126"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-34-127"><a id="__codelineno-34-127" name="__codelineno-34-127" href="#lab04-mcp-resources-lab-__codelineno-34-127"></a>
</span><span id="__span-34-128"><a id="__codelineno-34-128" name="__codelineno-34-128" href="#lab04-mcp-resources-lab-__codelineno-34-128"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-129"><a id="__codelineno-34-129" name="__codelineno-34-129" href="#lab04-mcp-resources-lab-__codelineno-34-129"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-34-130"><a id="__codelineno-34-130" name="__codelineno-34-130" href="#lab04-mcp-resources-lab-__codelineno-34-130"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readDatabaseResource</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-34-131"><a id="__codelineno-34-131" name="__codelineno-34-131" href="#lab04-mcp-resources-lab-__codelineno-34-131"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-34-132"><a id="__codelineno-34-132" name="__codelineno-34-132" href="#lab04-mcp-resources-lab-__codelineno-34-132"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-34-133"><a id="__codelineno-34-133" name="__codelineno-34-133" href="#lab04-mcp-resources-lab-__codelineno-34-133"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-134"><a id="__codelineno-34-134" name="__codelineno-34-134" href="#lab04-mcp-resources-lab-__codelineno-34-134"></a>
</span><span id="__span-34-135"><a id="__codelineno-34-135" name="__codelineno-34-135" href="#lab04-mcp-resources-lab-__codelineno-34-135"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">ensureDatabase</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-136"><a id="__codelineno-34-136" name="__codelineno-34-136" href="#lab04-mcp-resources-lab-__codelineno-34-136"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-34-137"><a id="__codelineno-34-137" name="__codelineno-34-137" href="#lab04-mcp-resources-lab-__codelineno-34-137"></a>
</span><span id="__span-34-138"><a id="__codelineno-34-138" name="__codelineno-34-138" href="#lab04-mcp-resources-lab-__codelineno-34-138"></a><span class="w">    </span><span class="c1">// Check if database file exists</span>
</span><span id="__span-34-139"><a id="__codelineno-34-139" name="__codelineno-34-139" href="#lab04-mcp-resources-lab-__codelineno-34-139"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-140"><a id="__codelineno-34-140" name="__codelineno-34-140" href="#lab04-mcp-resources-lab-__codelineno-34-140"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dbPath</span><span class="p">,</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">R_OK</span><span class="p">);</span>
</span><span id="__span-34-141"><a id="__codelineno-34-141" name="__codelineno-34-141" href="#lab04-mcp-resources-lab-__codelineno-34-141"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-142"><a id="__codelineno-34-142" name="__codelineno-34-142" href="#lab04-mcp-resources-lab-__codelineno-34-142"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Database file not found: </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">dbPath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-143"><a id="__codelineno-34-143" name="__codelineno-34-143" href="#lab04-mcp-resources-lab-__codelineno-34-143"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-144"><a id="__codelineno-34-144" name="__codelineno-34-144" href="#lab04-mcp-resources-lab-__codelineno-34-144"></a>
</span><span id="__span-34-145"><a id="__codelineno-34-145" name="__codelineno-34-145" href="#lab04-mcp-resources-lab-__codelineno-34-145"></a><span class="w">    </span><span class="c1">// Open database in read-only mode if specified</span>
</span><span id="__span-34-146"><a id="__codelineno-34-146" name="__codelineno-34-146" href="#lab04-mcp-resources-lab-__codelineno-34-146"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Database</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dbPath</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">readonly</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readOnly</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-34-147"><a id="__codelineno-34-147" name="__codelineno-34-147" href="#lab04-mcp-resources-lab-__codelineno-34-147"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-148"><a id="__codelineno-34-148" name="__codelineno-34-148" href="#lab04-mcp-resources-lab-__codelineno-34-148"></a>
</span><span id="__span-34-149"><a id="__codelineno-34-149" name="__codelineno-34-149" href="#lab04-mcp-resources-lab-__codelineno-34-149"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getTableInfo</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">TableInfo</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-150"><a id="__codelineno-34-150" name="__codelineno-34-150" href="#lab04-mcp-resources-lab-__codelineno-34-150"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Database not initialized&#39;</span><span class="p">);</span>
</span><span id="__span-34-151"><a id="__codelineno-34-151" name="__codelineno-34-151" href="#lab04-mcp-resources-lab-__codelineno-34-151"></a>
</span><span id="__span-34-152"><a id="__codelineno-34-152" name="__codelineno-34-152" href="#lab04-mcp-resources-lab-__codelineno-34-152"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tables</span><span class="o">:</span><span class="w"> </span><span class="kt">TableInfo</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-34-153"><a id="__codelineno-34-153" name="__codelineno-34-153" href="#lab04-mcp-resources-lab-__codelineno-34-153"></a>
</span><span id="__span-34-154"><a id="__codelineno-34-154" name="__codelineno-34-154" href="#lab04-mcp-resources-lab-__codelineno-34-154"></a><span class="w">    </span><span class="c1">// Get all tables</span>
</span><span id="__span-34-155"><a id="__codelineno-34-155" name="__codelineno-34-155" href="#lab04-mcp-resources-lab-__codelineno-34-155"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tableNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="sb">`</span>
</span><span id="__span-34-156"><a id="__codelineno-34-156" name="__codelineno-34-156" href="#lab04-mcp-resources-lab-__codelineno-34-156"></a><span class="sb">      SELECT name FROM sqlite_master </span>
</span><span id="__span-34-157"><a id="__codelineno-34-157" name="__codelineno-34-157" href="#lab04-mcp-resources-lab-__codelineno-34-157"></a><span class="sb">      WHERE type=&#39;table&#39; AND name NOT LIKE &#39;sqlite_%&#39;</span>
</span><span id="__span-34-158"><a id="__codelineno-34-158" name="__codelineno-34-158" href="#lab04-mcp-resources-lab-__codelineno-34-158"></a><span class="sb">    `</span><span class="p">).</span><span class="nx">all</span><span class="p">()</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nb">Array</span><span class="o">&lt;</span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
</span><span id="__span-34-159"><a id="__codelineno-34-159" name="__codelineno-34-159" href="#lab04-mcp-resources-lab-__codelineno-34-159"></a>
</span><span id="__span-34-160"><a id="__codelineno-34-160" name="__codelineno-34-160" href="#lab04-mcp-resources-lab-__codelineno-34-160"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">tableNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-161"><a id="__codelineno-34-161" name="__codelineno-34-161" href="#lab04-mcp-resources-lab-__codelineno-34-161"></a><span class="w">      </span><span class="c1">// Check if table is allowed</span>
</span><span id="__span-34-162"><a id="__codelineno-34-162" name="__codelineno-34-162" href="#lab04-mcp-resources-lab-__codelineno-34-162"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedTables</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedTables</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-163"><a id="__codelineno-34-163" name="__codelineno-34-163" href="#lab04-mcp-resources-lab-__codelineno-34-163"></a><span class="w">        </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-34-164"><a id="__codelineno-34-164" name="__codelineno-34-164" href="#lab04-mcp-resources-lab-__codelineno-34-164"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-34-165"><a id="__codelineno-34-165" name="__codelineno-34-165" href="#lab04-mcp-resources-lab-__codelineno-34-165"></a>
</span><span id="__span-34-166"><a id="__codelineno-34-166" name="__codelineno-34-166" href="#lab04-mcp-resources-lab-__codelineno-34-166"></a><span class="w">      </span><span class="c1">// Get column info</span>
</span><span id="__span-34-167"><a id="__codelineno-34-167" name="__codelineno-34-167" href="#lab04-mcp-resources-lab-__codelineno-34-167"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="sb">`PRAGMA table_info(</span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">)`</span><span class="p">).</span><span class="nx">all</span><span class="p">()</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">[];</span>
</span><span id="__span-34-168"><a id="__codelineno-34-168" name="__codelineno-34-168" href="#lab04-mcp-resources-lab-__codelineno-34-168"></a>
</span><span id="__span-34-169"><a id="__codelineno-34-169" name="__codelineno-34-169" href="#lab04-mcp-resources-lab-__codelineno-34-169"></a><span class="w">      </span><span class="c1">// Get row count</span>
</span><span id="__span-34-170"><a id="__codelineno-34-170" name="__codelineno-34-170" href="#lab04-mcp-resources-lab-__codelineno-34-170"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">rowCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="sb">`SELECT COUNT(*) as count FROM </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">).</span><span class="nx">get</span><span class="p">()</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">).</span><span class="nx">count</span><span class="p">;</span>
</span><span id="__span-34-171"><a id="__codelineno-34-171" name="__codelineno-34-171" href="#lab04-mcp-resources-lab-__codelineno-34-171"></a>
</span><span id="__span-34-172"><a id="__codelineno-34-172" name="__codelineno-34-172" href="#lab04-mcp-resources-lab-__codelineno-34-172"></a><span class="w">      </span><span class="nx">tables</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-34-173"><a id="__codelineno-34-173" name="__codelineno-34-173" href="#lab04-mcp-resources-lab-__codelineno-34-173"></a><span class="w">        </span><span class="nx">name</span><span class="p">,</span>
</span><span id="__span-34-174"><a id="__codelineno-34-174" name="__codelineno-34-174" href="#lab04-mcp-resources-lab-__codelineno-34-174"></a><span class="w">        </span><span class="nx">columns</span><span class="o">:</span><span class="w"> </span><span class="kt">columns.map</span><span class="p">(</span><span class="nx">col</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-34-175"><a id="__codelineno-34-175" name="__codelineno-34-175" href="#lab04-mcp-resources-lab-__codelineno-34-175"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">col.name</span><span class="p">,</span>
</span><span id="__span-34-176"><a id="__codelineno-34-176" name="__codelineno-34-176" href="#lab04-mcp-resources-lab-__codelineno-34-176"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">col</span><span class="p">.</span><span class="kr">type</span><span class="p">,</span>
</span><span id="__span-34-177"><a id="__codelineno-34-177" name="__codelineno-34-177" href="#lab04-mcp-resources-lab-__codelineno-34-177"></a><span class="w">          </span><span class="nx">notnull</span><span class="o">:</span><span class="w"> </span><span class="kt">col.notnull</span><span class="p">,</span>
</span><span id="__span-34-178"><a id="__codelineno-34-178" name="__codelineno-34-178" href="#lab04-mcp-resources-lab-__codelineno-34-178"></a><span class="w">          </span><span class="nx">pk</span><span class="o">:</span><span class="w"> </span><span class="kt">col.pk</span><span class="p">,</span>
</span><span id="__span-34-179"><a id="__codelineno-34-179" name="__codelineno-34-179" href="#lab04-mcp-resources-lab-__codelineno-34-179"></a><span class="w">        </span><span class="p">})),</span>
</span><span id="__span-34-180"><a id="__codelineno-34-180" name="__codelineno-34-180" href="#lab04-mcp-resources-lab-__codelineno-34-180"></a><span class="w">        </span><span class="nx">rowCount</span><span class="p">,</span>
</span><span id="__span-34-181"><a id="__codelineno-34-181" name="__codelineno-34-181" href="#lab04-mcp-resources-lab-__codelineno-34-181"></a><span class="w">      </span><span class="p">});</span>
</span><span id="__span-34-182"><a id="__codelineno-34-182" name="__codelineno-34-182" href="#lab04-mcp-resources-lab-__codelineno-34-182"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-183"><a id="__codelineno-34-183" name="__codelineno-34-183" href="#lab04-mcp-resources-lab-__codelineno-34-183"></a>
</span><span id="__span-34-184"><a id="__codelineno-34-184" name="__codelineno-34-184" href="#lab04-mcp-resources-lab-__codelineno-34-184"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">tables</span><span class="p">;</span>
</span><span id="__span-34-185"><a id="__codelineno-34-185" name="__codelineno-34-185" href="#lab04-mcp-resources-lab-__codelineno-34-185"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-186"><a id="__codelineno-34-186" name="__codelineno-34-186" href="#lab04-mcp-resources-lab-__codelineno-34-186"></a>
</span><span id="__span-34-187"><a id="__codelineno-34-187" name="__codelineno-34-187" href="#lab04-mcp-resources-lab-__codelineno-34-187"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">readDatabaseResource</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-188"><a id="__codelineno-34-188" name="__codelineno-34-188" href="#lab04-mcp-resources-lab-__codelineno-34-188"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">ensureDatabase</span><span class="p">();</span>
</span><span id="__span-34-189"><a id="__codelineno-34-189" name="__codelineno-34-189" href="#lab04-mcp-resources-lab-__codelineno-34-189"></a>
</span><span id="__span-34-190"><a id="__codelineno-34-190" name="__codelineno-34-190" href="#lab04-mcp-resources-lab-__codelineno-34-190"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">uri</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;db://&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-191"><a id="__codelineno-34-191" name="__codelineno-34-191" href="#lab04-mcp-resources-lab-__codelineno-34-191"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid database URI: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-192"><a id="__codelineno-34-192" name="__codelineno-34-192" href="#lab04-mcp-resources-lab-__codelineno-34-192"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-193"><a id="__codelineno-34-193" name="__codelineno-34-193" href="#lab04-mcp-resources-lab-__codelineno-34-193"></a>
</span><span id="__span-34-194"><a id="__codelineno-34-194" name="__codelineno-34-194" href="#lab04-mcp-resources-lab-__codelineno-34-194"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;db://&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span id="__span-34-195"><a id="__codelineno-34-195" name="__codelineno-34-195" href="#lab04-mcp-resources-lab-__codelineno-34-195"></a>
</span><span id="__span-34-196"><a id="__codelineno-34-196" name="__codelineno-34-196" href="#lab04-mcp-resources-lab-__codelineno-34-196"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-197"><a id="__codelineno-34-197" name="__codelineno-34-197" href="#lab04-mcp-resources-lab-__codelineno-34-197"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getDatabaseInfo</span><span class="p">();</span>
</span><span id="__span-34-198"><a id="__codelineno-34-198" name="__codelineno-34-198" href="#lab04-mcp-resources-lab-__codelineno-34-198"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-199"><a id="__codelineno-34-199" name="__codelineno-34-199" href="#lab04-mcp-resources-lab-__codelineno-34-199"></a>
</span><span id="__span-34-200"><a id="__codelineno-34-200" name="__codelineno-34-200" href="#lab04-mcp-resources-lab-__codelineno-34-200"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;tables/&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-201"><a id="__codelineno-34-201" name="__codelineno-34-201" href="#lab04-mcp-resources-lab-__codelineno-34-201"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readTableResource</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;tables/&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">));</span>
</span><span id="__span-34-202"><a id="__codelineno-34-202" name="__codelineno-34-202" href="#lab04-mcp-resources-lab-__codelineno-34-202"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-203"><a id="__codelineno-34-203" name="__codelineno-34-203" href="#lab04-mcp-resources-lab-__codelineno-34-203"></a>
</span><span id="__span-34-204"><a id="__codelineno-34-204" name="__codelineno-34-204" href="#lab04-mcp-resources-lab-__codelineno-34-204"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;query?&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-205"><a id="__codelineno-34-205" name="__codelineno-34-205" href="#lab04-mcp-resources-lab-__codelineno-34-205"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">executeCustomQuery</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s1">&#39;query?&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">));</span>
</span><span id="__span-34-206"><a id="__codelineno-34-206" name="__codelineno-34-206" href="#lab04-mcp-resources-lab-__codelineno-34-206"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-207"><a id="__codelineno-34-207" name="__codelineno-34-207" href="#lab04-mcp-resources-lab-__codelineno-34-207"></a>
</span><span id="__span-34-208"><a id="__codelineno-34-208" name="__codelineno-34-208" href="#lab04-mcp-resources-lab-__codelineno-34-208"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown database resource: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-209"><a id="__codelineno-34-209" name="__codelineno-34-209" href="#lab04-mcp-resources-lab-__codelineno-34-209"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-210"><a id="__codelineno-34-210" name="__codelineno-34-210" href="#lab04-mcp-resources-lab-__codelineno-34-210"></a>
</span><span id="__span-34-211"><a id="__codelineno-34-211" name="__codelineno-34-211" href="#lab04-mcp-resources-lab-__codelineno-34-211"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getDatabaseInfo</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-212"><a id="__codelineno-34-212" name="__codelineno-34-212" href="#lab04-mcp-resources-lab-__codelineno-34-212"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Database not initialized&#39;</span><span class="p">);</span>
</span><span id="__span-34-213"><a id="__codelineno-34-213" name="__codelineno-34-213" href="#lab04-mcp-resources-lab-__codelineno-34-213"></a>
</span><span id="__span-34-214"><a id="__codelineno-34-214" name="__codelineno-34-214" href="#lab04-mcp-resources-lab-__codelineno-34-214"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTableInfo</span><span class="p">();</span>
</span><span id="__span-34-215"><a id="__codelineno-34-215" name="__codelineno-34-215" href="#lab04-mcp-resources-lab-__codelineno-34-215"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">dbStats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="sb">`</span>
</span><span id="__span-34-216"><a id="__codelineno-34-216" name="__codelineno-34-216" href="#lab04-mcp-resources-lab-__codelineno-34-216"></a><span class="sb">      SELECT </span>
</span><span id="__span-34-217"><a id="__codelineno-34-217" name="__codelineno-34-217" href="#lab04-mcp-resources-lab-__codelineno-34-217"></a><span class="sb">        COUNT(*) as tableCount,</span>
</span><span id="__span-34-218"><a id="__codelineno-34-218" name="__codelineno-34-218" href="#lab04-mcp-resources-lab-__codelineno-34-218"></a><span class="sb">        SUM(</span>
</span><span id="__span-34-219"><a id="__codelineno-34-219" name="__codelineno-34-219" href="#lab04-mcp-resources-lab-__codelineno-34-219"></a><span class="sb">          (SELECT COUNT(*) FROM sqlite_master WHERE type=&#39;index&#39;) +</span>
</span><span id="__span-34-220"><a id="__codelineno-34-220" name="__codelineno-34-220" href="#lab04-mcp-resources-lab-__codelineno-34-220"></a><span class="sb">          (SELECT COUNT(*) FROM pragma_table_info(name))</span>
</span><span id="__span-34-221"><a id="__codelineno-34-221" name="__codelineno-34-221" href="#lab04-mcp-resources-lab-__codelineno-34-221"></a><span class="sb">        ) as totalColumns</span>
</span><span id="__span-34-222"><a id="__codelineno-34-222" name="__codelineno-34-222" href="#lab04-mcp-resources-lab-__codelineno-34-222"></a><span class="sb">      FROM sqlite_master </span>
</span><span id="__span-34-223"><a id="__codelineno-34-223" name="__codelineno-34-223" href="#lab04-mcp-resources-lab-__codelineno-34-223"></a><span class="sb">      WHERE type=&#39;table&#39; AND name NOT LIKE &#39;sqlite_%&#39;</span>
</span><span id="__span-34-224"><a id="__codelineno-34-224" name="__codelineno-34-224" href="#lab04-mcp-resources-lab-__codelineno-34-224"></a><span class="sb">    `</span><span class="p">).</span><span class="nx">get</span><span class="p">()</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">;</span>
</span><span id="__span-34-225"><a id="__codelineno-34-225" name="__codelineno-34-225" href="#lab04-mcp-resources-lab-__codelineno-34-225"></a>
</span><span id="__span-34-226"><a id="__codelineno-34-226" name="__codelineno-34-226" href="#lab04-mcp-resources-lab-__codelineno-34-226"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-227"><a id="__codelineno-34-227" name="__codelineno-34-227" href="#lab04-mcp-resources-lab-__codelineno-34-227"></a><span class="w">      </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://info&quot;</span><span class="p">,</span>
</span><span id="__span-34-228"><a id="__codelineno-34-228" name="__codelineno-34-228" href="#lab04-mcp-resources-lab-__codelineno-34-228"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-229"><a id="__codelineno-34-229" name="__codelineno-34-229" href="#lab04-mcp-resources-lab-__codelineno-34-229"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-34-230"><a id="__codelineno-34-230" name="__codelineno-34-230" href="#lab04-mcp-resources-lab-__codelineno-34-230"></a><span class="w">        </span><span class="nx">database</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-231"><a id="__codelineno-34-231" name="__codelineno-34-231" href="#lab04-mcp-resources-lab-__codelineno-34-231"></a><span class="w">          </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="kt">this.dbPath</span><span class="p">,</span>
</span><span id="__span-34-232"><a id="__codelineno-34-232" name="__codelineno-34-232" href="#lab04-mcp-resources-lab-__codelineno-34-232"></a><span class="w">          </span><span class="nx">readOnly</span><span class="o">:</span><span class="w"> </span><span class="kt">this.readOnly</span><span class="p">,</span>
</span><span id="__span-34-233"><a id="__codelineno-34-233" name="__codelineno-34-233" href="#lab04-mcp-resources-lab-__codelineno-34-233"></a><span class="w">          </span><span class="nx">tableCount</span><span class="o">:</span><span class="w"> </span><span class="kt">dbStats.tableCount</span><span class="p">,</span>
</span><span id="__span-34-234"><a id="__codelineno-34-234" name="__codelineno-34-234" href="#lab04-mcp-resources-lab-__codelineno-34-234"></a><span class="w">          </span><span class="nx">totalColumns</span><span class="o">:</span><span class="w"> </span><span class="kt">dbStats.totalColumns</span><span class="p">,</span>
</span><span id="__span-34-235"><a id="__codelineno-34-235" name="__codelineno-34-235" href="#lab04-mcp-resources-lab-__codelineno-34-235"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-236"><a id="__codelineno-34-236" name="__codelineno-34-236" href="#lab04-mcp-resources-lab-__codelineno-34-236"></a><span class="w">        </span><span class="nx">tables</span><span class="o">:</span><span class="w"> </span><span class="kt">tables.map</span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-34-237"><a id="__codelineno-34-237" name="__codelineno-34-237" href="#lab04-mcp-resources-lab-__codelineno-34-237"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">t.name</span><span class="p">,</span>
</span><span id="__span-34-238"><a id="__codelineno-34-238" name="__codelineno-34-238" href="#lab04-mcp-resources-lab-__codelineno-34-238"></a><span class="w">          </span><span class="nx">columns</span><span class="o">:</span><span class="w"> </span><span class="kt">t.columns.length</span><span class="p">,</span>
</span><span id="__span-34-239"><a id="__codelineno-34-239" name="__codelineno-34-239" href="#lab04-mcp-resources-lab-__codelineno-34-239"></a><span class="w">          </span><span class="nx">rows</span><span class="o">:</span><span class="w"> </span><span class="kt">t.rowCount</span><span class="p">,</span>
</span><span id="__span-34-240"><a id="__codelineno-34-240" name="__codelineno-34-240" href="#lab04-mcp-resources-lab-__codelineno-34-240"></a><span class="w">          </span><span class="nx">primaryKey</span><span class="o">:</span><span class="w"> </span><span class="kt">t.columns.find</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">pk</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span><span id="__span-34-241"><a id="__codelineno-34-241" name="__codelineno-34-241" href="#lab04-mcp-resources-lab-__codelineno-34-241"></a><span class="w">        </span><span class="p">})),</span>
</span><span id="__span-34-242"><a id="__codelineno-34-242" name="__codelineno-34-242" href="#lab04-mcp-resources-lab-__codelineno-34-242"></a><span class="w">        </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-243"><a id="__codelineno-34-243" name="__codelineno-34-243" href="#lab04-mcp-resources-lab-__codelineno-34-243"></a><span class="w">          </span><span class="nx">maxRows</span><span class="o">:</span><span class="w"> </span><span class="kt">this.maxRows</span><span class="p">,</span>
</span><span id="__span-34-244"><a id="__codelineno-34-244" name="__codelineno-34-244" href="#lab04-mcp-resources-lab-__codelineno-34-244"></a><span class="w">          </span><span class="nx">allowedTables</span><span class="o">:</span><span class="w"> </span><span class="kt">this.allowedTables.length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">allowedTables</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
</span><span id="__span-34-245"><a id="__codelineno-34-245" name="__codelineno-34-245" href="#lab04-mcp-resources-lab-__codelineno-34-245"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-246"><a id="__codelineno-34-246" name="__codelineno-34-246" href="#lab04-mcp-resources-lab-__codelineno-34-246"></a><span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-34-247"><a id="__codelineno-34-247" name="__codelineno-34-247" href="#lab04-mcp-resources-lab-__codelineno-34-247"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-34-248"><a id="__codelineno-34-248" name="__codelineno-34-248" href="#lab04-mcp-resources-lab-__codelineno-34-248"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-249"><a id="__codelineno-34-249" name="__codelineno-34-249" href="#lab04-mcp-resources-lab-__codelineno-34-249"></a>
</span><span id="__span-34-250"><a id="__codelineno-34-250" name="__codelineno-34-250" href="#lab04-mcp-resources-lab-__codelineno-34-250"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">readTableResource</span><span class="p">(</span><span class="nx">tablePath</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-251"><a id="__codelineno-34-251" name="__codelineno-34-251" href="#lab04-mcp-resources-lab-__codelineno-34-251"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Database not initialized&#39;</span><span class="p">);</span>
</span><span id="__span-34-252"><a id="__codelineno-34-252" name="__codelineno-34-252" href="#lab04-mcp-resources-lab-__codelineno-34-252"></a>
</span><span id="__span-34-253"><a id="__codelineno-34-253" name="__codelineno-34-253" href="#lab04-mcp-resources-lab-__codelineno-34-253"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tablePath</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span><span id="__span-34-254"><a id="__codelineno-34-254" name="__codelineno-34-254" href="#lab04-mcp-resources-lab-__codelineno-34-254"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tableName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="__span-34-255"><a id="__codelineno-34-255" name="__codelineno-34-255" href="#lab04-mcp-resources-lab-__codelineno-34-255"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
</span><span id="__span-34-256"><a id="__codelineno-34-256" name="__codelineno-34-256" href="#lab04-mcp-resources-lab-__codelineno-34-256"></a>
</span><span id="__span-34-257"><a id="__codelineno-34-257" name="__codelineno-34-257" href="#lab04-mcp-resources-lab-__codelineno-34-257"></a><span class="w">    </span><span class="c1">// Validate table access</span>
</span><span id="__span-34-258"><a id="__codelineno-34-258" name="__codelineno-34-258" href="#lab04-mcp-resources-lab-__codelineno-34-258"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedTables</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedTables</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">tableName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-259"><a id="__codelineno-34-259" name="__codelineno-34-259" href="#lab04-mcp-resources-lab-__codelineno-34-259"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Access denied to table: </span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-260"><a id="__codelineno-34-260" name="__codelineno-34-260" href="#lab04-mcp-resources-lab-__codelineno-34-260"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-261"><a id="__codelineno-34-261" name="__codelineno-34-261" href="#lab04-mcp-resources-lab-__codelineno-34-261"></a>
</span><span id="__span-34-262"><a id="__codelineno-34-262" name="__codelineno-34-262" href="#lab04-mcp-resources-lab-__codelineno-34-262"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-263"><a id="__codelineno-34-263" name="__codelineno-34-263" href="#lab04-mcp-resources-lab-__codelineno-34-263"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;schema&#39;</span><span class="o">:</span>
</span><span id="__span-34-264"><a id="__codelineno-34-264" name="__codelineno-34-264" href="#lab04-mcp-resources-lab-__codelineno-34-264"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTableSchema</span><span class="p">(</span><span class="nx">tableName</span><span class="p">);</span>
</span><span id="__span-34-265"><a id="__codelineno-34-265" name="__codelineno-34-265" href="#lab04-mcp-resources-lab-__codelineno-34-265"></a>
</span><span id="__span-34-266"><a id="__codelineno-34-266" name="__codelineno-34-266" href="#lab04-mcp-resources-lab-__codelineno-34-266"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;data&#39;</span><span class="o">:</span>
</span><span id="__span-34-267"><a id="__codelineno-34-267" name="__codelineno-34-267" href="#lab04-mcp-resources-lab-__codelineno-34-267"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">URL</span><span class="p">(</span><span class="sb">`db://tables/</span><span class="si">${</span><span class="nx">tablePath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-268"><a id="__codelineno-34-268" name="__codelineno-34-268" href="#lab04-mcp-resources-lab-__codelineno-34-268"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">searchParams</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;limit&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;100&#39;</span><span class="p">);</span>
</span><span id="__span-34-269"><a id="__codelineno-34-269" name="__codelineno-34-269" href="#lab04-mcp-resources-lab-__codelineno-34-269"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">searchParams</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">);</span>
</span><span id="__span-34-270"><a id="__codelineno-34-270" name="__codelineno-34-270" href="#lab04-mcp-resources-lab-__codelineno-34-270"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTableData</span><span class="p">(</span><span class="nx">tableName</span><span class="p">,</span><span class="w"> </span><span class="nx">limit</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="p">);</span>
</span><span id="__span-34-271"><a id="__codelineno-34-271" name="__codelineno-34-271" href="#lab04-mcp-resources-lab-__codelineno-34-271"></a>
</span><span id="__span-34-272"><a id="__codelineno-34-272" name="__codelineno-34-272" href="#lab04-mcp-resources-lab-__codelineno-34-272"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;records&#39;</span><span class="o">:</span>
</span><span id="__span-34-273"><a id="__codelineno-34-273" name="__codelineno-34-273" href="#lab04-mcp-resources-lab-__codelineno-34-273"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">recordId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="mf">2</span><span class="p">];</span>
</span><span id="__span-34-274"><a id="__codelineno-34-274" name="__codelineno-34-274" href="#lab04-mcp-resources-lab-__codelineno-34-274"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTableRecord</span><span class="p">(</span><span class="nx">tableName</span><span class="p">,</span><span class="w"> </span><span class="nx">recordId</span><span class="p">);</span>
</span><span id="__span-34-275"><a id="__codelineno-34-275" name="__codelineno-34-275" href="#lab04-mcp-resources-lab-__codelineno-34-275"></a>
</span><span id="__span-34-276"><a id="__codelineno-34-276" name="__codelineno-34-276" href="#lab04-mcp-resources-lab-__codelineno-34-276"></a><span class="w">      </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-34-277"><a id="__codelineno-34-277" name="__codelineno-34-277" href="#lab04-mcp-resources-lab-__codelineno-34-277"></a><span class="w">        </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown table action: </span><span class="si">${</span><span class="nx">action</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-278"><a id="__codelineno-34-278" name="__codelineno-34-278" href="#lab04-mcp-resources-lab-__codelineno-34-278"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-279"><a id="__codelineno-34-279" name="__codelineno-34-279" href="#lab04-mcp-resources-lab-__codelineno-34-279"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-280"><a id="__codelineno-34-280" name="__codelineno-34-280" href="#lab04-mcp-resources-lab-__codelineno-34-280"></a>
</span><span id="__span-34-281"><a id="__codelineno-34-281" name="__codelineno-34-281" href="#lab04-mcp-resources-lab-__codelineno-34-281"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getTableSchema</span><span class="p">(</span><span class="nx">tableName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-282"><a id="__codelineno-34-282" name="__codelineno-34-282" href="#lab04-mcp-resources-lab-__codelineno-34-282"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Database not initialized&#39;</span><span class="p">);</span>
</span><span id="__span-34-283"><a id="__codelineno-34-283" name="__codelineno-34-283" href="#lab04-mcp-resources-lab-__codelineno-34-283"></a>
</span><span id="__span-34-284"><a id="__codelineno-34-284" name="__codelineno-34-284" href="#lab04-mcp-resources-lab-__codelineno-34-284"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTableInfo</span><span class="p">();</span>
</span><span id="__span-34-285"><a id="__codelineno-34-285" name="__codelineno-34-285" href="#lab04-mcp-resources-lab-__codelineno-34-285"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tables</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">t</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">tableName</span><span class="p">);</span>
</span><span id="__span-34-286"><a id="__codelineno-34-286" name="__codelineno-34-286" href="#lab04-mcp-resources-lab-__codelineno-34-286"></a>
</span><span id="__span-34-287"><a id="__codelineno-34-287" name="__codelineno-34-287" href="#lab04-mcp-resources-lab-__codelineno-34-287"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">table</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-288"><a id="__codelineno-34-288" name="__codelineno-34-288" href="#lab04-mcp-resources-lab-__codelineno-34-288"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Table not found: </span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-289"><a id="__codelineno-34-289" name="__codelineno-34-289" href="#lab04-mcp-resources-lab-__codelineno-34-289"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-290"><a id="__codelineno-34-290" name="__codelineno-34-290" href="#lab04-mcp-resources-lab-__codelineno-34-290"></a>
</span><span id="__span-34-291"><a id="__codelineno-34-291" name="__codelineno-34-291" href="#lab04-mcp-resources-lab-__codelineno-34-291"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-292"><a id="__codelineno-34-292" name="__codelineno-34-292" href="#lab04-mcp-resources-lab-__codelineno-34-292"></a><span class="w">      </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://tables/</span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb">/schema`</span><span class="p">,</span>
</span><span id="__span-34-293"><a id="__codelineno-34-293" name="__codelineno-34-293" href="#lab04-mcp-resources-lab-__codelineno-34-293"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-294"><a id="__codelineno-34-294" name="__codelineno-34-294" href="#lab04-mcp-resources-lab-__codelineno-34-294"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-34-295"><a id="__codelineno-34-295" name="__codelineno-34-295" href="#lab04-mcp-resources-lab-__codelineno-34-295"></a><span class="w">        </span><span class="nx">table</span><span class="o">:</span><span class="w"> </span><span class="kt">tableName</span><span class="p">,</span>
</span><span id="__span-34-296"><a id="__codelineno-34-296" name="__codelineno-34-296" href="#lab04-mcp-resources-lab-__codelineno-34-296"></a><span class="w">        </span><span class="nx">columns</span><span class="o">:</span><span class="w"> </span><span class="kt">table.columns</span><span class="p">,</span>
</span><span id="__span-34-297"><a id="__codelineno-34-297" name="__codelineno-34-297" href="#lab04-mcp-resources-lab-__codelineno-34-297"></a><span class="w">        </span><span class="nx">rowCount</span><span class="o">:</span><span class="w"> </span><span class="kt">table.rowCount</span><span class="p">,</span>
</span><span id="__span-34-298"><a id="__codelineno-34-298" name="__codelineno-34-298" href="#lab04-mcp-resources-lab-__codelineno-34-298"></a><span class="w">        </span><span class="nx">indexes</span><span class="o">:</span><span class="w"> </span><span class="kt">this.getTableIndexes</span><span class="p">(</span><span class="nx">tableName</span><span class="p">),</span>
</span><span id="__span-34-299"><a id="__codelineno-34-299" name="__codelineno-34-299" href="#lab04-mcp-resources-lab-__codelineno-34-299"></a><span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-34-300"><a id="__codelineno-34-300" name="__codelineno-34-300" href="#lab04-mcp-resources-lab-__codelineno-34-300"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-34-301"><a id="__codelineno-34-301" name="__codelineno-34-301" href="#lab04-mcp-resources-lab-__codelineno-34-301"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-302"><a id="__codelineno-34-302" name="__codelineno-34-302" href="#lab04-mcp-resources-lab-__codelineno-34-302"></a>
</span><span id="__span-34-303"><a id="__codelineno-34-303" name="__codelineno-34-303" href="#lab04-mcp-resources-lab-__codelineno-34-303"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getTableData</span><span class="p">(</span><span class="nx">tableName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-304"><a id="__codelineno-34-304" name="__codelineno-34-304" href="#lab04-mcp-resources-lab-__codelineno-34-304"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Database not initialized&#39;</span><span class="p">);</span>
</span><span id="__span-34-305"><a id="__codelineno-34-305" name="__codelineno-34-305" href="#lab04-mcp-resources-lab-__codelineno-34-305"></a>
</span><span id="__span-34-306"><a id="__codelineno-34-306" name="__codelineno-34-306" href="#lab04-mcp-resources-lab-__codelineno-34-306"></a><span class="w">    </span><span class="c1">// Validate limits</span>
</span><span id="__span-34-307"><a id="__codelineno-34-307" name="__codelineno-34-307" href="#lab04-mcp-resources-lab-__codelineno-34-307"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">actualLimit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">limit</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">maxRows</span><span class="p">);</span>
</span><span id="__span-34-308"><a id="__codelineno-34-308" name="__codelineno-34-308" href="#lab04-mcp-resources-lab-__codelineno-34-308"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">actualOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="p">);</span>
</span><span id="__span-34-309"><a id="__codelineno-34-309" name="__codelineno-34-309" href="#lab04-mcp-resources-lab-__codelineno-34-309"></a>
</span><span id="__span-34-310"><a id="__codelineno-34-310" name="__codelineno-34-310" href="#lab04-mcp-resources-lab-__codelineno-34-310"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`SELECT * FROM </span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb"> LIMIT ? OFFSET ?`</span><span class="p">;</span>
</span><span id="__span-34-311"><a id="__codelineno-34-311" name="__codelineno-34-311" href="#lab04-mcp-resources-lab-__codelineno-34-311"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="nx">query</span><span class="p">).</span><span class="nx">all</span><span class="p">(</span><span class="nx">actualLimit</span><span class="p">,</span><span class="w"> </span><span class="nx">actualOffset</span><span class="p">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">[];</span>
</span><span id="__span-34-312"><a id="__codelineno-34-312" name="__codelineno-34-312" href="#lab04-mcp-resources-lab-__codelineno-34-312"></a>
</span><span id="__span-34-313"><a id="__codelineno-34-313" name="__codelineno-34-313" href="#lab04-mcp-resources-lab-__codelineno-34-313"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-314"><a id="__codelineno-34-314" name="__codelineno-34-314" href="#lab04-mcp-resources-lab-__codelineno-34-314"></a><span class="w">      </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://tables/</span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb">/data?limit=</span><span class="si">${</span><span class="nx">actualLimit</span><span class="si">}</span><span class="sb">&amp;offset=</span><span class="si">${</span><span class="nx">actualOffset</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-34-315"><a id="__codelineno-34-315" name="__codelineno-34-315" href="#lab04-mcp-resources-lab-__codelineno-34-315"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-316"><a id="__codelineno-34-316" name="__codelineno-34-316" href="#lab04-mcp-resources-lab-__codelineno-34-316"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-34-317"><a id="__codelineno-34-317" name="__codelineno-34-317" href="#lab04-mcp-resources-lab-__codelineno-34-317"></a><span class="w">        </span><span class="nx">table</span><span class="o">:</span><span class="w"> </span><span class="kt">tableName</span><span class="p">,</span>
</span><span id="__span-34-318"><a id="__codelineno-34-318" name="__codelineno-34-318" href="#lab04-mcp-resources-lab-__codelineno-34-318"></a><span class="w">        </span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-319"><a id="__codelineno-34-319" name="__codelineno-34-319" href="#lab04-mcp-resources-lab-__codelineno-34-319"></a><span class="w">          </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="kt">actualLimit</span><span class="p">,</span>
</span><span id="__span-34-320"><a id="__codelineno-34-320" name="__codelineno-34-320" href="#lab04-mcp-resources-lab-__codelineno-34-320"></a><span class="w">          </span><span class="nx">offset</span><span class="o">:</span><span class="w"> </span><span class="kt">actualOffset</span><span class="p">,</span>
</span><span id="__span-34-321"><a id="__codelineno-34-321" name="__codelineno-34-321" href="#lab04-mcp-resources-lab-__codelineno-34-321"></a><span class="w">          </span><span class="nx">totalRows</span><span class="o">:</span><span class="w"> </span><span class="kt">rows.length</span><span class="p">,</span>
</span><span id="__span-34-322"><a id="__codelineno-34-322" name="__codelineno-34-322" href="#lab04-mcp-resources-lab-__codelineno-34-322"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-323"><a id="__codelineno-34-323" name="__codelineno-34-323" href="#lab04-mcp-resources-lab-__codelineno-34-323"></a><span class="w">        </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">rows</span><span class="p">,</span>
</span><span id="__span-34-324"><a id="__codelineno-34-324" name="__codelineno-34-324" href="#lab04-mcp-resources-lab-__codelineno-34-324"></a><span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-34-325"><a id="__codelineno-34-325" name="__codelineno-34-325" href="#lab04-mcp-resources-lab-__codelineno-34-325"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-34-326"><a id="__codelineno-34-326" name="__codelineno-34-326" href="#lab04-mcp-resources-lab-__codelineno-34-326"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-327"><a id="__codelineno-34-327" name="__codelineno-34-327" href="#lab04-mcp-resources-lab-__codelineno-34-327"></a>
</span><span id="__span-34-328"><a id="__codelineno-34-328" name="__codelineno-34-328" href="#lab04-mcp-resources-lab-__codelineno-34-328"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getTableRecord</span><span class="p">(</span><span class="nx">tableName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">recordId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-329"><a id="__codelineno-34-329" name="__codelineno-34-329" href="#lab04-mcp-resources-lab-__codelineno-34-329"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Database not initialized&#39;</span><span class="p">);</span>
</span><span id="__span-34-330"><a id="__codelineno-34-330" name="__codelineno-34-330" href="#lab04-mcp-resources-lab-__codelineno-34-330"></a>
</span><span id="__span-34-331"><a id="__codelineno-34-331" name="__codelineno-34-331" href="#lab04-mcp-resources-lab-__codelineno-34-331"></a><span class="w">    </span><span class="c1">// Get primary key column</span>
</span><span id="__span-34-332"><a id="__codelineno-34-332" name="__codelineno-34-332" href="#lab04-mcp-resources-lab-__codelineno-34-332"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="sb">`PRAGMA table_info(</span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb">)`</span><span class="p">).</span><span class="nx">all</span><span class="p">()</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">[];</span>
</span><span id="__span-34-333"><a id="__codelineno-34-333" name="__codelineno-34-333" href="#lab04-mcp-resources-lab-__codelineno-34-333"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">pkColumn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">columns</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">col</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">col</span><span class="p">.</span><span class="nx">pk</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-34-334"><a id="__codelineno-34-334" name="__codelineno-34-334" href="#lab04-mcp-resources-lab-__codelineno-34-334"></a>
</span><span id="__span-34-335"><a id="__codelineno-34-335" name="__codelineno-34-335" href="#lab04-mcp-resources-lab-__codelineno-34-335"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">pkColumn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-336"><a id="__codelineno-34-336" name="__codelineno-34-336" href="#lab04-mcp-resources-lab-__codelineno-34-336"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`No primary key found for table: </span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-337"><a id="__codelineno-34-337" name="__codelineno-34-337" href="#lab04-mcp-resources-lab-__codelineno-34-337"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-338"><a id="__codelineno-34-338" name="__codelineno-34-338" href="#lab04-mcp-resources-lab-__codelineno-34-338"></a>
</span><span id="__span-34-339"><a id="__codelineno-34-339" name="__codelineno-34-339" href="#lab04-mcp-resources-lab-__codelineno-34-339"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`SELECT * FROM </span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb"> WHERE </span><span class="si">${</span><span class="nx">pkColumn</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> = ?`</span><span class="p">;</span>
</span><span id="__span-34-340"><a id="__codelineno-34-340" name="__codelineno-34-340" href="#lab04-mcp-resources-lab-__codelineno-34-340"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="nx">query</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">recordId</span><span class="p">);</span>
</span><span id="__span-34-341"><a id="__codelineno-34-341" name="__codelineno-34-341" href="#lab04-mcp-resources-lab-__codelineno-34-341"></a>
</span><span id="__span-34-342"><a id="__codelineno-34-342" name="__codelineno-34-342" href="#lab04-mcp-resources-lab-__codelineno-34-342"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">row</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-343"><a id="__codelineno-34-343" name="__codelineno-34-343" href="#lab04-mcp-resources-lab-__codelineno-34-343"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Record not found: </span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb">.</span><span class="si">${</span><span class="nx">pkColumn</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> = </span><span class="si">${</span><span class="nx">recordId</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-344"><a id="__codelineno-34-344" name="__codelineno-34-344" href="#lab04-mcp-resources-lab-__codelineno-34-344"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-345"><a id="__codelineno-34-345" name="__codelineno-34-345" href="#lab04-mcp-resources-lab-__codelineno-34-345"></a>
</span><span id="__span-34-346"><a id="__codelineno-34-346" name="__codelineno-34-346" href="#lab04-mcp-resources-lab-__codelineno-34-346"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-347"><a id="__codelineno-34-347" name="__codelineno-34-347" href="#lab04-mcp-resources-lab-__codelineno-34-347"></a><span class="w">      </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://tables/</span><span class="si">${</span><span class="nx">tableName</span><span class="si">}</span><span class="sb">/records/</span><span class="si">${</span><span class="nx">recordId</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-34-348"><a id="__codelineno-34-348" name="__codelineno-34-348" href="#lab04-mcp-resources-lab-__codelineno-34-348"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-349"><a id="__codelineno-34-349" name="__codelineno-34-349" href="#lab04-mcp-resources-lab-__codelineno-34-349"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-34-350"><a id="__codelineno-34-350" name="__codelineno-34-350" href="#lab04-mcp-resources-lab-__codelineno-34-350"></a><span class="w">        </span><span class="nx">table</span><span class="o">:</span><span class="w"> </span><span class="kt">tableName</span><span class="p">,</span>
</span><span id="__span-34-351"><a id="__codelineno-34-351" name="__codelineno-34-351" href="#lab04-mcp-resources-lab-__codelineno-34-351"></a><span class="w">        </span><span class="nx">primaryKey</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-352"><a id="__codelineno-34-352" name="__codelineno-34-352" href="#lab04-mcp-resources-lab-__codelineno-34-352"></a><span class="w">          </span><span class="nx">column</span><span class="o">:</span><span class="w"> </span><span class="kt">pkColumn.name</span><span class="p">,</span>
</span><span id="__span-34-353"><a id="__codelineno-34-353" name="__codelineno-34-353" href="#lab04-mcp-resources-lab-__codelineno-34-353"></a><span class="w">          </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">recordId</span><span class="p">,</span>
</span><span id="__span-34-354"><a id="__codelineno-34-354" name="__codelineno-34-354" href="#lab04-mcp-resources-lab-__codelineno-34-354"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-34-355"><a id="__codelineno-34-355" name="__codelineno-34-355" href="#lab04-mcp-resources-lab-__codelineno-34-355"></a><span class="w">        </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">row</span><span class="p">,</span>
</span><span id="__span-34-356"><a id="__codelineno-34-356" name="__codelineno-34-356" href="#lab04-mcp-resources-lab-__codelineno-34-356"></a><span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-34-357"><a id="__codelineno-34-357" name="__codelineno-34-357" href="#lab04-mcp-resources-lab-__codelineno-34-357"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-34-358"><a id="__codelineno-34-358" name="__codelineno-34-358" href="#lab04-mcp-resources-lab-__codelineno-34-358"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-359"><a id="__codelineno-34-359" name="__codelineno-34-359" href="#lab04-mcp-resources-lab-__codelineno-34-359"></a>
</span><span id="__span-34-360"><a id="__codelineno-34-360" name="__codelineno-34-360" href="#lab04-mcp-resources-lab-__codelineno-34-360"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">executeCustomQuery</span><span class="p">(</span><span class="nx">queryString</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-361"><a id="__codelineno-34-361" name="__codelineno-34-361" href="#lab04-mcp-resources-lab-__codelineno-34-361"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Database not initialized&#39;</span><span class="p">);</span>
</span><span id="__span-34-362"><a id="__codelineno-34-362" name="__codelineno-34-362" href="#lab04-mcp-resources-lab-__codelineno-34-362"></a>
</span><span id="__span-34-363"><a id="__codelineno-34-363" name="__codelineno-34-363" href="#lab04-mcp-resources-lab-__codelineno-34-363"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">URL</span><span class="p">(</span><span class="sb">`db://query?</span><span class="si">${</span><span class="nx">queryString</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-364"><a id="__codelineno-34-364" name="__codelineno-34-364" href="#lab04-mcp-resources-lab-__codelineno-34-364"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">url</span><span class="p">.</span><span class="nx">searchParams</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;sql&#39;</span><span class="p">);</span>
</span><span id="__span-34-365"><a id="__codelineno-34-365" name="__codelineno-34-365" href="#lab04-mcp-resources-lab-__codelineno-34-365"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">url</span><span class="p">.</span><span class="nx">searchParams</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;params&#39;</span><span class="p">);</span>
</span><span id="__span-34-366"><a id="__codelineno-34-366" name="__codelineno-34-366" href="#lab04-mcp-resources-lab-__codelineno-34-366"></a>
</span><span id="__span-34-367"><a id="__codelineno-34-367" name="__codelineno-34-367" href="#lab04-mcp-resources-lab-__codelineno-34-367"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">sql</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-368"><a id="__codelineno-34-368" name="__codelineno-34-368" href="#lab04-mcp-resources-lab-__codelineno-34-368"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;SQL parameter required for custom query&#39;</span><span class="p">);</span>
</span><span id="__span-34-369"><a id="__codelineno-34-369" name="__codelineno-34-369" href="#lab04-mcp-resources-lab-__codelineno-34-369"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-370"><a id="__codelineno-34-370" name="__codelineno-34-370" href="#lab04-mcp-resources-lab-__codelineno-34-370"></a>
</span><span id="__span-34-371"><a id="__codelineno-34-371" name="__codelineno-34-371" href="#lab04-mcp-resources-lab-__codelineno-34-371"></a><span class="w">    </span><span class="c1">// Security: Only allow SELECT queries</span>
</span><span id="__span-34-372"><a id="__codelineno-34-372" name="__codelineno-34-372" href="#lab04-mcp-resources-lab-__codelineno-34-372"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">sql</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toUpperCase</span><span class="p">().</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;SELECT&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-373"><a id="__codelineno-34-373" name="__codelineno-34-373" href="#lab04-mcp-resources-lab-__codelineno-34-373"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Only SELECT queries are allowed for security&#39;</span><span class="p">);</span>
</span><span id="__span-34-374"><a id="__codelineno-34-374" name="__codelineno-34-374" href="#lab04-mcp-resources-lab-__codelineno-34-374"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-375"><a id="__codelineno-34-375" name="__codelineno-34-375" href="#lab04-mcp-resources-lab-__codelineno-34-375"></a>
</span><span id="__span-34-376"><a id="__codelineno-34-376" name="__codelineno-34-376" href="#lab04-mcp-resources-lab-__codelineno-34-376"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">queryParams</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-34-377"><a id="__codelineno-34-377" name="__codelineno-34-377" href="#lab04-mcp-resources-lab-__codelineno-34-377"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">params</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-378"><a id="__codelineno-34-378" name="__codelineno-34-378" href="#lab04-mcp-resources-lab-__codelineno-34-378"></a><span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-379"><a id="__codelineno-34-379" name="__codelineno-34-379" href="#lab04-mcp-resources-lab-__codelineno-34-379"></a><span class="w">        </span><span class="nx">queryParams</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
</span><span id="__span-34-380"><a id="__codelineno-34-380" name="__codelineno-34-380" href="#lab04-mcp-resources-lab-__codelineno-34-380"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-381"><a id="__codelineno-34-381" name="__codelineno-34-381" href="#lab04-mcp-resources-lab-__codelineno-34-381"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Invalid params JSON&#39;</span><span class="p">);</span>
</span><span id="__span-34-382"><a id="__codelineno-34-382" name="__codelineno-34-382" href="#lab04-mcp-resources-lab-__codelineno-34-382"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-34-383"><a id="__codelineno-34-383" name="__codelineno-34-383" href="#lab04-mcp-resources-lab-__codelineno-34-383"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-384"><a id="__codelineno-34-384" name="__codelineno-34-384" href="#lab04-mcp-resources-lab-__codelineno-34-384"></a>
</span><span id="__span-34-385"><a id="__codelineno-34-385" name="__codelineno-34-385" href="#lab04-mcp-resources-lab-__codelineno-34-385"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="nx">sql</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; LIMIT ?&#39;</span><span class="p">);</span>
</span><span id="__span-34-386"><a id="__codelineno-34-386" name="__codelineno-34-386" href="#lab04-mcp-resources-lab-__codelineno-34-386"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stmt</span><span class="p">.</span><span class="nx">all</span><span class="p">(...</span><span class="nx">queryParams</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">maxRows</span><span class="p">);</span>
</span><span id="__span-34-387"><a id="__codelineno-34-387" name="__codelineno-34-387" href="#lab04-mcp-resources-lab-__codelineno-34-387"></a>
</span><span id="__span-34-388"><a id="__codelineno-34-388" name="__codelineno-34-388" href="#lab04-mcp-resources-lab-__codelineno-34-388"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-389"><a id="__codelineno-34-389" name="__codelineno-34-389" href="#lab04-mcp-resources-lab-__codelineno-34-389"></a><span class="w">      </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`db://query?sql=</span><span class="si">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">sql</span><span class="p">)</span><span class="si">}</span><span class="sb">&amp;params=</span><span class="si">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">queryParams</span><span class="p">))</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-34-390"><a id="__codelineno-34-390" name="__codelineno-34-390" href="#lab04-mcp-resources-lab-__codelineno-34-390"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="__span-34-391"><a id="__codelineno-34-391" name="__codelineno-34-391" href="#lab04-mcp-resources-lab-__codelineno-34-391"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-34-392"><a id="__codelineno-34-392" name="__codelineno-34-392" href="#lab04-mcp-resources-lab-__codelineno-34-392"></a><span class="w">        </span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="kt">sql</span><span class="p">,</span>
</span><span id="__span-34-393"><a id="__codelineno-34-393" name="__codelineno-34-393" href="#lab04-mcp-resources-lab-__codelineno-34-393"></a><span class="w">        </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">queryParams</span><span class="p">,</span>
</span><span id="__span-34-394"><a id="__codelineno-34-394" name="__codelineno-34-394" href="#lab04-mcp-resources-lab-__codelineno-34-394"></a><span class="w">        </span><span class="nx">resultCount</span><span class="o">:</span><span class="w"> </span><span class="kt">rows.length</span><span class="p">,</span>
</span><span id="__span-34-395"><a id="__codelineno-34-395" name="__codelineno-34-395" href="#lab04-mcp-resources-lab-__codelineno-34-395"></a><span class="w">        </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">rows</span><span class="p">,</span>
</span><span id="__span-34-396"><a id="__codelineno-34-396" name="__codelineno-34-396" href="#lab04-mcp-resources-lab-__codelineno-34-396"></a><span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span>
</span><span id="__span-34-397"><a id="__codelineno-34-397" name="__codelineno-34-397" href="#lab04-mcp-resources-lab-__codelineno-34-397"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-34-398"><a id="__codelineno-34-398" name="__codelineno-34-398" href="#lab04-mcp-resources-lab-__codelineno-34-398"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-399"><a id="__codelineno-34-399" name="__codelineno-34-399" href="#lab04-mcp-resources-lab-__codelineno-34-399"></a>
</span><span id="__span-34-400"><a id="__codelineno-34-400" name="__codelineno-34-400" href="#lab04-mcp-resources-lab-__codelineno-34-400"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getTableIndexes</span><span class="p">(</span><span class="nx">tableName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-401"><a id="__codelineno-34-401" name="__codelineno-34-401" href="#lab04-mcp-resources-lab-__codelineno-34-401"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-34-402"><a id="__codelineno-34-402" name="__codelineno-34-402" href="#lab04-mcp-resources-lab-__codelineno-34-402"></a>
</span><span id="__span-34-403"><a id="__codelineno-34-403" name="__codelineno-34-403" href="#lab04-mcp-resources-lab-__codelineno-34-403"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-404"><a id="__codelineno-34-404" name="__codelineno-34-404" href="#lab04-mcp-resources-lab-__codelineno-34-404"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="sb">`</span>
</span><span id="__span-34-405"><a id="__codelineno-34-405" name="__codelineno-34-405" href="#lab04-mcp-resources-lab-__codelineno-34-405"></a><span class="sb">        SELECT name, sql </span>
</span><span id="__span-34-406"><a id="__codelineno-34-406" name="__codelineno-34-406" href="#lab04-mcp-resources-lab-__codelineno-34-406"></a><span class="sb">        FROM sqlite_master </span>
</span><span id="__span-34-407"><a id="__codelineno-34-407" name="__codelineno-34-407" href="#lab04-mcp-resources-lab-__codelineno-34-407"></a><span class="sb">        WHERE type=&#39;index&#39; AND tbl_name=?</span>
</span><span id="__span-34-408"><a id="__codelineno-34-408" name="__codelineno-34-408" href="#lab04-mcp-resources-lab-__codelineno-34-408"></a><span class="sb">      `</span><span class="p">).</span><span class="nx">all</span><span class="p">(</span><span class="nx">tableName</span><span class="p">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">[];</span>
</span><span id="__span-34-409"><a id="__codelineno-34-409" name="__codelineno-34-409" href="#lab04-mcp-resources-lab-__codelineno-34-409"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-410"><a id="__codelineno-34-410" name="__codelineno-34-410" href="#lab04-mcp-resources-lab-__codelineno-34-410"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-34-411"><a id="__codelineno-34-411" name="__codelineno-34-411" href="#lab04-mcp-resources-lab-__codelineno-34-411"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-412"><a id="__codelineno-34-412" name="__codelineno-34-412" href="#lab04-mcp-resources-lab-__codelineno-34-412"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-413"><a id="__codelineno-34-413" name="__codelineno-34-413" href="#lab04-mcp-resources-lab-__codelineno-34-413"></a>
</span><span id="__span-34-414"><a id="__codelineno-34-414" name="__codelineno-34-414" href="#lab04-mcp-resources-lab-__codelineno-34-414"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-415"><a id="__codelineno-34-415" name="__codelineno-34-415" href="#lab04-mcp-resources-lab-__codelineno-34-415"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-416"><a id="__codelineno-34-416" name="__codelineno-34-416" href="#lab04-mcp-resources-lab-__codelineno-34-416"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-34-417"><a id="__codelineno-34-417" name="__codelineno-34-417" href="#lab04-mcp-resources-lab-__codelineno-34-417"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-34-418"><a id="__codelineno-34-418" name="__codelineno-34-418" href="#lab04-mcp-resources-lab-__codelineno-34-418"></a>
</span><span id="__span-34-419"><a id="__codelineno-34-419" name="__codelineno-34-419" href="#lab04-mcp-resources-lab-__codelineno-34-419"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-420"><a id="__codelineno-34-420" name="__codelineno-34-420" href="#lab04-mcp-resources-lab-__codelineno-34-420"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-421"><a id="__codelineno-34-421" name="__codelineno-34-421" href="#lab04-mcp-resources-lab-__codelineno-34-421"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-34-422"><a id="__codelineno-34-422" name="__codelineno-34-422" href="#lab04-mcp-resources-lab-__codelineno-34-422"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-34-423"><a id="__codelineno-34-423" name="__codelineno-34-423" href="#lab04-mcp-resources-lab-__codelineno-34-423"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-34-424"><a id="__codelineno-34-424" name="__codelineno-34-424" href="#lab04-mcp-resources-lab-__codelineno-34-424"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-34-425"><a id="__codelineno-34-425" name="__codelineno-34-425" href="#lab04-mcp-resources-lab-__codelineno-34-425"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-34-426"><a id="__codelineno-34-426" name="__codelineno-34-426" href="#lab04-mcp-resources-lab-__codelineno-34-426"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-427"><a id="__codelineno-34-427" name="__codelineno-34-427" href="#lab04-mcp-resources-lab-__codelineno-34-427"></a>
</span><span id="__span-34-428"><a id="__codelineno-34-428" name="__codelineno-34-428" href="#lab04-mcp-resources-lab-__codelineno-34-428"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-429"><a id="__codelineno-34-429" name="__codelineno-34-429" href="#lab04-mcp-resources-lab-__codelineno-34-429"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-34-430"><a id="__codelineno-34-430" name="__codelineno-34-430" href="#lab04-mcp-resources-lab-__codelineno-34-430"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-34-431"><a id="__codelineno-34-431" name="__codelineno-34-431" href="#lab04-mcp-resources-lab-__codelineno-34-431"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Database Resource Server running (DB: </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">dbPath</span><span class="si">}</span><span class="sb">)`</span><span class="p">);</span>
</span><span id="__span-34-432"><a id="__codelineno-34-432" name="__codelineno-34-432" href="#lab04-mcp-resources-lab-__codelineno-34-432"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-433"><a id="__codelineno-34-433" name="__codelineno-34-433" href="#lab04-mcp-resources-lab-__codelineno-34-433"></a><span class="p">}</span>
</span><span id="__span-34-434"><a id="__codelineno-34-434" name="__codelineno-34-434" href="#lab04-mcp-resources-lab-__codelineno-34-434"></a>
</span><span id="__span-34-435"><a id="__codelineno-34-435" name="__codelineno-34-435" href="#lab04-mcp-resources-lab-__codelineno-34-435"></a><span class="c1">// Main entry point</span>
</span><span id="__span-34-436"><a id="__codelineno-34-436" name="__codelineno-34-436" href="#lab04-mcp-resources-lab-__codelineno-34-436"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-437"><a id="__codelineno-34-437" name="__codelineno-34-437" href="#lab04-mcp-resources-lab-__codelineno-34-437"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DatabaseResourceServer</span><span class="p">();</span>
</span><span id="__span-34-438"><a id="__codelineno-34-438" name="__codelineno-34-438" href="#lab04-mcp-resources-lab-__codelineno-34-438"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-34-439"><a id="__codelineno-34-439" name="__codelineno-34-439" href="#lab04-mcp-resources-lab-__codelineno-34-439"></a><span class="p">}</span>
</span><span id="__span-34-440"><a id="__codelineno-34-440" name="__codelineno-34-440" href="#lab04-mcp-resources-lab-__codelineno-34-440"></a>
</span><span id="__span-34-441"><a id="__codelineno-34-441" name="__codelineno-34-441" href="#lab04-mcp-resources-lab-__codelineno-34-441"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-442"><a id="__codelineno-34-442" name="__codelineno-34-442" href="#lab04-mcp-resources-lab-__codelineno-34-442"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-34-443"><a id="__codelineno-34-443" name="__codelineno-34-443" href="#lab04-mcp-resources-lab-__codelineno-34-443"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-34-444"><a id="__codelineno-34-444" name="__codelineno-34-444" href="#lab04-mcp-resources-lab-__codelineno-34-444"></a><span class="p">});</span>
</span></code></pre></div>

Testing - First, create a test database:

<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#lab04-mcp-resources-lab-__codelineno-35-1"></a>sqlite3<span class="w"> </span>test.db<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#lab04-mcp-resources-lab-__codelineno-35-2"></a><span class="s">CREATE TABLE users (</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#lab04-mcp-resources-lab-__codelineno-35-3"></a><span class="s">  id INTEGER PRIMARY KEY,</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#lab04-mcp-resources-lab-__codelineno-35-4"></a><span class="s">  name TEXT NOT NULL,</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#lab04-mcp-resources-lab-__codelineno-35-5"></a><span class="s">  email TEXT UNIQUE,</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#lab04-mcp-resources-lab-__codelineno-35-6"></a><span class="s">  age INTEGER,</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#lab04-mcp-resources-lab-__codelineno-35-7"></a><span class="s">  created_at DATETIME DEFAULT CURRENT_TIMESTAMP</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#lab04-mcp-resources-lab-__codelineno-35-8"></a><span class="s">);</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#lab04-mcp-resources-lab-__codelineno-35-9"></a>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#lab04-mcp-resources-lab-__codelineno-35-10"></a><span class="s">CREATE TABLE products (</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#lab04-mcp-resources-lab-__codelineno-35-11"></a><span class="s">  id INTEGER PRIMARY KEY,</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#lab04-mcp-resources-lab-__codelineno-35-12"></a><span class="s">  name TEXT NOT NULL,</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#lab04-mcp-resources-lab-__codelineno-35-13"></a><span class="s">  price REAL,</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#lab04-mcp-resources-lab-__codelineno-35-14"></a><span class="s">  category TEXT,</span>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#lab04-mcp-resources-lab-__codelineno-35-15"></a><span class="s">  in_stock BOOLEAN DEFAULT 1</span>
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#lab04-mcp-resources-lab-__codelineno-35-16"></a><span class="s">);</span>
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#lab04-mcp-resources-lab-__codelineno-35-17"></a>
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18" href="#lab04-mcp-resources-lab-__codelineno-35-18"></a><span class="s">INSERT INTO users (name, email, age) VALUES </span>
</span><span id="__span-35-19"><a id="__codelineno-35-19" name="__codelineno-35-19" href="#lab04-mcp-resources-lab-__codelineno-35-19"></a><span class="s">  (&#39;Alice Johnson&#39;, &#39;alice@example.com&#39;, 28),</span>
</span><span id="__span-35-20"><a id="__codelineno-35-20" name="__codelineno-35-20" href="#lab04-mcp-resources-lab-__codelineno-35-20"></a><span class="s">  (&#39;Bob Smith&#39;, &#39;bob@example.com&#39;, 34);</span>
</span><span id="__span-35-21"><a id="__codelineno-35-21" name="__codelineno-35-21" href="#lab04-mcp-resources-lab-__codelineno-35-21"></a>
</span><span id="__span-35-22"><a id="__codelineno-35-22" name="__codelineno-35-22" href="#lab04-mcp-resources-lab-__codelineno-35-22"></a><span class="s">INSERT INTO products (name, price, category, in_stock) VALUES </span>
</span><span id="__span-35-23"><a id="__codelineno-35-23" name="__codelineno-35-23" href="#lab04-mcp-resources-lab-__codelineno-35-23"></a><span class="s">  (&#39;Laptop&#39;, 999.99, &#39;Electronics&#39;, 1),</span>
</span><span id="__span-35-24"><a id="__codelineno-35-24" name="__codelineno-35-24" href="#lab04-mcp-resources-lab-__codelineno-35-24"></a><span class="s">  (&#39;Book&#39;, 19.99, &#39;Education&#39;, 1);</span>
</span><span id="__span-35-25"><a id="__codelineno-35-25" name="__codelineno-35-25" href="#lab04-mcp-resources-lab-__codelineno-35-25"></a>
</span><span id="__span-35-26"><a id="__codelineno-35-26" name="__codelineno-35-26" href="#lab04-mcp-resources-lab-__codelineno-35-26"></a><span class="s">.quit</span>
</span><span id="__span-35-27"><a id="__codelineno-35-27" name="__codelineno-35-27" href="#lab04-mcp-resources-lab-__codelineno-35-27"></a><span class="s">EOF</span>
</span></code></pre></div>

Test the server:

<div class="language-javascript highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#lab04-mcp-resources-lab-__codelineno-36-1"></a><span class="c1">// Database info</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#lab04-mcp-resources-lab-__codelineno-36-2"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://info&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#lab04-mcp-resources-lab-__codelineno-36-3"></a>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#lab04-mcp-resources-lab-__codelineno-36-4"></a><span class="c1">// Table schemas</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#lab04-mcp-resources-lab-__codelineno-36-5"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/users/schema&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#lab04-mcp-resources-lab-__codelineno-36-6"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/products/schema&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#lab04-mcp-resources-lab-__codelineno-36-7"></a>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#lab04-mcp-resources-lab-__codelineno-36-8"></a><span class="c1">// Table data</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#lab04-mcp-resources-lab-__codelineno-36-9"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/users/data?limit=10&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#lab04-mcp-resources-lab-__codelineno-36-10"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/products/data?limit=10&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#lab04-mcp-resources-lab-__codelineno-36-11"></a>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#lab04-mcp-resources-lab-__codelineno-36-12"></a><span class="c1">// Specific records</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#lab04-mcp-resources-lab-__codelineno-36-13"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/users/records/1&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#lab04-mcp-resources-lab-__codelineno-36-14"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://tables/products/records/2&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#lab04-mcp-resources-lab-__codelineno-36-15"></a>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#lab04-mcp-resources-lab-__codelineno-36-16"></a><span class="c1">// Custom query</span>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#lab04-mcp-resources-lab-__codelineno-36-17"></a><span class="p">{</span><span class="w"> </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;db://query?sql=SELECT * FROM users WHERE age &gt; ?&amp;params=[25]&quot;</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>

</details>

<hr />
<h2 id="lab04-mcp-resources-lab-key-takeaways">Key Takeaways<a class="headerlink" href="#lab04-mcp-resources-lab-key-takeaways" title="Permanent link">&para;</a></h2>
<p>✅ <strong>Resources</strong> provide passive data access for LLMs</p>
<p>✅ <strong>Tools</strong> perform active operations with side effects</p>
<p>✅ <strong>URI schemes</strong> should be hierarchical and descriptive</p>
<p>✅ <strong>Templates</strong> enable parameterized resource access</p>
<p>✅ <strong>Subscriptions</strong> support real-time data updates</p>
<p>✅ <strong>Security</strong> is critical for resource access control</p>
<p>✅ <strong>Caching</strong> improves performance for static resources</p>
<p>✅ <strong>Hybrid servers</strong> combine resources and tools effectively</p>
<hr />
<h2 id="lab04-mcp-resources-lab-next-steps">Next Steps<a class="headerlink" href="#lab04-mcp-resources-lab-next-steps" title="Permanent link">&para;</a></h2>
<p>In <a href="#lab04-mcp-resources-lab05-mcp-prompts"><strong>Lab 5</strong></a>, you&rsquo;ll complete your MCP mastery by learning about Prompts:</p>
<ul>
<li>Creating reusable prompt templates</li>
<li>Embedding resources in prompts</li>
<li>Supporting prompt arguments</li>
<li>Building complete, production-ready MCP servers</li>
</ul>
<hr />
<p><strong>Ready to add prompts to your MCP toolkit? Continue to <a href="#lab04-mcp-resources-lab05-mcp-prompts">Lab 5!</a></strong></p></section><section class="print-page" id="lab05-mcp-prompts-lab" heading-number="2.7"><h1 id="lab05-mcp-prompts-lab-lab-5-mcp-prompts-and-complete-integration">Lab 5: MCP Prompts and Complete Integration<a class="headerlink" href="#lab05-mcp-prompts-lab-lab-5-mcp-prompts-and-complete-integration" title="Permanent link">&para;</a></h1>
<h2 id="lab05-mcp-prompts-lab-overview">Overview<a class="headerlink" href="#lab05-mcp-prompts-lab-overview" title="Permanent link">&para;</a></h2>
<p>Congratulations on reaching the final lab!</p>
<p>As you have already mastered tools and resources, now it&rsquo;s time to complete your MCP expertise with <strong>Prompts</strong>.</p>
<p>Prompts are reusable templates that help users and LLMs perform common tasks consistently and effectively. They can embed resources, accept arguments, and create structured workflows that combine the best of human expertise with AI capabilities.</p>
<p>In this lab, you&rsquo;ll learn how to create sophisticated prompt templates, integrate them with resources and tools, and build complete, production-ready MCP servers that showcase all three capabilities working together.</p>
<hr />
<h2 id="lab05-mcp-prompts-lab-learning-objectives">Learning Objectives<a class="headerlink" href="#lab05-mcp-prompts-lab-learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lab, you will:</p>
<ul>
<li>Understand the role of prompts in MCP ecosystems</li>
<li>Create static and dynamic prompt templates</li>
<li>Embed resources and arguments in prompts</li>
<li>Implement prompt handlers with proper validation</li>
<li>Build complete MCP servers combining all capabilities</li>
<li>Apply production best practices for deployment</li>
<li>Debug and troubleshoot complex MCP integrations</li>
<li>Create reusable prompt libraries for common tasks</li>
</ul>
<hr />
<h2 id="lab05-mcp-prompts-lab-prerequisites">Prerequisites<a class="headerlink" href="#lab05-mcp-prompts-lab-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Completed <a href="#lab05-mcp-prompts-lab04-mcp-resources">Lab 4 - Implementing MCP Resources</a></li>
<li>Understanding of prompt engineering concepts</li>
<li>Familiarity with template systems and variable substitution</li>
<li>Experience with complex application architecture</li>
</ul>
<hr />
<h2 id="lab05-mcp-prompts-lab-what-makes-prompts-special">What Makes Prompts Special?<a class="headerlink" href="#lab05-mcp-prompts-lab-what-makes-prompts-special" title="Permanent link">&para;</a></h2>
<p>Prompts in MCP are more than just text templates - they&rsquo;re <strong>structured, reusable AI workflows</strong> that:</p>
<ul>
<li><strong>Standardize</strong> common tasks across different users and contexts</li>
<li><strong>Combine expertise</strong> from domain specialists with AI capabilities</li>
<li><strong>Integrate resources</strong> to provide rich context automatically</li>
<li><strong>Accept parameters</strong> to customize behavior dynamically</li>
<li><strong>Create consistency</strong> in AI interactions and outputs</li>
</ul>
<h3 id="lab05-mcp-prompts-lab-when-to-use-prompts-vs-tools">When to Use Prompts vs. Tools<a class="headerlink" href="#lab05-mcp-prompts-lab-when-to-use-prompts-vs-tools" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Use Case</th>
<th>Use Prompt</th>
<th>Use Tool</th>
<th>Why</th>
</tr>
</thead>
<tbody>
<tr>
<td>Code review</td>
<td>✅ Prompt</td>
<td>❌ Tool</td>
<td>Needs structured guidance and context</td>
</tr>
<tr>
<td>Data analysis</td>
<td>✅ Prompt</td>
<td>❌ Tool</td>
<td>Requires analytical reasoning framework</td>
</tr>
<tr>
<td>Content writing</td>
<td>✅ Prompt</td>
<td>❌ Tool</td>
<td>Benefits from style guides and examples</td>
</tr>
<tr>
<td>API calls</td>
<td>❌ Prompt</td>
<td>✅ Tool</td>
<td>Direct action with predictable results</td>
</tr>
<tr>
<td>Calculations</td>
<td>❌ Prompt</td>
<td>✅ Tool</td>
<td>Mathematical precision required</td>
</tr>
<tr>
<td>Research synthesis</td>
<td>✅ Prompt</td>
<td>❌ Tool</td>
<td>Complex reasoning and integration needed</td>
</tr>
</tbody>
</table>
<h3 id="lab05-mcp-prompts-lab-prompt-architecture">Prompt Architecture<a class="headerlink" href="#lab05-mcp-prompts-lab-prompt-architecture" title="Permanent link">&para;</a></h3>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab05-mcp-prompts-lab-__codelineno-0-1"></a><span class="kd">interface</span><span class="w"> </span><span class="nx">Prompt</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab05-mcp-prompts-lab-__codelineno-0-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">              </span><span class="c1">// Unique identifier</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab05-mcp-prompts-lab-__codelineno-0-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">       </span><span class="c1">// What the prompt does</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab05-mcp-prompts-lab-__codelineno-0-4"></a><span class="w">  </span><span class="nx">arguments?</span><span class="o">:</span><span class="w"> </span><span class="kt">Argument</span><span class="p">[];</span><span class="w">    </span><span class="c1">// Optional parameters</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#lab05-mcp-prompts-lab-__codelineno-0-5"></a><span class="w">  </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="kt">Message</span><span class="p">[];</span><span class="w">       </span><span class="c1">// The actual prompt content</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#lab05-mcp-prompts-lab-__codelineno-0-6"></a><span class="p">}</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#lab05-mcp-prompts-lab-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#lab05-mcp-prompts-lab-__codelineno-0-8"></a><span class="kd">interface</span><span class="w"> </span><span class="nx">Argument</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#lab05-mcp-prompts-lab-__codelineno-0-9"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">              </span><span class="c1">// Parameter name</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#lab05-mcp-prompts-lab-__codelineno-0-10"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">       </span><span class="c1">// What it controls</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#lab05-mcp-prompts-lab-__codelineno-0-11"></a><span class="w">  </span><span class="nx">required?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">        </span><span class="c1">// Is it mandatory?</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#lab05-mcp-prompts-lab-__codelineno-0-12"></a><span class="p">}</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#lab05-mcp-prompts-lab-__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#lab05-mcp-prompts-lab-__codelineno-0-14"></a><span class="kd">interface</span><span class="w"> </span><span class="nx">Message</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#lab05-mcp-prompts-lab-__codelineno-0-15"></a><span class="w">  </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;assistant&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Who says this</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#lab05-mcp-prompts-lab-__codelineno-0-16"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="kt">Content</span><span class="p">;</span><span class="w">          </span><span class="c1">// The message content</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#lab05-mcp-prompts-lab-__codelineno-0-17"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="lab05-mcp-prompts-lab-project-setup">Project Setup<a class="headerlink" href="#lab05-mcp-prompts-lab-project-setup" title="Permanent link">&para;</a></h2>
<h3 id="lab05-mcp-prompts-lab-step-1-create-your-project">Step 1: Create Your Project<a class="headerlink" href="#lab05-mcp-prompts-lab-step-1-create-your-project" title="Permanent link">&para;</a></h3>
<p>Let&rsquo;s start by creating a new MCP server project for prompts:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab05-mcp-prompts-lab-__codelineno-1-1"></a>mkdir<span class="w"> </span>my-mcp-prompts-server<span class="w">  </span><span class="c1"># &lt;-- next to the directory created in previous labs</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#lab05-mcp-prompts-lab-__codelineno-1-2"></a><span class="nb">cd</span><span class="w"> </span>my-mcp-prompts-server
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#lab05-mcp-prompts-lab-__codelineno-1-3"></a>npm<span class="w"> </span>init<span class="w"> </span>-y
</span></code></pre></div>
<h3 id="lab05-mcp-prompts-lab-step-2-install-dependencies">Step 2: Install Dependencies<a class="headerlink" href="#lab05-mcp-prompts-lab-step-2-install-dependencies" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab05-mcp-prompts-lab-__codelineno-2-1"></a><span class="c1"># Core MCP SDK</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#lab05-mcp-prompts-lab-__codelineno-2-2"></a>npm<span class="w"> </span>install<span class="w"> </span>@modelcontextprotocol/sdk
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#lab05-mcp-prompts-lab-__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#lab05-mcp-prompts-lab-__codelineno-2-4"></a><span class="c1"># TypeScript and development tools</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#lab05-mcp-prompts-lab-__codelineno-2-5"></a>npm<span class="w"> </span>install<span class="w"> </span>-D<span class="w"> </span>typescript<span class="w"> </span>@types/node<span class="w"> </span>tsx
</span></code></pre></div>
<h3 id="lab05-mcp-prompts-lab-step-3-configure-typescript">Step 3: Configure TypeScript<a class="headerlink" href="#lab05-mcp-prompts-lab-step-3-configure-typescript" title="Permanent link">&para;</a></h3>
<p>Create a <code>tsconfig.json</code> file with the following content inside the <code>my-mcp-prompts-server</code> directory you have just created:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab05-mcp-prompts-lab-__codelineno-3-1"></a><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#lab05-mcp-prompts-lab-__codelineno-3-2"></a><span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#lab05-mcp-prompts-lab-__codelineno-3-3"></a><span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES2022&quot;</span><span class="p">,</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#lab05-mcp-prompts-lab-__codelineno-3-4"></a><span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Node16&quot;</span><span class="p">,</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#lab05-mcp-prompts-lab-__codelineno-3-5"></a><span class="w">    </span><span class="nt">&quot;moduleResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Node16&quot;</span><span class="p">,</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#lab05-mcp-prompts-lab-__codelineno-3-6"></a><span class="w">    </span><span class="nt">&quot;outDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./dist&quot;</span><span class="p">,</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#lab05-mcp-prompts-lab-__codelineno-3-7"></a><span class="w">    </span><span class="nt">&quot;rootDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src&quot;</span><span class="p">,</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#lab05-mcp-prompts-lab-__codelineno-3-8"></a><span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#lab05-mcp-prompts-lab-__codelineno-3-9"></a><span class="w">    </span><span class="nt">&quot;esModuleInterop&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#lab05-mcp-prompts-lab-__codelineno-3-10"></a><span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#lab05-mcp-prompts-lab-__codelineno-3-11"></a><span class="w">    </span><span class="nt">&quot;forceConsistentCasingInFileNames&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#lab05-mcp-prompts-lab-__codelineno-3-12"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#lab05-mcp-prompts-lab-__codelineno-3-13"></a><span class="w">  </span><span class="nt">&quot;include&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/**/*&quot;</span><span class="p">],</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#lab05-mcp-prompts-lab-__codelineno-3-14"></a><span class="w">  </span><span class="nt">&quot;exclude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node_modules&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dist&quot;</span><span class="p">]</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#lab05-mcp-prompts-lab-__codelineno-3-15"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="lab05-mcp-prompts-lab-step-4-create-project-structure">Step 4: Create Project Structure<a class="headerlink" href="#lab05-mcp-prompts-lab-step-4-create-project-structure" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab05-mcp-prompts-lab-__codelineno-4-1"></a>mkdir<span class="w"> </span>src<span class="w">     </span><span class="c1"># &lt;-- inside &quot;my-mcp-prompts-server&quot; directory</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#lab05-mcp-prompts-lab-__codelineno-4-2"></a>touch<span class="w"> </span>src/index.ts<span class="w">   </span><span class="c1"># and leave it empty for now</span>
</span></code></pre></div>
<hr />
<h2 id="lab05-mcp-prompts-lab-creating-your-first-prompt-server">Creating Your First Prompt Server<a class="headerlink" href="#lab05-mcp-prompts-lab-creating-your-first-prompt-server" title="Permanent link">&para;</a></h2>
<h3 id="lab05-mcp-prompts-lab-step-1-basic-server-setup">Step 1: Basic Server Setup<a class="headerlink" href="#lab05-mcp-prompts-lab-step-1-basic-server-setup" title="Permanent link">&para;</a></h3>
<p>Let&rsquo;s create a basic MCP server that exposes prompts. Paste the following inside <code>src/index.ts</code>:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab05-mcp-prompts-lab-__codelineno-5-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#lab05-mcp-prompts-lab-__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#lab05-mcp-prompts-lab-__codelineno-5-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#lab05-mcp-prompts-lab-__codelineno-5-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#lab05-mcp-prompts-lab-__codelineno-5-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#lab05-mcp-prompts-lab-__codelineno-5-6"></a><span class="w">  </span><span class="nx">ListPromptsRequestSchema</span><span class="p">,</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#lab05-mcp-prompts-lab-__codelineno-5-7"></a><span class="w">  </span><span class="nx">GetPromptRequestSchema</span><span class="p">,</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#lab05-mcp-prompts-lab-__codelineno-5-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#lab05-mcp-prompts-lab-__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#lab05-mcp-prompts-lab-__codelineno-5-10"></a><span class="kd">class</span><span class="w"> </span><span class="nx">PromptServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#lab05-mcp-prompts-lab-__codelineno-5-11"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#lab05-mcp-prompts-lab-__codelineno-5-12"></a>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#lab05-mcp-prompts-lab-__codelineno-5-13"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#lab05-mcp-prompts-lab-__codelineno-5-14"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#lab05-mcp-prompts-lab-__codelineno-5-15"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#lab05-mcp-prompts-lab-__codelineno-5-16"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;mcp-prompts-server&quot;</span><span class="p">,</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#lab05-mcp-prompts-lab-__codelineno-5-17"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#lab05-mcp-prompts-lab-__codelineno-5-18"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#lab05-mcp-prompts-lab-__codelineno-5-19"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#lab05-mcp-prompts-lab-__codelineno-5-20"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#lab05-mcp-prompts-lab-__codelineno-5-21"></a><span class="w">          </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#lab05-mcp-prompts-lab-__codelineno-5-22"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#lab05-mcp-prompts-lab-__codelineno-5-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#lab05-mcp-prompts-lab-__codelineno-5-24"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#lab05-mcp-prompts-lab-__codelineno-5-25"></a>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#lab05-mcp-prompts-lab-__codelineno-5-26"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#lab05-mcp-prompts-lab-__codelineno-5-27"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#lab05-mcp-prompts-lab-__codelineno-5-28"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#lab05-mcp-prompts-lab-__codelineno-5-29"></a>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#lab05-mcp-prompts-lab-__codelineno-5-30"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#lab05-mcp-prompts-lab-__codelineno-5-31"></a><span class="w">    </span><span class="c1">// List available prompts</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#lab05-mcp-prompts-lab-__codelineno-5-32"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListPromptsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#lab05-mcp-prompts-lab-__codelineno-5-33"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#lab05-mcp-prompts-lab-__codelineno-5-34"></a><span class="w">        </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#lab05-mcp-prompts-lab-__codelineno-5-35"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#lab05-mcp-prompts-lab-__codelineno-5-36"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hello-prompt&quot;</span><span class="p">,</span>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#lab05-mcp-prompts-lab-__codelineno-5-37"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;A simple greeting prompt&quot;</span><span class="p">,</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#lab05-mcp-prompts-lab-__codelineno-5-38"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#lab05-mcp-prompts-lab-__codelineno-5-39"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#lab05-mcp-prompts-lab-__codelineno-5-40"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;code-review&quot;</span><span class="p">,</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#lab05-mcp-prompts-lab-__codelineno-5-41"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Comprehensive code review with best practices&quot;</span><span class="p">,</span>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#lab05-mcp-prompts-lab-__codelineno-5-42"></a><span class="w">            </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#lab05-mcp-prompts-lab-__codelineno-5-43"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#lab05-mcp-prompts-lab-__codelineno-5-44"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;language&quot;</span><span class="p">,</span>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#lab05-mcp-prompts-lab-__codelineno-5-45"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Programming language (e.g., typescript, python)&quot;</span><span class="p">,</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#lab05-mcp-prompts-lab-__codelineno-5-46"></a><span class="w">                </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#lab05-mcp-prompts-lab-__codelineno-5-47"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#lab05-mcp-prompts-lab-__codelineno-5-48"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#lab05-mcp-prompts-lab-__codelineno-5-49"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#lab05-mcp-prompts-lab-__codelineno-5-50"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#lab05-mcp-prompts-lab-__codelineno-5-51"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#lab05-mcp-prompts-lab-__codelineno-5-52"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#lab05-mcp-prompts-lab-__codelineno-5-53"></a>
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#lab05-mcp-prompts-lab-__codelineno-5-54"></a><span class="w">    </span><span class="c1">// Get specific prompt</span>
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#lab05-mcp-prompts-lab-__codelineno-5-55"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">GetPromptRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#lab05-mcp-prompts-lab-__codelineno-5-56"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#lab05-mcp-prompts-lab-__codelineno-5-57"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generatePrompt</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{});</span>
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#lab05-mcp-prompts-lab-__codelineno-5-58"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#lab05-mcp-prompts-lab-__codelineno-5-59"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#lab05-mcp-prompts-lab-__codelineno-5-60"></a>
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#lab05-mcp-prompts-lab-__codelineno-5-61"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">generatePrompt</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-62"><a id="__codelineno-5-62" name="__codelineno-5-62" href="#lab05-mcp-prompts-lab-__codelineno-5-62"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-63"><a id="__codelineno-5-63" name="__codelineno-5-63" href="#lab05-mcp-prompts-lab-__codelineno-5-63"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;hello-prompt&quot;</span><span class="o">:</span>
</span><span id="__span-5-64"><a id="__codelineno-5-64" name="__codelineno-5-64" href="#lab05-mcp-prompts-lab-__codelineno-5-64"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-65"><a id="__codelineno-5-65" name="__codelineno-5-65" href="#lab05-mcp-prompts-lab-__codelineno-5-65"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;A simple greeting prompt&quot;</span><span class="p">,</span>
</span><span id="__span-5-66"><a id="__codelineno-5-66" name="__codelineno-5-66" href="#lab05-mcp-prompts-lab-__codelineno-5-66"></a><span class="w">          </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-5-67"><a id="__codelineno-5-67" name="__codelineno-5-67" href="#lab05-mcp-prompts-lab-__codelineno-5-67"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-5-68"><a id="__codelineno-5-68" name="__codelineno-5-68" href="#lab05-mcp-prompts-lab-__codelineno-5-68"></a><span class="w">              </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-5-69"><a id="__codelineno-5-69" name="__codelineno-5-69" href="#lab05-mcp-prompts-lab-__codelineno-5-69"></a><span class="w">              </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-70"><a id="__codelineno-5-70" name="__codelineno-5-70" href="#lab05-mcp-prompts-lab-__codelineno-5-70"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-71"><a id="__codelineno-5-71" name="__codelineno-5-71" href="#lab05-mcp-prompts-lab-__codelineno-5-71"></a><span class="w">                </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Hello! Please introduce yourself and explain what you can help me with today.&quot;</span><span class="p">,</span>
</span><span id="__span-5-72"><a id="__codelineno-5-72" name="__codelineno-5-72" href="#lab05-mcp-prompts-lab-__codelineno-5-72"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-5-73"><a id="__codelineno-5-73" name="__codelineno-5-73" href="#lab05-mcp-prompts-lab-__codelineno-5-73"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-5-74"><a id="__codelineno-5-74" name="__codelineno-5-74" href="#lab05-mcp-prompts-lab-__codelineno-5-74"></a><span class="w">          </span><span class="p">],</span>
</span><span id="__span-5-75"><a id="__codelineno-5-75" name="__codelineno-5-75" href="#lab05-mcp-prompts-lab-__codelineno-5-75"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-5-76"><a id="__codelineno-5-76" name="__codelineno-5-76" href="#lab05-mcp-prompts-lab-__codelineno-5-76"></a>
</span><span id="__span-5-77"><a id="__codelineno-5-77" name="__codelineno-5-77" href="#lab05-mcp-prompts-lab-__codelineno-5-77"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;code-review&quot;</span><span class="o">:</span>
</span><span id="__span-5-78"><a id="__codelineno-5-78" name="__codelineno-5-78" href="#lab05-mcp-prompts-lab-__codelineno-5-78"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">language</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;typescript&quot;</span><span class="p">;</span>
</span><span id="__span-5-79"><a id="__codelineno-5-79" name="__codelineno-5-79" href="#lab05-mcp-prompts-lab-__codelineno-5-79"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-80"><a id="__codelineno-5-80" name="__codelineno-5-80" href="#lab05-mcp-prompts-lab-__codelineno-5-80"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Code review for </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-5-81"><a id="__codelineno-5-81" name="__codelineno-5-81" href="#lab05-mcp-prompts-lab-__codelineno-5-81"></a><span class="w">          </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-5-82"><a id="__codelineno-5-82" name="__codelineno-5-82" href="#lab05-mcp-prompts-lab-__codelineno-5-82"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-5-83"><a id="__codelineno-5-83" name="__codelineno-5-83" href="#lab05-mcp-prompts-lab-__codelineno-5-83"></a><span class="w">              </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-5-84"><a id="__codelineno-5-84" name="__codelineno-5-84" href="#lab05-mcp-prompts-lab-__codelineno-5-84"></a><span class="w">              </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-85"><a id="__codelineno-5-85" name="__codelineno-5-85" href="#lab05-mcp-prompts-lab-__codelineno-5-85"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-5-86"><a id="__codelineno-5-86" name="__codelineno-5-86" href="#lab05-mcp-prompts-lab-__codelineno-5-86"></a><span class="w">                </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Please perform a comprehensive code review of the following </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb"> code. Focus on:</span>
</span><span id="__span-5-87"><a id="__codelineno-5-87" name="__codelineno-5-87" href="#lab05-mcp-prompts-lab-__codelineno-5-87"></a>
</span><span id="__span-5-88"><a id="__codelineno-5-88" name="__codelineno-5-88" href="#lab05-mcp-prompts-lab-__codelineno-5-88"></a><span class="sb">## Code Quality &amp; Best Practices</span>
</span><span id="__span-5-89"><a id="__codelineno-5-89" name="__codelineno-5-89" href="#lab05-mcp-prompts-lab-__codelineno-5-89"></a><span class="sb">- **Readability**: Is the code easy to understand?</span>
</span><span id="__span-5-90"><a id="__codelineno-5-90" name="__codelineno-5-90" href="#lab05-mcp-prompts-lab-__codelineno-5-90"></a><span class="sb">- **Maintainability**: How easy will this be to modify later?</span>
</span><span id="__span-5-91"><a id="__codelineno-5-91" name="__codelineno-5-91" href="#lab05-mcp-prompts-lab-__codelineno-5-91"></a><span class="sb">- **Performance**: Are there any obvious performance issues?</span>
</span><span id="__span-5-92"><a id="__codelineno-5-92" name="__codelineno-5-92" href="#lab05-mcp-prompts-lab-__codelineno-5-92"></a><span class="sb">- **Error Handling**: Are errors handled appropriately?</span>
</span><span id="__span-5-93"><a id="__codelineno-5-93" name="__codelineno-5-93" href="#lab05-mcp-prompts-lab-__codelineno-5-93"></a>
</span><span id="__span-5-94"><a id="__codelineno-5-94" name="__codelineno-5-94" href="#lab05-mcp-prompts-lab-__codelineno-5-94"></a><span class="sb">## </span><span class="si">${</span><span class="nx">language</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="si">}</span><span class="sb">-Specific Checks</span>
</span><span id="__span-5-95"><a id="__codelineno-5-95" name="__codelineno-5-95" href="#lab05-mcp-prompts-lab-__codelineno-5-95"></a><span class="sb">- Follow </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb"> conventions and best practices</span>
</span><span id="__span-5-96"><a id="__codelineno-5-96" name="__codelineno-5-96" href="#lab05-mcp-prompts-lab-__codelineno-5-96"></a><span class="sb">- Use appropriate design patterns</span>
</span><span id="__span-5-97"><a id="__codelineno-5-97" name="__codelineno-5-97" href="#lab05-mcp-prompts-lab-__codelineno-5-97"></a><span class="sb">- Ensure proper type safety (if applicable)</span>
</span><span id="__span-5-98"><a id="__codelineno-5-98" name="__codelineno-5-98" href="#lab05-mcp-prompts-lab-__codelineno-5-98"></a>
</span><span id="__span-5-99"><a id="__codelineno-5-99" name="__codelineno-5-99" href="#lab05-mcp-prompts-lab-__codelineno-5-99"></a><span class="sb">Please provide specific, actionable feedback with examples where possible.`</span><span class="p">,</span>
</span><span id="__span-5-100"><a id="__codelineno-5-100" name="__codelineno-5-100" href="#lab05-mcp-prompts-lab-__codelineno-5-100"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-5-101"><a id="__codelineno-5-101" name="__codelineno-5-101" href="#lab05-mcp-prompts-lab-__codelineno-5-101"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-5-102"><a id="__codelineno-5-102" name="__codelineno-5-102" href="#lab05-mcp-prompts-lab-__codelineno-5-102"></a><span class="w">          </span><span class="p">],</span>
</span><span id="__span-5-103"><a id="__codelineno-5-103" name="__codelineno-5-103" href="#lab05-mcp-prompts-lab-__codelineno-5-103"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-5-104"><a id="__codelineno-5-104" name="__codelineno-5-104" href="#lab05-mcp-prompts-lab-__codelineno-5-104"></a>
</span><span id="__span-5-105"><a id="__codelineno-5-105" name="__codelineno-5-105" href="#lab05-mcp-prompts-lab-__codelineno-5-105"></a><span class="w">      </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-5-106"><a id="__codelineno-5-106" name="__codelineno-5-106" href="#lab05-mcp-prompts-lab-__codelineno-5-106"></a><span class="w">        </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown prompt: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-5-107"><a id="__codelineno-5-107" name="__codelineno-5-107" href="#lab05-mcp-prompts-lab-__codelineno-5-107"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-108"><a id="__codelineno-5-108" name="__codelineno-5-108" href="#lab05-mcp-prompts-lab-__codelineno-5-108"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-109"><a id="__codelineno-5-109" name="__codelineno-5-109" href="#lab05-mcp-prompts-lab-__codelineno-5-109"></a>
</span><span id="__span-5-110"><a id="__codelineno-5-110" name="__codelineno-5-110" href="#lab05-mcp-prompts-lab-__codelineno-5-110"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-111"><a id="__codelineno-5-111" name="__codelineno-5-111" href="#lab05-mcp-prompts-lab-__codelineno-5-111"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-112"><a id="__codelineno-5-112" name="__codelineno-5-112" href="#lab05-mcp-prompts-lab-__codelineno-5-112"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-5-113"><a id="__codelineno-5-113" name="__codelineno-5-113" href="#lab05-mcp-prompts-lab-__codelineno-5-113"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-5-114"><a id="__codelineno-5-114" name="__codelineno-5-114" href="#lab05-mcp-prompts-lab-__codelineno-5-114"></a>
</span><span id="__span-5-115"><a id="__codelineno-5-115" name="__codelineno-5-115" href="#lab05-mcp-prompts-lab-__codelineno-5-115"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-116"><a id="__codelineno-5-116" name="__codelineno-5-116" href="#lab05-mcp-prompts-lab-__codelineno-5-116"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-5-117"><a id="__codelineno-5-117" name="__codelineno-5-117" href="#lab05-mcp-prompts-lab-__codelineno-5-117"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-5-118"><a id="__codelineno-5-118" name="__codelineno-5-118" href="#lab05-mcp-prompts-lab-__codelineno-5-118"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-5-119"><a id="__codelineno-5-119" name="__codelineno-5-119" href="#lab05-mcp-prompts-lab-__codelineno-5-119"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-120"><a id="__codelineno-5-120" name="__codelineno-5-120" href="#lab05-mcp-prompts-lab-__codelineno-5-120"></a>
</span><span id="__span-5-121"><a id="__codelineno-5-121" name="__codelineno-5-121" href="#lab05-mcp-prompts-lab-__codelineno-5-121"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-122"><a id="__codelineno-5-122" name="__codelineno-5-122" href="#lab05-mcp-prompts-lab-__codelineno-5-122"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-5-123"><a id="__codelineno-5-123" name="__codelineno-5-123" href="#lab05-mcp-prompts-lab-__codelineno-5-123"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-5-124"><a id="__codelineno-5-124" name="__codelineno-5-124" href="#lab05-mcp-prompts-lab-__codelineno-5-124"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Prompt Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-5-125"><a id="__codelineno-5-125" name="__codelineno-5-125" href="#lab05-mcp-prompts-lab-__codelineno-5-125"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-126"><a id="__codelineno-5-126" name="__codelineno-5-126" href="#lab05-mcp-prompts-lab-__codelineno-5-126"></a><span class="p">}</span>
</span><span id="__span-5-127"><a id="__codelineno-5-127" name="__codelineno-5-127" href="#lab05-mcp-prompts-lab-__codelineno-5-127"></a>
</span><span id="__span-5-128"><a id="__codelineno-5-128" name="__codelineno-5-128" href="#lab05-mcp-prompts-lab-__codelineno-5-128"></a><span class="c1">// Main entry point</span>
</span><span id="__span-5-129"><a id="__codelineno-5-129" name="__codelineno-5-129" href="#lab05-mcp-prompts-lab-__codelineno-5-129"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-130"><a id="__codelineno-5-130" name="__codelineno-5-130" href="#lab05-mcp-prompts-lab-__codelineno-5-130"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">PromptServer</span><span class="p">();</span>
</span><span id="__span-5-131"><a id="__codelineno-5-131" name="__codelineno-5-131" href="#lab05-mcp-prompts-lab-__codelineno-5-131"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-5-132"><a id="__codelineno-5-132" name="__codelineno-5-132" href="#lab05-mcp-prompts-lab-__codelineno-5-132"></a><span class="p">}</span>
</span><span id="__span-5-133"><a id="__codelineno-5-133" name="__codelineno-5-133" href="#lab05-mcp-prompts-lab-__codelineno-5-133"></a>
</span><span id="__span-5-134"><a id="__codelineno-5-134" name="__codelineno-5-134" href="#lab05-mcp-prompts-lab-__codelineno-5-134"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-135"><a id="__codelineno-5-135" name="__codelineno-5-135" href="#lab05-mcp-prompts-lab-__codelineno-5-135"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-5-136"><a id="__codelineno-5-136" name="__codelineno-5-136" href="#lab05-mcp-prompts-lab-__codelineno-5-136"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-5-137"><a id="__codelineno-5-137" name="__codelineno-5-137" href="#lab05-mcp-prompts-lab-__codelineno-5-137"></a><span class="p">});</span>
</span></code></pre></div>
<hr />
<h3 id="lab05-mcp-prompts-lab-step-2-test-your-server">Step 2: Test Your Server<a class="headerlink" href="#lab05-mcp-prompts-lab-step-2-test-your-server" title="Permanent link">&para;</a></h3>
<p><strong>Build and run the server:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab05-mcp-prompts-lab-__codelineno-6-1"></a>npm<span class="w"> </span>run<span class="w"> </span>build
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab05-mcp-prompts-lab-__codelineno-6-2"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node<span class="w"> </span>dist/index.js
</span></code></pre></div>
<p>The MCP Inspector will launch a web interface.</p>
<p><br></p>
<p><strong>Test the prompts in the MCP Inspector UI:</strong></p>
<ol>
<li>
<p><strong>List prompts</strong>: Click the &ldquo;Prompts&rdquo; tab, then click &ldquo;List Prompts&rdquo; to see your two prompts (&ldquo;hello-prompt&rdquo; and &ldquo;code-review&rdquo;).</p>
</li>
<li>
<p><strong>Get hello-prompt</strong>: In the same section, select &ldquo;Get Prompt&rdquo;, enter &ldquo;hello-prompt&rdquo; as the name, and submit to see the greeting prompt content.</p>
</li>
<li>
<p><strong>Get code-review</strong>: Select &ldquo;Get Prompt&rdquo;, enter &ldquo;code-review&rdquo; as the name, and optionally provide arguments like {&ldquo;language&rdquo;: &ldquo;typescript&rdquo;} in the arguments field, then submit to see the code review prompt.</p>
</li>
</ol>
<hr />
<h3 id="lab05-mcp-prompts-lab-step-3-adding-arguments-and-validation">Step 3: Adding Arguments and Validation<a class="headerlink" href="#lab05-mcp-prompts-lab-step-3-adding-arguments-and-validation" title="Permanent link">&para;</a></h3>
<p>Let&rsquo;s enhance our server with better argument handling. Update your existing <code>src/index.ts</code> file to add more arguments to the code-review prompt and include helper methods for dynamic content generation.</p>
<p><strong>Update the code-review prompt definition in the <code>ListPromptsRequestSchema</code> handler:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab05-mcp-prompts-lab-__codelineno-7-1"></a><span class="c1">// Update the code-review prompt definition</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#lab05-mcp-prompts-lab-__codelineno-7-2"></a><span class="p">{</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#lab05-mcp-prompts-lab-__codelineno-7-3"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;code-review&quot;</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#lab05-mcp-prompts-lab-__codelineno-7-4"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Comprehensive code review with best practices&quot;</span><span class="p">,</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#lab05-mcp-prompts-lab-__codelineno-7-5"></a><span class="w">  </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#lab05-mcp-prompts-lab-__codelineno-7-6"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#lab05-mcp-prompts-lab-__codelineno-7-7"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;language&quot;</span><span class="p">,</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#lab05-mcp-prompts-lab-__codelineno-7-8"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Programming language (e.g., typescript, python, java)&quot;</span><span class="p">,</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#lab05-mcp-prompts-lab-__codelineno-7-9"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#lab05-mcp-prompts-lab-__codelineno-7-10"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#lab05-mcp-prompts-lab-__codelineno-7-11"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#lab05-mcp-prompts-lab-__codelineno-7-12"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;complexity&quot;</span><span class="p">,</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#lab05-mcp-prompts-lab-__codelineno-7-13"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Code complexity level (beginner, intermediate, advanced)&quot;</span><span class="p">,</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#lab05-mcp-prompts-lab-__codelineno-7-14"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#lab05-mcp-prompts-lab-__codelineno-7-15"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#lab05-mcp-prompts-lab-__codelineno-7-16"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#lab05-mcp-prompts-lab-__codelineno-7-17"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;focus&quot;</span><span class="p">,</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#lab05-mcp-prompts-lab-__codelineno-7-18"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Review focus areas (comma-separated: quality,security,performance)&quot;</span><span class="p">,</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#lab05-mcp-prompts-lab-__codelineno-7-19"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#lab05-mcp-prompts-lab-__codelineno-7-20"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#lab05-mcp-prompts-lab-__codelineno-7-21"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#lab05-mcp-prompts-lab-__codelineno-7-22"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Update the prompt generation:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab05-mcp-prompts-lab-__codelineno-8-1"></a><span class="k">case</span><span class="w"> </span><span class="s2">&quot;code-review&quot;</span><span class="o">:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#lab05-mcp-prompts-lab-__codelineno-8-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">language</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;typescript&quot;</span><span class="p">;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#lab05-mcp-prompts-lab-__codelineno-8-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">complexity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">complexity</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;intermediate&quot;</span><span class="p">;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#lab05-mcp-prompts-lab-__codelineno-8-4"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">focus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">focus</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;quality&quot;</span><span class="p">;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#lab05-mcp-prompts-lab-__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#lab05-mcp-prompts-lab-__codelineno-8-6"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#lab05-mcp-prompts-lab-__codelineno-8-7"></a><span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Code review for </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb"> (</span><span class="si">${</span><span class="nx">complexity</span><span class="si">}</span><span class="sb"> level, focus: </span><span class="si">${</span><span class="nx">focus</span><span class="si">}</span><span class="sb">)`</span><span class="p">,</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#lab05-mcp-prompts-lab-__codelineno-8-8"></a><span class="w">    </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#lab05-mcp-prompts-lab-__codelineno-8-9"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#lab05-mcp-prompts-lab-__codelineno-8-10"></a><span class="w">        </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#lab05-mcp-prompts-lab-__codelineno-8-11"></a><span class="w">        </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#lab05-mcp-prompts-lab-__codelineno-8-12"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#lab05-mcp-prompts-lab-__codelineno-8-13"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Please perform a comprehensive code review of the following </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb"> code.</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#lab05-mcp-prompts-lab-__codelineno-8-14"></a>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#lab05-mcp-prompts-lab-__codelineno-8-15"></a><span class="sb">**Complexity Level:** </span><span class="si">${</span><span class="nx">complexity</span><span class="si">}</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#lab05-mcp-prompts-lab-__codelineno-8-16"></a><span class="sb">**Focus Areas:** </span><span class="si">${</span><span class="nx">focus</span><span class="si">}</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#lab05-mcp-prompts-lab-__codelineno-8-17"></a>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#lab05-mcp-prompts-lab-__codelineno-8-18"></a><span class="sb">## Review Guidelines</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#lab05-mcp-prompts-lab-__codelineno-8-19"></a>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#lab05-mcp-prompts-lab-__codelineno-8-20"></a><span class="sb">### Code Quality &amp; Best Practices</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#lab05-mcp-prompts-lab-__codelineno-8-21"></a><span class="sb">- **Readability**: Is the code easy to understand?</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#lab05-mcp-prompts-lab-__codelineno-8-22"></a><span class="sb">- **Maintainability**: How easy will this be to modify later?</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#lab05-mcp-prompts-lab-__codelineno-8-23"></a><span class="sb">- **Performance**: Are there any obvious performance issues?</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#lab05-mcp-prompts-lab-__codelineno-8-24"></a>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#lab05-mcp-prompts-lab-__codelineno-8-25"></a><span class="sb">### </span><span class="si">${</span><span class="nx">complexity</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">complexity</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="si">}</span><span class="sb"> Level Expectations</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#lab05-mcp-prompts-lab-__codelineno-8-26"></a><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">getComplexityExpectations</span><span class="p">(</span><span class="nx">complexity</span><span class="p">)</span><span class="si">}</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#lab05-mcp-prompts-lab-__codelineno-8-27"></a>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#lab05-mcp-prompts-lab-__codelineno-8-28"></a><span class="sb">### Focus Area: </span><span class="si">${</span><span class="nx">focus</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="si">}</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#lab05-mcp-prompts-lab-__codelineno-8-29"></a><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">getFocusAreaGuidance</span><span class="p">(</span><span class="nx">focus</span><span class="p">)</span><span class="si">}</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#lab05-mcp-prompts-lab-__codelineno-8-30"></a>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#lab05-mcp-prompts-lab-__codelineno-8-31"></a><span class="sb">Please provide specific, actionable feedback with examples where possible.`</span><span class="p">,</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#lab05-mcp-prompts-lab-__codelineno-8-32"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#lab05-mcp-prompts-lab-__codelineno-8-33"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#lab05-mcp-prompts-lab-__codelineno-8-34"></a><span class="w">    </span><span class="p">],</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#lab05-mcp-prompts-lab-__codelineno-8-35"></a><span class="w">  </span><span class="p">};</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Add helper methods:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab05-mcp-prompts-lab-__codelineno-9-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">getComplexityExpectations</span><span class="p">(</span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#lab05-mcp-prompts-lab-__codelineno-9-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">expectations</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#lab05-mcp-prompts-lab-__codelineno-9-3"></a><span class="w">    </span><span class="nx">beginner</span><span class="o">:</span><span class="w"> </span><span class="sb">`- Clear, self-documenting code\n- Basic error handling\n- Simple, understandable logic`</span><span class="p">,</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#lab05-mcp-prompts-lab-__codelineno-9-4"></a><span class="w">    </span><span class="nx">intermediate</span><span class="o">:</span><span class="w"> </span><span class="sb">`- Good separation of concerns\n- Comprehensive error handling\n- Appropriate design patterns\n- Unit test coverage`</span><span class="p">,</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#lab05-mcp-prompts-lab-__codelineno-9-5"></a><span class="w">    </span><span class="nx">advanced</span><span class="o">:</span><span class="w"> </span><span class="sb">`- High performance and scalability\n- Complex architectural patterns\n- Extensive testing (unit, integration, e2e)\n- Advanced optimization techniques`</span><span class="p">,</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#lab05-mcp-prompts-lab-__codelineno-9-6"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#lab05-mcp-prompts-lab-__codelineno-9-7"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">expectations</span><span class="p">[</span><span class="nx">level</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;- Standard coding practices&quot;</span><span class="p">;</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#lab05-mcp-prompts-lab-__codelineno-9-8"></a><span class="p">}</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#lab05-mcp-prompts-lab-__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#lab05-mcp-prompts-lab-__codelineno-9-10"></a><span class="k">private</span><span class="w"> </span><span class="nx">getFocusAreaGuidance</span><span class="p">(</span><span class="nx">focus</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#lab05-mcp-prompts-lab-__codelineno-9-11"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">guidance</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#lab05-mcp-prompts-lab-__codelineno-9-12"></a><span class="w">    </span><span class="nx">quality</span><span class="o">:</span><span class="w"> </span><span class="sb">`**Code Quality Focus:**</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#lab05-mcp-prompts-lab-__codelineno-9-13"></a><span class="sb">- Code readability and maintainability</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#lab05-mcp-prompts-lab-__codelineno-9-14"></a><span class="sb">- Consistent naming conventions</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#lab05-mcp-prompts-lab-__codelineno-9-15"></a><span class="sb">- Proper code organization</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#lab05-mcp-prompts-lab-__codelineno-9-16"></a><span class="sb">- Documentation quality`</span><span class="p">,</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#lab05-mcp-prompts-lab-__codelineno-9-17"></a><span class="w">    </span><span class="nx">security</span><span class="o">:</span><span class="w"> </span><span class="sb">`**Security Focus:**</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#lab05-mcp-prompts-lab-__codelineno-9-18"></a><span class="sb">- Input validation and sanitization</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#lab05-mcp-prompts-lab-__codelineno-9-19"></a><span class="sb">- Authentication and authorization</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#lab05-mcp-prompts-lab-__codelineno-9-20"></a><span class="sb">- Data protection practices</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#lab05-mcp-prompts-lab-__codelineno-9-21"></a><span class="sb">- Common vulnerability patterns`</span><span class="p">,</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#lab05-mcp-prompts-lab-__codelineno-9-22"></a><span class="w">    </span><span class="nx">performance</span><span class="o">:</span><span class="w"> </span><span class="sb">`**Performance Focus:**</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#lab05-mcp-prompts-lab-__codelineno-9-23"></a><span class="sb">- Algorithm efficiency</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#lab05-mcp-prompts-lab-__codelineno-9-24"></a><span class="sb">- Memory usage optimization</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#lab05-mcp-prompts-lab-__codelineno-9-25"></a><span class="sb">- Database query optimization</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#lab05-mcp-prompts-lab-__codelineno-9-26"></a><span class="sb">- Caching strategies`</span><span class="p">,</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#lab05-mcp-prompts-lab-__codelineno-9-27"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#lab05-mcp-prompts-lab-__codelineno-9-28"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">guidance</span><span class="p">[</span><span class="nx">focus</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;- General best practices&quot;</span><span class="p">;</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#lab05-mcp-prompts-lab-__codelineno-9-29"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p>Here&rsquo;s the complete updated <code>src/index.ts</code> with all the above enhancements, just for review purposes:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab05-mcp-prompts-lab-__codelineno-10-1"></a><span class="ch">#!/usr/bin/env node</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#lab05-mcp-prompts-lab-__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#lab05-mcp-prompts-lab-__codelineno-10-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#lab05-mcp-prompts-lab-__codelineno-10-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#lab05-mcp-prompts-lab-__codelineno-10-5"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#lab05-mcp-prompts-lab-__codelineno-10-6"></a><span class="w">  </span><span class="nx">ListPromptsRequestSchema</span><span class="p">,</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#lab05-mcp-prompts-lab-__codelineno-10-7"></a><span class="w">  </span><span class="nx">GetPromptRequestSchema</span><span class="p">,</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#lab05-mcp-prompts-lab-__codelineno-10-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#lab05-mcp-prompts-lab-__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#lab05-mcp-prompts-lab-__codelineno-10-10"></a><span class="kd">class</span><span class="w"> </span><span class="nx">PromptServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#lab05-mcp-prompts-lab-__codelineno-10-11"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#lab05-mcp-prompts-lab-__codelineno-10-12"></a>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#lab05-mcp-prompts-lab-__codelineno-10-13"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#lab05-mcp-prompts-lab-__codelineno-10-14"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#lab05-mcp-prompts-lab-__codelineno-10-15"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#lab05-mcp-prompts-lab-__codelineno-10-16"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;mcp-prompts-server&quot;</span><span class="p">,</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#lab05-mcp-prompts-lab-__codelineno-10-17"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#lab05-mcp-prompts-lab-__codelineno-10-18"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#lab05-mcp-prompts-lab-__codelineno-10-19"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#lab05-mcp-prompts-lab-__codelineno-10-20"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#lab05-mcp-prompts-lab-__codelineno-10-21"></a><span class="w">          </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#lab05-mcp-prompts-lab-__codelineno-10-22"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#lab05-mcp-prompts-lab-__codelineno-10-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#lab05-mcp-prompts-lab-__codelineno-10-24"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#lab05-mcp-prompts-lab-__codelineno-10-25"></a>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#lab05-mcp-prompts-lab-__codelineno-10-26"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#lab05-mcp-prompts-lab-__codelineno-10-27"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#lab05-mcp-prompts-lab-__codelineno-10-28"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#lab05-mcp-prompts-lab-__codelineno-10-29"></a>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#lab05-mcp-prompts-lab-__codelineno-10-30"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#lab05-mcp-prompts-lab-__codelineno-10-31"></a><span class="w">    </span><span class="c1">// List available prompts</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#lab05-mcp-prompts-lab-__codelineno-10-32"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListPromptsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#lab05-mcp-prompts-lab-__codelineno-10-33"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#lab05-mcp-prompts-lab-__codelineno-10-34"></a><span class="w">        </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#lab05-mcp-prompts-lab-__codelineno-10-35"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#lab05-mcp-prompts-lab-__codelineno-10-36"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hello-prompt&quot;</span><span class="p">,</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#lab05-mcp-prompts-lab-__codelineno-10-37"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;A simple greeting prompt&quot;</span><span class="p">,</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#lab05-mcp-prompts-lab-__codelineno-10-38"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#lab05-mcp-prompts-lab-__codelineno-10-39"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#lab05-mcp-prompts-lab-__codelineno-10-40"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;code-review&quot;</span><span class="p">,</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#lab05-mcp-prompts-lab-__codelineno-10-41"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Comprehensive code review with best practices&quot;</span><span class="p">,</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#lab05-mcp-prompts-lab-__codelineno-10-42"></a><span class="w">            </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#lab05-mcp-prompts-lab-__codelineno-10-43"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#lab05-mcp-prompts-lab-__codelineno-10-44"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;language&quot;</span><span class="p">,</span>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#lab05-mcp-prompts-lab-__codelineno-10-45"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Programming language (e.g., typescript, python, java)&quot;</span><span class="p">,</span>
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#lab05-mcp-prompts-lab-__codelineno-10-46"></a><span class="w">                </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#lab05-mcp-prompts-lab-__codelineno-10-47"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48" href="#lab05-mcp-prompts-lab-__codelineno-10-48"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49" href="#lab05-mcp-prompts-lab-__codelineno-10-49"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;complexity&quot;</span><span class="p">,</span>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50" href="#lab05-mcp-prompts-lab-__codelineno-10-50"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Code complexity level (beginner, intermediate, advanced)&quot;</span><span class="p">,</span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51" href="#lab05-mcp-prompts-lab-__codelineno-10-51"></a><span class="w">                </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52" href="#lab05-mcp-prompts-lab-__codelineno-10-52"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53" href="#lab05-mcp-prompts-lab-__codelineno-10-53"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54" href="#lab05-mcp-prompts-lab-__codelineno-10-54"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;focus&quot;</span><span class="p">,</span>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55" href="#lab05-mcp-prompts-lab-__codelineno-10-55"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Review focus areas (comma-separated: quality,security,performance)&quot;</span><span class="p">,</span>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56" href="#lab05-mcp-prompts-lab-__codelineno-10-56"></a><span class="w">                </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57" href="#lab05-mcp-prompts-lab-__codelineno-10-57"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58" href="#lab05-mcp-prompts-lab-__codelineno-10-58"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59" href="#lab05-mcp-prompts-lab-__codelineno-10-59"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60" href="#lab05-mcp-prompts-lab-__codelineno-10-60"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61" href="#lab05-mcp-prompts-lab-__codelineno-10-61"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62" href="#lab05-mcp-prompts-lab-__codelineno-10-62"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63" href="#lab05-mcp-prompts-lab-__codelineno-10-63"></a>
</span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64" href="#lab05-mcp-prompts-lab-__codelineno-10-64"></a><span class="w">    </span><span class="c1">// Get specific prompt</span>
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65" href="#lab05-mcp-prompts-lab-__codelineno-10-65"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">GetPromptRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66" href="#lab05-mcp-prompts-lab-__codelineno-10-66"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67" href="#lab05-mcp-prompts-lab-__codelineno-10-67"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generatePrompt</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{});</span>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68" href="#lab05-mcp-prompts-lab-__codelineno-10-68"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69" href="#lab05-mcp-prompts-lab-__codelineno-10-69"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70" href="#lab05-mcp-prompts-lab-__codelineno-10-70"></a>
</span><span id="__span-10-71"><a id="__codelineno-10-71" name="__codelineno-10-71" href="#lab05-mcp-prompts-lab-__codelineno-10-71"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">generatePrompt</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-72"><a id="__codelineno-10-72" name="__codelineno-10-72" href="#lab05-mcp-prompts-lab-__codelineno-10-72"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-73"><a id="__codelineno-10-73" name="__codelineno-10-73" href="#lab05-mcp-prompts-lab-__codelineno-10-73"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;hello-prompt&quot;</span><span class="o">:</span>
</span><span id="__span-10-74"><a id="__codelineno-10-74" name="__codelineno-10-74" href="#lab05-mcp-prompts-lab-__codelineno-10-74"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-75"><a id="__codelineno-10-75" name="__codelineno-10-75" href="#lab05-mcp-prompts-lab-__codelineno-10-75"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;A simple greeting prompt&quot;</span><span class="p">,</span>
</span><span id="__span-10-76"><a id="__codelineno-10-76" name="__codelineno-10-76" href="#lab05-mcp-prompts-lab-__codelineno-10-76"></a><span class="w">          </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-10-77"><a id="__codelineno-10-77" name="__codelineno-10-77" href="#lab05-mcp-prompts-lab-__codelineno-10-77"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-10-78"><a id="__codelineno-10-78" name="__codelineno-10-78" href="#lab05-mcp-prompts-lab-__codelineno-10-78"></a><span class="w">              </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-10-79"><a id="__codelineno-10-79" name="__codelineno-10-79" href="#lab05-mcp-prompts-lab-__codelineno-10-79"></a><span class="w">              </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-80"><a id="__codelineno-10-80" name="__codelineno-10-80" href="#lab05-mcp-prompts-lab-__codelineno-10-80"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-10-81"><a id="__codelineno-10-81" name="__codelineno-10-81" href="#lab05-mcp-prompts-lab-__codelineno-10-81"></a><span class="w">                </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Hello! Please introduce yourself and explain what you can help me with today.&quot;</span><span class="p">,</span>
</span><span id="__span-10-82"><a id="__codelineno-10-82" name="__codelineno-10-82" href="#lab05-mcp-prompts-lab-__codelineno-10-82"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-10-83"><a id="__codelineno-10-83" name="__codelineno-10-83" href="#lab05-mcp-prompts-lab-__codelineno-10-83"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-10-84"><a id="__codelineno-10-84" name="__codelineno-10-84" href="#lab05-mcp-prompts-lab-__codelineno-10-84"></a><span class="w">          </span><span class="p">],</span>
</span><span id="__span-10-85"><a id="__codelineno-10-85" name="__codelineno-10-85" href="#lab05-mcp-prompts-lab-__codelineno-10-85"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-10-86"><a id="__codelineno-10-86" name="__codelineno-10-86" href="#lab05-mcp-prompts-lab-__codelineno-10-86"></a>
</span><span id="__span-10-87"><a id="__codelineno-10-87" name="__codelineno-10-87" href="#lab05-mcp-prompts-lab-__codelineno-10-87"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;code-review&quot;</span><span class="o">:</span>
</span><span id="__span-10-88"><a id="__codelineno-10-88" name="__codelineno-10-88" href="#lab05-mcp-prompts-lab-__codelineno-10-88"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">language</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;typescript&quot;</span><span class="p">;</span>
</span><span id="__span-10-89"><a id="__codelineno-10-89" name="__codelineno-10-89" href="#lab05-mcp-prompts-lab-__codelineno-10-89"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">complexity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">complexity</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;intermediate&quot;</span><span class="p">;</span>
</span><span id="__span-10-90"><a id="__codelineno-10-90" name="__codelineno-10-90" href="#lab05-mcp-prompts-lab-__codelineno-10-90"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">focus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">focus</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;quality&quot;</span><span class="p">;</span>
</span><span id="__span-10-91"><a id="__codelineno-10-91" name="__codelineno-10-91" href="#lab05-mcp-prompts-lab-__codelineno-10-91"></a>
</span><span id="__span-10-92"><a id="__codelineno-10-92" name="__codelineno-10-92" href="#lab05-mcp-prompts-lab-__codelineno-10-92"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-93"><a id="__codelineno-10-93" name="__codelineno-10-93" href="#lab05-mcp-prompts-lab-__codelineno-10-93"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Code review for </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb"> (</span><span class="si">${</span><span class="nx">complexity</span><span class="si">}</span><span class="sb"> level, focus: </span><span class="si">${</span><span class="nx">focus</span><span class="si">}</span><span class="sb">)`</span><span class="p">,</span>
</span><span id="__span-10-94"><a id="__codelineno-10-94" name="__codelineno-10-94" href="#lab05-mcp-prompts-lab-__codelineno-10-94"></a><span class="w">          </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-10-95"><a id="__codelineno-10-95" name="__codelineno-10-95" href="#lab05-mcp-prompts-lab-__codelineno-10-95"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-10-96"><a id="__codelineno-10-96" name="__codelineno-10-96" href="#lab05-mcp-prompts-lab-__codelineno-10-96"></a><span class="w">              </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-10-97"><a id="__codelineno-10-97" name="__codelineno-10-97" href="#lab05-mcp-prompts-lab-__codelineno-10-97"></a><span class="w">              </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-98"><a id="__codelineno-10-98" name="__codelineno-10-98" href="#lab05-mcp-prompts-lab-__codelineno-10-98"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-10-99"><a id="__codelineno-10-99" name="__codelineno-10-99" href="#lab05-mcp-prompts-lab-__codelineno-10-99"></a><span class="w">                </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Please perform a comprehensive code review of the following </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb"> code.</span>
</span><span id="__span-10-100"><a id="__codelineno-10-100" name="__codelineno-10-100" href="#lab05-mcp-prompts-lab-__codelineno-10-100"></a>
</span><span id="__span-10-101"><a id="__codelineno-10-101" name="__codelineno-10-101" href="#lab05-mcp-prompts-lab-__codelineno-10-101"></a><span class="sb">**Complexity Level:** </span><span class="si">${</span><span class="nx">complexity</span><span class="si">}</span>
</span><span id="__span-10-102"><a id="__codelineno-10-102" name="__codelineno-10-102" href="#lab05-mcp-prompts-lab-__codelineno-10-102"></a><span class="sb">**Focus Areas:** </span><span class="si">${</span><span class="nx">focus</span><span class="si">}</span>
</span><span id="__span-10-103"><a id="__codelineno-10-103" name="__codelineno-10-103" href="#lab05-mcp-prompts-lab-__codelineno-10-103"></a>
</span><span id="__span-10-104"><a id="__codelineno-10-104" name="__codelineno-10-104" href="#lab05-mcp-prompts-lab-__codelineno-10-104"></a><span class="sb">## Review Guidelines</span>
</span><span id="__span-10-105"><a id="__codelineno-10-105" name="__codelineno-10-105" href="#lab05-mcp-prompts-lab-__codelineno-10-105"></a>
</span><span id="__span-10-106"><a id="__codelineno-10-106" name="__codelineno-10-106" href="#lab05-mcp-prompts-lab-__codelineno-10-106"></a><span class="sb">### Code Quality &amp; Best Practices</span>
</span><span id="__span-10-107"><a id="__codelineno-10-107" name="__codelineno-10-107" href="#lab05-mcp-prompts-lab-__codelineno-10-107"></a><span class="sb">- **Readability**: Is the code easy to understand?</span>
</span><span id="__span-10-108"><a id="__codelineno-10-108" name="__codelineno-10-108" href="#lab05-mcp-prompts-lab-__codelineno-10-108"></a><span class="sb">- **Maintainability**: How easy will this be to modify later?</span>
</span><span id="__span-10-109"><a id="__codelineno-10-109" name="__codelineno-10-109" href="#lab05-mcp-prompts-lab-__codelineno-10-109"></a><span class="sb">- **Performance**: Are there any obvious performance issues?</span>
</span><span id="__span-10-110"><a id="__codelineno-10-110" name="__codelineno-10-110" href="#lab05-mcp-prompts-lab-__codelineno-10-110"></a>
</span><span id="__span-10-111"><a id="__codelineno-10-111" name="__codelineno-10-111" href="#lab05-mcp-prompts-lab-__codelineno-10-111"></a><span class="sb">### </span><span class="si">${</span><span class="nx">complexity</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">complexity</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="si">}</span><span class="sb"> Level Expectations</span>
</span><span id="__span-10-112"><a id="__codelineno-10-112" name="__codelineno-10-112" href="#lab05-mcp-prompts-lab-__codelineno-10-112"></a><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">getComplexityExpectations</span><span class="p">(</span><span class="nx">complexity</span><span class="p">)</span><span class="si">}</span>
</span><span id="__span-10-113"><a id="__codelineno-10-113" name="__codelineno-10-113" href="#lab05-mcp-prompts-lab-__codelineno-10-113"></a>
</span><span id="__span-10-114"><a id="__codelineno-10-114" name="__codelineno-10-114" href="#lab05-mcp-prompts-lab-__codelineno-10-114"></a><span class="sb">### Focus Area: </span><span class="si">${</span><span class="nx">focus</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="si">}</span>
</span><span id="__span-10-115"><a id="__codelineno-10-115" name="__codelineno-10-115" href="#lab05-mcp-prompts-lab-__codelineno-10-115"></a><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">getFocusAreaGuidance</span><span class="p">(</span><span class="nx">focus</span><span class="p">)</span><span class="si">}</span>
</span><span id="__span-10-116"><a id="__codelineno-10-116" name="__codelineno-10-116" href="#lab05-mcp-prompts-lab-__codelineno-10-116"></a>
</span><span id="__span-10-117"><a id="__codelineno-10-117" name="__codelineno-10-117" href="#lab05-mcp-prompts-lab-__codelineno-10-117"></a><span class="sb">Please provide specific, actionable feedback with examples where possible.`</span><span class="p">,</span>
</span><span id="__span-10-118"><a id="__codelineno-10-118" name="__codelineno-10-118" href="#lab05-mcp-prompts-lab-__codelineno-10-118"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-10-119"><a id="__codelineno-10-119" name="__codelineno-10-119" href="#lab05-mcp-prompts-lab-__codelineno-10-119"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-10-120"><a id="__codelineno-10-120" name="__codelineno-10-120" href="#lab05-mcp-prompts-lab-__codelineno-10-120"></a><span class="w">          </span><span class="p">],</span>
</span><span id="__span-10-121"><a id="__codelineno-10-121" name="__codelineno-10-121" href="#lab05-mcp-prompts-lab-__codelineno-10-121"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-10-122"><a id="__codelineno-10-122" name="__codelineno-10-122" href="#lab05-mcp-prompts-lab-__codelineno-10-122"></a>
</span><span id="__span-10-123"><a id="__codelineno-10-123" name="__codelineno-10-123" href="#lab05-mcp-prompts-lab-__codelineno-10-123"></a><span class="w">      </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-10-124"><a id="__codelineno-10-124" name="__codelineno-10-124" href="#lab05-mcp-prompts-lab-__codelineno-10-124"></a><span class="w">        </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown prompt: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-10-125"><a id="__codelineno-10-125" name="__codelineno-10-125" href="#lab05-mcp-prompts-lab-__codelineno-10-125"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-126"><a id="__codelineno-10-126" name="__codelineno-10-126" href="#lab05-mcp-prompts-lab-__codelineno-10-126"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-127"><a id="__codelineno-10-127" name="__codelineno-10-127" href="#lab05-mcp-prompts-lab-__codelineno-10-127"></a>
</span><span id="__span-10-128"><a id="__codelineno-10-128" name="__codelineno-10-128" href="#lab05-mcp-prompts-lab-__codelineno-10-128"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getComplexityExpectations</span><span class="p">(</span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-129"><a id="__codelineno-10-129" name="__codelineno-10-129" href="#lab05-mcp-prompts-lab-__codelineno-10-129"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">expectations</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-130"><a id="__codelineno-10-130" name="__codelineno-10-130" href="#lab05-mcp-prompts-lab-__codelineno-10-130"></a><span class="w">      </span><span class="nx">beginner</span><span class="o">:</span><span class="w"> </span><span class="sb">`- Clear, self-documenting code\n- Basic error handling\n- Simple, understandable logic`</span><span class="p">,</span>
</span><span id="__span-10-131"><a id="__codelineno-10-131" name="__codelineno-10-131" href="#lab05-mcp-prompts-lab-__codelineno-10-131"></a><span class="w">      </span><span class="nx">intermediate</span><span class="o">:</span><span class="w"> </span><span class="sb">`- Good separation of concerns\n- Comprehensive error handling\n- Appropriate design patterns\n- Unit test coverage`</span><span class="p">,</span>
</span><span id="__span-10-132"><a id="__codelineno-10-132" name="__codelineno-10-132" href="#lab05-mcp-prompts-lab-__codelineno-10-132"></a><span class="w">      </span><span class="nx">advanced</span><span class="o">:</span><span class="w"> </span><span class="sb">`- High performance and scalability\n- Complex architectural patterns\n- Extensive testing (unit, integration, e2e)\n- Advanced optimization techniques`</span><span class="p">,</span>
</span><span id="__span-10-133"><a id="__codelineno-10-133" name="__codelineno-10-133" href="#lab05-mcp-prompts-lab-__codelineno-10-133"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-10-134"><a id="__codelineno-10-134" name="__codelineno-10-134" href="#lab05-mcp-prompts-lab-__codelineno-10-134"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">expectations</span><span class="p">[</span><span class="nx">level</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;- Standard coding practices&quot;</span><span class="p">;</span>
</span><span id="__span-10-135"><a id="__codelineno-10-135" name="__codelineno-10-135" href="#lab05-mcp-prompts-lab-__codelineno-10-135"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-136"><a id="__codelineno-10-136" name="__codelineno-10-136" href="#lab05-mcp-prompts-lab-__codelineno-10-136"></a>
</span><span id="__span-10-137"><a id="__codelineno-10-137" name="__codelineno-10-137" href="#lab05-mcp-prompts-lab-__codelineno-10-137"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">getFocusAreaGuidance</span><span class="p">(</span><span class="nx">focus</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-138"><a id="__codelineno-10-138" name="__codelineno-10-138" href="#lab05-mcp-prompts-lab-__codelineno-10-138"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">guidance</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-139"><a id="__codelineno-10-139" name="__codelineno-10-139" href="#lab05-mcp-prompts-lab-__codelineno-10-139"></a><span class="w">      </span><span class="nx">quality</span><span class="o">:</span><span class="w"> </span><span class="sb">`**Code Quality Focus:**</span>
</span><span id="__span-10-140"><a id="__codelineno-10-140" name="__codelineno-10-140" href="#lab05-mcp-prompts-lab-__codelineno-10-140"></a><span class="sb">- Code readability and maintainability</span>
</span><span id="__span-10-141"><a id="__codelineno-10-141" name="__codelineno-10-141" href="#lab05-mcp-prompts-lab-__codelineno-10-141"></a><span class="sb">- Consistent naming conventions</span>
</span><span id="__span-10-142"><a id="__codelineno-10-142" name="__codelineno-10-142" href="#lab05-mcp-prompts-lab-__codelineno-10-142"></a><span class="sb">- Proper code organization</span>
</span><span id="__span-10-143"><a id="__codelineno-10-143" name="__codelineno-10-143" href="#lab05-mcp-prompts-lab-__codelineno-10-143"></a><span class="sb">- Documentation quality`</span><span class="p">,</span>
</span><span id="__span-10-144"><a id="__codelineno-10-144" name="__codelineno-10-144" href="#lab05-mcp-prompts-lab-__codelineno-10-144"></a><span class="w">      </span><span class="nx">security</span><span class="o">:</span><span class="w"> </span><span class="sb">`**Security Focus:**</span>
</span><span id="__span-10-145"><a id="__codelineno-10-145" name="__codelineno-10-145" href="#lab05-mcp-prompts-lab-__codelineno-10-145"></a><span class="sb">- Input validation and sanitization</span>
</span><span id="__span-10-146"><a id="__codelineno-10-146" name="__codelineno-10-146" href="#lab05-mcp-prompts-lab-__codelineno-10-146"></a><span class="sb">- Authentication and authorization</span>
</span><span id="__span-10-147"><a id="__codelineno-10-147" name="__codelineno-10-147" href="#lab05-mcp-prompts-lab-__codelineno-10-147"></a><span class="sb">- Data protection practices</span>
</span><span id="__span-10-148"><a id="__codelineno-10-148" name="__codelineno-10-148" href="#lab05-mcp-prompts-lab-__codelineno-10-148"></a><span class="sb">- Common vulnerability patterns`</span><span class="p">,</span>
</span><span id="__span-10-149"><a id="__codelineno-10-149" name="__codelineno-10-149" href="#lab05-mcp-prompts-lab-__codelineno-10-149"></a><span class="w">      </span><span class="nx">performance</span><span class="o">:</span><span class="w"> </span><span class="sb">`**Performance Focus:**</span>
</span><span id="__span-10-150"><a id="__codelineno-10-150" name="__codelineno-10-150" href="#lab05-mcp-prompts-lab-__codelineno-10-150"></a><span class="sb">- Algorithm efficiency</span>
</span><span id="__span-10-151"><a id="__codelineno-10-151" name="__codelineno-10-151" href="#lab05-mcp-prompts-lab-__codelineno-10-151"></a><span class="sb">- Memory usage optimization</span>
</span><span id="__span-10-152"><a id="__codelineno-10-152" name="__codelineno-10-152" href="#lab05-mcp-prompts-lab-__codelineno-10-152"></a><span class="sb">- Database query optimization</span>
</span><span id="__span-10-153"><a id="__codelineno-10-153" name="__codelineno-10-153" href="#lab05-mcp-prompts-lab-__codelineno-10-153"></a><span class="sb">- Caching strategies`</span><span class="p">,</span>
</span><span id="__span-10-154"><a id="__codelineno-10-154" name="__codelineno-10-154" href="#lab05-mcp-prompts-lab-__codelineno-10-154"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-10-155"><a id="__codelineno-10-155" name="__codelineno-10-155" href="#lab05-mcp-prompts-lab-__codelineno-10-155"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">guidance</span><span class="p">[</span><span class="nx">focus</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;- General best practices&quot;</span><span class="p">;</span>
</span><span id="__span-10-156"><a id="__codelineno-10-156" name="__codelineno-10-156" href="#lab05-mcp-prompts-lab-__codelineno-10-156"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-157"><a id="__codelineno-10-157" name="__codelineno-10-157" href="#lab05-mcp-prompts-lab-__codelineno-10-157"></a>
</span><span id="__span-10-158"><a id="__codelineno-10-158" name="__codelineno-10-158" href="#lab05-mcp-prompts-lab-__codelineno-10-158"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-159"><a id="__codelineno-10-159" name="__codelineno-10-159" href="#lab05-mcp-prompts-lab-__codelineno-10-159"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-160"><a id="__codelineno-10-160" name="__codelineno-10-160" href="#lab05-mcp-prompts-lab-__codelineno-10-160"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-10-161"><a id="__codelineno-10-161" name="__codelineno-10-161" href="#lab05-mcp-prompts-lab-__codelineno-10-161"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-10-162"><a id="__codelineno-10-162" name="__codelineno-10-162" href="#lab05-mcp-prompts-lab-__codelineno-10-162"></a>
</span><span id="__span-10-163"><a id="__codelineno-10-163" name="__codelineno-10-163" href="#lab05-mcp-prompts-lab-__codelineno-10-163"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-164"><a id="__codelineno-10-164" name="__codelineno-10-164" href="#lab05-mcp-prompts-lab-__codelineno-10-164"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-10-165"><a id="__codelineno-10-165" name="__codelineno-10-165" href="#lab05-mcp-prompts-lab-__codelineno-10-165"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-10-166"><a id="__codelineno-10-166" name="__codelineno-10-166" href="#lab05-mcp-prompts-lab-__codelineno-10-166"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-10-167"><a id="__codelineno-10-167" name="__codelineno-10-167" href="#lab05-mcp-prompts-lab-__codelineno-10-167"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-168"><a id="__codelineno-10-168" name="__codelineno-10-168" href="#lab05-mcp-prompts-lab-__codelineno-10-168"></a>
</span><span id="__span-10-169"><a id="__codelineno-10-169" name="__codelineno-10-169" href="#lab05-mcp-prompts-lab-__codelineno-10-169"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-170"><a id="__codelineno-10-170" name="__codelineno-10-170" href="#lab05-mcp-prompts-lab-__codelineno-10-170"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-10-171"><a id="__codelineno-10-171" name="__codelineno-10-171" href="#lab05-mcp-prompts-lab-__codelineno-10-171"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-10-172"><a id="__codelineno-10-172" name="__codelineno-10-172" href="#lab05-mcp-prompts-lab-__codelineno-10-172"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Prompt Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-10-173"><a id="__codelineno-10-173" name="__codelineno-10-173" href="#lab05-mcp-prompts-lab-__codelineno-10-173"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-174"><a id="__codelineno-10-174" name="__codelineno-10-174" href="#lab05-mcp-prompts-lab-__codelineno-10-174"></a><span class="p">}</span>
</span><span id="__span-10-175"><a id="__codelineno-10-175" name="__codelineno-10-175" href="#lab05-mcp-prompts-lab-__codelineno-10-175"></a>
</span><span id="__span-10-176"><a id="__codelineno-10-176" name="__codelineno-10-176" href="#lab05-mcp-prompts-lab-__codelineno-10-176"></a><span class="c1">// Main entry point</span>
</span><span id="__span-10-177"><a id="__codelineno-10-177" name="__codelineno-10-177" href="#lab05-mcp-prompts-lab-__codelineno-10-177"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-178"><a id="__codelineno-10-178" name="__codelineno-10-178" href="#lab05-mcp-prompts-lab-__codelineno-10-178"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">PromptServer</span><span class="p">();</span>
</span><span id="__span-10-179"><a id="__codelineno-10-179" name="__codelineno-10-179" href="#lab05-mcp-prompts-lab-__codelineno-10-179"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</span><span id="__span-10-180"><a id="__codelineno-10-180" name="__codelineno-10-180" href="#lab05-mcp-prompts-lab-__codelineno-10-180"></a><span class="p">}</span>
</span><span id="__span-10-181"><a id="__codelineno-10-181" name="__codelineno-10-181" href="#lab05-mcp-prompts-lab-__codelineno-10-181"></a>
</span><span id="__span-10-182"><a id="__codelineno-10-182" name="__codelineno-10-182" href="#lab05-mcp-prompts-lab-__codelineno-10-182"></a><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-183"><a id="__codelineno-10-183" name="__codelineno-10-183" href="#lab05-mcp-prompts-lab-__codelineno-10-183"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Fatal error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-10-184"><a id="__codelineno-10-184" name="__codelineno-10-184" href="#lab05-mcp-prompts-lab-__codelineno-10-184"></a><span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-10-185"><a id="__codelineno-10-185" name="__codelineno-10-185" href="#lab05-mcp-prompts-lab-__codelineno-10-185"></a><span class="p">});</span>
</span></code></pre></div>
<p><br></p>
<h4 id="lab05-mcp-prompts-lab-test-enhanced-prompts">Test Enhanced Prompts<a class="headerlink" href="#lab05-mcp-prompts-lab-test-enhanced-prompts" title="Permanent link">&para;</a></h4>
<p><strong>Test with different arguments:</strong></p>
<ol>
<li>
<p><strong>Basic code review</strong> (with default values):
   <div class="language-javascript highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#lab05-mcp-prompts-lab-__codelineno-11-1"></a><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;code-review&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">language</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;typescript&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
   Expected: Returns a prompt with intermediate complexity and quality focus.</p>
</li>
<li>
<p><strong>Advanced code review with focus</strong>:
   <div class="language-javascript highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab05-mcp-prompts-lab-__codelineno-12-1"></a><span class="p">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#lab05-mcp-prompts-lab-__codelineno-12-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;code-review&quot;</span><span class="p">,</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#lab05-mcp-prompts-lab-__codelineno-12-3"></a><span class="w">  </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#lab05-mcp-prompts-lab-__codelineno-12-4"></a><span class="w">    </span><span class="nx">language</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;python&quot;</span><span class="p">,</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#lab05-mcp-prompts-lab-__codelineno-12-5"></a><span class="w">    </span><span class="nx">complexity</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;advanced&quot;</span><span class="p">,</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#lab05-mcp-prompts-lab-__codelineno-12-6"></a><span class="w">    </span><span class="nx">focus</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;security&quot;</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#lab05-mcp-prompts-lab-__codelineno-12-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#lab05-mcp-prompts-lab-__codelineno-12-8"></a><span class="p">}</span>
</span></code></pre></div>
   Expected: Returns a prompt with advanced complexity expectations and security focus guidance.</p>
</li>
</ol>
<p><strong>How to test in MCP Inspector:</strong></p>
<ol>
<li>
<p><strong>Start the server:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab05-mcp-prompts-lab-__codelineno-13-1"></a><span class="nb">cd</span><span class="w"> </span>my-mcp-prompts-server
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#lab05-mcp-prompts-lab-__codelineno-13-2"></a>npm<span class="w"> </span>run<span class="w"> </span>build
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#lab05-mcp-prompts-lab-__codelineno-13-3"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node<span class="w"> </span>dist/index.js
</span></code></pre></div></p>
</li>
<li>
<p><strong>Inside MCP Inspector UI, navigate to Prompts:</strong></p>
<ul>
<li>Click on the &ldquo;Prompts&rdquo; tab in the Inspector interface</li>
</ul>
</li>
<li>
<p><strong>Test List Prompts:</strong></p>
<ul>
<li>Click &ldquo;List Prompts&rdquo; button</li>
<li>Verify you see &ldquo;hello-prompt&rdquo; and &ldquo;code-review&rdquo; with the updated arguments</li>
</ul>
</li>
<li>
<p><strong>Test Get Prompt - Basic:</strong></p>
<ul>
<li>Select &ldquo;Get Prompt&rdquo; from the dropdown or click the button</li>
<li>Enter <code>code-review</code> in the &ldquo;Name&rdquo; field</li>
<li>In the &ldquo;Arguments&rdquo; field, enter: <code>{"language": "typescript"}</code></li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Check that the response includes intermediate complexity and quality focus</li>
</ul>
</li>
<li>
<p><strong>Test Get Prompt - Advanced:</strong></p>
<ul>
<li>Select &ldquo;Get Prompt&rdquo; again</li>
<li>Enter <code>code-review</code> in the &ldquo;Name&rdquo; field</li>
<li>In the &ldquo;Arguments&rdquo; field, enter:
    <div class="language-json highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab05-mcp-prompts-lab-__codelineno-14-1"></a><span class="p">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#lab05-mcp-prompts-lab-__codelineno-14-2"></a><span class="w">  </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;python&quot;</span><span class="p">,</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#lab05-mcp-prompts-lab-__codelineno-14-3"></a><span class="w">  </span><span class="nt">&quot;complexity&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;advanced&quot;</span><span class="p">,</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#lab05-mcp-prompts-lab-__codelineno-14-4"></a><span class="w">  </span><span class="nt">&quot;focus&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;security&quot;</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#lab05-mcp-prompts-lab-__codelineno-14-5"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Verify the prompt content includes advanced expectations and security guidance</li>
</ul>
</li>
<li>
<p><strong>Test without arguments:</strong></p>
<ul>
<li>Try <code>code-review</code> with no arguments</li>
<li>Should use defaults: typescript, intermediate, quality</li>
</ul>
</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>The prompt description should reflect the arguments (e.g., &ldquo;Code review for python (advanced level, focus: security)&rdquo;)</li>
<li>The prompt content should include the appropriate complexity expectations and focus area guidance</li>
<li>Helper methods should dynamically insert the correct text based on arguments</li>
</ul>
<hr />
<h2 id="lab05-mcp-prompts-lab-integrating-resources-with-prompts">Integrating Resources with Prompts<a class="headerlink" href="#lab05-mcp-prompts-lab-integrating-resources-with-prompts" title="Permanent link">&para;</a></h2>
<p>Prompts become more powerful when integrated with resources! </p>
<p>This allows prompts to dynamically include contextual information from your knowledge base, documentation, or data sources, creating richer and more informed AI interactions.</p>
<h3 id="lab05-mcp-prompts-lab-step-1-add-resource-support">Step 1: Add Resource Support<a class="headerlink" href="#lab05-mcp-prompts-lab-step-1-add-resource-support" title="Permanent link">&para;</a></h3>
<p><strong>Create a new project for the resource-prompt server:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab05-mcp-prompts-lab-__codelineno-15-1"></a><span class="c1"># Create new directory next to your previous server</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab05-mcp-prompts-lab-__codelineno-15-2"></a>mkdir<span class="w"> </span>my-resource-prompt-server<span class="w">  </span><span class="c1"># &lt;-- next to the directory created previously</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#lab05-mcp-prompts-lab-__codelineno-15-3"></a><span class="nb">cd</span><span class="w"> </span>my-resource-prompt-server
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#lab05-mcp-prompts-lab-__codelineno-15-4"></a>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#lab05-mcp-prompts-lab-__codelineno-15-5"></a><span class="c1"># Initialize and install dependencies</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#lab05-mcp-prompts-lab-__codelineno-15-6"></a>npm<span class="w"> </span>init<span class="w"> </span>-y
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#lab05-mcp-prompts-lab-__codelineno-15-7"></a>npm<span class="w"> </span>install<span class="w"> </span>@modelcontextprotocol/sdk
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#lab05-mcp-prompts-lab-__codelineno-15-8"></a>npm<span class="w"> </span>install<span class="w"> </span>-D<span class="w"> </span>typescript<span class="w"> </span>@types/node<span class="w"> </span>tsx
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#lab05-mcp-prompts-lab-__codelineno-15-9"></a>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#lab05-mcp-prompts-lab-__codelineno-15-10"></a><span class="c1"># Create TypeScript config (same as before)</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#lab05-mcp-prompts-lab-__codelineno-15-11"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>tsconfig.json<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#lab05-mcp-prompts-lab-__codelineno-15-12"></a><span class="s">{</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#lab05-mcp-prompts-lab-__codelineno-15-13"></a><span class="s">  &quot;compilerOptions&quot;: {</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#lab05-mcp-prompts-lab-__codelineno-15-14"></a><span class="s">    &quot;target&quot;: &quot;ES2022&quot;,</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#lab05-mcp-prompts-lab-__codelineno-15-15"></a><span class="s">    &quot;module&quot;: &quot;Node16&quot;,</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#lab05-mcp-prompts-lab-__codelineno-15-16"></a><span class="s">    &quot;moduleResolution&quot;: &quot;Node16&quot;,</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#lab05-mcp-prompts-lab-__codelineno-15-17"></a><span class="s">    &quot;outDir&quot;: &quot;./dist&quot;,</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#lab05-mcp-prompts-lab-__codelineno-15-18"></a><span class="s">    &quot;rootDir&quot;: &quot;./src&quot;,</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#lab05-mcp-prompts-lab-__codelineno-15-19"></a><span class="s">    &quot;strict&quot;: true,</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#lab05-mcp-prompts-lab-__codelineno-15-20"></a><span class="s">    &quot;esModuleInterop&quot;: true,</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#lab05-mcp-prompts-lab-__codelineno-15-21"></a><span class="s">    &quot;skipLibCheck&quot;: true,</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#lab05-mcp-prompts-lab-__codelineno-15-22"></a><span class="s">    &quot;forceConsistentCasingInFileNames&quot;: true</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#lab05-mcp-prompts-lab-__codelineno-15-23"></a><span class="s">  },</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#lab05-mcp-prompts-lab-__codelineno-15-24"></a><span class="s">  &quot;include&quot;: [&quot;src/**/*&quot;],</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#lab05-mcp-prompts-lab-__codelineno-15-25"></a><span class="s">  &quot;exclude&quot;: [&quot;node_modules&quot;, &quot;dist&quot;]</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#lab05-mcp-prompts-lab-__codelineno-15-26"></a><span class="s">}</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#lab05-mcp-prompts-lab-__codelineno-15-27"></a><span class="s">EOF</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#lab05-mcp-prompts-lab-__codelineno-15-28"></a>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#lab05-mcp-prompts-lab-__codelineno-15-29"></a><span class="c1"># Create directory structure</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#lab05-mcp-prompts-lab-__codelineno-15-30"></a>mkdir<span class="w"> </span>src<span class="w"> </span><span class="c1"># &lt;-- inside &quot;my-resource-prompt-server&quot; directory</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Now create the server file <code>src/index.ts</code> with the following content that combines prompts with resources:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#lab05-mcp-prompts-lab-__codelineno-16-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#lab05-mcp-prompts-lab-__codelineno-16-2"></a><span class="w">  </span><span class="nx">ListPromptsRequestSchema</span><span class="p">,</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#lab05-mcp-prompts-lab-__codelineno-16-3"></a><span class="w">  </span><span class="nx">GetPromptRequestSchema</span><span class="p">,</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#lab05-mcp-prompts-lab-__codelineno-16-4"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#lab05-mcp-prompts-lab-__codelineno-16-5"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#lab05-mcp-prompts-lab-__codelineno-16-6"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#lab05-mcp-prompts-lab-__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#lab05-mcp-prompts-lab-__codelineno-16-8"></a><span class="kd">class</span><span class="w"> </span><span class="nx">ResourcePromptServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#lab05-mcp-prompts-lab-__codelineno-16-9"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#lab05-mcp-prompts-lab-__codelineno-16-10"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">knowledgeBase</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#lab05-mcp-prompts-lab-__codelineno-16-11"></a>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#lab05-mcp-prompts-lab-__codelineno-16-12"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#lab05-mcp-prompts-lab-__codelineno-16-13"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#lab05-mcp-prompts-lab-__codelineno-16-14"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#lab05-mcp-prompts-lab-__codelineno-16-15"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;resource-prompt-server&quot;</span><span class="p">,</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#lab05-mcp-prompts-lab-__codelineno-16-16"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#lab05-mcp-prompts-lab-__codelineno-16-17"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#lab05-mcp-prompts-lab-__codelineno-16-18"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#lab05-mcp-prompts-lab-__codelineno-16-19"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#lab05-mcp-prompts-lab-__codelineno-16-20"></a><span class="w">          </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#lab05-mcp-prompts-lab-__codelineno-16-21"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#lab05-mcp-prompts-lab-__codelineno-16-22"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#lab05-mcp-prompts-lab-__codelineno-16-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#lab05-mcp-prompts-lab-__codelineno-16-24"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#lab05-mcp-prompts-lab-__codelineno-16-25"></a>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#lab05-mcp-prompts-lab-__codelineno-16-26"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">initializeKnowledgeBase</span><span class="p">();</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#lab05-mcp-prompts-lab-__codelineno-16-27"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#lab05-mcp-prompts-lab-__codelineno-16-28"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#lab05-mcp-prompts-lab-__codelineno-16-29"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#lab05-mcp-prompts-lab-__codelineno-16-30"></a>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#lab05-mcp-prompts-lab-__codelineno-16-31"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">initializeKnowledgeBase</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#lab05-mcp-prompts-lab-__codelineno-16-32"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;best-practices&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#lab05-mcp-prompts-lab-__codelineno-16-33"></a><span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Development Best Practices&quot;</span><span class="p">,</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#lab05-mcp-prompts-lab-__codelineno-16-34"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#lab05-mcp-prompts-lab-__codelineno-16-35"></a><span class="sb">## Code Quality</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#lab05-mcp-prompts-lab-__codelineno-16-36"></a><span class="sb">- Write self-documenting code</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#lab05-mcp-prompts-lab-__codelineno-16-37"></a><span class="sb">- Use meaningful variable names</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#lab05-mcp-prompts-lab-__codelineno-16-38"></a><span class="sb">- Keep functions small and focused</span>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#lab05-mcp-prompts-lab-__codelineno-16-39"></a>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#lab05-mcp-prompts-lab-__codelineno-16-40"></a><span class="sb">## Testing</span>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#lab05-mcp-prompts-lab-__codelineno-16-41"></a><span class="sb">- Write unit tests for all functions</span>
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#lab05-mcp-prompts-lab-__codelineno-16-42"></a><span class="sb">- Include integration tests</span>
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43" href="#lab05-mcp-prompts-lab-__codelineno-16-43"></a><span class="sb">- Test edge cases and error conditions</span>
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44" href="#lab05-mcp-prompts-lab-__codelineno-16-44"></a><span class="sb">      `</span><span class="p">,</span>
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45" href="#lab05-mcp-prompts-lab-__codelineno-16-45"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46" href="#lab05-mcp-prompts-lab-__codelineno-16-46"></a>
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47" href="#lab05-mcp-prompts-lab-__codelineno-16-47"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;security-guidelines&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48" href="#lab05-mcp-prompts-lab-__codelineno-16-48"></a><span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Security Guidelines&quot;</span><span class="p">,</span>
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49" href="#lab05-mcp-prompts-lab-__codelineno-16-49"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-16-50"><a id="__codelineno-16-50" name="__codelineno-16-50" href="#lab05-mcp-prompts-lab-__codelineno-16-50"></a><span class="sb">## Input Validation</span>
</span><span id="__span-16-51"><a id="__codelineno-16-51" name="__codelineno-16-51" href="#lab05-mcp-prompts-lab-__codelineno-16-51"></a><span class="sb">- Validate all user inputs</span>
</span><span id="__span-16-52"><a id="__codelineno-16-52" name="__codelineno-16-52" href="#lab05-mcp-prompts-lab-__codelineno-16-52"></a><span class="sb">- Use parameterized queries</span>
</span><span id="__span-16-53"><a id="__codelineno-16-53" name="__codelineno-16-53" href="#lab05-mcp-prompts-lab-__codelineno-16-53"></a><span class="sb">- Sanitize HTML content</span>
</span><span id="__span-16-54"><a id="__codelineno-16-54" name="__codelineno-16-54" href="#lab05-mcp-prompts-lab-__codelineno-16-54"></a>
</span><span id="__span-16-55"><a id="__codelineno-16-55" name="__codelineno-16-55" href="#lab05-mcp-prompts-lab-__codelineno-16-55"></a><span class="sb">## Authentication</span>
</span><span id="__span-16-56"><a id="__codelineno-16-56" name="__codelineno-16-56" href="#lab05-mcp-prompts-lab-__codelineno-16-56"></a><span class="sb">- Use strong password policies</span>
</span><span id="__span-16-57"><a id="__codelineno-16-57" name="__codelineno-16-57" href="#lab05-mcp-prompts-lab-__codelineno-16-57"></a><span class="sb">- Implement multi-factor authentication</span>
</span><span id="__span-16-58"><a id="__codelineno-16-58" name="__codelineno-16-58" href="#lab05-mcp-prompts-lab-__codelineno-16-58"></a><span class="sb">      `</span><span class="p">,</span>
</span><span id="__span-16-59"><a id="__codelineno-16-59" name="__codelineno-16-59" href="#lab05-mcp-prompts-lab-__codelineno-16-59"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-16-60"><a id="__codelineno-16-60" name="__codelineno-16-60" href="#lab05-mcp-prompts-lab-__codelineno-16-60"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-16-61"><a id="__codelineno-16-61" name="__codelineno-16-61" href="#lab05-mcp-prompts-lab-__codelineno-16-61"></a>
</span><span id="__span-16-62"><a id="__codelineno-16-62" name="__codelineno-16-62" href="#lab05-mcp-prompts-lab-__codelineno-16-62"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-63"><a id="__codelineno-16-63" name="__codelineno-16-63" href="#lab05-mcp-prompts-lab-__codelineno-16-63"></a><span class="w">    </span><span class="c1">// Resource handlers</span>
</span><span id="__span-16-64"><a id="__codelineno-16-64" name="__codelineno-16-64" href="#lab05-mcp-prompts-lab-__codelineno-16-64"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-65"><a id="__codelineno-16-65" name="__codelineno-16-65" href="#lab05-mcp-prompts-lab-__codelineno-16-65"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">entries</span><span class="p">()).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">doc</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-16-66"><a id="__codelineno-16-66" name="__codelineno-16-66" href="#lab05-mcp-prompts-lab-__codelineno-16-66"></a><span class="w">        </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`kb://articles/</span><span class="si">${</span><span class="nx">key</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-16-67"><a id="__codelineno-16-67" name="__codelineno-16-67" href="#lab05-mcp-prompts-lab-__codelineno-16-67"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">doc.title</span><span class="p">,</span>
</span><span id="__span-16-68"><a id="__codelineno-16-68" name="__codelineno-16-68" href="#lab05-mcp-prompts-lab-__codelineno-16-68"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Knowledge base: </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-16-69"><a id="__codelineno-16-69" name="__codelineno-16-69" href="#lab05-mcp-prompts-lab-__codelineno-16-69"></a><span class="w">        </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text/markdown&quot;</span><span class="p">,</span>
</span><span id="__span-16-70"><a id="__codelineno-16-70" name="__codelineno-16-70" href="#lab05-mcp-prompts-lab-__codelineno-16-70"></a><span class="w">      </span><span class="p">}));</span>
</span><span id="__span-16-71"><a id="__codelineno-16-71" name="__codelineno-16-71" href="#lab05-mcp-prompts-lab-__codelineno-16-71"></a>
</span><span id="__span-16-72"><a id="__codelineno-16-72" name="__codelineno-16-72" href="#lab05-mcp-prompts-lab-__codelineno-16-72"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-16-73"><a id="__codelineno-16-73" name="__codelineno-16-73" href="#lab05-mcp-prompts-lab-__codelineno-16-73"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-16-74"><a id="__codelineno-16-74" name="__codelineno-16-74" href="#lab05-mcp-prompts-lab-__codelineno-16-74"></a>
</span><span id="__span-16-75"><a id="__codelineno-16-75" name="__codelineno-16-75" href="#lab05-mcp-prompts-lab-__codelineno-16-75"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-76"><a id="__codelineno-16-76" name="__codelineno-16-76" href="#lab05-mcp-prompts-lab-__codelineno-16-76"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-16-77"><a id="__codelineno-16-77" name="__codelineno-16-77" href="#lab05-mcp-prompts-lab-__codelineno-16-77"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readKnowledgeBase</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-16-78"><a id="__codelineno-16-78" name="__codelineno-16-78" href="#lab05-mcp-prompts-lab-__codelineno-16-78"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-16-79"><a id="__codelineno-16-79" name="__codelineno-16-79" href="#lab05-mcp-prompts-lab-__codelineno-16-79"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-16-80"><a id="__codelineno-16-80" name="__codelineno-16-80" href="#lab05-mcp-prompts-lab-__codelineno-16-80"></a>
</span><span id="__span-16-81"><a id="__codelineno-16-81" name="__codelineno-16-81" href="#lab05-mcp-prompts-lab-__codelineno-16-81"></a><span class="w">    </span><span class="c1">// Prompt handlers</span>
</span><span id="__span-16-82"><a id="__codelineno-16-82" name="__codelineno-16-82" href="#lab05-mcp-prompts-lab-__codelineno-16-82"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListPromptsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-83"><a id="__codelineno-16-83" name="__codelineno-16-83" href="#lab05-mcp-prompts-lab-__codelineno-16-83"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-84"><a id="__codelineno-16-84" name="__codelineno-16-84" href="#lab05-mcp-prompts-lab-__codelineno-16-84"></a><span class="w">        </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-16-85"><a id="__codelineno-16-85" name="__codelineno-16-85" href="#lab05-mcp-prompts-lab-__codelineno-16-85"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-16-86"><a id="__codelineno-16-86" name="__codelineno-16-86" href="#lab05-mcp-prompts-lab-__codelineno-16-86"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;contextual-code-review&quot;</span><span class="p">,</span>
</span><span id="__span-16-87"><a id="__codelineno-16-87" name="__codelineno-16-87" href="#lab05-mcp-prompts-lab-__codelineno-16-87"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Code review with integrated best practices&quot;</span><span class="p">,</span>
</span><span id="__span-16-88"><a id="__codelineno-16-88" name="__codelineno-16-88" href="#lab05-mcp-prompts-lab-__codelineno-16-88"></a><span class="w">            </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-16-89"><a id="__codelineno-16-89" name="__codelineno-16-89" href="#lab05-mcp-prompts-lab-__codelineno-16-89"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-16-90"><a id="__codelineno-16-90" name="__codelineno-16-90" href="#lab05-mcp-prompts-lab-__codelineno-16-90"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;language&quot;</span><span class="p">,</span>
</span><span id="__span-16-91"><a id="__codelineno-16-91" name="__codelineno-16-91" href="#lab05-mcp-prompts-lab-__codelineno-16-91"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Programming language&quot;</span><span class="p">,</span>
</span><span id="__span-16-92"><a id="__codelineno-16-92" name="__codelineno-16-92" href="#lab05-mcp-prompts-lab-__codelineno-16-92"></a><span class="w">                </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-16-93"><a id="__codelineno-16-93" name="__codelineno-16-93" href="#lab05-mcp-prompts-lab-__codelineno-16-93"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-16-94"><a id="__codelineno-16-94" name="__codelineno-16-94" href="#lab05-mcp-prompts-lab-__codelineno-16-94"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-16-95"><a id="__codelineno-16-95" name="__codelineno-16-95" href="#lab05-mcp-prompts-lab-__codelineno-16-95"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;focusAreas&quot;</span><span class="p">,</span>
</span><span id="__span-16-96"><a id="__codelineno-16-96" name="__codelineno-16-96" href="#lab05-mcp-prompts-lab-__codelineno-16-96"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Focus areas (comma-separated)&quot;</span><span class="p">,</span>
</span><span id="__span-16-97"><a id="__codelineno-16-97" name="__codelineno-16-97" href="#lab05-mcp-prompts-lab-__codelineno-16-97"></a><span class="w">                </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-16-98"><a id="__codelineno-16-98" name="__codelineno-16-98" href="#lab05-mcp-prompts-lab-__codelineno-16-98"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-16-99"><a id="__codelineno-16-99" name="__codelineno-16-99" href="#lab05-mcp-prompts-lab-__codelineno-16-99"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-16-100"><a id="__codelineno-16-100" name="__codelineno-16-100" href="#lab05-mcp-prompts-lab-__codelineno-16-100"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-16-101"><a id="__codelineno-16-101" name="__codelineno-16-101" href="#lab05-mcp-prompts-lab-__codelineno-16-101"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-16-102"><a id="__codelineno-16-102" name="__codelineno-16-102" href="#lab05-mcp-prompts-lab-__codelineno-16-102"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-16-103"><a id="__codelineno-16-103" name="__codelineno-16-103" href="#lab05-mcp-prompts-lab-__codelineno-16-103"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-16-104"><a id="__codelineno-16-104" name="__codelineno-16-104" href="#lab05-mcp-prompts-lab-__codelineno-16-104"></a>
</span><span id="__span-16-105"><a id="__codelineno-16-105" name="__codelineno-16-105" href="#lab05-mcp-prompts-lab-__codelineno-16-105"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">GetPromptRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-106"><a id="__codelineno-16-106" name="__codelineno-16-106" href="#lab05-mcp-prompts-lab-__codelineno-16-106"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-16-107"><a id="__codelineno-16-107" name="__codelineno-16-107" href="#lab05-mcp-prompts-lab-__codelineno-16-107"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generatePrompt</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{});</span>
</span><span id="__span-16-108"><a id="__codelineno-16-108" name="__codelineno-16-108" href="#lab05-mcp-prompts-lab-__codelineno-16-108"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-16-109"><a id="__codelineno-16-109" name="__codelineno-16-109" href="#lab05-mcp-prompts-lab-__codelineno-16-109"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-16-110"><a id="__codelineno-16-110" name="__codelineno-16-110" href="#lab05-mcp-prompts-lab-__codelineno-16-110"></a>
</span><span id="__span-16-111"><a id="__codelineno-16-111" name="__codelineno-16-111" href="#lab05-mcp-prompts-lab-__codelineno-16-111"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">readKnowledgeBase</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-112"><a id="__codelineno-16-112" name="__codelineno-16-112" href="#lab05-mcp-prompts-lab-__codelineno-16-112"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^kb:\/\/articles\/(.+)$/</span><span class="p">);</span>
</span><span id="__span-16-113"><a id="__codelineno-16-113" name="__codelineno-16-113" href="#lab05-mcp-prompts-lab-__codelineno-16-113"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid knowledge base URI: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-16-114"><a id="__codelineno-16-114" name="__codelineno-16-114" href="#lab05-mcp-prompts-lab-__codelineno-16-114"></a>
</span><span id="__span-16-115"><a id="__codelineno-16-115" name="__codelineno-16-115" href="#lab05-mcp-prompts-lab-__codelineno-16-115"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
</span><span id="__span-16-116"><a id="__codelineno-16-116" name="__codelineno-16-116" href="#lab05-mcp-prompts-lab-__codelineno-16-116"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">article</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span><span id="__span-16-117"><a id="__codelineno-16-117" name="__codelineno-16-117" href="#lab05-mcp-prompts-lab-__codelineno-16-117"></a>
</span><span id="__span-16-118"><a id="__codelineno-16-118" name="__codelineno-16-118" href="#lab05-mcp-prompts-lab-__codelineno-16-118"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">article</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Article not found: </span><span class="si">${</span><span class="nx">key</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-16-119"><a id="__codelineno-16-119" name="__codelineno-16-119" href="#lab05-mcp-prompts-lab-__codelineno-16-119"></a>
</span><span id="__span-16-120"><a id="__codelineno-16-120" name="__codelineno-16-120" href="#lab05-mcp-prompts-lab-__codelineno-16-120"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-121"><a id="__codelineno-16-121" name="__codelineno-16-121" href="#lab05-mcp-prompts-lab-__codelineno-16-121"></a><span class="w">      </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-16-122"><a id="__codelineno-16-122" name="__codelineno-16-122" href="#lab05-mcp-prompts-lab-__codelineno-16-122"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text/markdown&quot;</span><span class="p">,</span>
</span><span id="__span-16-123"><a id="__codelineno-16-123" name="__codelineno-16-123" href="#lab05-mcp-prompts-lab-__codelineno-16-123"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">article.content</span><span class="p">,</span>
</span><span id="__span-16-124"><a id="__codelineno-16-124" name="__codelineno-16-124" href="#lab05-mcp-prompts-lab-__codelineno-16-124"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-16-125"><a id="__codelineno-16-125" name="__codelineno-16-125" href="#lab05-mcp-prompts-lab-__codelineno-16-125"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-16-126"><a id="__codelineno-16-126" name="__codelineno-16-126" href="#lab05-mcp-prompts-lab-__codelineno-16-126"></a>
</span><span id="__span-16-127"><a id="__codelineno-16-127" name="__codelineno-16-127" href="#lab05-mcp-prompts-lab-__codelineno-16-127"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">generatePrompt</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-128"><a id="__codelineno-16-128" name="__codelineno-16-128" href="#lab05-mcp-prompts-lab-__codelineno-16-128"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-129"><a id="__codelineno-16-129" name="__codelineno-16-129" href="#lab05-mcp-prompts-lab-__codelineno-16-129"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;contextual-code-review&quot;</span><span class="o">:</span>
</span><span id="__span-16-130"><a id="__codelineno-16-130" name="__codelineno-16-130" href="#lab05-mcp-prompts-lab-__codelineno-16-130"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createContextualCodeReviewPrompt</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-16-131"><a id="__codelineno-16-131" name="__codelineno-16-131" href="#lab05-mcp-prompts-lab-__codelineno-16-131"></a>
</span><span id="__span-16-132"><a id="__codelineno-16-132" name="__codelineno-16-132" href="#lab05-mcp-prompts-lab-__codelineno-16-132"></a><span class="w">      </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-16-133"><a id="__codelineno-16-133" name="__codelineno-16-133" href="#lab05-mcp-prompts-lab-__codelineno-16-133"></a><span class="w">        </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown prompt: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-16-134"><a id="__codelineno-16-134" name="__codelineno-16-134" href="#lab05-mcp-prompts-lab-__codelineno-16-134"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-16-135"><a id="__codelineno-16-135" name="__codelineno-16-135" href="#lab05-mcp-prompts-lab-__codelineno-16-135"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-16-136"><a id="__codelineno-16-136" name="__codelineno-16-136" href="#lab05-mcp-prompts-lab-__codelineno-16-136"></a>
</span><span id="__span-16-137"><a id="__codelineno-16-137" name="__codelineno-16-137" href="#lab05-mcp-prompts-lab-__codelineno-16-137"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">createContextualCodeReviewPrompt</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-138"><a id="__codelineno-16-138" name="__codelineno-16-138" href="#lab05-mcp-prompts-lab-__codelineno-16-138"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">language</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;typescript&quot;</span><span class="p">;</span>
</span><span id="__span-16-139"><a id="__codelineno-16-139" name="__codelineno-16-139" href="#lab05-mcp-prompts-lab-__codelineno-16-139"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">focusAreas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">focusAreas</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">focusAreas</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">).</span><span class="nx">map</span><span class="p">((</span><span class="nx">s</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;quality&quot;</span><span class="p">];</span>
</span><span id="__span-16-140"><a id="__codelineno-16-140" name="__codelineno-16-140" href="#lab05-mcp-prompts-lab-__codelineno-16-140"></a>
</span><span id="__span-16-141"><a id="__codelineno-16-141" name="__codelineno-16-141" href="#lab05-mcp-prompts-lab-__codelineno-16-141"></a><span class="w">    </span><span class="c1">// Fetch relevant knowledge base articles</span>
</span><span id="__span-16-142"><a id="__codelineno-16-142" name="__codelineno-16-142" href="#lab05-mcp-prompts-lab-__codelineno-16-142"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">contextContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="__span-16-143"><a id="__codelineno-16-143" name="__codelineno-16-143" href="#lab05-mcp-prompts-lab-__codelineno-16-143"></a>
</span><span id="__span-16-144"><a id="__codelineno-16-144" name="__codelineno-16-144" href="#lab05-mcp-prompts-lab-__codelineno-16-144"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">focusAreas</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;quality&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-145"><a id="__codelineno-16-145" name="__codelineno-16-145" href="#lab05-mcp-prompts-lab-__codelineno-16-145"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">bestPractices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;best-practices&quot;</span><span class="p">);</span>
</span><span id="__span-16-146"><a id="__codelineno-16-146" name="__codelineno-16-146" href="#lab05-mcp-prompts-lab-__codelineno-16-146"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">bestPractices</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-147"><a id="__codelineno-16-147" name="__codelineno-16-147" href="#lab05-mcp-prompts-lab-__codelineno-16-147"></a><span class="w">        </span><span class="nx">contextContent</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`\n## Development Best Practices\n</span><span class="si">${</span><span class="nx">bestPractices</span><span class="p">.</span><span class="nx">content</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-16-148"><a id="__codelineno-16-148" name="__codelineno-16-148" href="#lab05-mcp-prompts-lab-__codelineno-16-148"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-16-149"><a id="__codelineno-16-149" name="__codelineno-16-149" href="#lab05-mcp-prompts-lab-__codelineno-16-149"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-16-150"><a id="__codelineno-16-150" name="__codelineno-16-150" href="#lab05-mcp-prompts-lab-__codelineno-16-150"></a>
</span><span id="__span-16-151"><a id="__codelineno-16-151" name="__codelineno-16-151" href="#lab05-mcp-prompts-lab-__codelineno-16-151"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">focusAreas</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;security&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-152"><a id="__codelineno-16-152" name="__codelineno-16-152" href="#lab05-mcp-prompts-lab-__codelineno-16-152"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">securityGuidelines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;security-guidelines&quot;</span><span class="p">);</span>
</span><span id="__span-16-153"><a id="__codelineno-16-153" name="__codelineno-16-153" href="#lab05-mcp-prompts-lab-__codelineno-16-153"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">securityGuidelines</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-154"><a id="__codelineno-16-154" name="__codelineno-16-154" href="#lab05-mcp-prompts-lab-__codelineno-16-154"></a><span class="w">        </span><span class="nx">contextContent</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`\n## Security Guidelines\n</span><span class="si">${</span><span class="nx">securityGuidelines</span><span class="p">.</span><span class="nx">content</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-16-155"><a id="__codelineno-16-155" name="__codelineno-16-155" href="#lab05-mcp-prompts-lab-__codelineno-16-155"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-16-156"><a id="__codelineno-16-156" name="__codelineno-16-156" href="#lab05-mcp-prompts-lab-__codelineno-16-156"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-16-157"><a id="__codelineno-16-157" name="__codelineno-16-157" href="#lab05-mcp-prompts-lab-__codelineno-16-157"></a>
</span><span id="__span-16-158"><a id="__codelineno-16-158" name="__codelineno-16-158" href="#lab05-mcp-prompts-lab-__codelineno-16-158"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-159"><a id="__codelineno-16-159" name="__codelineno-16-159" href="#lab05-mcp-prompts-lab-__codelineno-16-159"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Contextual code review for </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb"> with focus on: </span><span class="si">${</span><span class="nx">focusAreas</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-16-160"><a id="__codelineno-16-160" name="__codelineno-16-160" href="#lab05-mcp-prompts-lab-__codelineno-16-160"></a><span class="w">      </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-16-161"><a id="__codelineno-16-161" name="__codelineno-16-161" href="#lab05-mcp-prompts-lab-__codelineno-16-161"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-16-162"><a id="__codelineno-16-162" name="__codelineno-16-162" href="#lab05-mcp-prompts-lab-__codelineno-16-162"></a><span class="w">          </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-16-163"><a id="__codelineno-16-163" name="__codelineno-16-163" href="#lab05-mcp-prompts-lab-__codelineno-16-163"></a><span class="w">          </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-164"><a id="__codelineno-16-164" name="__codelineno-16-164" href="#lab05-mcp-prompts-lab-__codelineno-16-164"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-16-165"><a id="__codelineno-16-165" name="__codelineno-16-165" href="#lab05-mcp-prompts-lab-__codelineno-16-165"></a><span class="w">            </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Please perform a comprehensive code review of the following </span><span class="si">${</span><span class="nx">language</span><span class="si">}</span><span class="sb"> code. Use the integrated knowledge base context to provide informed recommendations.</span>
</span><span id="__span-16-166"><a id="__codelineno-16-166" name="__codelineno-16-166" href="#lab05-mcp-prompts-lab-__codelineno-16-166"></a>
</span><span id="__span-16-167"><a id="__codelineno-16-167" name="__codelineno-16-167" href="#lab05-mcp-prompts-lab-__codelineno-16-167"></a><span class="sb">## Review Context</span>
</span><span id="__span-16-168"><a id="__codelineno-16-168" name="__codelineno-16-168" href="#lab05-mcp-prompts-lab-__codelineno-16-168"></a><span class="si">${</span><span class="nx">contextContent</span><span class="si">}</span>
</span><span id="__span-16-169"><a id="__codelineno-16-169" name="__codelineno-16-169" href="#lab05-mcp-prompts-lab-__codelineno-16-169"></a>
</span><span id="__span-16-170"><a id="__codelineno-16-170" name="__codelineno-16-170" href="#lab05-mcp-prompts-lab-__codelineno-16-170"></a><span class="sb">## Code to Review</span>
</span><span id="__span-16-171"><a id="__codelineno-16-171" name="__codelineno-16-171" href="#lab05-mcp-prompts-lab-__codelineno-16-171"></a><span class="sb">[Insert code here]</span>
</span><span id="__span-16-172"><a id="__codelineno-16-172" name="__codelineno-16-172" href="#lab05-mcp-prompts-lab-__codelineno-16-172"></a>
</span><span id="__span-16-173"><a id="__codelineno-16-173" name="__codelineno-16-173" href="#lab05-mcp-prompts-lab-__codelineno-16-173"></a><span class="sb">## Review Focus Areas</span>
</span><span id="__span-16-174"><a id="__codelineno-16-174" name="__codelineno-16-174" href="#lab05-mcp-prompts-lab-__codelineno-16-174"></a><span class="si">${</span><span class="nx">focusAreas</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">area</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="sb">`- **</span><span class="si">${</span><span class="nx">area</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">area</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="si">}</span><span class="sb">**: Apply relevant guidelines from the context above`</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="si">}</span>
</span><span id="__span-16-175"><a id="__codelineno-16-175" name="__codelineno-16-175" href="#lab05-mcp-prompts-lab-__codelineno-16-175"></a>
</span><span id="__span-16-176"><a id="__codelineno-16-176" name="__codelineno-16-176" href="#lab05-mcp-prompts-lab-__codelineno-16-176"></a><span class="sb">## Review Structure</span>
</span><span id="__span-16-177"><a id="__codelineno-16-177" name="__codelineno-16-177" href="#lab05-mcp-prompts-lab-__codelineno-16-177"></a><span class="sb">1. **Summary**: Overall assessment and key findings</span>
</span><span id="__span-16-178"><a id="__codelineno-16-178" name="__codelineno-16-178" href="#lab05-mcp-prompts-lab-__codelineno-16-178"></a><span class="sb">2. **Strengths**: What the code does well</span>
</span><span id="__span-16-179"><a id="__codelineno-16-179" name="__codelineno-16-179" href="#lab05-mcp-prompts-lab-__codelineno-16-179"></a><span class="sb">3. **Areas for Improvement**: Specific recommendations with context references</span>
</span><span id="__span-16-180"><a id="__codelineno-16-180" name="__codelineno-16-180" href="#lab05-mcp-prompts-lab-__codelineno-16-180"></a><span class="sb">4. **Action Items**: Prioritized list of recommended changes</span>
</span><span id="__span-16-181"><a id="__codelineno-16-181" name="__codelineno-16-181" href="#lab05-mcp-prompts-lab-__codelineno-16-181"></a>
</span><span id="__span-16-182"><a id="__codelineno-16-182" name="__codelineno-16-182" href="#lab05-mcp-prompts-lab-__codelineno-16-182"></a><span class="sb">Please reference specific guidelines from the provided context and explain how they apply to this code.`</span><span class="p">,</span>
</span><span id="__span-16-183"><a id="__codelineno-16-183" name="__codelineno-16-183" href="#lab05-mcp-prompts-lab-__codelineno-16-183"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-16-184"><a id="__codelineno-16-184" name="__codelineno-16-184" href="#lab05-mcp-prompts-lab-__codelineno-16-184"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-16-185"><a id="__codelineno-16-185" name="__codelineno-16-185" href="#lab05-mcp-prompts-lab-__codelineno-16-185"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-16-186"><a id="__codelineno-16-186" name="__codelineno-16-186" href="#lab05-mcp-prompts-lab-__codelineno-16-186"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-16-187"><a id="__codelineno-16-187" name="__codelineno-16-187" href="#lab05-mcp-prompts-lab-__codelineno-16-187"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-16-188"><a id="__codelineno-16-188" name="__codelineno-16-188" href="#lab05-mcp-prompts-lab-__codelineno-16-188"></a>
</span><span id="__span-16-189"><a id="__codelineno-16-189" name="__codelineno-16-189" href="#lab05-mcp-prompts-lab-__codelineno-16-189"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-190"><a id="__codelineno-16-190" name="__codelineno-16-190" href="#lab05-mcp-prompts-lab-__codelineno-16-190"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-191"><a id="__codelineno-16-191" name="__codelineno-16-191" href="#lab05-mcp-prompts-lab-__codelineno-16-191"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-16-192"><a id="__codelineno-16-192" name="__codelineno-16-192" href="#lab05-mcp-prompts-lab-__codelineno-16-192"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-16-193"><a id="__codelineno-16-193" name="__codelineno-16-193" href="#lab05-mcp-prompts-lab-__codelineno-16-193"></a>
</span><span id="__span-16-194"><a id="__codelineno-16-194" name="__codelineno-16-194" href="#lab05-mcp-prompts-lab-__codelineno-16-194"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-195"><a id="__codelineno-16-195" name="__codelineno-16-195" href="#lab05-mcp-prompts-lab-__codelineno-16-195"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-16-196"><a id="__codelineno-16-196" name="__codelineno-16-196" href="#lab05-mcp-prompts-lab-__codelineno-16-196"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-16-197"><a id="__codelineno-16-197" name="__codelineno-16-197" href="#lab05-mcp-prompts-lab-__codelineno-16-197"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-16-198"><a id="__codelineno-16-198" name="__codelineno-16-198" href="#lab05-mcp-prompts-lab-__codelineno-16-198"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-16-199"><a id="__codelineno-16-199" name="__codelineno-16-199" href="#lab05-mcp-prompts-lab-__codelineno-16-199"></a>
</span><span id="__span-16-200"><a id="__codelineno-16-200" name="__codelineno-16-200" href="#lab05-mcp-prompts-lab-__codelineno-16-200"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-201"><a id="__codelineno-16-201" name="__codelineno-16-201" href="#lab05-mcp-prompts-lab-__codelineno-16-201"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-16-202"><a id="__codelineno-16-202" name="__codelineno-16-202" href="#lab05-mcp-prompts-lab-__codelineno-16-202"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-16-203"><a id="__codelineno-16-203" name="__codelineno-16-203" href="#lab05-mcp-prompts-lab-__codelineno-16-203"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Resource-Prompt Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-16-204"><a id="__codelineno-16-204" name="__codelineno-16-204" href="#lab05-mcp-prompts-lab-__codelineno-16-204"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-16-205"><a id="__codelineno-16-205" name="__codelineno-16-205" href="#lab05-mcp-prompts-lab-__codelineno-16-205"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lab05-mcp-prompts-lab-step-2-test-resource-integration">Step 2: Test Resource Integration<a class="headerlink" href="#lab05-mcp-prompts-lab-step-2-test-resource-integration" title="Permanent link">&para;</a></h3>
<p><strong>Build and run the resource-prompt server:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab05-mcp-prompts-lab-__codelineno-17-1"></a><span class="nb">cd</span><span class="w"> </span>my-resource-prompt-server
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#lab05-mcp-prompts-lab-__codelineno-17-2"></a>npm<span class="w"> </span>run<span class="w"> </span>build
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#lab05-mcp-prompts-lab-__codelineno-17-3"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node<span class="w"> </span>dist/index.js
</span></code></pre></div>
<p><strong>Test the enhanced server inside the MCP Inspector UI:</strong></p>
<ol>
<li>
<p><strong>Navigate to Resources tab:</strong></p>
<ul>
<li>Click on the &ldquo;Resources&rdquo; tab</li>
</ul>
</li>
<li>
<p><strong>List resources:</strong></p>
<ul>
<li>Click &ldquo;List Resources&rdquo; button</li>
<li>Verify you see the knowledge base articles (&ldquo;Development Best Practices&rdquo; and &ldquo;Security Guidelines&rdquo;)</li>
</ul>
</li>
<li>
<p><strong>Read a resource:</strong></p>
<ul>
<li>Select &ldquo;Read Resource&rdquo; from the dropdown</li>
<li>Enter <code>kb://articles/best-practices</code> in the &ldquo;URI&rdquo; field</li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Check that the response includes the full content of the best practices article</li>
</ul>
</li>
<li>
<p><strong>Read another resource:</strong></p>
<ul>
<li>Select &ldquo;Read Resource&rdquo; again</li>
<li>Enter <code>kb://articles/security-guidelines</code> in the &ldquo;URI&rdquo; field</li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Verify the security guidelines content is returned</li>
</ul>
</li>
<li>
<p><strong>Navigate to Prompts tab:</strong></p>
<ul>
<li>Click on the &ldquo;Prompts&rdquo; tab</li>
</ul>
</li>
<li>
<p><strong>List prompts:</strong></p>
<ul>
<li>Click &ldquo;List Prompts&rdquo; button</li>
<li>Verify you see the &ldquo;contextual-code-review&rdquo; prompt with its arguments</li>
</ul>
</li>
<li>
<p><strong>Get contextual prompt - Basic:</strong></p>
<ul>
<li>Select &ldquo;Get Prompt&rdquo;</li>
<li>Enter <code>contextual-code-review</code> in the &ldquo;Name&rdquo; field</li>
<li>In the &ldquo;Arguments&rdquo; field, enter: <code>{"language": "typescript"}</code></li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Check that the prompt content includes the best practices from the knowledge base</li>
</ul>
</li>
<li>
<p><strong>Get contextual prompt - With focus areas:</strong></p>
<ul>
<li>Select &ldquo;Get Prompt&rdquo; again</li>
<li>Enter <code>contextual-code-review</code> in the &ldquo;Name&rdquo; field</li>
<li>In the &ldquo;Arguments&rdquo; field, enter:
    <div class="language-json highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab05-mcp-prompts-lab-__codelineno-18-1"></a><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#lab05-mcp-prompts-lab-__codelineno-18-2"></a><span class="w">  </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;python&quot;</span><span class="p">,</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#lab05-mcp-prompts-lab-__codelineno-18-3"></a><span class="w">  </span><span class="nt">&quot;focusAreas&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;quality,security&quot;</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#lab05-mcp-prompts-lab-__codelineno-18-4"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Verify the prompt includes both best practices and security guidelines from the knowledge base</li>
</ul>
</li>
</ol>
<p><br></p>
<p><strong>Expected Results:</strong></p>
<ul>
<li>Resources should list the knowledge base articles with proper URIs and descriptions</li>
<li>Reading resources should return the full markdown content of each article</li>
<li>Prompts should dynamically include relevant knowledge base content based on the focus areas argument</li>
<li>The contextual prompt should reference specific guidelines from the integrated resources</li>
</ul>
<hr />
<h2 id="lab05-mcp-prompts-lab-complete-mcp-server-integration">Complete MCP Server Integration<a class="headerlink" href="#lab05-mcp-prompts-lab-complete-mcp-server-integration" title="Permanent link">&para;</a></h2>
<p>Complete MCP server integration combines all three core capabilities - tools, resources, and prompts - into a single server that can perform complex operations and provide rich, contextual AI interactions.</p>
<h3 id="lab05-mcp-prompts-lab-step-1-combine-all-capabilities">Step 1: Combine All Capabilities<a class="headerlink" href="#lab05-mcp-prompts-lab-step-1-combine-all-capabilities" title="Permanent link">&para;</a></h3>
<p><strong>Create a new project for the complete MCP server:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#lab05-mcp-prompts-lab-__codelineno-19-1"></a><span class="c1"># Create new directory next to your previous servers</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#lab05-mcp-prompts-lab-__codelineno-19-2"></a>mkdir<span class="w"> </span>my-complete-mcp-server
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#lab05-mcp-prompts-lab-__codelineno-19-3"></a><span class="nb">cd</span><span class="w"> </span>my-complete-mcp-server
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#lab05-mcp-prompts-lab-__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#lab05-mcp-prompts-lab-__codelineno-19-5"></a><span class="c1"># Initialize and install dependencies</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#lab05-mcp-prompts-lab-__codelineno-19-6"></a>npm<span class="w"> </span>init<span class="w"> </span>-y
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#lab05-mcp-prompts-lab-__codelineno-19-7"></a>npm<span class="w"> </span>install<span class="w"> </span>@modelcontextprotocol/sdk
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#lab05-mcp-prompts-lab-__codelineno-19-8"></a>npm<span class="w"> </span>install<span class="w"> </span>-D<span class="w"> </span>typescript<span class="w"> </span>@types/node<span class="w"> </span>tsx
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#lab05-mcp-prompts-lab-__codelineno-19-9"></a>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#lab05-mcp-prompts-lab-__codelineno-19-10"></a><span class="c1"># Create TypeScript config (same as before)</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#lab05-mcp-prompts-lab-__codelineno-19-11"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>tsconfig.json<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#lab05-mcp-prompts-lab-__codelineno-19-12"></a><span class="s">{</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#lab05-mcp-prompts-lab-__codelineno-19-13"></a><span class="s">  &quot;compilerOptions&quot;: {</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#lab05-mcp-prompts-lab-__codelineno-19-14"></a><span class="s">    &quot;target&quot;: &quot;ES2022&quot;,</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#lab05-mcp-prompts-lab-__codelineno-19-15"></a><span class="s">    &quot;module&quot;: &quot;Node16&quot;,</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#lab05-mcp-prompts-lab-__codelineno-19-16"></a><span class="s">    &quot;moduleResolution&quot;: &quot;Node16&quot;,</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#lab05-mcp-prompts-lab-__codelineno-19-17"></a><span class="s">    &quot;outDir&quot;: &quot;./dist&quot;,</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#lab05-mcp-prompts-lab-__codelineno-19-18"></a><span class="s">    &quot;rootDir&quot;: &quot;./src&quot;,</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#lab05-mcp-prompts-lab-__codelineno-19-19"></a><span class="s">    &quot;strict&quot;: true,</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#lab05-mcp-prompts-lab-__codelineno-19-20"></a><span class="s">    &quot;esModuleInterop&quot;: true,</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#lab05-mcp-prompts-lab-__codelineno-19-21"></a><span class="s">    &quot;skipLibCheck&quot;: true,</span>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#lab05-mcp-prompts-lab-__codelineno-19-22"></a><span class="s">    &quot;forceConsistentCasingInFileNames&quot;: true</span>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#lab05-mcp-prompts-lab-__codelineno-19-23"></a><span class="s">  },</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24" href="#lab05-mcp-prompts-lab-__codelineno-19-24"></a><span class="s">  &quot;include&quot;: [&quot;src/**/*&quot;],</span>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25" href="#lab05-mcp-prompts-lab-__codelineno-19-25"></a><span class="s">  &quot;exclude&quot;: [&quot;node_modules&quot;, &quot;dist&quot;]</span>
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26" href="#lab05-mcp-prompts-lab-__codelineno-19-26"></a><span class="s">}</span>
</span><span id="__span-19-27"><a id="__codelineno-19-27" name="__codelineno-19-27" href="#lab05-mcp-prompts-lab-__codelineno-19-27"></a><span class="s">EOF</span>
</span><span id="__span-19-28"><a id="__codelineno-19-28" name="__codelineno-19-28" href="#lab05-mcp-prompts-lab-__codelineno-19-28"></a>
</span><span id="__span-19-29"><a id="__codelineno-19-29" name="__codelineno-19-29" href="#lab05-mcp-prompts-lab-__codelineno-19-29"></a><span class="c1"># Create directory structure</span>
</span><span id="__span-19-30"><a id="__codelineno-19-30" name="__codelineno-19-30" href="#lab05-mcp-prompts-lab-__codelineno-19-30"></a>mkdir<span class="w"> </span>src
</span></code></pre></div>
<p><br></p>
<p><strong>Now create the server file <code>src/index.ts</code>, that combines tools, resources, and prompts, with the following content:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#lab05-mcp-prompts-lab-__codelineno-20-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#lab05-mcp-prompts-lab-__codelineno-20-2"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#lab05-mcp-prompts-lab-__codelineno-20-3"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#lab05-mcp-prompts-lab-__codelineno-20-4"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#lab05-mcp-prompts-lab-__codelineno-20-5"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#lab05-mcp-prompts-lab-__codelineno-20-6"></a><span class="w">  </span><span class="nx">ListPromptsRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#lab05-mcp-prompts-lab-__codelineno-20-7"></a><span class="w">  </span><span class="nx">GetPromptRequestSchema</span><span class="p">,</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#lab05-mcp-prompts-lab-__codelineno-20-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#lab05-mcp-prompts-lab-__codelineno-20-9"></a>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#lab05-mcp-prompts-lab-__codelineno-20-10"></a><span class="kd">class</span><span class="w"> </span><span class="nx">CompleteMCPServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#lab05-mcp-prompts-lab-__codelineno-20-11"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#lab05-mcp-prompts-lab-__codelineno-20-12"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">knowledgeBase</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#lab05-mcp-prompts-lab-__codelineno-20-13"></a>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#lab05-mcp-prompts-lab-__codelineno-20-14"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#lab05-mcp-prompts-lab-__codelineno-20-15"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#lab05-mcp-prompts-lab-__codelineno-20-16"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#lab05-mcp-prompts-lab-__codelineno-20-17"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#lab05-mcp-prompts-lab-__codelineno-20-18"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#lab05-mcp-prompts-lab-__codelineno-20-19"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#lab05-mcp-prompts-lab-__codelineno-20-20"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#lab05-mcp-prompts-lab-__codelineno-20-21"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#lab05-mcp-prompts-lab-__codelineno-20-22"></a><span class="w">          </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#lab05-mcp-prompts-lab-__codelineno-20-23"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#lab05-mcp-prompts-lab-__codelineno-20-24"></a><span class="w">          </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#lab05-mcp-prompts-lab-__codelineno-20-25"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#lab05-mcp-prompts-lab-__codelineno-20-26"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#lab05-mcp-prompts-lab-__codelineno-20-27"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#lab05-mcp-prompts-lab-__codelineno-20-28"></a>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#lab05-mcp-prompts-lab-__codelineno-20-29"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">initializeKnowledgeBase</span><span class="p">();</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#lab05-mcp-prompts-lab-__codelineno-20-30"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#lab05-mcp-prompts-lab-__codelineno-20-31"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#lab05-mcp-prompts-lab-__codelineno-20-32"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33" href="#lab05-mcp-prompts-lab-__codelineno-20-33"></a>
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34" href="#lab05-mcp-prompts-lab-__codelineno-20-34"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">initializeKnowledgeBase</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35" href="#lab05-mcp-prompts-lab-__codelineno-20-35"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;development-workflow&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36" href="#lab05-mcp-prompts-lab-__codelineno-20-36"></a><span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Complete Development Workflow&quot;</span><span class="p">,</span>
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37" href="#lab05-mcp-prompts-lab-__codelineno-20-37"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38" href="#lab05-mcp-prompts-lab-__codelineno-20-38"></a><span class="sb">## Development Process</span>
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39" href="#lab05-mcp-prompts-lab-__codelineno-20-39"></a><span class="sb">1. Requirements gathering and analysis</span>
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40" href="#lab05-mcp-prompts-lab-__codelineno-20-40"></a><span class="sb">2. System design and architecture</span>
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41" href="#lab05-mcp-prompts-lab-__codelineno-20-41"></a><span class="sb">3. Implementation with best practices</span>
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42" href="#lab05-mcp-prompts-lab-__codelineno-20-42"></a><span class="sb">4. Code review and quality assurance</span>
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43" href="#lab05-mcp-prompts-lab-__codelineno-20-43"></a><span class="sb">5. Testing and validation</span>
</span><span id="__span-20-44"><a id="__codelineno-20-44" name="__codelineno-20-44" href="#lab05-mcp-prompts-lab-__codelineno-20-44"></a><span class="sb">6. Deployment and monitoring</span>
</span><span id="__span-20-45"><a id="__codelineno-20-45" name="__codelineno-20-45" href="#lab05-mcp-prompts-lab-__codelineno-20-45"></a><span class="sb">7. Maintenance and updates</span>
</span><span id="__span-20-46"><a id="__codelineno-20-46" name="__codelineno-20-46" href="#lab05-mcp-prompts-lab-__codelineno-20-46"></a><span class="sb">      `</span><span class="p">,</span>
</span><span id="__span-20-47"><a id="__codelineno-20-47" name="__codelineno-20-47" href="#lab05-mcp-prompts-lab-__codelineno-20-47"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-48"><a id="__codelineno-20-48" name="__codelineno-20-48" href="#lab05-mcp-prompts-lab-__codelineno-20-48"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-49"><a id="__codelineno-20-49" name="__codelineno-20-49" href="#lab05-mcp-prompts-lab-__codelineno-20-49"></a>
</span><span id="__span-20-50"><a id="__codelineno-20-50" name="__codelineno-20-50" href="#lab05-mcp-prompts-lab-__codelineno-20-50"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-51"><a id="__codelineno-20-51" name="__codelineno-20-51" href="#lab05-mcp-prompts-lab-__codelineno-20-51"></a><span class="w">    </span><span class="c1">// Tool handlers</span>
</span><span id="__span-20-52"><a id="__codelineno-20-52" name="__codelineno-20-52" href="#lab05-mcp-prompts-lab-__codelineno-20-52"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-53"><a id="__codelineno-20-53" name="__codelineno-20-53" href="#lab05-mcp-prompts-lab-__codelineno-20-53"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-54"><a id="__codelineno-20-54" name="__codelineno-20-54" href="#lab05-mcp-prompts-lab-__codelineno-20-54"></a><span class="w">        </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-55"><a id="__codelineno-20-55" name="__codelineno-20-55" href="#lab05-mcp-prompts-lab-__codelineno-20-55"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-20-56"><a id="__codelineno-20-56" name="__codelineno-20-56" href="#lab05-mcp-prompts-lab-__codelineno-20-56"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;analyze_codebase&quot;</span><span class="p">,</span>
</span><span id="__span-20-57"><a id="__codelineno-20-57" name="__codelineno-20-57" href="#lab05-mcp-prompts-lab-__codelineno-20-57"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analyze codebase structure and provide insights&quot;</span><span class="p">,</span>
</span><span id="__span-20-58"><a id="__codelineno-20-58" name="__codelineno-20-58" href="#lab05-mcp-prompts-lab-__codelineno-20-58"></a><span class="w">            </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-59"><a id="__codelineno-20-59" name="__codelineno-20-59" href="#lab05-mcp-prompts-lab-__codelineno-20-59"></a><span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-20-60"><a id="__codelineno-20-60" name="__codelineno-20-60" href="#lab05-mcp-prompts-lab-__codelineno-20-60"></a><span class="w">              </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-61"><a id="__codelineno-20-61" name="__codelineno-20-61" href="#lab05-mcp-prompts-lab-__codelineno-20-61"></a><span class="w">                </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Path to analyze&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-20-62"><a id="__codelineno-20-62" name="__codelineno-20-62" href="#lab05-mcp-prompts-lab-__codelineno-20-62"></a><span class="w">                </span><span class="nx">analysisType</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-63"><a id="__codelineno-20-63" name="__codelineno-20-63" href="#lab05-mcp-prompts-lab-__codelineno-20-63"></a><span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-20-64"><a id="__codelineno-20-64" name="__codelineno-20-64" href="#lab05-mcp-prompts-lab-__codelineno-20-64"></a><span class="w">                  </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;complexity&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dependencies&quot;</span><span class="p">],</span>
</span><span id="__span-20-65"><a id="__codelineno-20-65" name="__codelineno-20-65" href="#lab05-mcp-prompts-lab-__codelineno-20-65"></a><span class="w">                  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;structure&quot;</span>
</span><span id="__span-20-66"><a id="__codelineno-20-66" name="__codelineno-20-66" href="#lab05-mcp-prompts-lab-__codelineno-20-66"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-20-67"><a id="__codelineno-20-67" name="__codelineno-20-67" href="#lab05-mcp-prompts-lab-__codelineno-20-67"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-20-68"><a id="__codelineno-20-68" name="__codelineno-20-68" href="#lab05-mcp-prompts-lab-__codelineno-20-68"></a><span class="w">              </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">],</span>
</span><span id="__span-20-69"><a id="__codelineno-20-69" name="__codelineno-20-69" href="#lab05-mcp-prompts-lab-__codelineno-20-69"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-20-70"><a id="__codelineno-20-70" name="__codelineno-20-70" href="#lab05-mcp-prompts-lab-__codelineno-20-70"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-20-71"><a id="__codelineno-20-71" name="__codelineno-20-71" href="#lab05-mcp-prompts-lab-__codelineno-20-71"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-20-72"><a id="__codelineno-20-72" name="__codelineno-20-72" href="#lab05-mcp-prompts-lab-__codelineno-20-72"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-20-73"><a id="__codelineno-20-73" name="__codelineno-20-73" href="#lab05-mcp-prompts-lab-__codelineno-20-73"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-74"><a id="__codelineno-20-74" name="__codelineno-20-74" href="#lab05-mcp-prompts-lab-__codelineno-20-74"></a>
</span><span id="__span-20-75"><a id="__codelineno-20-75" name="__codelineno-20-75" href="#lab05-mcp-prompts-lab-__codelineno-20-75"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">CallToolRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-76"><a id="__codelineno-20-76" name="__codelineno-20-76" href="#lab05-mcp-prompts-lab-__codelineno-20-76"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-20-77"><a id="__codelineno-20-77" name="__codelineno-20-77" href="#lab05-mcp-prompts-lab-__codelineno-20-77"></a>
</span><span id="__span-20-78"><a id="__codelineno-20-78" name="__codelineno-20-78" href="#lab05-mcp-prompts-lab-__codelineno-20-78"></a><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-79"><a id="__codelineno-20-79" name="__codelineno-20-79" href="#lab05-mcp-prompts-lab-__codelineno-20-79"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;analyze_codebase&quot;</span><span class="o">:</span>
</span><span id="__span-20-80"><a id="__codelineno-20-80" name="__codelineno-20-80" href="#lab05-mcp-prompts-lab-__codelineno-20-80"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzeCodebase</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-20-81"><a id="__codelineno-20-81" name="__codelineno-20-81" href="#lab05-mcp-prompts-lab-__codelineno-20-81"></a>
</span><span id="__span-20-82"><a id="__codelineno-20-82" name="__codelineno-20-82" href="#lab05-mcp-prompts-lab-__codelineno-20-82"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-20-83"><a id="__codelineno-20-83" name="__codelineno-20-83" href="#lab05-mcp-prompts-lab-__codelineno-20-83"></a><span class="w">          </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-20-84"><a id="__codelineno-20-84" name="__codelineno-20-84" href="#lab05-mcp-prompts-lab-__codelineno-20-84"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-20-85"><a id="__codelineno-20-85" name="__codelineno-20-85" href="#lab05-mcp-prompts-lab-__codelineno-20-85"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-86"><a id="__codelineno-20-86" name="__codelineno-20-86" href="#lab05-mcp-prompts-lab-__codelineno-20-86"></a>
</span><span id="__span-20-87"><a id="__codelineno-20-87" name="__codelineno-20-87" href="#lab05-mcp-prompts-lab-__codelineno-20-87"></a><span class="w">    </span><span class="c1">// Resource handlers</span>
</span><span id="__span-20-88"><a id="__codelineno-20-88" name="__codelineno-20-88" href="#lab05-mcp-prompts-lab-__codelineno-20-88"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-89"><a id="__codelineno-20-89" name="__codelineno-20-89" href="#lab05-mcp-prompts-lab-__codelineno-20-89"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-90"><a id="__codelineno-20-90" name="__codelineno-20-90" href="#lab05-mcp-prompts-lab-__codelineno-20-90"></a><span class="w">        </span><span class="p">...</span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">entries</span><span class="p">()).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">doc</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-20-91"><a id="__codelineno-20-91" name="__codelineno-20-91" href="#lab05-mcp-prompts-lab-__codelineno-20-91"></a><span class="w">          </span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="sb">`kb://articles/</span><span class="si">${</span><span class="nx">key</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-20-92"><a id="__codelineno-20-92" name="__codelineno-20-92" href="#lab05-mcp-prompts-lab-__codelineno-20-92"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">doc.title</span><span class="p">,</span>
</span><span id="__span-20-93"><a id="__codelineno-20-93" name="__codelineno-20-93" href="#lab05-mcp-prompts-lab-__codelineno-20-93"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Knowledge: </span><span class="si">${</span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-20-94"><a id="__codelineno-20-94" name="__codelineno-20-94" href="#lab05-mcp-prompts-lab-__codelineno-20-94"></a><span class="w">          </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text/markdown&quot;</span><span class="p">,</span>
</span><span id="__span-20-95"><a id="__codelineno-20-95" name="__codelineno-20-95" href="#lab05-mcp-prompts-lab-__codelineno-20-95"></a><span class="w">        </span><span class="p">})),</span>
</span><span id="__span-20-96"><a id="__codelineno-20-96" name="__codelineno-20-96" href="#lab05-mcp-prompts-lab-__codelineno-20-96"></a><span class="w">      </span><span class="p">];</span>
</span><span id="__span-20-97"><a id="__codelineno-20-97" name="__codelineno-20-97" href="#lab05-mcp-prompts-lab-__codelineno-20-97"></a>
</span><span id="__span-20-98"><a id="__codelineno-20-98" name="__codelineno-20-98" href="#lab05-mcp-prompts-lab-__codelineno-20-98"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">resources</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-20-99"><a id="__codelineno-20-99" name="__codelineno-20-99" href="#lab05-mcp-prompts-lab-__codelineno-20-99"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-100"><a id="__codelineno-20-100" name="__codelineno-20-100" href="#lab05-mcp-prompts-lab-__codelineno-20-100"></a>
</span><span id="__span-20-101"><a id="__codelineno-20-101" name="__codelineno-20-101" href="#lab05-mcp-prompts-lab-__codelineno-20-101"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-102"><a id="__codelineno-20-102" name="__codelineno-20-102" href="#lab05-mcp-prompts-lab-__codelineno-20-102"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uri</span><span class="p">;</span>
</span><span id="__span-20-103"><a id="__codelineno-20-103" name="__codelineno-20-103" href="#lab05-mcp-prompts-lab-__codelineno-20-103"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readResource</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-20-104"><a id="__codelineno-20-104" name="__codelineno-20-104" href="#lab05-mcp-prompts-lab-__codelineno-20-104"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contents</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">content</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-20-105"><a id="__codelineno-20-105" name="__codelineno-20-105" href="#lab05-mcp-prompts-lab-__codelineno-20-105"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-106"><a id="__codelineno-20-106" name="__codelineno-20-106" href="#lab05-mcp-prompts-lab-__codelineno-20-106"></a>
</span><span id="__span-20-107"><a id="__codelineno-20-107" name="__codelineno-20-107" href="#lab05-mcp-prompts-lab-__codelineno-20-107"></a><span class="w">    </span><span class="c1">// Prompt handlers</span>
</span><span id="__span-20-108"><a id="__codelineno-20-108" name="__codelineno-20-108" href="#lab05-mcp-prompts-lab-__codelineno-20-108"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListPromptsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-109"><a id="__codelineno-20-109" name="__codelineno-20-109" href="#lab05-mcp-prompts-lab-__codelineno-20-109"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-110"><a id="__codelineno-20-110" name="__codelineno-20-110" href="#lab05-mcp-prompts-lab-__codelineno-20-110"></a><span class="w">        </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-111"><a id="__codelineno-20-111" name="__codelineno-20-111" href="#lab05-mcp-prompts-lab-__codelineno-20-111"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-20-112"><a id="__codelineno-20-112" name="__codelineno-20-112" href="#lab05-mcp-prompts-lab-__codelineno-20-112"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;full-development-workflow&quot;</span><span class="p">,</span>
</span><span id="__span-20-113"><a id="__codelineno-20-113" name="__codelineno-20-113" href="#lab05-mcp-prompts-lab-__codelineno-20-113"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Complete development workflow with integrated resources&quot;</span><span class="p">,</span>
</span><span id="__span-20-114"><a id="__codelineno-20-114" name="__codelineno-20-114" href="#lab05-mcp-prompts-lab-__codelineno-20-114"></a><span class="w">            </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-115"><a id="__codelineno-20-115" name="__codelineno-20-115" href="#lab05-mcp-prompts-lab-__codelineno-20-115"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-20-116"><a id="__codelineno-20-116" name="__codelineno-20-116" href="#lab05-mcp-prompts-lab-__codelineno-20-116"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;projectType&quot;</span><span class="p">,</span>
</span><span id="__span-20-117"><a id="__codelineno-20-117" name="__codelineno-20-117" href="#lab05-mcp-prompts-lab-__codelineno-20-117"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Type of project (web, api, mobile)&quot;</span><span class="p">,</span>
</span><span id="__span-20-118"><a id="__codelineno-20-118" name="__codelineno-20-118" href="#lab05-mcp-prompts-lab-__codelineno-20-118"></a><span class="w">                </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-20-119"><a id="__codelineno-20-119" name="__codelineno-20-119" href="#lab05-mcp-prompts-lab-__codelineno-20-119"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-20-120"><a id="__codelineno-20-120" name="__codelineno-20-120" href="#lab05-mcp-prompts-lab-__codelineno-20-120"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-20-121"><a id="__codelineno-20-121" name="__codelineno-20-121" href="#lab05-mcp-prompts-lab-__codelineno-20-121"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-20-122"><a id="__codelineno-20-122" name="__codelineno-20-122" href="#lab05-mcp-prompts-lab-__codelineno-20-122"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-20-123"><a id="__codelineno-20-123" name="__codelineno-20-123" href="#lab05-mcp-prompts-lab-__codelineno-20-123"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;code-quality-assessment&quot;</span><span class="p">,</span>
</span><span id="__span-20-124"><a id="__codelineno-20-124" name="__codelineno-20-124" href="#lab05-mcp-prompts-lab-__codelineno-20-124"></a><span class="w">            </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Comprehensive code quality assessment using all capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-20-125"><a id="__codelineno-20-125" name="__codelineno-20-125" href="#lab05-mcp-prompts-lab-__codelineno-20-125"></a><span class="w">            </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-126"><a id="__codelineno-20-126" name="__codelineno-20-126" href="#lab05-mcp-prompts-lab-__codelineno-20-126"></a><span class="w">              </span><span class="p">{</span>
</span><span id="__span-20-127"><a id="__codelineno-20-127" name="__codelineno-20-127" href="#lab05-mcp-prompts-lab-__codelineno-20-127"></a><span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;codeSample&quot;</span><span class="p">,</span>
</span><span id="__span-20-128"><a id="__codelineno-20-128" name="__codelineno-20-128" href="#lab05-mcp-prompts-lab-__codelineno-20-128"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Code to assess&quot;</span><span class="p">,</span>
</span><span id="__span-20-129"><a id="__codelineno-20-129" name="__codelineno-20-129" href="#lab05-mcp-prompts-lab-__codelineno-20-129"></a><span class="w">                </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-20-130"><a id="__codelineno-20-130" name="__codelineno-20-130" href="#lab05-mcp-prompts-lab-__codelineno-20-130"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-20-131"><a id="__codelineno-20-131" name="__codelineno-20-131" href="#lab05-mcp-prompts-lab-__codelineno-20-131"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-20-132"><a id="__codelineno-20-132" name="__codelineno-20-132" href="#lab05-mcp-prompts-lab-__codelineno-20-132"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-20-133"><a id="__codelineno-20-133" name="__codelineno-20-133" href="#lab05-mcp-prompts-lab-__codelineno-20-133"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-20-134"><a id="__codelineno-20-134" name="__codelineno-20-134" href="#lab05-mcp-prompts-lab-__codelineno-20-134"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-20-135"><a id="__codelineno-20-135" name="__codelineno-20-135" href="#lab05-mcp-prompts-lab-__codelineno-20-135"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-136"><a id="__codelineno-20-136" name="__codelineno-20-136" href="#lab05-mcp-prompts-lab-__codelineno-20-136"></a>
</span><span id="__span-20-137"><a id="__codelineno-20-137" name="__codelineno-20-137" href="#lab05-mcp-prompts-lab-__codelineno-20-137"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">GetPromptRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-138"><a id="__codelineno-20-138" name="__codelineno-20-138" href="#lab05-mcp-prompts-lab-__codelineno-20-138"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-20-139"><a id="__codelineno-20-139" name="__codelineno-20-139" href="#lab05-mcp-prompts-lab-__codelineno-20-139"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateIntegratedPrompt</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{});</span>
</span><span id="__span-20-140"><a id="__codelineno-20-140" name="__codelineno-20-140" href="#lab05-mcp-prompts-lab-__codelineno-20-140"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-141"><a id="__codelineno-20-141" name="__codelineno-20-141" href="#lab05-mcp-prompts-lab-__codelineno-20-141"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-142"><a id="__codelineno-20-142" name="__codelineno-20-142" href="#lab05-mcp-prompts-lab-__codelineno-20-142"></a>
</span><span id="__span-20-143"><a id="__codelineno-20-143" name="__codelineno-20-143" href="#lab05-mcp-prompts-lab-__codelineno-20-143"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">analyzeCodebase</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-144"><a id="__codelineno-20-144" name="__codelineno-20-144" href="#lab05-mcp-prompts-lab-__codelineno-20-144"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">targetPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">path</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;./&quot;</span><span class="p">;</span>
</span><span id="__span-20-145"><a id="__codelineno-20-145" name="__codelineno-20-145" href="#lab05-mcp-prompts-lab-__codelineno-20-145"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">analysisType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">analysisType</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;structure&quot;</span><span class="p">;</span>
</span><span id="__span-20-146"><a id="__codelineno-20-146" name="__codelineno-20-146" href="#lab05-mcp-prompts-lab-__codelineno-20-146"></a>
</span><span id="__span-20-147"><a id="__codelineno-20-147" name="__codelineno-20-147" href="#lab05-mcp-prompts-lab-__codelineno-20-147"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-148"><a id="__codelineno-20-148" name="__codelineno-20-148" href="#lab05-mcp-prompts-lab-__codelineno-20-148"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">analysis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">performCodeAnalysis</span><span class="p">(</span><span class="nx">targetPath</span><span class="p">,</span><span class="w"> </span><span class="nx">analysisType</span><span class="p">);</span>
</span><span id="__span-20-149"><a id="__codelineno-20-149" name="__codelineno-20-149" href="#lab05-mcp-prompts-lab-__codelineno-20-149"></a>
</span><span id="__span-20-150"><a id="__codelineno-20-150" name="__codelineno-20-150" href="#lab05-mcp-prompts-lab-__codelineno-20-150"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-151"><a id="__codelineno-20-151" name="__codelineno-20-151" href="#lab05-mcp-prompts-lab-__codelineno-20-151"></a><span class="w">        </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-152"><a id="__codelineno-20-152" name="__codelineno-20-152" href="#lab05-mcp-prompts-lab-__codelineno-20-152"></a><span class="w">          </span><span class="p">{</span>
</span><span id="__span-20-153"><a id="__codelineno-20-153" name="__codelineno-20-153" href="#lab05-mcp-prompts-lab-__codelineno-20-153"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-20-154"><a id="__codelineno-20-154" name="__codelineno-20-154" href="#lab05-mcp-prompts-lab-__codelineno-20-154"></a><span class="w">            </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`## Codebase Analysis: </span><span class="si">${</span><span class="nx">analysisType</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="si">}</span><span class="sb">\n\n</span><span class="si">${</span><span class="nx">analysis</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-20-155"><a id="__codelineno-20-155" name="__codelineno-20-155" href="#lab05-mcp-prompts-lab-__codelineno-20-155"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-20-156"><a id="__codelineno-20-156" name="__codelineno-20-156" href="#lab05-mcp-prompts-lab-__codelineno-20-156"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-20-157"><a id="__codelineno-20-157" name="__codelineno-20-157" href="#lab05-mcp-prompts-lab-__codelineno-20-157"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-20-158"><a id="__codelineno-20-158" name="__codelineno-20-158" href="#lab05-mcp-prompts-lab-__codelineno-20-158"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-159"><a id="__codelineno-20-159" name="__codelineno-20-159" href="#lab05-mcp-prompts-lab-__codelineno-20-159"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Codebase analysis failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-20-160"><a id="__codelineno-20-160" name="__codelineno-20-160" href="#lab05-mcp-prompts-lab-__codelineno-20-160"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-161"><a id="__codelineno-20-161" name="__codelineno-20-161" href="#lab05-mcp-prompts-lab-__codelineno-20-161"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-162"><a id="__codelineno-20-162" name="__codelineno-20-162" href="#lab05-mcp-prompts-lab-__codelineno-20-162"></a>
</span><span id="__span-20-163"><a id="__codelineno-20-163" name="__codelineno-20-163" href="#lab05-mcp-prompts-lab-__codelineno-20-163"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">performCodeAnalysis</span><span class="p">(</span><span class="nx">targetPath</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">analysisType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-164"><a id="__codelineno-20-164" name="__codelineno-20-164" href="#lab05-mcp-prompts-lab-__codelineno-20-164"></a><span class="w">    </span><span class="c1">// Simplified analysis - in real implementation, use proper code analysis tools</span>
</span><span id="__span-20-165"><a id="__codelineno-20-165" name="__codelineno-20-165" href="#lab05-mcp-prompts-lab-__codelineno-20-165"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`### Analysis Results</span>
</span><span id="__span-20-166"><a id="__codelineno-20-166" name="__codelineno-20-166" href="#lab05-mcp-prompts-lab-__codelineno-20-166"></a><span class="sb">- **Path**: </span><span class="si">${</span><span class="nx">targetPath</span><span class="si">}</span>
</span><span id="__span-20-167"><a id="__codelineno-20-167" name="__codelineno-20-167" href="#lab05-mcp-prompts-lab-__codelineno-20-167"></a><span class="sb">- **Type**: </span><span class="si">${</span><span class="nx">analysisType</span><span class="si">}</span>
</span><span id="__span-20-168"><a id="__codelineno-20-168" name="__codelineno-20-168" href="#lab05-mcp-prompts-lab-__codelineno-20-168"></a><span class="sb">- **Status**: Analysis completed successfully</span>
</span><span id="__span-20-169"><a id="__codelineno-20-169" name="__codelineno-20-169" href="#lab05-mcp-prompts-lab-__codelineno-20-169"></a>
</span><span id="__span-20-170"><a id="__codelineno-20-170" name="__codelineno-20-170" href="#lab05-mcp-prompts-lab-__codelineno-20-170"></a><span class="sb">### Recommendations</span>
</span><span id="__span-20-171"><a id="__codelineno-20-171" name="__codelineno-20-171" href="#lab05-mcp-prompts-lab-__codelineno-20-171"></a><span class="sb">- Consider organizing files by feature</span>
</span><span id="__span-20-172"><a id="__codelineno-20-172" name="__codelineno-20-172" href="#lab05-mcp-prompts-lab-__codelineno-20-172"></a><span class="sb">- Add proper documentation</span>
</span><span id="__span-20-173"><a id="__codelineno-20-173" name="__codelineno-20-173" href="#lab05-mcp-prompts-lab-__codelineno-20-173"></a><span class="sb">- Implement consistent coding standards`</span><span class="p">;</span>
</span><span id="__span-20-174"><a id="__codelineno-20-174" name="__codelineno-20-174" href="#lab05-mcp-prompts-lab-__codelineno-20-174"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-175"><a id="__codelineno-20-175" name="__codelineno-20-175" href="#lab05-mcp-prompts-lab-__codelineno-20-175"></a>
</span><span id="__span-20-176"><a id="__codelineno-20-176" name="__codelineno-20-176" href="#lab05-mcp-prompts-lab-__codelineno-20-176"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">readResource</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-177"><a id="__codelineno-20-177" name="__codelineno-20-177" href="#lab05-mcp-prompts-lab-__codelineno-20-177"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;kb://&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-178"><a id="__codelineno-20-178" name="__codelineno-20-178" href="#lab05-mcp-prompts-lab-__codelineno-20-178"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readKnowledgeBase</span><span class="p">(</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-20-179"><a id="__codelineno-20-179" name="__codelineno-20-179" href="#lab05-mcp-prompts-lab-__codelineno-20-179"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-180"><a id="__codelineno-20-180" name="__codelineno-20-180" href="#lab05-mcp-prompts-lab-__codelineno-20-180"></a>
</span><span id="__span-20-181"><a id="__codelineno-20-181" name="__codelineno-20-181" href="#lab05-mcp-prompts-lab-__codelineno-20-181"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown resource URI: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-20-182"><a id="__codelineno-20-182" name="__codelineno-20-182" href="#lab05-mcp-prompts-lab-__codelineno-20-182"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-183"><a id="__codelineno-20-183" name="__codelineno-20-183" href="#lab05-mcp-prompts-lab-__codelineno-20-183"></a>
</span><span id="__span-20-184"><a id="__codelineno-20-184" name="__codelineno-20-184" href="#lab05-mcp-prompts-lab-__codelineno-20-184"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">readKnowledgeBase</span><span class="p">(</span><span class="nx">uri</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-185"><a id="__codelineno-20-185" name="__codelineno-20-185" href="#lab05-mcp-prompts-lab-__codelineno-20-185"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uri</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^kb:\/\/articles\/(.+)$/</span><span class="p">);</span>
</span><span id="__span-20-186"><a id="__codelineno-20-186" name="__codelineno-20-186" href="#lab05-mcp-prompts-lab-__codelineno-20-186"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid knowledge base URI: </span><span class="si">${</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-20-187"><a id="__codelineno-20-187" name="__codelineno-20-187" href="#lab05-mcp-prompts-lab-__codelineno-20-187"></a>
</span><span id="__span-20-188"><a id="__codelineno-20-188" name="__codelineno-20-188" href="#lab05-mcp-prompts-lab-__codelineno-20-188"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
</span><span id="__span-20-189"><a id="__codelineno-20-189" name="__codelineno-20-189" href="#lab05-mcp-prompts-lab-__codelineno-20-189"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">article</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span><span id="__span-20-190"><a id="__codelineno-20-190" name="__codelineno-20-190" href="#lab05-mcp-prompts-lab-__codelineno-20-190"></a>
</span><span id="__span-20-191"><a id="__codelineno-20-191" name="__codelineno-20-191" href="#lab05-mcp-prompts-lab-__codelineno-20-191"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">article</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Article not found: </span><span class="si">${</span><span class="nx">key</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-20-192"><a id="__codelineno-20-192" name="__codelineno-20-192" href="#lab05-mcp-prompts-lab-__codelineno-20-192"></a>
</span><span id="__span-20-193"><a id="__codelineno-20-193" name="__codelineno-20-193" href="#lab05-mcp-prompts-lab-__codelineno-20-193"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-194"><a id="__codelineno-20-194" name="__codelineno-20-194" href="#lab05-mcp-prompts-lab-__codelineno-20-194"></a><span class="w">      </span><span class="nx">uri</span><span class="p">,</span>
</span><span id="__span-20-195"><a id="__codelineno-20-195" name="__codelineno-20-195" href="#lab05-mcp-prompts-lab-__codelineno-20-195"></a><span class="w">      </span><span class="nx">mimeType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text/markdown&quot;</span><span class="p">,</span>
</span><span id="__span-20-196"><a id="__codelineno-20-196" name="__codelineno-20-196" href="#lab05-mcp-prompts-lab-__codelineno-20-196"></a><span class="w">      </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">article.content</span><span class="p">,</span>
</span><span id="__span-20-197"><a id="__codelineno-20-197" name="__codelineno-20-197" href="#lab05-mcp-prompts-lab-__codelineno-20-197"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-20-198"><a id="__codelineno-20-198" name="__codelineno-20-198" href="#lab05-mcp-prompts-lab-__codelineno-20-198"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-199"><a id="__codelineno-20-199" name="__codelineno-20-199" href="#lab05-mcp-prompts-lab-__codelineno-20-199"></a>
</span><span id="__span-20-200"><a id="__codelineno-20-200" name="__codelineno-20-200" href="#lab05-mcp-prompts-lab-__codelineno-20-200"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">generateIntegratedPrompt</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-201"><a id="__codelineno-20-201" name="__codelineno-20-201" href="#lab05-mcp-prompts-lab-__codelineno-20-201"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-202"><a id="__codelineno-20-202" name="__codelineno-20-202" href="#lab05-mcp-prompts-lab-__codelineno-20-202"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;full-development-workflow&quot;</span><span class="o">:</span>
</span><span id="__span-20-203"><a id="__codelineno-20-203" name="__codelineno-20-203" href="#lab05-mcp-prompts-lab-__codelineno-20-203"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createFullWorkflowPrompt</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-20-204"><a id="__codelineno-20-204" name="__codelineno-20-204" href="#lab05-mcp-prompts-lab-__codelineno-20-204"></a>
</span><span id="__span-20-205"><a id="__codelineno-20-205" name="__codelineno-20-205" href="#lab05-mcp-prompts-lab-__codelineno-20-205"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;code-quality-assessment&quot;</span><span class="o">:</span>
</span><span id="__span-20-206"><a id="__codelineno-20-206" name="__codelineno-20-206" href="#lab05-mcp-prompts-lab-__codelineno-20-206"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createQualityAssessmentPrompt</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-20-207"><a id="__codelineno-20-207" name="__codelineno-20-207" href="#lab05-mcp-prompts-lab-__codelineno-20-207"></a>
</span><span id="__span-20-208"><a id="__codelineno-20-208" name="__codelineno-20-208" href="#lab05-mcp-prompts-lab-__codelineno-20-208"></a><span class="w">      </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-20-209"><a id="__codelineno-20-209" name="__codelineno-20-209" href="#lab05-mcp-prompts-lab-__codelineno-20-209"></a><span class="w">        </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unknown prompt: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-20-210"><a id="__codelineno-20-210" name="__codelineno-20-210" href="#lab05-mcp-prompts-lab-__codelineno-20-210"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-211"><a id="__codelineno-20-211" name="__codelineno-20-211" href="#lab05-mcp-prompts-lab-__codelineno-20-211"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-212"><a id="__codelineno-20-212" name="__codelineno-20-212" href="#lab05-mcp-prompts-lab-__codelineno-20-212"></a>
</span><span id="__span-20-213"><a id="__codelineno-20-213" name="__codelineno-20-213" href="#lab05-mcp-prompts-lab-__codelineno-20-213"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">createFullWorkflowPrompt</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-214"><a id="__codelineno-20-214" name="__codelineno-20-214" href="#lab05-mcp-prompts-lab-__codelineno-20-214"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">projectType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">projectType</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;web&quot;</span><span class="p">;</span>
</span><span id="__span-20-215"><a id="__codelineno-20-215" name="__codelineno-20-215" href="#lab05-mcp-prompts-lab-__codelineno-20-215"></a>
</span><span id="__span-20-216"><a id="__codelineno-20-216" name="__codelineno-20-216" href="#lab05-mcp-prompts-lab-__codelineno-20-216"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">workflowDoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;development-workflow&quot;</span><span class="p">);</span>
</span><span id="__span-20-217"><a id="__codelineno-20-217" name="__codelineno-20-217" href="#lab05-mcp-prompts-lab-__codelineno-20-217"></a>
</span><span id="__span-20-218"><a id="__codelineno-20-218" name="__codelineno-20-218" href="#lab05-mcp-prompts-lab-__codelineno-20-218"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-219"><a id="__codelineno-20-219" name="__codelineno-20-219" href="#lab05-mcp-prompts-lab-__codelineno-20-219"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Complete </span><span class="si">${</span><span class="nx">projectType</span><span class="si">}</span><span class="sb"> development workflow`</span><span class="p">,</span>
</span><span id="__span-20-220"><a id="__codelineno-20-220" name="__codelineno-20-220" href="#lab05-mcp-prompts-lab-__codelineno-20-220"></a><span class="w">      </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-221"><a id="__codelineno-20-221" name="__codelineno-20-221" href="#lab05-mcp-prompts-lab-__codelineno-20-221"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-20-222"><a id="__codelineno-20-222" name="__codelineno-20-222" href="#lab05-mcp-prompts-lab-__codelineno-20-222"></a><span class="w">          </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-20-223"><a id="__codelineno-20-223" name="__codelineno-20-223" href="#lab05-mcp-prompts-lab-__codelineno-20-223"></a><span class="w">          </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-224"><a id="__codelineno-20-224" name="__codelineno-20-224" href="#lab05-mcp-prompts-lab-__codelineno-20-224"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-20-225"><a id="__codelineno-20-225" name="__codelineno-20-225" href="#lab05-mcp-prompts-lab-__codelineno-20-225"></a><span class="w">            </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Guide me through a complete </span><span class="si">${</span><span class="nx">projectType</span><span class="si">}</span><span class="sb"> development project.</span>
</span><span id="__span-20-226"><a id="__codelineno-20-226" name="__codelineno-20-226" href="#lab05-mcp-prompts-lab-__codelineno-20-226"></a>
</span><span id="__span-20-227"><a id="__codelineno-20-227" name="__codelineno-20-227" href="#lab05-mcp-prompts-lab-__codelineno-20-227"></a><span class="sb">## Development Workflow Reference</span>
</span><span id="__span-20-228"><a id="__codelineno-20-228" name="__codelineno-20-228" href="#lab05-mcp-prompts-lab-__codelineno-20-228"></a><span class="si">${</span><span class="nx">workflowDoc</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">workflowDoc</span><span class="p">.</span><span class="nx">content</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Standard development practices apply&quot;</span><span class="si">}</span>
</span><span id="__span-20-229"><a id="__codelineno-20-229" name="__codelineno-20-229" href="#lab05-mcp-prompts-lab-__codelineno-20-229"></a>
</span><span id="__span-20-230"><a id="__codelineno-20-230" name="__codelineno-20-230" href="#lab05-mcp-prompts-lab-__codelineno-20-230"></a><span class="sb">## Project Context</span>
</span><span id="__span-20-231"><a id="__codelineno-20-231" name="__codelineno-20-231" href="#lab05-mcp-prompts-lab-__codelineno-20-231"></a><span class="sb">- **Type**: </span><span class="si">${</span><span class="nx">projectType</span><span class="si">}</span>
</span><span id="__span-20-232"><a id="__codelineno-20-232" name="__codelineno-20-232" href="#lab05-mcp-prompts-lab-__codelineno-20-232"></a><span class="sb">- **Current Phase**: Planning</span>
</span><span id="__span-20-233"><a id="__codelineno-20-233" name="__codelineno-20-233" href="#lab05-mcp-prompts-lab-__codelineno-20-233"></a>
</span><span id="__span-20-234"><a id="__codelineno-20-234" name="__codelineno-20-234" href="#lab05-mcp-prompts-lab-__codelineno-20-234"></a><span class="sb">Please provide a comprehensive development plan with specific phases, deliverables, and best practices.`</span><span class="p">,</span>
</span><span id="__span-20-235"><a id="__codelineno-20-235" name="__codelineno-20-235" href="#lab05-mcp-prompts-lab-__codelineno-20-235"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-20-236"><a id="__codelineno-20-236" name="__codelineno-20-236" href="#lab05-mcp-prompts-lab-__codelineno-20-236"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-20-237"><a id="__codelineno-20-237" name="__codelineno-20-237" href="#lab05-mcp-prompts-lab-__codelineno-20-237"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-20-238"><a id="__codelineno-20-238" name="__codelineno-20-238" href="#lab05-mcp-prompts-lab-__codelineno-20-238"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-20-239"><a id="__codelineno-20-239" name="__codelineno-20-239" href="#lab05-mcp-prompts-lab-__codelineno-20-239"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-240"><a id="__codelineno-20-240" name="__codelineno-20-240" href="#lab05-mcp-prompts-lab-__codelineno-20-240"></a>
</span><span id="__span-20-241"><a id="__codelineno-20-241" name="__codelineno-20-241" href="#lab05-mcp-prompts-lab-__codelineno-20-241"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">createQualityAssessmentPrompt</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-242"><a id="__codelineno-20-242" name="__codelineno-20-242" href="#lab05-mcp-prompts-lab-__codelineno-20-242"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">codeSample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">codeSample</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;[Insert code here]&quot;</span><span class="p">;</span>
</span><span id="__span-20-243"><a id="__codelineno-20-243" name="__codelineno-20-243" href="#lab05-mcp-prompts-lab-__codelineno-20-243"></a>
</span><span id="__span-20-244"><a id="__codelineno-20-244" name="__codelineno-20-244" href="#lab05-mcp-prompts-lab-__codelineno-20-244"></a><span class="w">    </span><span class="c1">// Use tools to analyze the code</span>
</span><span id="__span-20-245"><a id="__codelineno-20-245" name="__codelineno-20-245" href="#lab05-mcp-prompts-lab-__codelineno-20-245"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">analysisResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzeCodebase</span><span class="p">({</span><span class="w"> </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;./&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">analysisType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;structure&quot;</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-20-246"><a id="__codelineno-20-246" name="__codelineno-20-246" href="#lab05-mcp-prompts-lab-__codelineno-20-246"></a>
</span><span id="__span-20-247"><a id="__codelineno-20-247" name="__codelineno-20-247" href="#lab05-mcp-prompts-lab-__codelineno-20-247"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-248"><a id="__codelineno-20-248" name="__codelineno-20-248" href="#lab05-mcp-prompts-lab-__codelineno-20-248"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Comprehensive code quality assessment&quot;</span><span class="p">,</span>
</span><span id="__span-20-249"><a id="__codelineno-20-249" name="__codelineno-20-249" href="#lab05-mcp-prompts-lab-__codelineno-20-249"></a><span class="w">      </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-20-250"><a id="__codelineno-20-250" name="__codelineno-20-250" href="#lab05-mcp-prompts-lab-__codelineno-20-250"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-20-251"><a id="__codelineno-20-251" name="__codelineno-20-251" href="#lab05-mcp-prompts-lab-__codelineno-20-251"></a><span class="w">          </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-20-252"><a id="__codelineno-20-252" name="__codelineno-20-252" href="#lab05-mcp-prompts-lab-__codelineno-20-252"></a><span class="w">          </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-253"><a id="__codelineno-20-253" name="__codelineno-20-253" href="#lab05-mcp-prompts-lab-__codelineno-20-253"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-20-254"><a id="__codelineno-20-254" name="__codelineno-20-254" href="#lab05-mcp-prompts-lab-__codelineno-20-254"></a><span class="w">            </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Perform a comprehensive code quality assessment of the following code.</span>
</span><span id="__span-20-255"><a id="__codelineno-20-255" name="__codelineno-20-255" href="#lab05-mcp-prompts-lab-__codelineno-20-255"></a>
</span><span id="__span-20-256"><a id="__codelineno-20-256" name="__codelineno-20-256" href="#lab05-mcp-prompts-lab-__codelineno-20-256"></a><span class="sb">## Code to Assess</span>
</span><span id="__span-20-257"><a id="__codelineno-20-257" name="__codelineno-20-257" href="#lab05-mcp-prompts-lab-__codelineno-20-257"></a><span class="sb">\`\`\`</span>
</span><span id="__span-20-258"><a id="__codelineno-20-258" name="__codelineno-20-258" href="#lab05-mcp-prompts-lab-__codelineno-20-258"></a><span class="si">${</span><span class="nx">codeSample</span><span class="si">}</span>
</span><span id="__span-20-259"><a id="__codelineno-20-259" name="__codelineno-20-259" href="#lab05-mcp-prompts-lab-__codelineno-20-259"></a><span class="sb">\`\`\`</span>
</span><span id="__span-20-260"><a id="__codelineno-20-260" name="__codelineno-20-260" href="#lab05-mcp-prompts-lab-__codelineno-20-260"></a>
</span><span id="__span-20-261"><a id="__codelineno-20-261" name="__codelineno-20-261" href="#lab05-mcp-prompts-lab-__codelineno-20-261"></a><span class="sb">## Automated Analysis Results</span>
</span><span id="__span-20-262"><a id="__codelineno-20-262" name="__codelineno-20-262" href="#lab05-mcp-prompts-lab-__codelineno-20-262"></a><span class="si">${</span><span class="nx">analysisResult</span><span class="p">.</span><span class="nx">content</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">text</span><span class="si">}</span>
</span><span id="__span-20-263"><a id="__codelineno-20-263" name="__codelineno-20-263" href="#lab05-mcp-prompts-lab-__codelineno-20-263"></a>
</span><span id="__span-20-264"><a id="__codelineno-20-264" name="__codelineno-20-264" href="#lab05-mcp-prompts-lab-__codelineno-20-264"></a><span class="sb">## Assessment Framework</span>
</span><span id="__span-20-265"><a id="__codelineno-20-265" name="__codelineno-20-265" href="#lab05-mcp-prompts-lab-__codelineno-20-265"></a>
</span><span id="__span-20-266"><a id="__codelineno-20-266" name="__codelineno-20-266" href="#lab05-mcp-prompts-lab-__codelineno-20-266"></a><span class="sb">### 1. Code Quality Metrics</span>
</span><span id="__span-20-267"><a id="__codelineno-20-267" name="__codelineno-20-267" href="#lab05-mcp-prompts-lab-__codelineno-20-267"></a><span class="sb">- **Readability**: Is the code easy to understand?</span>
</span><span id="__span-20-268"><a id="__codelineno-20-268" name="__codelineno-20-268" href="#lab05-mcp-prompts-lab-__codelineno-20-268"></a><span class="sb">- **Maintainability**: How easy will this be to modify?</span>
</span><span id="__span-20-269"><a id="__codelineno-20-269" name="__codelineno-20-269" href="#lab05-mcp-prompts-lab-__codelineno-20-269"></a><span class="sb">- **Performance**: Are there any obvious issues?</span>
</span><span id="__span-20-270"><a id="__codelineno-20-270" name="__codelineno-20-270" href="#lab05-mcp-prompts-lab-__codelineno-20-270"></a>
</span><span id="__span-20-271"><a id="__codelineno-20-271" name="__codelineno-20-271" href="#lab05-mcp-prompts-lab-__codelineno-20-271"></a><span class="sb">### 2. Best Practices</span>
</span><span id="__span-20-272"><a id="__codelineno-20-272" name="__codelineno-20-272" href="#lab05-mcp-prompts-lab-__codelineno-20-272"></a><span class="sb">- Does it follow coding standards?</span>
</span><span id="__span-20-273"><a id="__codelineno-20-273" name="__codelineno-20-273" href="#lab05-mcp-prompts-lab-__codelineno-20-273"></a><span class="sb">- Are there appropriate error handling?</span>
</span><span id="__span-20-274"><a id="__codelineno-20-274" name="__codelineno-20-274" href="#lab05-mcp-prompts-lab-__codelineno-20-274"></a><span class="sb">- Is the code well-structured?</span>
</span><span id="__span-20-275"><a id="__codelineno-20-275" name="__codelineno-20-275" href="#lab05-mcp-prompts-lab-__codelineno-20-275"></a>
</span><span id="__span-20-276"><a id="__codelineno-20-276" name="__codelineno-20-276" href="#lab05-mcp-prompts-lab-__codelineno-20-276"></a><span class="sb">### 3. Recommendations</span>
</span><span id="__span-20-277"><a id="__codelineno-20-277" name="__codelineno-20-277" href="#lab05-mcp-prompts-lab-__codelineno-20-277"></a><span class="sb">Provide specific, prioritized recommendations for improvement.</span>
</span><span id="__span-20-278"><a id="__codelineno-20-278" name="__codelineno-20-278" href="#lab05-mcp-prompts-lab-__codelineno-20-278"></a>
</span><span id="__span-20-279"><a id="__codelineno-20-279" name="__codelineno-20-279" href="#lab05-mcp-prompts-lab-__codelineno-20-279"></a><span class="sb">Please provide a thorough assessment.`</span><span class="p">,</span>
</span><span id="__span-20-280"><a id="__codelineno-20-280" name="__codelineno-20-280" href="#lab05-mcp-prompts-lab-__codelineno-20-280"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-20-281"><a id="__codelineno-20-281" name="__codelineno-20-281" href="#lab05-mcp-prompts-lab-__codelineno-20-281"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-20-282"><a id="__codelineno-20-282" name="__codelineno-20-282" href="#lab05-mcp-prompts-lab-__codelineno-20-282"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-20-283"><a id="__codelineno-20-283" name="__codelineno-20-283" href="#lab05-mcp-prompts-lab-__codelineno-20-283"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-20-284"><a id="__codelineno-20-284" name="__codelineno-20-284" href="#lab05-mcp-prompts-lab-__codelineno-20-284"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-285"><a id="__codelineno-20-285" name="__codelineno-20-285" href="#lab05-mcp-prompts-lab-__codelineno-20-285"></a>
</span><span id="__span-20-286"><a id="__codelineno-20-286" name="__codelineno-20-286" href="#lab05-mcp-prompts-lab-__codelineno-20-286"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-287"><a id="__codelineno-20-287" name="__codelineno-20-287" href="#lab05-mcp-prompts-lab-__codelineno-20-287"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-288"><a id="__codelineno-20-288" name="__codelineno-20-288" href="#lab05-mcp-prompts-lab-__codelineno-20-288"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;[MCP Error]&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-20-289"><a id="__codelineno-20-289" name="__codelineno-20-289" href="#lab05-mcp-prompts-lab-__codelineno-20-289"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-20-290"><a id="__codelineno-20-290" name="__codelineno-20-290" href="#lab05-mcp-prompts-lab-__codelineno-20-290"></a>
</span><span id="__span-20-291"><a id="__codelineno-20-291" name="__codelineno-20-291" href="#lab05-mcp-prompts-lab-__codelineno-20-291"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGINT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-292"><a id="__codelineno-20-292" name="__codelineno-20-292" href="#lab05-mcp-prompts-lab-__codelineno-20-292"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-20-293"><a id="__codelineno-20-293" name="__codelineno-20-293" href="#lab05-mcp-prompts-lab-__codelineno-20-293"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-20-294"><a id="__codelineno-20-294" name="__codelineno-20-294" href="#lab05-mcp-prompts-lab-__codelineno-20-294"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-20-295"><a id="__codelineno-20-295" name="__codelineno-20-295" href="#lab05-mcp-prompts-lab-__codelineno-20-295"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-296"><a id="__codelineno-20-296" name="__codelineno-20-296" href="#lab05-mcp-prompts-lab-__codelineno-20-296"></a>
</span><span id="__span-20-297"><a id="__codelineno-20-297" name="__codelineno-20-297" href="#lab05-mcp-prompts-lab-__codelineno-20-297"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-298"><a id="__codelineno-20-298" name="__codelineno-20-298" href="#lab05-mcp-prompts-lab-__codelineno-20-298"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-20-299"><a id="__codelineno-20-299" name="__codelineno-20-299" href="#lab05-mcp-prompts-lab-__codelineno-20-299"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-20-300"><a id="__codelineno-20-300" name="__codelineno-20-300" href="#lab05-mcp-prompts-lab-__codelineno-20-300"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Complete MCP Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-20-301"><a id="__codelineno-20-301" name="__codelineno-20-301" href="#lab05-mcp-prompts-lab-__codelineno-20-301"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-302"><a id="__codelineno-20-302" name="__codelineno-20-302" href="#lab05-mcp-prompts-lab-__codelineno-20-302"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lab05-mcp-prompts-lab-step-2-test-complete-integration">Step 2: Test Complete Integration<a class="headerlink" href="#lab05-mcp-prompts-lab-step-2-test-complete-integration" title="Permanent link">&para;</a></h3>
<p><strong>Build and run the complete MCP server:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#lab05-mcp-prompts-lab-__codelineno-21-1"></a><span class="nb">cd</span><span class="w"> </span>my-complete-mcp-server
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#lab05-mcp-prompts-lab-__codelineno-21-2"></a>npm<span class="w"> </span>run<span class="w"> </span>build
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#lab05-mcp-prompts-lab-__codelineno-21-3"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node<span class="w"> </span>dist/index.js
</span></code></pre></div>
<p><strong>Test the complete integration inside the MCP Inspector UI:</strong></p>
<ol>
<li>
<p><strong>Navigate to Tools tab:</strong></p>
<ul>
<li>Click on the &ldquo;Tools&rdquo; tab</li>
</ul>
</li>
<li>
<p><strong>List tools:</strong></p>
<ul>
<li>Click &ldquo;List Tools&rdquo; button</li>
<li>Verify you see the &ldquo;analyze_codebase&rdquo; tool with its description and input schema</li>
</ul>
</li>
<li>
<p><strong>Call tool:</strong></p>
<ul>
<li>Select &ldquo;Call Tool&rdquo; from the dropdown</li>
<li>Enter <code>analyze_codebase</code> in the &ldquo;Name&rdquo; field</li>
<li>In the &ldquo;Arguments&rdquo; field, enter: <code>{"path": "./", "analysisType": "structure"}</code></li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Check that the response includes a codebase analysis with recommendations</li>
</ul>
</li>
<li>
<p><strong>Navigate to Resources tab:</strong></p>
<ul>
<li>Click on the &ldquo;Resources&rdquo; tab</li>
</ul>
</li>
<li>
<p><strong>List resources:</strong></p>
<ul>
<li>Click &ldquo;List Resources&rdquo; button</li>
<li>Verify you see the knowledge base article (&ldquo;Complete Development Workflow&rdquo;)</li>
</ul>
</li>
<li>
<p><strong>Read resource:</strong></p>
<ul>
<li>Select &ldquo;Read Resource&rdquo; from the dropdown</li>
<li>Enter <code>kb://articles/development-workflow</code> in the &ldquo;URI&rdquo; field</li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Check that the response includes the full development workflow content</li>
</ul>
</li>
<li>
<p><strong>Navigate to Prompts tab:</strong></p>
<ul>
<li>Click on the &ldquo;Prompts&rdquo; tab</li>
</ul>
</li>
<li>
<p><strong>List prompts:</strong></p>
<ul>
<li>Click &ldquo;List Prompts&rdquo; button</li>
<li>Verify you see the &ldquo;full-development-workflow&rdquo; and &ldquo;code-quality-assessment&rdquo; prompts with their arguments</li>
</ul>
</li>
<li>
<p><strong>Get full development workflow prompt:</strong></p>
<ul>
<li>Select &ldquo;Get Prompt&rdquo;</li>
<li>Enter <code>full-development-workflow</code> in the &ldquo;Name&rdquo; field</li>
<li>In the &ldquo;Arguments&rdquo; field, enter: <code>{"projectType": "web"}</code></li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Check that the prompt content includes the development workflow from the knowledge base</li>
</ul>
</li>
<li>
<p><strong>Get code quality assessment prompt:</strong></p>
<ul>
<li>Select &ldquo;Get Prompt&rdquo; again</li>
<li>Enter <code>code-quality-assessment</code> in the &ldquo;Name&rdquo; field</li>
<li>In the &ldquo;Arguments&rdquo; field, enter: <code>{"codeSample": "function test() { return true; }"}</code></li>
<li>Click &ldquo;Send Request&rdquo;</li>
<li>Verify the prompt includes automated analysis results and assessment framework</li>
</ul>
</li>
</ol>
<p><br></p>
<p><strong>Expected Results:</strong></p>
<ul>
<li>Tools should list the analysis tool with proper schema and description</li>
<li>Calling tools should return structured analysis results</li>
<li>Resources should list knowledge base articles with proper URIs</li>
<li>Reading resources should return the full markdown content</li>
<li>Prompts should list integrated prompts with their arguments</li>
<li>Getting prompts should dynamically include tool results and resource content</li>
<li>The complete integration should demonstrate all three capabilities working together seamlessly</li>
</ul>
<hr />
<h2 id="lab05-mcp-prompts-lab-hands-on-exercises">Hands-On Exercises<a class="headerlink" href="#lab05-mcp-prompts-lab-hands-on-exercises" title="Permanent link">&para;</a></h2>
<h3 id="lab05-mcp-prompts-lab-exercise-1-custom-prompt-library">Exercise 1: Custom Prompt Library<a class="headerlink" href="#lab05-mcp-prompts-lab-exercise-1-custom-prompt-library" title="Permanent link">&para;</a></h3>
<p><strong>Goal:</strong> Create a specialized prompt library for a specific domain.</p>
<p><strong>Steps:</strong></p>
<ol>
<li>Choose a domain (e.g., data science, DevOps, content writing)</li>
<li>Create 3-5 domain-specific prompts</li>
<li>Add appropriate arguments for customization</li>
<li>Include domain-specific resources</li>
<li>Test with the MCP Inspector</li>
</ol>
<p><strong>Requirements:</strong></p>
<ul>
<li>At least one prompt with required arguments</li>
<li>At least one prompt with optional arguments</li>
<li>Include resource integration</li>
<li>Proper error handling</li>
</ul>
<details>
<summary>Solution</summary>

Choose data science domain.<br><br>

Create 3 domain-specific prompts: data-exploration, model-training, visualization.<br><br>

Add arguments: dataset (required), focus (optional).<br><br>

Include domain-specific resources: data science best practices.<br><br>

Example code structure:<br><br>

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#lab05-mcp-prompts-lab-__codelineno-22-1"></a><span class="c1">// In ListPromptsRequestSchema handler</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#lab05-mcp-prompts-lab-__codelineno-22-2"></a><span class="p">{</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#lab05-mcp-prompts-lab-__codelineno-22-3"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;data-exploration&quot;</span><span class="p">,</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#lab05-mcp-prompts-lab-__codelineno-22-4"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Guide for exploratory data analysis&quot;</span><span class="p">,</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#lab05-mcp-prompts-lab-__codelineno-22-5"></a><span class="w">  </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#lab05-mcp-prompts-lab-__codelineno-22-6"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#lab05-mcp-prompts-lab-__codelineno-22-7"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#lab05-mcp-prompts-lab-__codelineno-22-8"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Dataset description&quot;</span><span class="p">,</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#lab05-mcp-prompts-lab-__codelineno-22-9"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#lab05-mcp-prompts-lab-__codelineno-22-10"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#lab05-mcp-prompts-lab-__codelineno-22-11"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#lab05-mcp-prompts-lab-__codelineno-22-12"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;focus&quot;</span><span class="p">,</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#lab05-mcp-prompts-lab-__codelineno-22-13"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analysis focus (distribution, correlation, outliers)&quot;</span><span class="p">,</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#lab05-mcp-prompts-lab-__codelineno-22-14"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#lab05-mcp-prompts-lab-__codelineno-22-15"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#lab05-mcp-prompts-lab-__codelineno-22-16"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#lab05-mcp-prompts-lab-__codelineno-22-17"></a><span class="p">},</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#lab05-mcp-prompts-lab-__codelineno-22-18"></a><span class="p">{</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#lab05-mcp-prompts-lab-__codelineno-22-19"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;model-training&quot;</span><span class="p">,</span>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20" href="#lab05-mcp-prompts-lab-__codelineno-22-20"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Guide for machine learning model training&quot;</span><span class="p">,</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21" href="#lab05-mcp-prompts-lab-__codelineno-22-21"></a><span class="w">  </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22" href="#lab05-mcp-prompts-lab-__codelineno-22-22"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23" href="#lab05-mcp-prompts-lab-__codelineno-22-23"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;algorithm&quot;</span><span class="p">,</span>
</span><span id="__span-22-24"><a id="__codelineno-22-24" name="__codelineno-22-24" href="#lab05-mcp-prompts-lab-__codelineno-22-24"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;ML algorithm (linear, tree, neural)&quot;</span><span class="p">,</span>
</span><span id="__span-22-25"><a id="__codelineno-22-25" name="__codelineno-22-25" href="#lab05-mcp-prompts-lab-__codelineno-22-25"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-22-26"><a id="__codelineno-22-26" name="__codelineno-22-26" href="#lab05-mcp-prompts-lab-__codelineno-22-26"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-22-27"><a id="__codelineno-22-27" name="__codelineno-22-27" href="#lab05-mcp-prompts-lab-__codelineno-22-27"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-28"><a id="__codelineno-22-28" name="__codelineno-22-28" href="#lab05-mcp-prompts-lab-__codelineno-22-28"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
</span><span id="__span-22-29"><a id="__codelineno-22-29" name="__codelineno-22-29" href="#lab05-mcp-prompts-lab-__codelineno-22-29"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Target variable&quot;</span><span class="p">,</span>
</span><span id="__span-22-30"><a id="__codelineno-22-30" name="__codelineno-22-30" href="#lab05-mcp-prompts-lab-__codelineno-22-30"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-22-31"><a id="__codelineno-22-31" name="__codelineno-22-31" href="#lab05-mcp-prompts-lab-__codelineno-22-31"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-22-32"><a id="__codelineno-22-32" name="__codelineno-22-32" href="#lab05-mcp-prompts-lab-__codelineno-22-32"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-22-33"><a id="__codelineno-22-33" name="__codelineno-22-33" href="#lab05-mcp-prompts-lab-__codelineno-22-33"></a><span class="p">},</span>
</span><span id="__span-22-34"><a id="__codelineno-22-34" name="__codelineno-22-34" href="#lab05-mcp-prompts-lab-__codelineno-22-34"></a><span class="p">{</span>
</span><span id="__span-22-35"><a id="__codelineno-22-35" name="__codelineno-22-35" href="#lab05-mcp-prompts-lab-__codelineno-22-35"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;data-visualization&quot;</span><span class="p">,</span>
</span><span id="__span-22-36"><a id="__codelineno-22-36" name="__codelineno-22-36" href="#lab05-mcp-prompts-lab-__codelineno-22-36"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Guide for creating effective data visualizations&quot;</span><span class="p">,</span>
</span><span id="__span-22-37"><a id="__codelineno-22-37" name="__codelineno-22-37" href="#lab05-mcp-prompts-lab-__codelineno-22-37"></a><span class="w">  </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-22-38"><a id="__codelineno-22-38" name="__codelineno-22-38" href="#lab05-mcp-prompts-lab-__codelineno-22-38"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-39"><a id="__codelineno-22-39" name="__codelineno-22-39" href="#lab05-mcp-prompts-lab-__codelineno-22-39"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;chartType&quot;</span><span class="p">,</span>
</span><span id="__span-22-40"><a id="__codelineno-22-40" name="__codelineno-22-40" href="#lab05-mcp-prompts-lab-__codelineno-22-40"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Type of chart (bar, line, scatter)&quot;</span><span class="p">,</span>
</span><span id="__span-22-41"><a id="__codelineno-22-41" name="__codelineno-22-41" href="#lab05-mcp-prompts-lab-__codelineno-22-41"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-22-42"><a id="__codelineno-22-42" name="__codelineno-22-42" href="#lab05-mcp-prompts-lab-__codelineno-22-42"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-22-43"><a id="__codelineno-22-43" name="__codelineno-22-43" href="#lab05-mcp-prompts-lab-__codelineno-22-43"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-22-44"><a id="__codelineno-22-44" name="__codelineno-22-44" href="#lab05-mcp-prompts-lab-__codelineno-22-44"></a><span class="p">}</span>
</span><span id="__span-22-45"><a id="__codelineno-22-45" name="__codelineno-22-45" href="#lab05-mcp-prompts-lab-__codelineno-22-45"></a>
</span><span id="__span-22-46"><a id="__codelineno-22-46" name="__codelineno-22-46" href="#lab05-mcp-prompts-lab-__codelineno-22-46"></a><span class="c1">// In generatePrompt method</span>
</span><span id="__span-22-47"><a id="__codelineno-22-47" name="__codelineno-22-47" href="#lab05-mcp-prompts-lab-__codelineno-22-47"></a><span class="k">case</span><span class="w"> </span><span class="s2">&quot;data-exploration&quot;</span><span class="o">:</span>
</span><span id="__span-22-48"><a id="__codelineno-22-48" name="__codelineno-22-48" href="#lab05-mcp-prompts-lab-__codelineno-22-48"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">dataset</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;dataset&quot;</span><span class="p">;</span>
</span><span id="__span-22-49"><a id="__codelineno-22-49" name="__codelineno-22-49" href="#lab05-mcp-prompts-lab-__codelineno-22-49"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">focus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">focus</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;distribution&quot;</span><span class="p">;</span>
</span><span id="__span-22-50"><a id="__codelineno-22-50" name="__codelineno-22-50" href="#lab05-mcp-prompts-lab-__codelineno-22-50"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-51"><a id="__codelineno-22-51" name="__codelineno-22-51" href="#lab05-mcp-prompts-lab-__codelineno-22-51"></a><span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Data exploration for </span><span class="si">${</span><span class="nx">dataset</span><span class="si">}</span><span class="sb"> focusing on </span><span class="si">${</span><span class="nx">focus</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-22-52"><a id="__codelineno-22-52" name="__codelineno-22-52" href="#lab05-mcp-prompts-lab-__codelineno-22-52"></a><span class="w">    </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-22-53"><a id="__codelineno-22-53" name="__codelineno-22-53" href="#lab05-mcp-prompts-lab-__codelineno-22-53"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-22-54"><a id="__codelineno-22-54" name="__codelineno-22-54" href="#lab05-mcp-prompts-lab-__codelineno-22-54"></a><span class="w">        </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-22-55"><a id="__codelineno-22-55" name="__codelineno-22-55" href="#lab05-mcp-prompts-lab-__codelineno-22-55"></a><span class="w">        </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-56"><a id="__codelineno-22-56" name="__codelineno-22-56" href="#lab05-mcp-prompts-lab-__codelineno-22-56"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-22-57"><a id="__codelineno-22-57" name="__codelineno-22-57" href="#lab05-mcp-prompts-lab-__codelineno-22-57"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Perform exploratory data analysis on the </span><span class="si">${</span><span class="nx">dataset</span><span class="si">}</span><span class="sb"> dataset.</span>
</span><span id="__span-22-58"><a id="__codelineno-22-58" name="__codelineno-22-58" href="#lab05-mcp-prompts-lab-__codelineno-22-58"></a>
</span><span id="__span-22-59"><a id="__codelineno-22-59" name="__codelineno-22-59" href="#lab05-mcp-prompts-lab-__codelineno-22-59"></a><span class="sb">Focus areas: </span><span class="si">${</span><span class="nx">focus</span><span class="si">}</span>
</span><span id="__span-22-60"><a id="__codelineno-22-60" name="__codelineno-22-60" href="#lab05-mcp-prompts-lab-__codelineno-22-60"></a>
</span><span id="__span-22-61"><a id="__codelineno-22-61" name="__codelineno-22-61" href="#lab05-mcp-prompts-lab-__codelineno-22-61"></a><span class="sb">Guidelines:</span>
</span><span id="__span-22-62"><a id="__codelineno-22-62" name="__codelineno-22-62" href="#lab05-mcp-prompts-lab-__codelineno-22-62"></a><span class="sb">- Examine data structure and types</span>
</span><span id="__span-22-63"><a id="__codelineno-22-63" name="__codelineno-22-63" href="#lab05-mcp-prompts-lab-__codelineno-22-63"></a><span class="sb">- Check for missing values and outliers</span>
</span><span id="__span-22-64"><a id="__codelineno-22-64" name="__codelineno-22-64" href="#lab05-mcp-prompts-lab-__codelineno-22-64"></a><span class="sb">- Analyze distributions and correlations</span>
</span><span id="__span-22-65"><a id="__codelineno-22-65" name="__codelineno-22-65" href="#lab05-mcp-prompts-lab-__codelineno-22-65"></a><span class="sb">- Generate summary statistics</span>
</span><span id="__span-22-66"><a id="__codelineno-22-66" name="__codelineno-22-66" href="#lab05-mcp-prompts-lab-__codelineno-22-66"></a>
</span><span id="__span-22-67"><a id="__codelineno-22-67" name="__codelineno-22-67" href="#lab05-mcp-prompts-lab-__codelineno-22-67"></a><span class="sb">Provide insights and recommendations.`</span><span class="p">,</span>
</span><span id="__span-22-68"><a id="__codelineno-22-68" name="__codelineno-22-68" href="#lab05-mcp-prompts-lab-__codelineno-22-68"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-22-69"><a id="__codelineno-22-69" name="__codelineno-22-69" href="#lab05-mcp-prompts-lab-__codelineno-22-69"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-22-70"><a id="__codelineno-22-70" name="__codelineno-22-70" href="#lab05-mcp-prompts-lab-__codelineno-22-70"></a><span class="w">    </span><span class="p">],</span>
</span><span id="__span-22-71"><a id="__codelineno-22-71" name="__codelineno-22-71" href="#lab05-mcp-prompts-lab-__codelineno-22-71"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-22-72"><a id="__codelineno-22-72" name="__codelineno-22-72" href="#lab05-mcp-prompts-lab-__codelineno-22-72"></a>
</span><span id="__span-22-73"><a id="__codelineno-22-73" name="__codelineno-22-73" href="#lab05-mcp-prompts-lab-__codelineno-22-73"></a><span class="c1">// Add resources in initializeKnowledgeBase</span>
</span><span id="__span-22-74"><a id="__codelineno-22-74" name="__codelineno-22-74" href="#lab05-mcp-prompts-lab-__codelineno-22-74"></a><span class="k">this</span><span class="p">.</span><span class="nx">knowledgeBase</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;data-science-practices&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-75"><a id="__codelineno-22-75" name="__codelineno-22-75" href="#lab05-mcp-prompts-lab-__codelineno-22-75"></a><span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Data Science Best Practices&quot;</span><span class="p">,</span>
</span><span id="__span-22-76"><a id="__codelineno-22-76" name="__codelineno-22-76" href="#lab05-mcp-prompts-lab-__codelineno-22-76"></a><span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-22-77"><a id="__codelineno-22-77" name="__codelineno-22-77" href="#lab05-mcp-prompts-lab-__codelineno-22-77"></a><span class="sb">Data Quality</span>
</span><span id="__span-22-78"><a id="__codelineno-22-78" name="__codelineno-22-78" href="#lab05-mcp-prompts-lab-__codelineno-22-78"></a><span class="sb">- Validate data integrity</span>
</span><span id="__span-22-79"><a id="__codelineno-22-79" name="__codelineno-22-79" href="#lab05-mcp-prompts-lab-__codelineno-22-79"></a><span class="sb">- Handle missing values appropriately</span>
</span><span id="__span-22-80"><a id="__codelineno-22-80" name="__codelineno-22-80" href="#lab05-mcp-prompts-lab-__codelineno-22-80"></a><span class="sb">- Check for data consistency</span>
</span><span id="__span-22-81"><a id="__codelineno-22-81" name="__codelineno-22-81" href="#lab05-mcp-prompts-lab-__codelineno-22-81"></a>
</span><span id="__span-22-82"><a id="__codelineno-22-82" name="__codelineno-22-82" href="#lab05-mcp-prompts-lab-__codelineno-22-82"></a><span class="sb">Analysis Process</span>
</span><span id="__span-22-83"><a id="__codelineno-22-83" name="__codelineno-22-83" href="#lab05-mcp-prompts-lab-__codelineno-22-83"></a><span class="sb">- Start with descriptive statistics</span>
</span><span id="__span-22-84"><a id="__codelineno-22-84" name="__codelineno-22-84" href="#lab05-mcp-prompts-lab-__codelineno-22-84"></a><span class="sb">- Use visualizations for insights</span>
</span><span id="__span-22-85"><a id="__codelineno-22-85" name="__codelineno-22-85" href="#lab05-mcp-prompts-lab-__codelineno-22-85"></a><span class="sb">- Test hypotheses systematically</span>
</span><span id="__span-22-86"><a id="__codelineno-22-86" name="__codelineno-22-86" href="#lab05-mcp-prompts-lab-__codelineno-22-86"></a><span class="sb">  `</span><span class="p">,</span>
</span><span id="__span-22-87"><a id="__codelineno-22-87" name="__codelineno-22-87" href="#lab05-mcp-prompts-lab-__codelineno-22-87"></a><span class="p">});</span>
</span></code></pre></div>

Test with MCP Inspector by listing prompts, getting prompts with different arguments, and verifying resource integration.
</details>

<h3 id="lab05-mcp-prompts-lab-exercise-2-multi-step-workflow-prompt">Exercise 2: Multi-Step Workflow Prompt<a class="headerlink" href="#lab05-mcp-prompts-lab-exercise-2-multi-step-workflow-prompt" title="Permanent link">&para;</a></h3>
<p><strong>Goal:</strong> Create a prompt that guides users through complex, multi-step processes.</p>
<p><strong>Steps:</strong></p>
<ol>
<li>Design a multi-step workflow (e.g., code review → testing → deployment)</li>
<li>Create prompts for each step</li>
<li>Add logic to chain prompts together</li>
<li>Include progress tracking</li>
<li>Test the complete workflow</li>
</ol>
<p><strong>Requirements:</strong></p>
<ul>
<li>Clear step progression</li>
<li>State management between steps</li>
<li>Error handling and recovery</li>
<li>Progress indicators</li>
</ul>
<details>
<summary>Solution</summary>

Design a code review to deployment workflow with steps: review, testing, deployment.<br><br>

Create prompts for each step with currentStep argument.<br><br>

Add logic to chain prompts and track progress.<br><br>

Example code structure:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#lab05-mcp-prompts-lab-__codelineno-23-1"></a><span class="c1">// In ListPromptsRequestSchema handler</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#lab05-mcp-prompts-lab-__codelineno-23-2"></a><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#lab05-mcp-prompts-lab-__codelineno-23-3"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;workflow-step&quot;</span><span class="p">,</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#lab05-mcp-prompts-lab-__codelineno-23-4"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Multi-step development workflow guidance&quot;</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#lab05-mcp-prompts-lab-__codelineno-23-5"></a><span class="w">  </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#lab05-mcp-prompts-lab-__codelineno-23-6"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#lab05-mcp-prompts-lab-__codelineno-23-7"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;currentStep&quot;</span><span class="p">,</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#lab05-mcp-prompts-lab-__codelineno-23-8"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Current workflow step (review, testing, deployment)&quot;</span><span class="p">,</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#lab05-mcp-prompts-lab-__codelineno-23-9"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#lab05-mcp-prompts-lab-__codelineno-23-10"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#lab05-mcp-prompts-lab-__codelineno-23-11"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#lab05-mcp-prompts-lab-__codelineno-23-12"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;projectType&quot;</span><span class="p">,</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#lab05-mcp-prompts-lab-__codelineno-23-13"></a><span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Type of project&quot;</span><span class="p">,</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#lab05-mcp-prompts-lab-__codelineno-23-14"></a><span class="w">      </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#lab05-mcp-prompts-lab-__codelineno-23-15"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#lab05-mcp-prompts-lab-__codelineno-23-16"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#lab05-mcp-prompts-lab-__codelineno-23-17"></a><span class="p">}</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#lab05-mcp-prompts-lab-__codelineno-23-18"></a>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#lab05-mcp-prompts-lab-__codelineno-23-19"></a><span class="c1">// In generatePrompt method</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#lab05-mcp-prompts-lab-__codelineno-23-20"></a><span class="k">case</span><span class="w"> </span><span class="s2">&quot;workflow-step&quot;</span><span class="o">:</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#lab05-mcp-prompts-lab-__codelineno-23-21"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">currentStep</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;review&quot;</span><span class="p">;</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#lab05-mcp-prompts-lab-__codelineno-23-22"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">projectType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">projectType</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;web&quot;</span><span class="p">;</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#lab05-mcp-prompts-lab-__codelineno-23-23"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">workflowSteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;review&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;testing&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;deployment&quot;</span><span class="p">];</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#lab05-mcp-prompts-lab-__codelineno-23-24"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">workflowSteps</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">step</span><span class="p">);</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#lab05-mcp-prompts-lab-__codelineno-23-25"></a>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#lab05-mcp-prompts-lab-__codelineno-23-26"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#lab05-mcp-prompts-lab-__codelineno-23-27"></a><span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">projectType</span><span class="si">}</span><span class="sb"> development workflow - Step </span><span class="si">${</span><span class="nx">currentIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">step</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#lab05-mcp-prompts-lab-__codelineno-23-28"></a><span class="w">    </span><span class="nx">messages</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#lab05-mcp-prompts-lab-__codelineno-23-29"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#lab05-mcp-prompts-lab-__codelineno-23-30"></a><span class="w">        </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#lab05-mcp-prompts-lab-__codelineno-23-31"></a><span class="w">        </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#lab05-mcp-prompts-lab-__codelineno-23-32"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#lab05-mcp-prompts-lab-__codelineno-23-33"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Guide for </span><span class="si">${</span><span class="nx">projectType</span><span class="si">}</span><span class="sb"> project </span><span class="si">${</span><span class="nx">step</span><span class="si">}</span><span class="sb"> phase.</span>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34" href="#lab05-mcp-prompts-lab-__codelineno-23-34"></a>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35" href="#lab05-mcp-prompts-lab-__codelineno-23-35"></a><span class="sb">Progress: Step </span><span class="si">${</span><span class="nx">currentIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="si">}</span><span class="sb"> of </span><span class="si">${</span><span class="nx">workflowSteps</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36" href="#lab05-mcp-prompts-lab-__codelineno-23-36"></a><span class="sb">Previous steps: </span><span class="si">${</span><span class="nx">workflowSteps</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">currentIndex</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span>
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37" href="#lab05-mcp-prompts-lab-__codelineno-23-37"></a><span class="sb">Next steps: </span><span class="si">${</span><span class="nx">workflowSteps</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">currentIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;Complete&#39;</span><span class="si">}</span>
</span><span id="__span-23-38"><a id="__codelineno-23-38" name="__codelineno-23-38" href="#lab05-mcp-prompts-lab-__codelineno-23-38"></a>
</span><span id="__span-23-39"><a id="__codelineno-23-39" name="__codelineno-23-39" href="#lab05-mcp-prompts-lab-__codelineno-23-39"></a><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">getStepGuidance</span><span class="p">(</span><span class="nx">step</span><span class="p">,</span><span class="w"> </span><span class="nx">projectType</span><span class="p">)</span><span class="si">}</span>
</span><span id="__span-23-40"><a id="__codelineno-23-40" name="__codelineno-23-40" href="#lab05-mcp-prompts-lab-__codelineno-23-40"></a>
</span><span id="__span-23-41"><a id="__codelineno-23-41" name="__codelineno-23-41" href="#lab05-mcp-prompts-lab-__codelineno-23-41"></a><span class="sb">Provide detailed guidance and check completion criteria before proceeding.`</span><span class="p">,</span>
</span><span id="__span-23-42"><a id="__codelineno-23-42" name="__codelineno-23-42" href="#lab05-mcp-prompts-lab-__codelineno-23-42"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-23-43"><a id="__codelineno-23-43" name="__codelineno-23-43" href="#lab05-mcp-prompts-lab-__codelineno-23-43"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-23-44"><a id="__codelineno-23-44" name="__codelineno-23-44" href="#lab05-mcp-prompts-lab-__codelineno-23-44"></a><span class="w">    </span><span class="p">],</span>
</span><span id="__span-23-45"><a id="__codelineno-23-45" name="__codelineno-23-45" href="#lab05-mcp-prompts-lab-__codelineno-23-45"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-23-46"><a id="__codelineno-23-46" name="__codelineno-23-46" href="#lab05-mcp-prompts-lab-__codelineno-23-46"></a>
</span><span id="__span-23-47"><a id="__codelineno-23-47" name="__codelineno-23-47" href="#lab05-mcp-prompts-lab-__codelineno-23-47"></a><span class="c1">// Helper method</span>
</span><span id="__span-23-48"><a id="__codelineno-23-48" name="__codelineno-23-48" href="#lab05-mcp-prompts-lab-__codelineno-23-48"></a><span class="k">private</span><span class="w"> </span><span class="nx">getStepGuidance</span><span class="p">(</span><span class="nx">step</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">projectType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-49"><a id="__codelineno-23-49" name="__codelineno-23-49" href="#lab05-mcp-prompts-lab-__codelineno-23-49"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">guidance</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-50"><a id="__codelineno-23-50" name="__codelineno-23-50" href="#lab05-mcp-prompts-lab-__codelineno-23-50"></a><span class="w">    </span><span class="nx">review</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-51"><a id="__codelineno-23-51" name="__codelineno-23-51" href="#lab05-mcp-prompts-lab-__codelineno-23-51"></a><span class="w">      </span><span class="nx">web</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Code Review Guidelines:\n- Check code quality and standards\n- Verify security practices\n- Review performance considerations\n- Validate functionality&quot;</span><span class="p">,</span>
</span><span id="__span-23-52"><a id="__codelineno-23-52" name="__codelineno-23-52" href="#lab05-mcp-prompts-lab-__codelineno-23-52"></a><span class="w">      </span><span class="nx">api</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;API Review Guidelines:\n- Check endpoint design\n- Validate error handling\n- Review authentication\n- Test API contracts&quot;</span><span class="p">,</span>
</span><span id="__span-23-53"><a id="__codelineno-23-53" name="__codelineno-23-53" href="#lab05-mcp-prompts-lab-__codelineno-23-53"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-54"><a id="__codelineno-23-54" name="__codelineno-23-54" href="#lab05-mcp-prompts-lab-__codelineno-23-54"></a><span class="w">    </span><span class="nx">testing</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-55"><a id="__codelineno-23-55" name="__codelineno-23-55" href="#lab05-mcp-prompts-lab-__codelineno-23-55"></a><span class="w">      </span><span class="nx">web</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Testing Guidelines:\n- Unit test coverage\n- Integration testing\n- User acceptance testing\n- Performance testing&quot;</span><span class="p">,</span>
</span><span id="__span-23-56"><a id="__codelineno-23-56" name="__codelineno-23-56" href="#lab05-mcp-prompts-lab-__codelineno-23-56"></a><span class="w">      </span><span class="nx">api</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;API Testing Guidelines:\n- Endpoint testing\n- Load testing\n- Security testing\n- Contract testing&quot;</span><span class="p">,</span>
</span><span id="__span-23-57"><a id="__codelineno-23-57" name="__codelineno-23-57" href="#lab05-mcp-prompts-lab-__codelineno-23-57"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-58"><a id="__codelineno-23-58" name="__codelineno-23-58" href="#lab05-mcp-prompts-lab-__codelineno-23-58"></a><span class="w">    </span><span class="nx">deployment</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-59"><a id="__codelineno-23-59" name="__codelineno-23-59" href="#lab05-mcp-prompts-lab-__codelineno-23-59"></a><span class="w">      </span><span class="nx">web</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Deployment Guidelines:\n- Environment configuration\n- Database migrations\n- Rollback procedures\n- Monitoring setup&quot;</span><span class="p">,</span>
</span><span id="__span-23-60"><a id="__codelineno-23-60" name="__codelineno-23-60" href="#lab05-mcp-prompts-lab-__codelineno-23-60"></a><span class="w">      </span><span class="nx">api</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;API Deployment Guidelines:\n- API gateway configuration\n- Version management\n- Documentation publishing\n- Client notifications&quot;</span><span class="p">,</span>
</span><span id="__span-23-61"><a id="__codelineno-23-61" name="__codelineno-23-61" href="#lab05-mcp-prompts-lab-__codelineno-23-61"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-62"><a id="__codelineno-23-62" name="__codelineno-23-62" href="#lab05-mcp-prompts-lab-__codelineno-23-62"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-23-63"><a id="__codelineno-23-63" name="__codelineno-23-63" href="#lab05-mcp-prompts-lab-__codelineno-23-63"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">guidance</span><span class="p">[</span><span class="nx">step</span><span class="p">]</span><span class="o">?</span><span class="p">.[</span><span class="nx">projectType</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;Follow standard practices for this step.&quot;</span><span class="p">;</span>
</span><span id="__span-23-64"><a id="__codelineno-23-64" name="__codelineno-23-64" href="#lab05-mcp-prompts-lab-__codelineno-23-64"></a><span class="p">}</span>
</span></code></pre></div>

Test the workflow by calling the prompt with different currentStep values and verifying step progression and guidance.

</details>

<h3 id="lab05-mcp-prompts-lab-exercise-3-production-ready-server">Exercise 3: Production-Ready Server<a class="headerlink" href="#lab05-mcp-prompts-lab-exercise-3-production-ready-server" title="Permanent link">&para;</a></h3>
<p><strong>Goal:</strong> Create a production-ready MCP server with all capabilities.</p>
<p><strong>Steps:</strong></p>
<ol>
<li>Implement comprehensive error handling</li>
<li>Add logging and monitoring</li>
<li>Include health checks</li>
<li>Add configuration management</li>
<li>Implement rate limiting</li>
<li>Create deployment scripts</li>
</ol>
<p><strong>Requirements:</strong></p>
<ul>
<li>Structured logging</li>
<li>Health check endpoints</li>
<li>Configuration validation</li>
<li>Graceful shutdown</li>
<li>Performance monitoring</li>
</ul>
<details>
<summary>Solution</summary>

Implement comprehensive error handling, logging, health checks, configuration management, rate limiting, and deployment scripts.<br><br>

Example code structure:

<div class="language-typescript highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#lab05-mcp-prompts-lab-__codelineno-24-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#lab05-mcp-prompts-lab-__codelineno-24-2"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#lab05-mcp-prompts-lab-__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#lab05-mcp-prompts-lab-__codelineno-24-4"></a><span class="kd">class</span><span class="w"> </span><span class="nx">ProductionMCPServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#lab05-mcp-prompts-lab-__codelineno-24-5"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#lab05-mcp-prompts-lab-__codelineno-24-6"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#lab05-mcp-prompts-lab-__codelineno-24-7"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">requestCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#lab05-mcp-prompts-lab-__codelineno-24-8"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#lab05-mcp-prompts-lab-__codelineno-24-9"></a>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#lab05-mcp-prompts-lab-__codelineno-24-10"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">configPath?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#lab05-mcp-prompts-lab-__codelineno-24-11"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">loadConfiguration</span><span class="p">(</span><span class="nx">configPath</span><span class="p">);</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#lab05-mcp-prompts-lab-__codelineno-24-12"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#lab05-mcp-prompts-lab-__codelineno-24-13"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#lab05-mcp-prompts-lab-__codelineno-24-14"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">this.config.name</span><span class="p">,</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#lab05-mcp-prompts-lab-__codelineno-24-15"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="kt">this.config.version</span><span class="p">,</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#lab05-mcp-prompts-lab-__codelineno-24-16"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#lab05-mcp-prompts-lab-__codelineno-24-17"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#lab05-mcp-prompts-lab-__codelineno-24-18"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#lab05-mcp-prompts-lab-__codelineno-24-19"></a><span class="w">          </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#lab05-mcp-prompts-lab-__codelineno-24-20"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#lab05-mcp-prompts-lab-__codelineno-24-21"></a><span class="w">          </span><span class="nx">prompts</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#lab05-mcp-prompts-lab-__codelineno-24-22"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#lab05-mcp-prompts-lab-__codelineno-24-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#lab05-mcp-prompts-lab-__codelineno-24-24"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#lab05-mcp-prompts-lab-__codelineno-24-25"></a>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#lab05-mcp-prompts-lab-__codelineno-24-26"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupLogging</span><span class="p">();</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#lab05-mcp-prompts-lab-__codelineno-24-27"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#lab05-mcp-prompts-lab-__codelineno-24-28"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupErrorHandling</span><span class="p">();</span>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29" href="#lab05-mcp-prompts-lab-__codelineno-24-29"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHealthChecks</span><span class="p">();</span>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30" href="#lab05-mcp-prompts-lab-__codelineno-24-30"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31" href="#lab05-mcp-prompts-lab-__codelineno-24-31"></a>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32" href="#lab05-mcp-prompts-lab-__codelineno-24-32"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">loadConfiguration</span><span class="p">(</span><span class="nx">configPath?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33" href="#lab05-mcp-prompts-lab-__codelineno-24-33"></a><span class="w">    </span><span class="c1">// Load from file or environment</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34" href="#lab05-mcp-prompts-lab-__codelineno-24-34"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35" href="#lab05-mcp-prompts-lab-__codelineno-24-35"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;production-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36" href="#lab05-mcp-prompts-lab-__codelineno-24-36"></a><span class="w">      </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-24-37"><a id="__codelineno-24-37" name="__codelineno-24-37" href="#lab05-mcp-prompts-lab-__codelineno-24-37"></a><span class="w">      </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="kt">process.env.PORT</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">3000</span><span class="p">,</span>
</span><span id="__span-24-38"><a id="__codelineno-24-38" name="__codelineno-24-38" href="#lab05-mcp-prompts-lab-__codelineno-24-38"></a><span class="w">      </span><span class="nx">logLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">process.env.LOG_LEVEL</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;info&quot;</span><span class="p">,</span>
</span><span id="__span-24-39"><a id="__codelineno-24-39" name="__codelineno-24-39" href="#lab05-mcp-prompts-lab-__codelineno-24-39"></a><span class="w">      </span><span class="nx">rateLimit</span><span class="o">:</span><span class="w"> </span><span class="kt">parseInt</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">RATE_LIMIT</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;100&quot;</span><span class="p">),</span>
</span><span id="__span-24-40"><a id="__codelineno-24-40" name="__codelineno-24-40" href="#lab05-mcp-prompts-lab-__codelineno-24-40"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-24-41"><a id="__codelineno-24-41" name="__codelineno-24-41" href="#lab05-mcp-prompts-lab-__codelineno-24-41"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-42"><a id="__codelineno-24-42" name="__codelineno-24-42" href="#lab05-mcp-prompts-lab-__codelineno-24-42"></a>
</span><span id="__span-24-43"><a id="__codelineno-24-43" name="__codelineno-24-43" href="#lab05-mcp-prompts-lab-__codelineno-24-43"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupLogging</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-44"><a id="__codelineno-24-44" name="__codelineno-24-44" href="#lab05-mcp-prompts-lab-__codelineno-24-44"></a><span class="w">    </span><span class="c1">// Use a proper logging library in production</span>
</span><span id="__span-24-45"><a id="__codelineno-24-45" name="__codelineno-24-45" href="#lab05-mcp-prompts-lab-__codelineno-24-45"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createLogger</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">);</span>
</span><span id="__span-24-46"><a id="__codelineno-24-46" name="__codelineno-24-46" href="#lab05-mcp-prompts-lab-__codelineno-24-46"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createLogger</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">);</span>
</span><span id="__span-24-47"><a id="__codelineno-24-47" name="__codelineno-24-47" href="#lab05-mcp-prompts-lab-__codelineno-24-47"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-48"><a id="__codelineno-24-48" name="__codelineno-24-48" href="#lab05-mcp-prompts-lab-__codelineno-24-48"></a>
</span><span id="__span-24-49"><a id="__codelineno-24-49" name="__codelineno-24-49" href="#lab05-mcp-prompts-lab-__codelineno-24-49"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">createLogger</span><span class="p">(</span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">...args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-50"><a id="__codelineno-24-50" name="__codelineno-24-50" href="#lab05-mcp-prompts-lab-__codelineno-24-50"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="nx">...args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-51"><a id="__codelineno-24-51" name="__codelineno-24-51" href="#lab05-mcp-prompts-lab-__codelineno-24-51"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">();</span>
</span><span id="__span-24-52"><a id="__codelineno-24-52" name="__codelineno-24-52" href="#lab05-mcp-prompts-lab-__codelineno-24-52"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="sb">`[</span><span class="si">${</span><span class="nx">timestamp</span><span class="si">}</span><span class="sb">] </span><span class="si">${</span><span class="nx">level</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">\n`</span><span class="p">);</span>
</span><span id="__span-24-53"><a id="__codelineno-24-53" name="__codelineno-24-53" href="#lab05-mcp-prompts-lab-__codelineno-24-53"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-24-54"><a id="__codelineno-24-54" name="__codelineno-24-54" href="#lab05-mcp-prompts-lab-__codelineno-24-54"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-55"><a id="__codelineno-24-55" name="__codelineno-24-55" href="#lab05-mcp-prompts-lab-__codelineno-24-55"></a>
</span><span id="__span-24-56"><a id="__codelineno-24-56" name="__codelineno-24-56" href="#lab05-mcp-prompts-lab-__codelineno-24-56"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-57"><a id="__codelineno-24-57" name="__codelineno-24-57" href="#lab05-mcp-prompts-lab-__codelineno-24-57"></a><span class="w">    </span><span class="c1">// Add rate limiting to handlers</span>
</span><span id="__span-24-58"><a id="__codelineno-24-58" name="__codelineno-24-58" href="#lab05-mcp-prompts-lab-__codelineno-24-58"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">rateLimitedHandler</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-59"><a id="__codelineno-24-59" name="__codelineno-24-59" href="#lab05-mcp-prompts-lab-__codelineno-24-59"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-24-60"><a id="__codelineno-24-60" name="__codelineno-24-60" href="#lab05-mcp-prompts-lab-__codelineno-24-60"></a><span class="w">    </span><span class="p">}));</span>
</span><span id="__span-24-61"><a id="__codelineno-24-61" name="__codelineno-24-61" href="#lab05-mcp-prompts-lab-__codelineno-24-61"></a>
</span><span id="__span-24-62"><a id="__codelineno-24-62" name="__codelineno-24-62" href="#lab05-mcp-prompts-lab-__codelineno-24-62"></a><span class="w">    </span><span class="c1">// Add other handlers similarly</span>
</span><span id="__span-24-63"><a id="__codelineno-24-63" name="__codelineno-24-63" href="#lab05-mcp-prompts-lab-__codelineno-24-63"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-64"><a id="__codelineno-24-64" name="__codelineno-24-64" href="#lab05-mcp-prompts-lab-__codelineno-24-64"></a>
</span><span id="__span-24-65"><a id="__codelineno-24-65" name="__codelineno-24-65" href="#lab05-mcp-prompts-lab-__codelineno-24-65"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">rateLimitedHandler</span><span class="p">(</span><span class="nx">handler</span><span class="o">:</span><span class="w"> </span><span class="kt">Function</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Function</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-66"><a id="__codelineno-24-66" name="__codelineno-24-66" href="#lab05-mcp-prompts-lab-__codelineno-24-66"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-67"><a id="__codelineno-24-67" name="__codelineno-24-67" href="#lab05-mcp-prompts-lab-__codelineno-24-67"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">requestCount</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-24-68"><a id="__codelineno-24-68" name="__codelineno-24-68" href="#lab05-mcp-prompts-lab-__codelineno-24-68"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">requestCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">rateLimit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-69"><a id="__codelineno-24-69" name="__codelineno-24-69" href="#lab05-mcp-prompts-lab-__codelineno-24-69"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Rate limit exceeded&quot;</span><span class="p">);</span>
</span><span id="__span-24-70"><a id="__codelineno-24-70" name="__codelineno-24-70" href="#lab05-mcp-prompts-lab-__codelineno-24-70"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-24-71"><a id="__codelineno-24-71" name="__codelineno-24-71" href="#lab05-mcp-prompts-lab-__codelineno-24-71"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">handler</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span>
</span><span id="__span-24-72"><a id="__codelineno-24-72" name="__codelineno-24-72" href="#lab05-mcp-prompts-lab-__codelineno-24-72"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-24-73"><a id="__codelineno-24-73" name="__codelineno-24-73" href="#lab05-mcp-prompts-lab-__codelineno-24-73"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-74"><a id="__codelineno-24-74" name="__codelineno-24-74" href="#lab05-mcp-prompts-lab-__codelineno-24-74"></a>
</span><span id="__span-24-75"><a id="__codelineno-24-75" name="__codelineno-24-75" href="#lab05-mcp-prompts-lab-__codelineno-24-75"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHealthChecks</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-76"><a id="__codelineno-24-76" name="__codelineno-24-76" href="#lab05-mcp-prompts-lab-__codelineno-24-76"></a><span class="w">    </span><span class="c1">// Add health check endpoint (if using HTTP transport)</span>
</span><span id="__span-24-77"><a id="__codelineno-24-77" name="__codelineno-24-77" href="#lab05-mcp-prompts-lab-__codelineno-24-77"></a><span class="w">    </span><span class="c1">// For stdio, we can add a special tool</span>
</span><span id="__span-24-78"><a id="__codelineno-24-78" name="__codelineno-24-78" href="#lab05-mcp-prompts-lab-__codelineno-24-78"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">CallToolRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-79"><a id="__codelineno-24-79" name="__codelineno-24-79" href="#lab05-mcp-prompts-lab-__codelineno-24-79"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;health_check&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-80"><a id="__codelineno-24-80" name="__codelineno-24-80" href="#lab05-mcp-prompts-lab-__codelineno-24-80"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-81"><a id="__codelineno-24-81" name="__codelineno-24-81" href="#lab05-mcp-prompts-lab-__codelineno-24-81"></a><span class="w">          </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span>
</span><span id="__span-24-82"><a id="__codelineno-24-82" name="__codelineno-24-82" href="#lab05-mcp-prompts-lab-__codelineno-24-82"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-24-83"><a id="__codelineno-24-83" name="__codelineno-24-83" href="#lab05-mcp-prompts-lab-__codelineno-24-83"></a><span class="w">            </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
</span><span id="__span-24-84"><a id="__codelineno-24-84" name="__codelineno-24-84" href="#lab05-mcp-prompts-lab-__codelineno-24-84"></a><span class="w">              </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;healthy&quot;</span><span class="p">,</span>
</span><span id="__span-24-85"><a id="__codelineno-24-85" name="__codelineno-24-85" href="#lab05-mcp-prompts-lab-__codelineno-24-85"></a><span class="w">              </span><span class="nx">uptime</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">startTime</span><span class="p">,</span>
</span><span id="__span-24-86"><a id="__codelineno-24-86" name="__codelineno-24-86" href="#lab05-mcp-prompts-lab-__codelineno-24-86"></a><span class="w">              </span><span class="nx">requestCount</span><span class="o">:</span><span class="w"> </span><span class="kt">this.requestCount</span><span class="p">,</span>
</span><span id="__span-24-87"><a id="__codelineno-24-87" name="__codelineno-24-87" href="#lab05-mcp-prompts-lab-__codelineno-24-87"></a><span class="w">            </span><span class="p">}),</span>
</span><span id="__span-24-88"><a id="__codelineno-24-88" name="__codelineno-24-88" href="#lab05-mcp-prompts-lab-__codelineno-24-88"></a><span class="w">          </span><span class="p">}],</span>
</span><span id="__span-24-89"><a id="__codelineno-24-89" name="__codelineno-24-89" href="#lab05-mcp-prompts-lab-__codelineno-24-89"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-24-90"><a id="__codelineno-24-90" name="__codelineno-24-90" href="#lab05-mcp-prompts-lab-__codelineno-24-90"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-24-91"><a id="__codelineno-24-91" name="__codelineno-24-91" href="#lab05-mcp-prompts-lab-__codelineno-24-91"></a><span class="w">      </span><span class="c1">// Handle other tools</span>
</span><span id="__span-24-92"><a id="__codelineno-24-92" name="__codelineno-24-92" href="#lab05-mcp-prompts-lab-__codelineno-24-92"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-24-93"><a id="__codelineno-24-93" name="__codelineno-24-93" href="#lab05-mcp-prompts-lab-__codelineno-24-93"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-94"><a id="__codelineno-24-94" name="__codelineno-24-94" href="#lab05-mcp-prompts-lab-__codelineno-24-94"></a>
</span><span id="__span-24-95"><a id="__codelineno-24-95" name="__codelineno-24-95" href="#lab05-mcp-prompts-lab-__codelineno-24-95"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupErrorHandling</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-96"><a id="__codelineno-24-96" name="__codelineno-24-96" href="#lab05-mcp-prompts-lab-__codelineno-24-96"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-97"><a id="__codelineno-24-97" name="__codelineno-24-97" href="#lab05-mcp-prompts-lab-__codelineno-24-97"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Server error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-24-98"><a id="__codelineno-24-98" name="__codelineno-24-98" href="#lab05-mcp-prompts-lab-__codelineno-24-98"></a><span class="w">      </span><span class="c1">// Send to monitoring service</span>
</span><span id="__span-24-99"><a id="__codelineno-24-99" name="__codelineno-24-99" href="#lab05-mcp-prompts-lab-__codelineno-24-99"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-24-100"><a id="__codelineno-24-100" name="__codelineno-24-100" href="#lab05-mcp-prompts-lab-__codelineno-24-100"></a>
</span><span id="__span-24-101"><a id="__codelineno-24-101" name="__codelineno-24-101" href="#lab05-mcp-prompts-lab-__codelineno-24-101"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SIGTERM&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-102"><a id="__codelineno-24-102" name="__codelineno-24-102" href="#lab05-mcp-prompts-lab-__codelineno-24-102"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Received SIGTERM, shutting down gracefully&quot;</span><span class="p">);</span>
</span><span id="__span-24-103"><a id="__codelineno-24-103" name="__codelineno-24-103" href="#lab05-mcp-prompts-lab-__codelineno-24-103"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span id="__span-24-104"><a id="__codelineno-24-104" name="__codelineno-24-104" href="#lab05-mcp-prompts-lab-__codelineno-24-104"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-24-105"><a id="__codelineno-24-105" name="__codelineno-24-105" href="#lab05-mcp-prompts-lab-__codelineno-24-105"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-24-106"><a id="__codelineno-24-106" name="__codelineno-24-106" href="#lab05-mcp-prompts-lab-__codelineno-24-106"></a>
</span><span id="__span-24-107"><a id="__codelineno-24-107" name="__codelineno-24-107" href="#lab05-mcp-prompts-lab-__codelineno-24-107"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;uncaughtException&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-108"><a id="__codelineno-24-108" name="__codelineno-24-108" href="#lab05-mcp-prompts-lab-__codelineno-24-108"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Uncaught exception:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-24-109"><a id="__codelineno-24-109" name="__codelineno-24-109" href="#lab05-mcp-prompts-lab-__codelineno-24-109"></a><span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="__span-24-110"><a id="__codelineno-24-110" name="__codelineno-24-110" href="#lab05-mcp-prompts-lab-__codelineno-24-110"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-24-111"><a id="__codelineno-24-111" name="__codelineno-24-111" href="#lab05-mcp-prompts-lab-__codelineno-24-111"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-112"><a id="__codelineno-24-112" name="__codelineno-24-112" href="#lab05-mcp-prompts-lab-__codelineno-24-112"></a>
</span><span id="__span-24-113"><a id="__codelineno-24-113" name="__codelineno-24-113" href="#lab05-mcp-prompts-lab-__codelineno-24-113"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">start</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-114"><a id="__codelineno-24-114" name="__codelineno-24-114" href="#lab05-mcp-prompts-lab-__codelineno-24-114"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-24-115"><a id="__codelineno-24-115" name="__codelineno-24-115" href="#lab05-mcp-prompts-lab-__codelineno-24-115"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-24-116"><a id="__codelineno-24-116" name="__codelineno-24-116" href="#lab05-mcp-prompts-lab-__codelineno-24-116"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Production MCP Server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-24-117"><a id="__codelineno-24-117" name="__codelineno-24-117" href="#lab05-mcp-prompts-lab-__codelineno-24-117"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-118"><a id="__codelineno-24-118" name="__codelineno-24-118" href="#lab05-mcp-prompts-lab-__codelineno-24-118"></a><span class="p">}</span>
</span><span id="__span-24-119"><a id="__codelineno-24-119" name="__codelineno-24-119" href="#lab05-mcp-prompts-lab-__codelineno-24-119"></a>
</span><span id="__span-24-120"><a id="__codelineno-24-120" name="__codelineno-24-120" href="#lab05-mcp-prompts-lab-__codelineno-24-120"></a><span class="c1">// Deployment script (deploy.sh)</span>
</span><span id="__span-24-121"><a id="__codelineno-24-121" name="__codelineno-24-121" href="#lab05-mcp-prompts-lab-__codelineno-24-121"></a><span class="err">#</span><span class="o">!</span><span class="err">/bin/bash</span>
</span><span id="__span-24-122"><a id="__codelineno-24-122" name="__codelineno-24-122" href="#lab05-mcp-prompts-lab-__codelineno-24-122"></a><span class="nx">npm</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nx">build</span>
</span><span id="__span-24-123"><a id="__codelineno-24-123" name="__codelineno-24-123" href="#lab05-mcp-prompts-lab-__codelineno-24-123"></a><span class="nx">npm</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nx">test</span>
</span><span id="__span-24-124"><a id="__codelineno-24-124" name="__codelineno-24-124" href="#lab05-mcp-prompts-lab-__codelineno-24-124"></a><span class="nx">docker</span><span class="w"> </span><span class="nx">build</span><span class="w"> </span><span class="o">-</span><span class="nx">t</span><span class="w"> </span><span class="nx">mcp</span><span class="o">-</span><span class="nx">server</span><span class="w"> </span><span class="p">.</span>
</span><span id="__span-24-125"><a id="__codelineno-24-125" name="__codelineno-24-125" href="#lab05-mcp-prompts-lab-__codelineno-24-125"></a><span class="nx">docker</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="o">-</span><span class="nx">p</span><span class="w"> </span><span class="nx">3000</span><span class="o">:</span><span class="kt">3000</span><span class="w"> </span><span class="nx">mcp</span><span class="o">-</span><span class="nx">server</span>
</span></code></pre></div>

Test by running the server, checking logs, calling health check tool, and verifying graceful shutdown.

</details>

<hr />
<h2 id="lab05-mcp-prompts-lab-key-takeaways">Key Takeaways<a class="headerlink" href="#lab05-mcp-prompts-lab-key-takeaways" title="Permanent link">&para;</a></h2>
<p>✅ <strong>Prompts</strong> create reusable AI workflows with structured guidance</p>
<p>✅ <strong>Resource integration</strong> provides contextually rich prompt experiences</p>
<p>✅ <strong>Arguments</strong> make prompts flexible and customizable</p>
<p>✅ <strong>Complete servers</strong> combine tools, resources, and prompts effectively</p>
<p>✅ <strong>Dynamic prompts</strong> adapt to current data and context</p>
<p>✅ <strong>Production readiness</strong> requires comprehensive error handling and monitoring</p>
<p>✅ <strong>Workflow orchestration</strong> enables complex, multi-step AI processes</p>
<p>✅ <strong>Domain specialization</strong> creates powerful, focused AI capabilities</p>

<hr />
<h2 id="lab05-mcp-prompts-lab-next-steps">Next Steps<a class="headerlink" href="#lab05-mcp-prompts-lab-next-steps" title="Permanent link">&para;</a></h2>
<p>Congratulations! </p>
<p>You&rsquo;ve completed the comprehensive MCP learning series. </p>
<p>You now posses the knowledge and skills to:</p>
<p>✅ <strong>Build</strong> complete MCP servers with all three capabilities</p>
<p>✅ <strong>Create</strong> sophisticated AI workflows and integrations</p>
<p>✅ <strong>Deploy</strong> production-ready MCP solutions</p>
<p>✅ <strong>Contribute</strong> to the MCP ecosystem</p>

<hr />
<h2 id="lab05-mcp-prompts-lab-whats-next">What&rsquo;s Next?<a class="headerlink" href="#lab05-mcp-prompts-lab-whats-next" title="Permanent link">&para;</a></h2>
<h3 id="lab05-mcp-prompts-lab-further-experimentation">Further experimentation<a class="headerlink" href="#lab05-mcp-prompts-lab-further-experimentation" title="Permanent link">&para;</a></h3>
<p>Go ahead and experiment further with MCP un the <a href="#lab05-mcp-prompts-tasks">MCP Lab Tasks</a> section, filled with hands-on exercises to deepen your understanding of MCP capabilities.</p>
<h3 id="lab05-mcp-prompts-lab-advanced-topics">Advanced Topics<a class="headerlink" href="#lab05-mcp-prompts-lab-advanced-topics" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>MCP Extensions</strong>: Custom protocol extensions</li>
<li><strong>Multi-server Coordination</strong>: Server orchestration</li>
<li><strong>Performance Optimization</strong>: Scaling MCP servers</li>
<li><strong>Security Hardening</strong>: Advanced security patterns</li>
</ul>
<h3 id="lab05-mcp-prompts-lab-real-world-applications">Real-World Applications<a class="headerlink" href="#lab05-mcp-prompts-lab-real-world-applications" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Code Analysis Tools</strong>: Automated code review and improvement</li>
<li><strong>DevOps Automation</strong>: Infrastructure and deployment automation</li>
<li><strong>Data Science Workflows</strong>: AI-assisted data analysis</li>
<li><strong>Content Creation</strong>: AI-powered content generation pipelines</li>
</ul>
<h3 id="lab05-mcp-prompts-lab-community-engagement">Community Engagement<a class="headerlink" href="#lab05-mcp-prompts-lab-community-engagement" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Contribute to MCP</strong>: Join the open-source development</li>
<li><strong>Share Your Servers</strong>: Publish your MCP servers</li>
<li><strong>Build Integrations</strong>: Create MCP clients and tools</li>
<li><strong>Teach Others</strong>: Help grow the MCP community</li>
</ul>
<hr />
<p><strong>Your MCP journey has just begun!</strong> </p>
<p><strong>The protocol provides endless possibilities for AI-human collaboration.</strong></p>
<p><strong>Go forth and build amazing things!</strong></p></section><section class="print-page" id="lab06-mcp-workflow-lab" heading-number="2.8"><h1 id="lab06-mcp-workflow-lab-complete-mcp-server-hands-on-lab">Complete MCP Server - Hands-On Lab<a class="headerlink" href="#lab06-mcp-workflow-lab-complete-mcp-server-hands-on-lab" title="Permanent link">&para;</a></h1>
<h2 id="lab06-mcp-workflow-lab-mcp-server-structure-lab">MCP Server Structure Lab<a class="headerlink" href="#lab06-mcp-workflow-lab-mcp-server-structure-lab" title="Permanent link">&para;</a></h2>
<h2 id="lab06-mcp-workflow-lab-lab-objective">Lab Objective<a class="headerlink" href="#lab06-mcp-workflow-lab-lab-objective" title="Permanent link">&para;</a></h2>
<ul>
<li>In this hands-on lab, you&rsquo;ll build a complete MCP (Model Context Protocol) server from scratch.</li>
<li>You&rsquo;ll learn how each component works by implementing it yourself, understanding why each piece is necessary, and seeing the complete architecture come together.</li>
</ul>
<h2 id="lab06-mcp-workflow-lab-prerequisites">Prerequisites<a class="headerlink" href="#lab06-mcp-workflow-lab-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Python 3.10 or higher installed</li>
<li>Basic understanding of Python programming</li>
<li>Terminal/command line access</li>
<li>Text editor or IDE</li>
</ul>
<hr />
<h2 id="lab06-mcp-workflow-lab-getting-started">Getting Started<a class="headerlink" href="#lab06-mcp-workflow-lab-getting-started" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-step-1-create-your-project-file">Step 1: Create Your Project File<a class="headerlink" href="#lab06-mcp-workflow-lab-step-1-create-your-project-file" title="Permanent link">&para;</a></h3>
<ol>
<li>Create a new file called <code>mcp_server.py</code></li>
<li>Open it in your favorite text editor</li>
<li>We&rsquo;ll build this server step by step!</li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-step-01-adding-imports">Step 01: Adding Imports<a class="headerlink" href="#lab06-mcp-workflow-lab-step-01-adding-imports" title="Permanent link">&para;</a></h2>
<ul>
<li>Before we write any code, we need to understand what libraries we&rsquo;re using and why.</li>
</ul>
<h3 id="lab06-mcp-workflow-lab-asyncio-asynchronous-io"><code>asyncio</code> - Asynchronous I/O<a class="headerlink" href="#lab06-mcp-workflow-lab-asyncio-asynchronous-io" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">asyncio</p>
<h4 id="lab06-mcp-workflow-lab-definition">Definition:<a class="headerlink" href="#lab06-mcp-workflow-lab-definition" title="Permanent link">&para;</a></h4>
<ul>
<li><code>asyncio</code> is a Python library for writing concurrent code using the async/await syntax.</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-why">Why:<a class="headerlink" href="#lab06-mcp-workflow-lab-why" title="Permanent link">&para;</a></h4>
<ul>
<li>Enables asynchronous programming in Python</li>
<li>MCP servers handle multiple concurrent operations (I/O, requests) without blocking</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-usage">Usage:<a class="headerlink" href="#lab06-mcp-workflow-lab-usage" title="Permanent link">&para;</a></h4>
<ul>
<li><code>async</code>/<code>await</code> keywords, event loops, concurrent task execution</li>
</ul>
</div>
<hr />
<h3 id="lab06-mcp-workflow-lab-json-javascript-object-notation"><code>json</code> - JavaScript Object Notation<a class="headerlink" href="#lab06-mcp-workflow-lab-json-javascript-object-notation" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">json</p>
<h4 id="lab06-mcp-workflow-lab-definition_1">Definition:<a class="headerlink" href="#lab06-mcp-workflow-lab-definition_1" title="Permanent link">&para;</a></h4>
<ul>
<li>JSON encoding/decoding for data serialization</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-why_1">Why:<a class="headerlink" href="#lab06-mcp-workflow-lab-why_1" title="Permanent link">&para;</a></h4>
<ul>
<li>MCP uses JSON-RPC protocol; resources return JSON data</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-usage_1">Usage:<a class="headerlink" href="#lab06-mcp-workflow-lab-usage_1" title="Permanent link">&para;</a></h4>
<ul>
<li><code>json.dumps()</code> to serialize Python dicts, <code>json.loads()</code> to parse</li>
</ul>
</div>
<hr />
<h3 id="lab06-mcp-workflow-lab-typing-type-hints"><code>typing</code> - Type Hints<a class="headerlink" href="#lab06-mcp-workflow-lab-typing-type-hints" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">typing</p>
<h4 id="lab06-mcp-workflow-lab-definition_2">Definition:<a class="headerlink" href="#lab06-mcp-workflow-lab-definition_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Type hints for better code documentation and IDE support</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-why_2">Why:<a class="headerlink" href="#lab06-mcp-workflow-lab-why_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Makes code more maintainable and catches type errors early</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-usage_2">Usage:<a class="headerlink" href="#lab06-mcp-workflow-lab-usage_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Function parameters, return types (Any = any type, Optional = can be None)</li>
</ul>
</div>
<hr />
<h3 id="lab06-mcp-workflow-lab-mcpserver-core-mcp-server"><code>mcp.server</code> - Core MCP Server<a class="headerlink" href="#lab06-mcp-workflow-lab-mcpserver-core-mcp-server" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.server</p>
<h4 id="lab06-mcp-workflow-lab-definition_3">Definition:<a class="headerlink" href="#lab06-mcp-workflow-lab-definition_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Core MCP Server class - the foundation of our server</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-why_3">Why:<a class="headerlink" href="#lab06-mcp-workflow-lab-why_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Provides all MCP protocol implementation and lifecycle management</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-usage_3">Usage:<a class="headerlink" href="#lab06-mcp-workflow-lab-usage_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Create server instance, register handlers, manage connections</li>
</ul>
</div>
<hr />
<h3 id="lab06-mcp-workflow-lab-mcpserverstdio-standard-io-transport"><code>mcp.server.stdio</code> - Standard I/O Transport<a class="headerlink" href="#lab06-mcp-workflow-lab-mcpserverstdio-standard-io-transport" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.server.stdio</p>
<h4 id="lab06-mcp-workflow-lab-definition_4">Definition:<a class="headerlink" href="#lab06-mcp-workflow-lab-definition_4" title="Permanent link">&para;</a></h4>
<ul>
<li>Standard Input/Output transport layer for MCP</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-why_4">Why:<a class="headerlink" href="#lab06-mcp-workflow-lab-why_4" title="Permanent link">&para;</a></h4>
<ul>
<li>MCP servers communicate via stdio (standard in/out streams)</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-usage_4">Usage:<a class="headerlink" href="#lab06-mcp-workflow-lab-usage_4" title="Permanent link">&para;</a></h4>
<ul>
<li>Connects server to clients through stdin/stdout pipes</li>
</ul>
</div>
<hr />
<h3 id="lab06-mcp-workflow-lab-mcptypes-protocol-types"><code>mcp.types</code> - Protocol Types<a class="headerlink" href="#lab06-mcp-workflow-lab-mcptypes-protocol-types" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.types</p>
<h4 id="lab06-mcp-workflow-lab-definition_5">Definition:<a class="headerlink" href="#lab06-mcp-workflow-lab-definition_5" title="Permanent link">&para;</a></h4>
<ul>
<li>MCP protocol type definitions for structured data</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-why_5">Why:<a class="headerlink" href="#lab06-mcp-workflow-lab-why_5" title="Permanent link">&para;</a></h4>
<ul>
<li>Type-safe definitions for all MCP primitives (tools, resources, prompts)</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-usage_5">Usage:<a class="headerlink" href="#lab06-mcp-workflow-lab-usage_5" title="Permanent link">&para;</a></h4>
<ul>
<li>Tool = executable functions, Resource = readable data, Prompt = templates, TextContent = text responses</li>
</ul>
</div>
<hr />
<h3 id="lab06-mcp-workflow-lab-sys-system-functions"><code>sys</code> - System Functions<a class="headerlink" href="#lab06-mcp-workflow-lab-sys-system-functions" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">sys</p>
<h4 id="lab06-mcp-workflow-lab-definition_6">Definition:<a class="headerlink" href="#lab06-mcp-workflow-lab-definition_6" title="Permanent link">&para;</a></h4>
<ul>
<li>System-specific parameters and functions</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-why_6">Why:<a class="headerlink" href="#lab06-mcp-workflow-lab-why_6" title="Permanent link">&para;</a></h4>
<ul>
<li>Handle system exits, command-line arguments, and stdio streams</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-usage_6">Usage:<a class="headerlink" href="#lab06-mcp-workflow-lab-usage_6" title="Permanent link">&para;</a></h4>
<ul>
<li><code>sys.exit()</code> for graceful shutdown, <code>sys.stdin</code>/<code>stdout</code> for I/O</li>
</ul>
</div>
<hr />
<h2 id="lab06-mcp-workflow-lab-step-02-skeleton-code">Step 02: Skeleton Code<a class="headerlink" href="#lab06-mcp-workflow-lab-step-02-skeleton-code" title="Permanent link">&para;</a></h2>
<h2 id="lab06-mcp-workflow-lab-skeleton-01-imports">Skeleton 01: <code>Imports</code><a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-01-imports" title="Permanent link">&para;</a></h2>
<ul>
<li>Set the following imports inside the <code>mcp_server.py</code>:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab06-mcp-workflow-lab-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab06-mcp-workflow-lab-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab06-mcp-workflow-lab-__codelineno-0-3"></a><span class="sd">Complete MCP (Model Context Protocol) Server Implementation</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab06-mcp-workflow-lab-__codelineno-0-4"></a><span class="sd">Built step by step for learning purposes.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#lab06-mcp-workflow-lab-__codelineno-0-5"></a><span class="sd">- Enables clients to get ready-to-use prompts</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#lab06-mcp-workflow-lab-__codelineno-0-6"></a><span class="sd">- Connects prompt templates to actual content</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#lab06-mcp-workflow-lab-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#lab06-mcp-workflow-lab-__codelineno-0-8"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#lab06-mcp-workflow-lab-__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#lab06-mcp-workflow-lab-__codelineno-0-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#lab06-mcp-workflow-lab-__codelineno-0-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#lab06-mcp-workflow-lab-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#lab06-mcp-workflow-lab-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#lab06-mcp-workflow-lab-__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#lab06-mcp-workflow-lab-__codelineno-0-15"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#lab06-mcp-workflow-lab-__codelineno-0-16"></a>  <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#lab06-mcp-workflow-lab-__codelineno-0-17"></a>  <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#lab06-mcp-workflow-lab-__codelineno-0-18"></a>  <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#lab06-mcp-workflow-lab-__codelineno-0-19"></a>  <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#lab06-mcp-workflow-lab-__codelineno-0-20"></a>  <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#lab06-mcp-workflow-lab-__codelineno-0-21"></a>  <span class="n">EmbeddedResource</span><span class="p">,</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#lab06-mcp-workflow-lab-__codelineno-0-22"></a><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#lab06-mcp-workflow-lab-__codelineno-0-23"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span></code></pre></div>
<ul>
<li>Create the <code>requirements.txt</code> file with the following content:</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab06-mcp-workflow-lab-__codelineno-1-1"></a>mcp
</span></code></pre></div>
<ul>
<li>Install the MCP library:</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab06-mcp-workflow-lab-__codelineno-2-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span></code></pre></div>
<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-02-class">Skeleton 02: <code>Class</code><a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-02-class" title="Permanent link">&para;</a></h2>
<ul>
<li>Add thislass definition after the imports in your <code>mcp_server.py</code> file:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab06-mcp-workflow-lab-__codelineno-3-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteMCPServer</span><span class="p">:</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#lab06-mcp-workflow-lab-__codelineno-3-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#lab06-mcp-workflow-lab-__codelineno-3-3"></a><span class="sd">    A comprehensive MCP Server implementation showcasing all</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#lab06-mcp-workflow-lab-__codelineno-3-4"></a><span class="sd">    - Enables clients to get ready-to-use prompts</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#lab06-mcp-workflow-lab-__codelineno-3-5"></a><span class="sd">    - Connects prompt templates to actual content</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#lab06-mcp-workflow-lab-__codelineno-3-6"></a><span class="sd">    protocol features.</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#lab06-mcp-workflow-lab-__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#lab06-mcp-workflow-lab-__codelineno-3-8"></a><span class="sd">  This class demonstrates:</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#lab06-mcp-workflow-lab-__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#lab06-mcp-workflow-lab-__codelineno-3-10"></a><span class="sd">    - Server initialization</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#lab06-mcp-workflow-lab-__codelineno-3-11"></a><span class="sd">    - Tool registration and execution</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#lab06-mcp-workflow-lab-__codelineno-3-12"></a><span class="sd">    - Resource management</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#lab06-mcp-workflow-lab-__codelineno-3-13"></a><span class="sd">    - Prompt templates</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#lab06-mcp-workflow-lab-__codelineno-3-14"></a><span class="sd">    - Defines the behavior of each prompt</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#lab06-mcp-workflow-lab-__codelineno-3-15"></a><span class="sd">    - Handlers make prompts functional</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#lab06-mcp-workflow-lab-__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#lab06-mcp-workflow-lab-__codelineno-3-17"></a><span class="sd">    - Request handling</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#lab06-mcp-workflow-lab-__codelineno-3-18"></a><span class="sd">  &quot;&quot;&quot;</span>
</span></code></pre></div>
<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-03-constructor">Skeleton 03: <code>Constructor</code><a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-03-constructor" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-method__init__-constructor">Method<code>__init__</code> (Constructor)<a class="headerlink" href="#lab06-mcp-workflow-lab-method__init__-constructor" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="nv">Initializes</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">MCP</span><span class="w"> </span><span class="nv">Server</span><span class="w"> </span><span class="nv">instance</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Creates</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">server</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">version</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Sets</span><span class="w"> </span><span class="nv">up</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">foundation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">MCP</span><span class="w"> </span><span class="nv">operations</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Enables</span><span class="w"> </span><span class="nv">clients</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">get</span><span class="w"> </span><span class="nv">ready</span><span class="o">-</span><span class="nv">to</span><span class="o">-</span><span class="nv">use</span><span class="w"> </span><span class="nv">prompts</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Connects</span><span class="w"> </span><span class="nv">prompt</span><span class="w"> </span><span class="nv">templates</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">actual</span><span class="w"> </span><span class="nv">content</span>
</code></pre></div>

<ul>
<li>Prepares data structures for tools, resources, and prompts</li>
</ul>
<p><strong>Why This Runs First:</strong></p>
<div class="codehilite"><pre><span></span><code>- Constructor must run before any other methods
- Creates the server object that all other methods will use
- Defines the behavior of each prompt
- Handlers make prompts functional
</code></pre></div>

<ul>
<li>No other operations can occur without this initialization</li>
<li>Sets up the basic state of the server</li>
</ul>
<hr />
<ul>
<li>Add this class definition after inside your <code>CompleteMCPServer</code> class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab06-mcp-workflow-lab-__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#lab06-mcp-workflow-lab-__codelineno-4-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the MCP Server instance.&quot;&quot;&quot;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#lab06-mcp-workflow-lab-__codelineno-4-3"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#lab06-mcp-workflow-lab-__codelineno-4-4"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Simple in-memory data storage</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#lab06-mcp-workflow-lab-__codelineno-4-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server instance created successfully!&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="lab06-mcp-workflow-lab-code-break-down">Code break down:<a class="headerlink" href="#lab06-mcp-workflow-lab-code-break-down" title="Permanent link">&para;</a></h3>
<ul>
<li><code>Server("complete-mcp-server")</code> creates the MCP server with a name</li>
<li><code>self.data_store = {}</code> creates an empty dictionary for storing data</li>
<li>This object will be used throughout all other methods</li>
</ul>
<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-04-register-tools">Skeleton 04: Register Tools<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-04-register-tools" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-methodregister_tools">Method<code>register_tools</code><a class="headerlink" href="#lab06-mcp-workflow-lab-methodregister_tools" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">Registers</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">MCP</span><span class="w"> </span><span class="n">server</span>
<span class="o">-</span><span class="w"> </span><span class="n">Defines</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="n">schemas</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Makes</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">discoverable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">clients</span>
<span class="o">-</span><span class="w"> </span><span class="n">Enables</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">ready</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">use</span><span class="w"> </span><span class="n">prompts</span>
<span class="o">-</span><span class="w"> </span><span class="n">Connects</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="n">templates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">content</span>
</code></pre></div>

<ul>
<li>Sets up the tool execution infrastructure</li>
</ul>
<p><strong>Why This Runs Second:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">initialization</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">available</span>
<span class="o">-</span><span class="w"> </span><span class="n">Defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">prompt</span>
<span class="o">-</span><span class="w"> </span><span class="n">Handlers</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">prompts</span><span class="w"> </span><span class="n">functional</span>
</code></pre></div>

<ul>
<li>Tools must be registered before they can be called</li>
<li>Defines the capabilities clients can invoke</li>
</ul>
<p><strong>What is a Tool?</strong></p>
<ul>
<li>A tool is an executable function that clients can invoke.</li>
<li>Think of it like an API endpoint that performs an action.</li>
<li>Tools have names, descriptions, and input parameters.</li>
<li>Clients can discover and call these tools to perform operations.</li>
<li>Examples: calculator, data storage, text processing</li>
<li>Tools are central to MCP&rsquo;s functionality.</li>
</ul>
<hr />
<ul>
<li>Add this method to your class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab06-mcp-workflow-lab-__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#lab06-mcp-workflow-lab-__codelineno-5-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register all available tools with the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#lab06-mcp-workflow-lab-__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#lab06-mcp-workflow-lab-__codelineno-5-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#lab06-mcp-workflow-lab-__codelineno-5-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#lab06-mcp-workflow-lab-__codelineno-5-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#lab06-mcp-workflow-lab-__codelineno-5-7"></a><span class="sd">        Return the list of available tools.</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#lab06-mcp-workflow-lab-__codelineno-5-8"></a><span class="sd">        This is called when clients want to discover what tools are available.</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#lab06-mcp-workflow-lab-__codelineno-5-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#lab06-mcp-workflow-lab-__codelineno-5-10"></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#lab06-mcp-workflow-lab-__codelineno-5-11"></a>            <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#lab06-mcp-workflow-lab-__codelineno-5-12"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#lab06-mcp-workflow-lab-__codelineno-5-13"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform mathematical operations (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#lab06-mcp-workflow-lab-__codelineno-5-14"></a>                <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#lab06-mcp-workflow-lab-__codelineno-5-15"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#lab06-mcp-workflow-lab-__codelineno-5-16"></a>                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#lab06-mcp-workflow-lab-__codelineno-5-17"></a>                        <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#lab06-mcp-workflow-lab-__codelineno-5-18"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#lab06-mcp-workflow-lab-__codelineno-5-19"></a>                            <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">],</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#lab06-mcp-workflow-lab-__codelineno-5-20"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to perform&quot;</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#lab06-mcp-workflow-lab-__codelineno-5-21"></a>                        <span class="p">},</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#lab06-mcp-workflow-lab-__codelineno-5-22"></a>                        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#lab06-mcp-workflow-lab-__codelineno-5-23"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#lab06-mcp-workflow-lab-__codelineno-5-24"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#lab06-mcp-workflow-lab-__codelineno-5-25"></a>                        <span class="p">},</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#lab06-mcp-workflow-lab-__codelineno-5-26"></a>                        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#lab06-mcp-workflow-lab-__codelineno-5-27"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#lab06-mcp-workflow-lab-__codelineno-5-28"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#lab06-mcp-workflow-lab-__codelineno-5-29"></a>                        <span class="p">}</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#lab06-mcp-workflow-lab-__codelineno-5-30"></a>                    <span class="p">},</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#lab06-mcp-workflow-lab-__codelineno-5-31"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#lab06-mcp-workflow-lab-__codelineno-5-32"></a>                <span class="p">}</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#lab06-mcp-workflow-lab-__codelineno-5-33"></a>            <span class="p">),</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#lab06-mcp-workflow-lab-__codelineno-5-34"></a>            <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#lab06-mcp-workflow-lab-__codelineno-5-35"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_data&quot;</span><span class="p">,</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#lab06-mcp-workflow-lab-__codelineno-5-36"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Store a key-value pair in the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#lab06-mcp-workflow-lab-__codelineno-5-37"></a>                <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#lab06-mcp-workflow-lab-__codelineno-5-38"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#lab06-mcp-workflow-lab-__codelineno-5-39"></a>                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#lab06-mcp-workflow-lab-__codelineno-5-40"></a>                        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#lab06-mcp-workflow-lab-__codelineno-5-41"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#lab06-mcp-workflow-lab-__codelineno-5-42"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to store&quot;</span>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#lab06-mcp-workflow-lab-__codelineno-5-43"></a>                        <span class="p">},</span>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#lab06-mcp-workflow-lab-__codelineno-5-44"></a>                        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#lab06-mcp-workflow-lab-__codelineno-5-45"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#lab06-mcp-workflow-lab-__codelineno-5-46"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The value to store&quot;</span>
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#lab06-mcp-workflow-lab-__codelineno-5-47"></a>                        <span class="p">}</span>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#lab06-mcp-workflow-lab-__codelineno-5-48"></a>                    <span class="p">},</span>
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#lab06-mcp-workflow-lab-__codelineno-5-49"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#lab06-mcp-workflow-lab-__codelineno-5-50"></a>                <span class="p">}</span>
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#lab06-mcp-workflow-lab-__codelineno-5-51"></a>            <span class="p">),</span>
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#lab06-mcp-workflow-lab-__codelineno-5-52"></a>            <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#lab06-mcp-workflow-lab-__codelineno-5-53"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;retrieve_data&quot;</span><span class="p">,</span>
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#lab06-mcp-workflow-lab-__codelineno-5-54"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Retrieve a value from the server&#39;s data store&quot;</span><span class="p">,</span>
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#lab06-mcp-workflow-lab-__codelineno-5-55"></a>                <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#lab06-mcp-workflow-lab-__codelineno-5-56"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#lab06-mcp-workflow-lab-__codelineno-5-57"></a>                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#lab06-mcp-workflow-lab-__codelineno-5-58"></a>                        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#lab06-mcp-workflow-lab-__codelineno-5-59"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#lab06-mcp-workflow-lab-__codelineno-5-60"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key to retrieve&quot;</span>
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#lab06-mcp-workflow-lab-__codelineno-5-61"></a>                        <span class="p">}</span>
</span><span id="__span-5-62"><a id="__codelineno-5-62" name="__codelineno-5-62" href="#lab06-mcp-workflow-lab-__codelineno-5-62"></a>                    <span class="p">},</span>
</span><span id="__span-5-63"><a id="__codelineno-5-63" name="__codelineno-5-63" href="#lab06-mcp-workflow-lab-__codelineno-5-63"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
</span><span id="__span-5-64"><a id="__codelineno-5-64" name="__codelineno-5-64" href="#lab06-mcp-workflow-lab-__codelineno-5-64"></a>                <span class="p">}</span>
</span><span id="__span-5-65"><a id="__codelineno-5-65" name="__codelineno-5-65" href="#lab06-mcp-workflow-lab-__codelineno-5-65"></a>            <span class="p">),</span>
</span><span id="__span-5-66"><a id="__codelineno-5-66" name="__codelineno-5-66" href="#lab06-mcp-workflow-lab-__codelineno-5-66"></a>            <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-5-67"><a id="__codelineno-5-67" name="__codelineno-5-67" href="#lab06-mcp-workflow-lab-__codelineno-5-67"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span>
</span><span id="__span-5-68"><a id="__codelineno-5-68" name="__codelineno-5-68" href="#lab06-mcp-workflow-lab-__codelineno-5-68"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Echo back the input text&quot;</span><span class="p">,</span>
</span><span id="__span-5-69"><a id="__codelineno-5-69" name="__codelineno-5-69" href="#lab06-mcp-workflow-lab-__codelineno-5-69"></a>                <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-70"><a id="__codelineno-5-70" name="__codelineno-5-70" href="#lab06-mcp-workflow-lab-__codelineno-5-70"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-5-71"><a id="__codelineno-5-71" name="__codelineno-5-71" href="#lab06-mcp-workflow-lab-__codelineno-5-71"></a>                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-72"><a id="__codelineno-5-72" name="__codelineno-5-72" href="#lab06-mcp-workflow-lab-__codelineno-5-72"></a>                        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-73"><a id="__codelineno-5-73" name="__codelineno-5-73" href="#lab06-mcp-workflow-lab-__codelineno-5-73"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-74"><a id="__codelineno-5-74" name="__codelineno-5-74" href="#lab06-mcp-workflow-lab-__codelineno-5-74"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to echo back&quot;</span>
</span><span id="__span-5-75"><a id="__codelineno-5-75" name="__codelineno-5-75" href="#lab06-mcp-workflow-lab-__codelineno-5-75"></a>                        <span class="p">}</span>
</span><span id="__span-5-76"><a id="__codelineno-5-76" name="__codelineno-5-76" href="#lab06-mcp-workflow-lab-__codelineno-5-76"></a>                    <span class="p">},</span>
</span><span id="__span-5-77"><a id="__codelineno-5-77" name="__codelineno-5-77" href="#lab06-mcp-workflow-lab-__codelineno-5-77"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</span><span id="__span-5-78"><a id="__codelineno-5-78" name="__codelineno-5-78" href="#lab06-mcp-workflow-lab-__codelineno-5-78"></a>                <span class="p">}</span>
</span><span id="__span-5-79"><a id="__codelineno-5-79" name="__codelineno-5-79" href="#lab06-mcp-workflow-lab-__codelineno-5-79"></a>            <span class="p">)</span>
</span><span id="__span-5-80"><a id="__codelineno-5-80" name="__codelineno-5-80" href="#lab06-mcp-workflow-lab-__codelineno-5-80"></a>        <span class="p">]</span>
</span><span id="__span-5-81"><a id="__codelineno-5-81" name="__codelineno-5-81" href="#lab06-mcp-workflow-lab-__codelineno-5-81"></a>
</span><span id="__span-5-82"><a id="__codelineno-5-82" name="__codelineno-5-82" href="#lab06-mcp-workflow-lab-__codelineno-5-82"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tools registered: calculate, store_data, retrieve_data, echo&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.list_tools()</code> decorator registers a handler for tool listing</li>
<li>Each <code>Tool</code> object defines the tool&rsquo;s name, description, and input schema</li>
<li>The <code>inputSchema</code> uses JSON Schema format to validate inputs</li>
<li>When a client calls <code>list_tools()</code>, they get this list</li>
<li>This makes the tools discoverable and usable by clients</li>
</ul>
<h3 id="lab06-mcp-workflow-lab-hands-on-exercise">Hands-On Exercise:<a class="headerlink" href="#lab06-mcp-workflow-lab-hands-on-exercise" title="Permanent link">&para;</a></h3>
<ul>
<li>Add a new tool called <code>greeting</code> that takes a string input <code>name</code> and returns a greeting message.</li>
<li>Define its name, description, and input schema similar to the other tools.</li>
<li>Test it later when we implement tool handlers.</li>
<li>Hint: Use the existing tools as a reference for structure.</li>
<li>After adding, your <code>list_tools</code> method should include the new <code>greeting</code> tool.</li>
<li>This exercise helps you understand how to define and register new tools in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Greeting Tool</summary>

<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab06-mcp-workflow-lab-__codelineno-6-1"></a><span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab06-mcp-workflow-lab-__codelineno-6-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;greeting&quot;</span><span class="p">,</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#lab06-mcp-workflow-lab-__codelineno-6-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Return a greeting message for the given name&quot;</span><span class="p">,</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#lab06-mcp-workflow-lab-__codelineno-6-4"></a>    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#lab06-mcp-workflow-lab-__codelineno-6-5"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#lab06-mcp-workflow-lab-__codelineno-6-6"></a>        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#lab06-mcp-workflow-lab-__codelineno-6-7"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#lab06-mcp-workflow-lab-__codelineno-6-8"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#lab06-mcp-workflow-lab-__codelineno-6-9"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The name to greet&quot;</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#lab06-mcp-workflow-lab-__codelineno-6-10"></a>            <span class="p">}</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#lab06-mcp-workflow-lab-__codelineno-6-11"></a>        <span class="p">},</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#lab06-mcp-workflow-lab-__codelineno-6-12"></a>        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#lab06-mcp-workflow-lab-__codelineno-6-13"></a>    <span class="p">}</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#lab06-mcp-workflow-lab-__codelineno-6-14"></a><span class="p">)</span>
</span></code></pre></div>

  </details>

<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-05-tools-handlers">Skeleton 05: Tool(s) Handlers<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-05-tools-handlers" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-methodregister_tool_handlers">Method<code>register_tool_handlers</code><a class="headerlink" href="#lab06-mcp-workflow-lab-methodregister_tool_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">Implements</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="k">tool</span>
<span class="o">-</span><span class="w"> </span><span class="n">Handles</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">clients</span>
<span class="o">-</span><span class="w"> </span><span class="n">Processes</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">results</span>
<span class="o">-</span><span class="w"> </span><span class="n">Enables</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">ready</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">use</span><span class="w"> </span><span class="n">prompts</span>
<span class="o">-</span><span class="w"> </span><span class="n">Connects</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="n">templates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">content</span>
</code></pre></div>

<ul>
<li>Provides error handling for tool execution</li>
<li>Enables dynamic tool functionality</li>
</ul>
<p><strong>Why This Runs Third:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">registered</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="n">when</span>
<span class="o">-</span><span class="w"> </span><span class="n">Defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">prompt</span>
<span class="o">-</span><span class="w"> </span><span class="n">Handlers</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">prompts</span><span class="w"> </span><span class="n">functional</span>
<span class="n">each</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">called</span>
</code></pre></div>

<ul>
<li><strong>Without handlers, tools are just definitions with no action</strong></li>
<li>Tools need implementation before they can be executed</li>
<li>Connects tool schemas to actual functionality</li>
<li>Defines the behavior of each tool</li>
<li>Handlers make tools operational</li>
<li>Clients rely on these handlers to perform tasks</li>
<li>This is where the server&rsquo;s capabilities come to life</li>
<li>Handlers are essential for a functional MCP server</li>
<li>They bridge the gap between tool definition and execution</li>
</ul>
<hr />
<ul>
<li>Add this method to your class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab06-mcp-workflow-lab-__codelineno-7-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_tool_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#lab06-mcp-workflow-lab-__codelineno-7-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement the actual logic for each tool.&quot;&quot;&quot;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#lab06-mcp-workflow-lab-__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#lab06-mcp-workflow-lab-__codelineno-7-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#lab06-mcp-workflow-lab-__codelineno-7-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#lab06-mcp-workflow-lab-__codelineno-7-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#lab06-mcp-workflow-lab-__codelineno-7-7"></a><span class="sd">        Handle tool execution requests.</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#lab06-mcp-workflow-lab-__codelineno-7-8"></a><span class="sd">        This is called when a client wants to execute a tool.</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#lab06-mcp-workflow-lab-__codelineno-7-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#lab06-mcp-workflow-lab-__codelineno-7-10"></a>        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate&quot;</span><span class="p">:</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#lab06-mcp-workflow-lab-__codelineno-7-11"></a>            <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#lab06-mcp-workflow-lab-__codelineno-7-12"></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#lab06-mcp-workflow-lab-__codelineno-7-13"></a>            <span class="n">b</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#lab06-mcp-workflow-lab-__codelineno-7-14"></a>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#lab06-mcp-workflow-lab-__codelineno-7-15"></a>            <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#lab06-mcp-workflow-lab-__codelineno-7-16"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#lab06-mcp-workflow-lab-__codelineno-7-17"></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;subtract&quot;</span><span class="p">:</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#lab06-mcp-workflow-lab-__codelineno-7-18"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#lab06-mcp-workflow-lab-__codelineno-7-19"></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;multiply&quot;</span><span class="p">:</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#lab06-mcp-workflow-lab-__codelineno-7-20"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#lab06-mcp-workflow-lab-__codelineno-7-21"></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;divide&quot;</span><span class="p">:</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#lab06-mcp-workflow-lab-__codelineno-7-22"></a>                <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#lab06-mcp-workflow-lab-__codelineno-7-23"></a>                    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#lab06-mcp-workflow-lab-__codelineno-7-24"></a>                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#lab06-mcp-workflow-lab-__codelineno-7-25"></a>                        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Error: Cannot divide by zero&quot;</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#lab06-mcp-workflow-lab-__codelineno-7-26"></a>                    <span class="p">)]</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#lab06-mcp-workflow-lab-__codelineno-7-27"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#lab06-mcp-workflow-lab-__codelineno-7-28"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#lab06-mcp-workflow-lab-__codelineno-7-29"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#lab06-mcp-workflow-lab-__codelineno-7-30"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#lab06-mcp-workflow-lab-__codelineno-7-31"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#lab06-mcp-workflow-lab-__codelineno-7-32"></a>                <span class="p">)]</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#lab06-mcp-workflow-lab-__codelineno-7-33"></a>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#lab06-mcp-workflow-lab-__codelineno-7-34"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#lab06-mcp-workflow-lab-__codelineno-7-35"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#lab06-mcp-workflow-lab-__codelineno-7-36"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#lab06-mcp-workflow-lab-__codelineno-7-37"></a>            <span class="p">)]</span>
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38" href="#lab06-mcp-workflow-lab-__codelineno-7-38"></a>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39" href="#lab06-mcp-workflow-lab-__codelineno-7-39"></a>        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;store_data&quot;</span><span class="p">:</span>
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40" href="#lab06-mcp-workflow-lab-__codelineno-7-40"></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41" href="#lab06-mcp-workflow-lab-__codelineno-7-41"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42" href="#lab06-mcp-workflow-lab-__codelineno-7-42"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43" href="#lab06-mcp-workflow-lab-__codelineno-7-43"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44" href="#lab06-mcp-workflow-lab-__codelineno-7-44"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45" href="#lab06-mcp-workflow-lab-__codelineno-7-45"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stored: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-46"><a id="__codelineno-7-46" name="__codelineno-7-46" href="#lab06-mcp-workflow-lab-__codelineno-7-46"></a>            <span class="p">)]</span>
</span><span id="__span-7-47"><a id="__codelineno-7-47" name="__codelineno-7-47" href="#lab06-mcp-workflow-lab-__codelineno-7-47"></a>
</span><span id="__span-7-48"><a id="__codelineno-7-48" name="__codelineno-7-48" href="#lab06-mcp-workflow-lab-__codelineno-7-48"></a>        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;retrieve_data&quot;</span><span class="p">:</span>
</span><span id="__span-7-49"><a id="__codelineno-7-49" name="__codelineno-7-49" href="#lab06-mcp-workflow-lab-__codelineno-7-49"></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</span><span id="__span-7-50"><a id="__codelineno-7-50" name="__codelineno-7-50" href="#lab06-mcp-workflow-lab-__codelineno-7-50"></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-7-51"><a id="__codelineno-7-51" name="__codelineno-7-51" href="#lab06-mcp-workflow-lab-__codelineno-7-51"></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-52"><a id="__codelineno-7-52" name="__codelineno-7-52" href="#lab06-mcp-workflow-lab-__codelineno-7-52"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-7-53"><a id="__codelineno-7-53" name="__codelineno-7-53" href="#lab06-mcp-workflow-lab-__codelineno-7-53"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-7-54"><a id="__codelineno-7-54" name="__codelineno-7-54" href="#lab06-mcp-workflow-lab-__codelineno-7-54"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
</span><span id="__span-7-55"><a id="__codelineno-7-55" name="__codelineno-7-55" href="#lab06-mcp-workflow-lab-__codelineno-7-55"></a>                <span class="p">)]</span>
</span><span id="__span-7-56"><a id="__codelineno-7-56" name="__codelineno-7-56" href="#lab06-mcp-workflow-lab-__codelineno-7-56"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-7-57"><a id="__codelineno-7-57" name="__codelineno-7-57" href="#lab06-mcp-workflow-lab-__codelineno-7-57"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-7-58"><a id="__codelineno-7-58" name="__codelineno-7-58" href="#lab06-mcp-workflow-lab-__codelineno-7-58"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Retrieved: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-59"><a id="__codelineno-7-59" name="__codelineno-7-59" href="#lab06-mcp-workflow-lab-__codelineno-7-59"></a>            <span class="p">)]</span>
</span><span id="__span-7-60"><a id="__codelineno-7-60" name="__codelineno-7-60" href="#lab06-mcp-workflow-lab-__codelineno-7-60"></a>
</span><span id="__span-7-61"><a id="__codelineno-7-61" name="__codelineno-7-61" href="#lab06-mcp-workflow-lab-__codelineno-7-61"></a>        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;echo&quot;</span><span class="p">:</span>
</span><span id="__span-7-62"><a id="__codelineno-7-62" name="__codelineno-7-62" href="#lab06-mcp-workflow-lab-__codelineno-7-62"></a>            <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-7-63"><a id="__codelineno-7-63" name="__codelineno-7-63" href="#lab06-mcp-workflow-lab-__codelineno-7-63"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-7-64"><a id="__codelineno-7-64" name="__codelineno-7-64" href="#lab06-mcp-workflow-lab-__codelineno-7-64"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-7-65"><a id="__codelineno-7-65" name="__codelineno-7-65" href="#lab06-mcp-workflow-lab-__codelineno-7-65"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Echo: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-66"><a id="__codelineno-7-66" name="__codelineno-7-66" href="#lab06-mcp-workflow-lab-__codelineno-7-66"></a>            <span class="p">)]</span>
</span><span id="__span-7-67"><a id="__codelineno-7-67" name="__codelineno-7-67" href="#lab06-mcp-workflow-lab-__codelineno-7-67"></a>
</span><span id="__span-7-68"><a id="__codelineno-7-68" name="__codelineno-7-68" href="#lab06-mcp-workflow-lab-__codelineno-7-68"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-7-69"><a id="__codelineno-7-69" name="__codelineno-7-69" href="#lab06-mcp-workflow-lab-__codelineno-7-69"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-7-70"><a id="__codelineno-7-70" name="__codelineno-7-70" href="#lab06-mcp-workflow-lab-__codelineno-7-70"></a>                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-7-71"><a id="__codelineno-7-71" name="__codelineno-7-71" href="#lab06-mcp-workflow-lab-__codelineno-7-71"></a>                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown tool &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-7-72"><a id="__codelineno-7-72" name="__codelineno-7-72" href="#lab06-mcp-workflow-lab-__codelineno-7-72"></a>            <span class="p">)]</span>
</span><span id="__span-7-73"><a id="__codelineno-7-73" name="__codelineno-7-73" href="#lab06-mcp-workflow-lab-__codelineno-7-73"></a>
</span><span id="__span-7-74"><a id="__codelineno-7-74" name="__codelineno-7-74" href="#lab06-mcp-workflow-lab-__codelineno-7-74"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tool handlers implemented&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.call_tool()</code> decorator registers the execution handler</li>
<li>Each tool&rsquo;s logic is in an <code>if/elif</code> block</li>
<li>Results are wrapped in <code>TextContent</code> objects</li>
<li>Error handling is included for edge cases (like division by zero)</li>
<li>When a client calls a tool, this handler processes the request and returns the output</li>
<li>This makes the tools functional and usable by clients</li>
</ul>
<hr />
<h3 id="lab06-mcp-workflow-lab-hands-on-exercise_1">Hands-On Exercise:<a class="headerlink" href="#lab06-mcp-workflow-lab-hands-on-exercise_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Implement the handler logic for the <code>greeting</code> tool you added earlier.</li>
<li>The tool should take the <code>name</code> parameter and return a greeting message like &ldquo;Hello, {name}!&rdquo;.</li>
<li>Test it later when we run the server.</li>
<li>Hint: Follow the structure of the other tool handlers.</li>
<li>After adding, your <code>call_tool</code> method should include the new <code>greeting</code> tool logic.</li>
<li>This exercise helps you understand how to implement tool functionality in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Greeting Tool Handler</summary>

<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab06-mcp-workflow-lab-__codelineno-8-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;greeting&quot;</span><span class="p">:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#lab06-mcp-workflow-lab-__codelineno-8-2"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#lab06-mcp-workflow-lab-__codelineno-8-3"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#lab06-mcp-workflow-lab-__codelineno-8-4"></a>        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#lab06-mcp-workflow-lab-__codelineno-8-5"></a>        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#lab06-mcp-workflow-lab-__codelineno-8-6"></a>    <span class="p">)]</span>
</span></code></pre></div>

  </details>

<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-06-register-resources">Skeleton 06: Register Resources<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-06-register-resources" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-methodregister_resources">Method<code>register_resources</code><a class="headerlink" href="#lab06-mcp-workflow-lab-methodregister_resources" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code>- Registers resources that clients can access
- Defines resource URIs and metadata
- Makes static and dynamic content available
- Enables clients to get ready-to-use prompts
- Connects prompt templates to actual content
</code></pre></div>

<ul>
<li>Enables resource discovery and retrieval</li>
<li>Provides additional data for clients</li>
<li>Supports richer interactions with the server</li>
<li>Expands server capabilities beyond tools</li>
<li>
<p>Facilitates data sharing and information access</p>
</li>
<li>
<p>Defines the behavior of each prompt</p>
</li>
<li>Handlers make prompts functional</li>
</ul>
<p><strong>Why This Runs Fourth:</strong>
  - After tools are set up, we add resources which provide additional data
  - Resources are complementary to tools
  - Provides data that tools might reference</p>
<p><strong>What is a Resource?</strong></p>
<ul>
<li>A resource is readable data or content.</li>
<li>Think of it like a file or endpoint you can read from (but not execute).</li>
<li>Resources have URIs (like URLs) and metadata (name, description, MIME type).</li>
<li>Clients can discover and read these resources.</li>
<li>Examples: server info, data store contents, welcome message</li>
<li>Resources enhance the server&rsquo;s functionality by providing static or dynamic data.</li>
</ul>
<hr />
<ul>
<li>Add this method to your class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab06-mcp-workflow-lab-__codelineno-9-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#lab06-mcp-workflow-lab-__codelineno-9-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register resources that clients can access.&quot;&quot;&quot;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#lab06-mcp-workflow-lab-__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#lab06-mcp-workflow-lab-__codelineno-9-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#lab06-mcp-workflow-lab-__codelineno-9-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#lab06-mcp-workflow-lab-__codelineno-9-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#lab06-mcp-workflow-lab-__codelineno-9-7"></a><span class="sd">        Return the list of available resources.</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#lab06-mcp-workflow-lab-__codelineno-9-8"></a><span class="sd">        This is called when clients want to discover what resources are available.</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#lab06-mcp-workflow-lab-__codelineno-9-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#lab06-mcp-workflow-lab-__codelineno-9-10"></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#lab06-mcp-workflow-lab-__codelineno-9-11"></a>            <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#lab06-mcp-workflow-lab-__codelineno-9-12"></a>                <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#lab06-mcp-workflow-lab-__codelineno-9-13"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#lab06-mcp-workflow-lab-__codelineno-9-14"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#lab06-mcp-workflow-lab-__codelineno-9-15"></a>                <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#lab06-mcp-workflow-lab-__codelineno-9-16"></a>            <span class="p">),</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#lab06-mcp-workflow-lab-__codelineno-9-17"></a>            <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#lab06-mcp-workflow-lab-__codelineno-9-18"></a>                <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://data-store&quot;</span><span class="p">,</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#lab06-mcp-workflow-lab-__codelineno-9-19"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Store&quot;</span><span class="p">,</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#lab06-mcp-workflow-lab-__codelineno-9-20"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current contents of the data store&quot;</span><span class="p">,</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#lab06-mcp-workflow-lab-__codelineno-9-21"></a>                <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#lab06-mcp-workflow-lab-__codelineno-9-22"></a>            <span class="p">),</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#lab06-mcp-workflow-lab-__codelineno-9-23"></a>            <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#lab06-mcp-workflow-lab-__codelineno-9-24"></a>                <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://welcome&quot;</span><span class="p">,</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#lab06-mcp-workflow-lab-__codelineno-9-25"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Welcome Message&quot;</span><span class="p">,</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#lab06-mcp-workflow-lab-__codelineno-9-26"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Welcome message and server capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#lab06-mcp-workflow-lab-__codelineno-9-27"></a>                <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#lab06-mcp-workflow-lab-__codelineno-9-28"></a>            <span class="p">)</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#lab06-mcp-workflow-lab-__codelineno-9-29"></a>        <span class="p">]</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#lab06-mcp-workflow-lab-__codelineno-9-30"></a>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#lab06-mcp-workflow-lab-__codelineno-9-31"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources registered: server-info, data-store, welcome&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.list_resources()</code> decorator registers the resource listing handler</li>
<li>Each <code>Resource</code> defines a URI (like a URL), name, description, and MIME type</li>
<li>URIs use the <code>resource://</code> scheme to identify resources</li>
<li>When a client calls <code>list_resources()</code>, they get this list</li>
<li>This makes the resources discoverable and accessible by clients</li>
<li>Resources provide additional data that clients can read</li>
<li>Enhances the server&rsquo;s capabilities beyond just tools</li>
</ul>
<hr />
<h3 id="lab06-mcp-workflow-lab-hands-on-exercise_2">Hands-On Exercise:<a class="headerlink" href="#lab06-mcp-workflow-lab-hands-on-exercise_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Add a new resource called <code>server-author</code> that return your name as the author of the server.</li>
<li>Define its URI, name, description, and MIME type similar to the other resources.</li>
<li>Test it later when we implement resource handlers.</li>
<li>Hint: Use the existing resources as a reference for structure.</li>
<li>After adding, your <code>list_resources</code> method should include the new <code>server-author</code> resource.</li>
<li>This exercise helps you understand how to define and register new resources in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Server Stats Resource</summary>

<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab06-mcp-workflow-lab-__codelineno-10-1"></a><span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#lab06-mcp-workflow-lab-__codelineno-10-2"></a>    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-author&quot;</span><span class="p">,</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#lab06-mcp-workflow-lab-__codelineno-10-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Author&quot;</span><span class="p">,</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#lab06-mcp-workflow-lab-__codelineno-10-4"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Author of the MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#lab06-mcp-workflow-lab-__codelineno-10-5"></a>    <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#lab06-mcp-workflow-lab-__codelineno-10-6"></a><span class="p">)</span>
</span></code></pre></div>

  </details>

<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-07-resource-handlers">Skeleton 07: Resource Handlers<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-07-resource-handlers" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-methodregister_resource_handlers">Method<code>register_resource_handlers</code><a class="headerlink" href="#lab06-mcp-workflow-lab-methodregister_resource_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="nv">Implements</span><span class="w"> </span><span class="nv">resource</span><span class="w"> </span><span class="nv">retrieval</span><span class="w"> </span><span class="nv">logic</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Returns</span><span class="w"> </span><span class="nv">actual</span><span class="w"> </span><span class="nv">content</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">each</span><span class="w"> </span><span class="nv">resource</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Handles</span><span class="w"> </span><span class="nv">dynamic</span><span class="w"> </span><span class="nv">resource</span><span class="w"> </span><span class="nv">generation</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Enables</span><span class="w"> </span><span class="nv">clients</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">get</span><span class="w"> </span><span class="nv">ready</span><span class="o">-</span><span class="nv">to</span><span class="o">-</span><span class="nv">use</span><span class="w"> </span><span class="nv">prompts</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Connects</span><span class="w"> </span><span class="nv">prompt</span><span class="w"> </span><span class="nv">templates</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">actual</span><span class="w"> </span><span class="nv">content</span>
</code></pre></div>

<ul>
<li>Provides resource access control</li>
<li>Enables clients to read server data</li>
<li>Supports various content types (JSON, text)</li>
<li>Facilitates data sharing with clients</li>
<li>Connects resource definitions to actual data</li>
<li>Enhances server usability and information access</li>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
</ul>
<p><strong>Why This Runs Fifth:</strong></p>
<ul>
<li>After resources are registered, we need to implement what content is returned</li>
<li>Resources need implementation to return actual data</li>
<li>Connects resource URIs to actual content</li>
<li>Defines the behavior of each resource</li>
<li>Handlers make resources accessible</li>
<li>Clients rely on these handlers to read data</li>
<li>This is where resource definitions become functional</li>
<li>Handlers are essential for a usable MCP server</li>
<li>They bridge the gap between resource definition and content delivery</li>
<li>Without handlers, resources are just placeholders with no data</li>
<li>Handlers bring resources to life</li>
</ul>
<hr />
<ul>
<li>Add this method to your class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#lab06-mcp-workflow-lab-__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_resource_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#lab06-mcp-workflow-lab-__codelineno-11-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement resource retrieval logic.&quot;&quot;&quot;</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#lab06-mcp-workflow-lab-__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#lab06-mcp-workflow-lab-__codelineno-11-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#lab06-mcp-workflow-lab-__codelineno-11-5"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#lab06-mcp-workflow-lab-__codelineno-11-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#lab06-mcp-workflow-lab-__codelineno-11-7"></a><span class="sd">        Handle resource read requests.</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#lab06-mcp-workflow-lab-__codelineno-11-8"></a><span class="sd">        This is called when a client wants to read a resource.</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#lab06-mcp-workflow-lab-__codelineno-11-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#lab06-mcp-workflow-lab-__codelineno-11-10"></a>        <span class="c1"># Extract the URI string from the AnyUrl object</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#lab06-mcp-workflow-lab-__codelineno-11-11"></a>        <span class="n">uri_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#lab06-mcp-workflow-lab-__codelineno-11-12"></a>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#lab06-mcp-workflow-lab-__codelineno-11-13"></a>        <span class="k">if</span> <span class="n">uri_str</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span><span class="p">:</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#lab06-mcp-workflow-lab-__codelineno-11-14"></a>            <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#lab06-mcp-workflow-lab-__codelineno-11-15"></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;complete-mcp-server&quot;</span><span class="p">,</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#lab06-mcp-workflow-lab-__codelineno-11-16"></a>                <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#lab06-mcp-workflow-lab-__codelineno-11-17"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A comprehensive MCP server implementation&quot;</span><span class="p">,</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#lab06-mcp-workflow-lab-__codelineno-11-18"></a>                <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#lab06-mcp-workflow-lab-__codelineno-11-19"></a>                    <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#lab06-mcp-workflow-lab-__codelineno-11-20"></a>                    <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#lab06-mcp-workflow-lab-__codelineno-11-21"></a>                    <span class="s2">&quot;prompts&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#lab06-mcp-workflow-lab-__codelineno-11-22"></a>                <span class="p">}</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#lab06-mcp-workflow-lab-__codelineno-11-23"></a>            <span class="p">}</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#lab06-mcp-workflow-lab-__codelineno-11-24"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#lab06-mcp-workflow-lab-__codelineno-11-25"></a>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#lab06-mcp-workflow-lab-__codelineno-11-26"></a>        <span class="k">elif</span> <span class="n">uri_str</span> <span class="o">==</span> <span class="s2">&quot;resource://data-store&quot;</span><span class="p">:</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#lab06-mcp-workflow-lab-__codelineno-11-27"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#lab06-mcp-workflow-lab-__codelineno-11-28"></a>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#lab06-mcp-workflow-lab-__codelineno-11-29"></a>        <span class="k">elif</span> <span class="n">uri_str</span> <span class="o">==</span> <span class="s2">&quot;resource://welcome&quot;</span><span class="p">:</span>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#lab06-mcp-workflow-lab-__codelineno-11-30"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;&quot;Welcome to the Complete MCP Server!</span>
</span></code></pre></div>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.read_resource()</code> decorator registers the read handler</li>
<li>Each resource URI returns appropriate content</li>
<li>JSON resources use <code>json.dumps()</code> to serialize data</li>
<li>Plain text resources return strings directly</li>
<li>When a client reads a resource, this handler processes the request and returns the content</li>
<li>This makes the resources functional and usable by clients</li>
</ul>
<hr />
<h3 id="lab06-mcp-workflow-lab-hands-on-exercise_3">Hands-On Exercise:<a class="headerlink" href="#lab06-mcp-workflow-lab-hands-on-exercise_3" title="Permanent link">&para;</a></h3>
<ul>
<li>Implement the handler logic for the <code>server-author</code> resource you added earlier.</li>
<li>The resource should return your name as plain text.</li>
<li>Test it later when we run the server.</li>
<li>Hint: Follow the structure of the other resource handlers.</li>
<li>After adding, your <code>read_resource</code> method should include the new <code>server-author</code> resource logic.</li>
<li>This exercise helps you understand how to implement resource functionality in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Server Author Resource Handler</summary>

  <div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab06-mcp-workflow-lab-__codelineno-12-1"></a><span class="k">elif</span> <span class="n">uri_str</span> <span class="o">==</span> <span class="s2">&quot;resource://server-author&quot;</span><span class="p">:</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#lab06-mcp-workflow-lab-__codelineno-12-2"></a>    <span class="k">return</span> <span class="s2">&quot;Author: Your Name Here&quot;</span>
</span></code></pre></div>

  </details>

<hr />
<h3 id="lab06-mcp-workflow-lab-handle-errors">Handle Errors<a class="headerlink" href="#lab06-mcp-workflow-lab-handle-errors" title="Permanent link">&para;</a></h3>
<ul>
<li>Add Error Handling for Unknown Resources</li>
<li>Add this at the end of the <code>read_resource</code> method to handle unknown resources:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab06-mcp-workflow-lab-__codelineno-13-1"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#lab06-mcp-workflow-lab-__codelineno-13-2"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-08-register-prompts">Skeleton 08: Register Prompts<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-08-register-prompts" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-method-register_prompts">Method <code>register_prompts</code><a class="headerlink" href="#lab06-mcp-workflow-lab-method-register_prompts" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Registers prompt templates for clients</li>
<li>Defines structured prompts with parameters</li>
<li>Enables prompt discovery</li>
<li>Enables clients to get ready-to-use prompts</li>
<li>Connects prompt templates to actual content</li>
<li>Provides reusable prompt patterns</li>
<li>Facilitates advanced AI interactions</li>
<li>Supports dynamic prompt generation</li>
</ul>
<p><strong>Why This Runs Sixth:</strong></p>
<ul>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
<li>After tools and resources, prompts add higher-level interaction patterns</li>
<li>Prompts build on available tools and resources</li>
<li>Provides templates for AI assistants</li>
</ul>
<p><strong>What is a Prompt?</strong></p>
<ul>
<li>A prompt is a template that guides AI assistants on how to use the server&rsquo;s tools and resources effectively.</li>
<li>Prompts have names, descriptions, and parameters.</li>
<li>Clients can discover and request prompts.</li>
<li>Examples: code review prompt, data analysis prompt</li>
<li>Prompts enhance the server&rsquo;s capabilities by providing structured interaction patterns.</li>
</ul>
<hr />
<ul>
<li>Add this method to your class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab06-mcp-workflow-lab-__codelineno-14-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_prompts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#lab06-mcp-workflow-lab-__codelineno-14-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register prompt templates for clients.&quot;&quot;&quot;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#lab06-mcp-workflow-lab-__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#lab06-mcp-workflow-lab-__codelineno-14-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_prompts</span><span class="p">()</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#lab06-mcp-workflow-lab-__codelineno-14-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_prompts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Prompt</span><span class="p">]:</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#lab06-mcp-workflow-lab-__codelineno-14-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#lab06-mcp-workflow-lab-__codelineno-14-7"></a><span class="sd">        Return the list of available prompts.</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#lab06-mcp-workflow-lab-__codelineno-14-8"></a><span class="sd">        This is called when clients want to discover what prompts are available.</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#lab06-mcp-workflow-lab-__codelineno-14-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#lab06-mcp-workflow-lab-__codelineno-14-10"></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#lab06-mcp-workflow-lab-__codelineno-14-11"></a>            <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#lab06-mcp-workflow-lab-__codelineno-14-12"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analyze-data&quot;</span><span class="p">,</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#lab06-mcp-workflow-lab-__codelineno-14-13"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze data stored in the server&quot;</span><span class="p">,</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#lab06-mcp-workflow-lab-__codelineno-14-14"></a>                <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#lab06-mcp-workflow-lab-__codelineno-14-15"></a>                    <span class="p">{</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#lab06-mcp-workflow-lab-__codelineno-14-16"></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#lab06-mcp-workflow-lab-__codelineno-14-17"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The key of the data to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#lab06-mcp-workflow-lab-__codelineno-14-18"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#lab06-mcp-workflow-lab-__codelineno-14-19"></a>                    <span class="p">}</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#lab06-mcp-workflow-lab-__codelineno-14-20"></a>                <span class="p">]</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#lab06-mcp-workflow-lab-__codelineno-14-21"></a>            <span class="p">),</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#lab06-mcp-workflow-lab-__codelineno-14-22"></a>            <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#lab06-mcp-workflow-lab-__codelineno-14-23"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculate-scenario&quot;</span><span class="p">,</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#lab06-mcp-workflow-lab-__codelineno-14-24"></a>                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Walk through a calculation scenario&quot;</span><span class="p">,</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#lab06-mcp-workflow-lab-__codelineno-14-25"></a>                <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#lab06-mcp-workflow-lab-__codelineno-14-26"></a>                    <span class="p">{</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#lab06-mcp-workflow-lab-__codelineno-14-27"></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;operation&quot;</span><span class="p">,</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#lab06-mcp-workflow-lab-__codelineno-14-28"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The operation to demonstrate (add, subtract, multiply, divide)&quot;</span><span class="p">,</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#lab06-mcp-workflow-lab-__codelineno-14-29"></a>                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#lab06-mcp-workflow-lab-__codelineno-14-30"></a>                    <span class="p">}</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#lab06-mcp-workflow-lab-__codelineno-14-31"></a>                <span class="p">]</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#lab06-mcp-workflow-lab-__codelineno-14-32"></a>            <span class="p">)</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#lab06-mcp-workflow-lab-__codelineno-14-33"></a>        <span class="p">]</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#lab06-mcp-workflow-lab-__codelineno-14-34"></a>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#lab06-mcp-workflow-lab-__codelineno-14-35"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompts registered: analyze-data, calculate-scenario&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.list_prompts()</code> decorator registers the prompt listing handler</li>
<li>Each <code>Prompt</code> defines a name, description, and arguments</li>
<li>Arguments specify what parameters the prompt template needs</li>
<li>When a client calls <code>list_prompts()</code>, they get this list</li>
<li>This makes the prompts discoverable and usable by clients</li>
<li>Prompts provide structured templates for AI interactions</li>
</ul>
<hr />
<h3 id="lab06-mcp-workflow-lab-hands-on-exercise_4">Hands-On Exercise:<a class="headerlink" href="#lab06-mcp-workflow-lab-hands-on-exercise_4" title="Permanent link">&para;</a></h3>
<ul>
<li>Add a new prompt called <code>greet-user</code> that prompts the AI to greet a user by name.</li>
<li>Define its name, description, and arguments similar to the other prompts.</li>
<li>Test it later when we implement prompt handlers.</li>
<li>Hint: Use the existing prompts as a reference for structure.</li>
<li>After adding, your <code>list_prompts</code> method should include the new <code>greet-user</code> prompt.</li>
<li>This exercise helps you understand how to define and register new prompts in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Greet User Prompt</summary>

<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab06-mcp-workflow-lab-__codelineno-15-1"></a><span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab06-mcp-workflow-lab-__codelineno-15-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;greet-user&quot;</span><span class="p">,</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#lab06-mcp-workflow-lab-__codelineno-15-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Prompt the AI to greet a user by name&quot;</span><span class="p">,</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#lab06-mcp-workflow-lab-__codelineno-15-4"></a>    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#lab06-mcp-workflow-lab-__codelineno-15-5"></a>        <span class="p">{</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#lab06-mcp-workflow-lab-__codelineno-15-6"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#lab06-mcp-workflow-lab-__codelineno-15-7"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of the user to greet&quot;</span><span class="p">,</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#lab06-mcp-workflow-lab-__codelineno-15-8"></a>            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#lab06-mcp-workflow-lab-__codelineno-15-9"></a>        <span class="p">}</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#lab06-mcp-workflow-lab-__codelineno-15-10"></a>    <span class="p">]</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#lab06-mcp-workflow-lab-__codelineno-15-11"></a><span class="p">)</span>
</span></code></pre></div>

  </details>

<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-09-prompt-handlers">Skeleton 09: Prompt Handlers<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-09-prompt-handlers" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-method-register_prompt_handlers">Method: <code>register_prompt_handlers</code><a class="headerlink" href="#lab06-mcp-workflow-lab-method-register_prompt_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Implements prompt generation logic</li>
<li>Returns formatted prompts with embedded context</li>
<li>Handles prompt parameters and customization</li>
<li>Provides dynamic prompt content</li>
<li>Enables clients to get ready-to-use prompts</li>
<li>Connects prompt templates to actual content</li>
</ul>
<p><strong>Why This Runs Seventh:</strong></p>
<ul>
<li>After prompts are registered, we implement the logic that generates prompt content</li>
<li>Prompts need implementation to generate actual text</li>
<li>Connects prompt templates to actual content</li>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
</ul>
<hr />
<ul>
<li>Add this method to your class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#lab06-mcp-workflow-lab-__codelineno-16-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_prompt_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#lab06-mcp-workflow-lab-__codelineno-16-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement prompt generation logic.&quot;&quot;&quot;</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#lab06-mcp-workflow-lab-__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#lab06-mcp-workflow-lab-__codelineno-16-4"></a>    <span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">get_prompt</span><span class="p">()</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#lab06-mcp-workflow-lab-__codelineno-16-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prompt</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#lab06-mcp-workflow-lab-__codelineno-16-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#lab06-mcp-workflow-lab-__codelineno-16-7"></a><span class="sd">        Handle prompt generation requests.</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#lab06-mcp-workflow-lab-__codelineno-16-8"></a><span class="sd">        This is called when a client wants to get a prompt.</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#lab06-mcp-workflow-lab-__codelineno-16-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#lab06-mcp-workflow-lab-__codelineno-16-10"></a>        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;analyze-data&quot;</span><span class="p">:</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#lab06-mcp-workflow-lab-__codelineno-16-11"></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#lab06-mcp-workflow-lab-__codelineno-16-12"></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;not found&quot;</span><span class="p">)</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#lab06-mcp-workflow-lab-__codelineno-16-13"></a>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#lab06-mcp-workflow-lab-__codelineno-16-14"></a>            <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Analyze the following data from the server:</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#lab06-mcp-workflow-lab-__codelineno-16-15"></a>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#lab06-mcp-workflow-lab-__codelineno-16-16"></a><span class="s2">Key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#lab06-mcp-workflow-lab-__codelineno-16-17"></a><span class="s2">Value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#lab06-mcp-workflow-lab-__codelineno-16-18"></a>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#lab06-mcp-workflow-lab-__codelineno-16-19"></a><span class="s2">Please provide:</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#lab06-mcp-workflow-lab-__codelineno-16-20"></a><span class="s2">1. A description of what this data represents</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#lab06-mcp-workflow-lab-__codelineno-16-21"></a><span class="s2">2. Any patterns or insights you notice</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#lab06-mcp-workflow-lab-__codelineno-16-22"></a><span class="s2">3. Suggestions for how this data could be used</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#lab06-mcp-workflow-lab-__codelineno-16-23"></a>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#lab06-mcp-workflow-lab-__codelineno-16-24"></a><span class="s2">Use the retrieve_data tool if you need to fetch additional context.&quot;&quot;&quot;</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#lab06-mcp-workflow-lab-__codelineno-16-25"></a>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#lab06-mcp-workflow-lab-__codelineno-16-26"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#lab06-mcp-workflow-lab-__codelineno-16-27"></a>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#lab06-mcp-workflow-lab-__codelineno-16-28"></a>            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;calculate-scenario&quot;</span><span class="p">:</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#lab06-mcp-workflow-lab-__codelineno-16-29"></a>                <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;add&quot;</span><span class="p">)</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#lab06-mcp-workflow-lab-__codelineno-16-30"></a>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#lab06-mcp-workflow-lab-__codelineno-16-31"></a>                <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Let&#39;s work through a </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2"> calculation scenario.</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#lab06-mcp-workflow-lab-__codelineno-16-32"></a>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#lab06-mcp-workflow-lab-__codelineno-16-33"></a><span class="s2">Use the calculate tool with the operation &#39;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&#39;.</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#lab06-mcp-workflow-lab-__codelineno-16-34"></a><span class="s2">For example:</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#lab06-mcp-workflow-lab-__codelineno-16-35"></a><span class="s2">- Choose two numbers (a and b)</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#lab06-mcp-workflow-lab-__codelineno-16-36"></a><span class="s2">- Execute: calculate(operation=&quot;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&quot;, a=10, b=5)</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#lab06-mcp-workflow-lab-__codelineno-16-37"></a><span class="s2">- Explain the result</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#lab06-mcp-workflow-lab-__codelineno-16-38"></a>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#lab06-mcp-workflow-lab-__codelineno-16-39"></a><span class="s2">This demonstrates how to use computational tools in the MCP server.&quot;&quot;&quot;</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#lab06-mcp-workflow-lab-__codelineno-16-40"></a>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#lab06-mcp-workflow-lab-__codelineno-16-41"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#lab06-mcp-workflow-lab-__codelineno-16-42"></a>
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43" href="#lab06-mcp-workflow-lab-__codelineno-16-43"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44" href="#lab06-mcp-workflow-lab-__codelineno-16-44"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span>
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45" href="#lab06-mcp-workflow-lab-__codelineno-16-45"></a>                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46" href="#lab06-mcp-workflow-lab-__codelineno-16-46"></a>                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: Unknown prompt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47" href="#lab06-mcp-workflow-lab-__codelineno-16-47"></a>                <span class="p">)]</span>
</span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48" href="#lab06-mcp-workflow-lab-__codelineno-16-48"></a>
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49" href="#lab06-mcp-workflow-lab-__codelineno-16-49"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prompt handlers implemented&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>@self.server.get_prompt()</code> decorator registers the prompt generation handler</li>
<li>Each prompt returns formatted text based on the parameters</li>
<li>Prompts can reference tools and resources</li>
<li>Dynamic content is generated based on current server state</li>
</ul>
<hr />
<h3 id="lab06-mcp-workflow-lab-hands-on">Hands On:<a class="headerlink" href="#lab06-mcp-workflow-lab-hands-on" title="Permanent link">&para;</a></h3>
<ul>
<li>Implement the handler logic for the <code>greet-user</code> prompt you added earlier.</li>
<li>The prompt should return a greeting message using the provided <code>name</code> parameter.</li>
<li>Test it later when we run the server.</li>
<li>Hint: Follow the structure of the other prompt handlers.</li>
<li>After adding, your <code>get_prompt</code> method should include the new <code>greet-user</code> prompt logic.</li>
<li>This exercise helps you understand how to implement prompt functionality in the MCP server.</li>
<li>Try to implement it on your own before looking at the solution below!</li>
</ul>
<details>
  <summary>Solution for Greet User Prompt Handler</summary>

<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab06-mcp-workflow-lab-__codelineno-17-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;greet-user&quot;</span><span class="p">:</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#lab06-mcp-workflow-lab-__codelineno-17-2"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Guest&quot;</span><span class="p">)</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#lab06-mcp-workflow-lab-__codelineno-17-3"></a>    <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">! Welcome to the Complete MCP Server. How can I assist you today?&quot;</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#lab06-mcp-workflow-lab-__codelineno-17-4"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">prompt_text</span><span class="p">)]</span>
</span></code></pre></div>

  </details>

<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-10-lifecycle-handlers">Skeleton 10: Lifecycle Handlers<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-10-lifecycle-handlers" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-method-setup_lifecycle_handlers">Method: <code>setup_lifecycle_handlers</code><a class="headerlink" href="#lab06-mcp-workflow-lab-method-setup_lifecycle_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Handles server initialization events</li>
<li>Manages server shutdown procedures</li>
<li>Logs server lifecycle events</li>
<li>Ensures clean startup and teardown</li>
<li>Enables clients to get ready-to-use prompts</li>
<li>Connects prompt templates to actual content</li>
<li>Maintains server stability and reliability</li>
</ul>
<p><strong>Why This Runs Eighth:</strong></p>
<ul>
<li>After all features are configured, we set up lifecycle management</li>
<li>Lifecycle handlers need complete server setup</li>
<li>Prepares server for actual runtime operations</li>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
<li>Ensures proper resource management during startup/shutdown</li>
<li>Critical for long-running server processes</li>
<li>Helps prevent resource leaks and data corruption</li>
</ul>
<p><strong>Why Servers Need Shutdown Procedures:</strong></p>
<ul>
<li>Release system resources (memory, file handles, connections)</li>
<li>Save any pending data or state to disk</li>
<li>Close network connections gracefully</li>
<li>Notify connected clients of server shutdown</li>
<li>Clean up temporary files and caches</li>
<li>Log final statistics and status</li>
<li>Prevent data corruption from abrupt termination</li>
<li>Allow pending operations to complete</li>
</ul>
<hr />
<ul>
<li>Add this method to your class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab06-mcp-workflow-lab-__codelineno-18-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">setup_lifecycle_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#lab06-mcp-workflow-lab-__codelineno-18-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Setup lifecycle management (conceptual for MCP).&quot;&quot;&quot;</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#lab06-mcp-workflow-lab-__codelineno-18-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lifecycle management configured&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>Note: MCP servers typically don&rsquo;t have explicit lifecycle hooks</li>
<li>This is a conceptual method showing where such logic would go</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul>
<li>You can implement custom startup/shutdown logic here if needed</li>
<li>Use this as a placeholder for lifecycle management</li>
<li>The actual &ldquo;lifecycle&rdquo; of the server is managed implicitly by:</li>
<li><strong>Startup:</strong> When <code>asyncio.run(main())</code> is called and <code>server.run()</code> begins the event loop.</li>
<li><strong>Shutdown:</strong> When the process receives a signal (like <code>KeyboardInterrupt / Ctrl+C</code>), which is caught in the if <code>__name__ == "__main__":</code> block to exit gracefully.</li>
</ul>
</div>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>MCP servers use the standard Python lifecycle</li>
<li>Cleanup happens when the server process exits</li>
<li>You can use <code>try/except/finally</code> blocks in the main function for cleanup</li>
<li>This method is a placeholder for lifecycle logic</li>
<li>In real-world servers, you might add logging or resource management here</li>
<li>This prepares the server for stable operation</li>
<li>Enhances reliability during startup and shutdown</li>
<li>Critical for production-grade servers</li>
<li>Though MCP lacks explicit lifecycle hooks, this method indicates where such logic would be placed</li>
<li>It serves as a reminder to consider lifecycle management in server design</li>
<li>Helps maintain server health over long runtimes</li>
<li>Prepares for future enhancements that may introduce lifecycle events</li>
<li>Ensures the server is robust and reliable</li>
<li>Maintains server integrity during its lifecycle</li>
</ul>
<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-11-run-the-server">Skeleton 11: Run the Server<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-11-run-the-server" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-method-run">Method: <code>run</code><a class="headerlink" href="#lab06-mcp-workflow-lab-method-run" title="Permanent link">&para;</a></h3>
<ul>
<li>This is the final method to add to your class.</li>
<li>It starts the MCP server and begins listening for client requests.</li>
</ul>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Starts the MCP server</li>
<li>Connects to stdio transport</li>
<li>Begins listening for client requests</li>
<li>Runs the main event loop</li>
<li>Enables clients to get ready-to-use prompts</li>
<li>Connects prompt templates to actual content</li>
<li>Facilitates real-time client-server communication</li>
</ul>
<p><strong>Why This Runs Last:</strong></p>
<ul>
<li>All tools, resources, and prompts must be registered first</li>
<li>This starts the actual server operation</li>
<li>After this, the server is live and accepting requests</li>
<li>Defines the behavior of each prompt</li>
<li>Handlers make prompts functional</li>
<li>This is the final step to make the server operational</li>
<li>Without this, the server would not run</li>
<li>This method initiates the event loop that processes requests</li>
<li>Critical for real-time interactions with clients</li>
</ul>
<hr />
<h4 id="lab06-mcp-workflow-lab-how-does-mcp-server-start">How does MCP Server Start:<a class="headerlink" href="#lab06-mcp-workflow-lab-how-does-mcp-server-start" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Create stdio transport:</strong> <code>stdio_server()</code></li>
<li>Opens stdin (standard input) for receiving messages</li>
<li>
<p>Opens stdout (standard output) for sending responses</p>
</li>
<li>
<p><strong>Run server with streams:</strong> <code>server.run(read_stream, write_stream)</code></p>
</li>
<li>Listens on stdin for JSON-RPC messages from client</li>
<li>
<p>Sends JSON-RPC responses back on stdout</p>
</li>
<li>
<p><strong>Event loop processes requests asynchronously</strong></p>
</li>
<li>Handles multiple concurrent requests</li>
<li>Executes tools, returns resources, generates prompts</li>
</ol>
<hr />
<h4 id="lab06-mcp-workflow-lab-what-is-stdio-standard-inputoutput">What is STDIO (Standard Input/Output)?<a class="headerlink" href="#lab06-mcp-workflow-lab-what-is-stdio-standard-inputoutput" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th style="text-align: left;">Component</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>stdio</strong></td>
<td style="text-align: left;">Standard Input/Output streams</td>
</tr>
<tr>
<td style="text-align: left;"><strong>stdin</strong></td>
<td style="text-align: left;">Channel for receiving data (keyboard, pipe)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>stdout</strong></td>
<td style="text-align: left;">Channel for sending data (screen, pipe)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Usage</strong></td>
<td style="text-align: left;">MCP uses stdio for client-server communication</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Flow</strong></td>
<td style="text-align: left;">Client stdin → Server stdout → Client</td>
</tr>
</tbody>
</table>
<h4 id="lab06-mcp-workflow-lab-alternatives-to-stdio">Alternatives to STDIO:<a class="headerlink" href="#lab06-mcp-workflow-lab-alternatives-to-stdio" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th style="text-align: left;">Component</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>HTTP/HTTPS</strong></td>
<td style="text-align: left;">Web-based API (REST or GraphQL)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>WebSockets</strong></td>
<td style="text-align: left;">Bidirectional real-time communication</td>
</tr>
<tr>
<td style="text-align: left;"><strong>gRPC</strong></td>
<td style="text-align: left;">High-performance RPC framework</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Unix Domain Sockets</strong></td>
<td style="text-align: left;">Local inter-process communication</td>
</tr>
<tr>
<td style="text-align: left;"><strong>TCP/IP Sockets</strong></td>
<td style="text-align: left;">Network communication</td>
</tr>
</tbody>
</table>
<p><strong>Why STDIO for MCP?</strong></p>
<ul>
<li>✓ Simple: No network configuration needed</li>
<li>✓ Secure: Stays within local process boundary</li>
<li>✓ Universal: Works on all operating systems</li>
<li>✓ Easy to integrate: Pipe to any process</li>
<li>✓ Lightweight: Minimal overhead for communication</li>
<li>✓ Ideal for local AI assistant integrations</li>
<li>✓ Fits well with command-line tools and scripts</li>
<li>✓ Perfect for development and testing</li>
<li>✓ Common in LSP (Language Server Protocol) implementations</li>
<li>✓ Easy to debug: View raw messages in terminal</li>
<li>✓ No firewall or network issues</li>
<li>✓ Works well with containerized environments</li>
</ul>
<p><strong>Async Event Loop Explained:</strong></p>
<ul>
<li>Event Loop: Central coordinator for async operations</li>
<li>Async/Await: Write concurrent code that looks sequential</li>
<li>Non-blocking: Server handles multiple requests simultaneously</li>
<li>Efficient: Uses single thread for many connections</li>
<li>Scalable: Easily handles growing workloads</li>
</ul>
<hr />
<p><strong>How It Works:</strong></p>
<ol>
<li>Event loop starts and waits for events (<code>messages</code>)</li>
<li>When message arrives, creates a Task to handle it</li>
<li>While waiting for I/O ( <code>tool execution</code>), processes other tasks</li>
<li>When task completes, <strong>sends response back to client</strong></li>
<li>Continues looping until server shuts down</li>
<li>This allows high concurrency with minimal threads</li>
</ol>
<p><strong>Benefits:</strong></p>
<ul>
<li>✓ Handle 1000s of connections with single thread</li>
<li>✓ No waiting: Process other requests during I/O</li>
<li>✓ Memory efficient: No thread per connection</li>
<li>✓ Scalable: Add more tasks without more threads</li>
<li>✓ Responsive: Quick handling of many clients</li>
<li>✓ Ideal for I/O-bound workloads (like MCP servers)</li>
<li>✓ Simplifies concurrency model</li>
<li>✓ Reduces complexity of multi-threaded code</li>
<li>✓ Easier to maintain and debug</li>
<li>✓ Leverages Python&rsquo;s async capabilities effectively</li>
</ul>
<hr />
<ul>
<li>Add this method to your class:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#lab06-mcp-workflow-lab-__codelineno-19-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#lab06-mcp-workflow-lab-__codelineno-19-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Start the MCP server and begin serving requests.&quot;&quot;&quot;</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#lab06-mcp-workflow-lab-__codelineno-19-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting MCP server...&quot;</span><span class="p">)</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#lab06-mcp-workflow-lab-__codelineno-19-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server is now running and ready to accept connections&quot;</span><span class="p">)</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#lab06-mcp-workflow-lab-__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#lab06-mcp-workflow-lab-__codelineno-19-6"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">stdio_server</span><span class="p">()</span> <span class="k">as</span> <span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">):</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#lab06-mcp-workflow-lab-__codelineno-19-7"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#lab06-mcp-workflow-lab-__codelineno-19-8"></a>            <span class="n">read_stream</span><span class="p">,</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#lab06-mcp-workflow-lab-__codelineno-19-9"></a>            <span class="n">write_stream</span><span class="p">,</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#lab06-mcp-workflow-lab-__codelineno-19-10"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">create_initialization_options</span><span class="p">()</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#lab06-mcp-workflow-lab-__codelineno-19-11"></a>        <span class="p">)</span>
</span></code></pre></div>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li><code>stdio_server()</code> creates the stdin/stdout transport</li>
<li><code>self.server.run()</code> starts the server event loop</li>
<li>The server now listens for JSON-RPC messages on stdin</li>
<li>Responses are sent back on stdout</li>
<li>The server can now handle tool calls, resource reads, and prompt requests</li>
<li>This is the final step to make the server operational</li>
<li>The server runs indefinitely until interrupted</li>
<li>Clients can now connect and interact with the server</li>
<li>This method is asynchronous, allowing concurrent request handling</li>
<li>The server is now live and ready for use</li>
</ul>
<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-12-rag">Skeleton 12: RAG<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-12-rag" title="Permanent link">&para;</a></h2>
<p><strong>What is RAG?</strong></p>
<ul>
<li>RAG = Retrieval Augmented Generation</li>
<li>A technique that enhances AI responses by retrieving relevant information from a knowledge base before generating answers</li>
<li>Think of it like giving the AI access to a reference library</li>
<li>Combines information retrieval with text generation</li>
<li>Enables accurate, context-aware responses based on specific data</li>
<li>Examples: Customer support bots, domain-specific Q&amp;A systems, documentation assistants</li>
<li>Critical for providing factually accurate responses from your own data sources</li>
</ul>
<p><strong>Why Add RAG to Your MCP Server?</strong></p>
<ul>
<li>Makes your server more intelligent and context-aware</li>
<li>Allows retrieval of relevant information from local data sources</li>
<li>Provides accurate responses based on your specific domain knowledge</li>
<li>Enables filtering and querying of structured data</li>
<li>Enhances the server&rsquo;s ability to answer domain-specific questions</li>
<li>No heavy vector database dependencies required for simple implementations</li>
</ul>
<hr />
<h4 id="lab06-mcp-workflow-lab-1-install-dependencies">1. Install Dependencies<a class="headerlink" href="#lab06-mcp-workflow-lab-1-install-dependencies" title="Permanent link">&para;</a></h4>
<ul>
<li>No heavy dependencies (like vector databases) are required for this simple implementation.</li>
<li>We will use standard Python libraries.</li>
</ul>
<h4 id="lab06-mcp-workflow-lab-2-update-the-mcp-server">2. Update the MCP Server<a class="headerlink" href="#lab06-mcp-workflow-lab-2-update-the-mcp-server" title="Permanent link">&para;</a></h4>
<ul>
<li>Open your MCP server file and add the following imports and initialization code to set up a simple in-memory users.</li>
<li>We will also add a helper function to load data from a CSV file.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#lab06-mcp-workflow-lab-__codelineno-20-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#lab06-mcp-workflow-lab-__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#lab06-mcp-workflow-lab-__codelineno-20-3"></a><span class="c1"># Initialize an in-memory users</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#lab06-mcp-workflow-lab-__codelineno-20-4"></a><span class="n">users</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#lab06-mcp-workflow-lab-__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#lab06-mcp-workflow-lab-__codelineno-20-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_users</span><span class="p">(</span><span class="n">csv_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#lab06-mcp-workflow-lab-__codelineno-20-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load users from a CSV file.&quot;&quot;&quot;</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#lab06-mcp-workflow-lab-__codelineno-20-8"></a>    <span class="k">global</span> <span class="n">users</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#lab06-mcp-workflow-lab-__codelineno-20-9"></a>    <span class="n">users</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#lab06-mcp-workflow-lab-__codelineno-20-10"></a>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#lab06-mcp-workflow-lab-__codelineno-20-11"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#lab06-mcp-workflow-lab-__codelineno-20-12"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">csv_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#lab06-mcp-workflow-lab-__codelineno-20-13"></a>            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#lab06-mcp-workflow-lab-__codelineno-20-14"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#lab06-mcp-workflow-lab-__codelineno-20-15"></a>                <span class="c1"># Load all fields from the CSV</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#lab06-mcp-workflow-lab-__codelineno-20-16"></a>                <span class="n">first_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#lab06-mcp-workflow-lab-__codelineno-20-17"></a>                <span class="n">last_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#lab06-mcp-workflow-lab-__codelineno-20-18"></a>                <span class="n">age</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#lab06-mcp-workflow-lab-__codelineno-20-19"></a>                <span class="n">city</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#lab06-mcp-workflow-lab-__codelineno-20-20"></a>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#lab06-mcp-workflow-lab-__codelineno-20-21"></a>                <span class="c1"># Create full name and content</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#lab06-mcp-workflow-lab-__codelineno-20-22"></a>                <span class="n">full_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">last_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#lab06-mcp-workflow-lab-__codelineno-20-23"></a>                <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">full_name</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">city</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">city</span> <span class="k">else</span> <span class="n">full_name</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#lab06-mcp-workflow-lab-__codelineno-20-24"></a>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#lab06-mcp-workflow-lab-__codelineno-20-25"></a>                <span class="c1"># Create user dict with all available fields</span>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#lab06-mcp-workflow-lab-__codelineno-20-26"></a>                <span class="n">user</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#lab06-mcp-workflow-lab-__codelineno-20-27"></a>                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#lab06-mcp-workflow-lab-__codelineno-20-28"></a>                    <span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="n">first_name</span><span class="p">,</span>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#lab06-mcp-workflow-lab-__codelineno-20-29"></a>                    <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="n">last_name</span><span class="p">,</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#lab06-mcp-workflow-lab-__codelineno-20-30"></a>                    <span class="s2">&quot;full_name&quot;</span><span class="p">:</span> <span class="n">full_name</span><span class="p">,</span>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#lab06-mcp-workflow-lab-__codelineno-20-31"></a>                    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#lab06-mcp-workflow-lab-__codelineno-20-32"></a>                    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="n">age</span><span class="p">,</span>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33" href="#lab06-mcp-workflow-lab-__codelineno-20-33"></a>                    <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="n">city</span>
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34" href="#lab06-mcp-workflow-lab-__codelineno-20-34"></a>                <span class="p">}</span>
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35" href="#lab06-mcp-workflow-lab-__codelineno-20-35"></a>                <span class="n">users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36" href="#lab06-mcp-workflow-lab-__codelineno-20-36"></a>
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37" href="#lab06-mcp-workflow-lab-__codelineno-20-37"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">users</span><span class="p">)</span><span class="si">}</span><span class="s2"> users from CSV.&quot;</span><span class="p">)</span>
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38" href="#lab06-mcp-workflow-lab-__codelineno-20-38"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39" href="#lab06-mcp-workflow-lab-__codelineno-20-39"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading users: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40" href="#lab06-mcp-workflow-lab-__codelineno-20-40"></a>
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41" href="#lab06-mcp-workflow-lab-__codelineno-20-41"></a><span class="c1"># Load the users</span>
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42" href="#lab06-mcp-workflow-lab-__codelineno-20-42"></a><span class="c1"># Make sure you have a &#39;users.csv&#39; file in the same directory</span>
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43" href="#lab06-mcp-workflow-lab-__codelineno-20-43"></a><span class="c1"># Format: first_name,last_name,city,age</span>
</span><span id="__span-20-44"><a id="__codelineno-20-44" name="__codelineno-20-44" href="#lab06-mcp-workflow-lab-__codelineno-20-44"></a><span class="n">load_users</span><span class="p">(</span><span class="s2">&quot;users.csv&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="lab06-mcp-workflow-lab-3-register-the-rag-tools">3. Register the RAG Tool(s)<a class="headerlink" href="#lab06-mcp-workflow-lab-3-register-the-rag-tools" title="Permanent link">&para;</a></h4>
<ul>
<li>Add new tools to your MCP server that allow the agent to query this collection using simple keyword matching.</li>
<li>Here are two example tools: one to filter users by city and another to filter users by age.</li>
<li>Add these tool definitions to the list in your <code>register_tools</code> method (inside the <code>list_tools</code> return array):</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#lab06-mcp-workflow-lab-__codelineno-21-1"></a><span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#lab06-mcp-workflow-lab-__codelineno-21-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;filter_users_by_city&quot;</span><span class="p">,</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#lab06-mcp-workflow-lab-__codelineno-21-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Filter and return users who live in a specific city&quot;</span><span class="p">,</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#lab06-mcp-workflow-lab-__codelineno-21-4"></a>    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#lab06-mcp-workflow-lab-__codelineno-21-5"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#lab06-mcp-workflow-lab-__codelineno-21-6"></a>        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#lab06-mcp-workflow-lab-__codelineno-21-7"></a>            <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#lab06-mcp-workflow-lab-__codelineno-21-8"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#lab06-mcp-workflow-lab-__codelineno-21-9"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The city to filter users by&quot;</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#lab06-mcp-workflow-lab-__codelineno-21-10"></a>            <span class="p">}</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#lab06-mcp-workflow-lab-__codelineno-21-11"></a>        <span class="p">},</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#lab06-mcp-workflow-lab-__codelineno-21-12"></a>        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;city&quot;</span><span class="p">]</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#lab06-mcp-workflow-lab-__codelineno-21-13"></a>    <span class="p">}</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#lab06-mcp-workflow-lab-__codelineno-21-14"></a><span class="p">),</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#lab06-mcp-workflow-lab-__codelineno-21-15"></a><span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#lab06-mcp-workflow-lab-__codelineno-21-16"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;filter_users_by_age&quot;</span><span class="p">,</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#lab06-mcp-workflow-lab-__codelineno-21-17"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Filter and return users who are older than the specified minimum age&quot;</span><span class="p">,</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#lab06-mcp-workflow-lab-__codelineno-21-18"></a>    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#lab06-mcp-workflow-lab-__codelineno-21-19"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#lab06-mcp-workflow-lab-__codelineno-21-20"></a>        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#lab06-mcp-workflow-lab-__codelineno-21-21"></a>            <span class="s2">&quot;min_age&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#lab06-mcp-workflow-lab-__codelineno-21-22"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#lab06-mcp-workflow-lab-__codelineno-21-23"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The minimum age to filter users by&quot;</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#lab06-mcp-workflow-lab-__codelineno-21-24"></a>            <span class="p">}</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#lab06-mcp-workflow-lab-__codelineno-21-25"></a>        <span class="p">},</span>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#lab06-mcp-workflow-lab-__codelineno-21-26"></a>        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;min_age&quot;</span><span class="p">]</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#lab06-mcp-workflow-lab-__codelineno-21-27"></a>    <span class="p">}</span>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#lab06-mcp-workflow-lab-__codelineno-21-28"></a><span class="p">)</span>
</span></code></pre></div>
<ul>
<li>Then add the corresponding handlers in your <code>register_tool_handlers</code> method (inside the <code>call_tool</code> function):</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#lab06-mcp-workflow-lab-__codelineno-22-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;filter_users_by_city&quot;</span><span class="p">:</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#lab06-mcp-workflow-lab-__codelineno-22-2"></a>    <span class="n">city</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#lab06-mcp-workflow-lab-__codelineno-22-3"></a>    <span class="n">filtered_users</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#lab06-mcp-workflow-lab-__codelineno-22-4"></a>    <span class="n">target_city</span> <span class="o">=</span> <span class="n">city</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#lab06-mcp-workflow-lab-__codelineno-22-5"></a>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#lab06-mcp-workflow-lab-__codelineno-22-6"></a>    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#lab06-mcp-workflow-lab-__codelineno-22-7"></a>        <span class="c1"># Get city from user dict</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#lab06-mcp-workflow-lab-__codelineno-22-8"></a>        <span class="n">u_city</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#lab06-mcp-workflow-lab-__codelineno-22-9"></a>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#lab06-mcp-workflow-lab-__codelineno-22-10"></a>        <span class="k">if</span> <span class="n">u_city</span> <span class="o">==</span> <span class="n">target_city</span><span class="p">:</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#lab06-mcp-workflow-lab-__codelineno-22-11"></a>            <span class="n">full_name</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;full_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#lab06-mcp-workflow-lab-__codelineno-22-12"></a>            <span class="n">age</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#lab06-mcp-workflow-lab-__codelineno-22-13"></a>            <span class="n">filtered_users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">full_name</span><span class="si">}</span><span class="s2">, Age: </span><span class="si">{</span><span class="n">age</span><span class="si">}</span><span class="s2">, City: </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;city&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#lab06-mcp-workflow-lab-__codelineno-22-14"></a>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#lab06-mcp-workflow-lab-__codelineno-22-15"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filtered_users</span><span class="p">:</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#lab06-mcp-workflow-lab-__codelineno-22-16"></a>        <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;No users found in </span><span class="si">{</span><span class="n">city</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#lab06-mcp-workflow-lab-__codelineno-22-17"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#lab06-mcp-workflow-lab-__codelineno-22-18"></a>        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filtered_users</span><span class="p">)</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#lab06-mcp-workflow-lab-__codelineno-22-19"></a>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20" href="#lab06-mcp-workflow-lab-__codelineno-22-20"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21" href="#lab06-mcp-workflow-lab-__codelineno-22-21"></a>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22" href="#lab06-mcp-workflow-lab-__codelineno-22-22"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;filter_users_by_age&quot;</span><span class="p">:</span>
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23" href="#lab06-mcp-workflow-lab-__codelineno-22-23"></a>    <span class="n">min_age</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;min_age&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="__span-22-24"><a id="__codelineno-22-24" name="__codelineno-22-24" href="#lab06-mcp-workflow-lab-__codelineno-22-24"></a>    <span class="n">filtered_users</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-22-25"><a id="__codelineno-22-25" name="__codelineno-22-25" href="#lab06-mcp-workflow-lab-__codelineno-22-25"></a>
</span><span id="__span-22-26"><a id="__codelineno-22-26" name="__codelineno-22-26" href="#lab06-mcp-workflow-lab-__codelineno-22-26"></a>    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
</span><span id="__span-22-27"><a id="__codelineno-22-27" name="__codelineno-22-27" href="#lab06-mcp-workflow-lab-__codelineno-22-27"></a>        <span class="c1"># Get age from user dict</span>
</span><span id="__span-22-28"><a id="__codelineno-22-28" name="__codelineno-22-28" href="#lab06-mcp-workflow-lab-__codelineno-22-28"></a>        <span class="n">u_age</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-22-29"><a id="__codelineno-22-29" name="__codelineno-22-29" href="#lab06-mcp-workflow-lab-__codelineno-22-29"></a>
</span><span id="__span-22-30"><a id="__codelineno-22-30" name="__codelineno-22-30" href="#lab06-mcp-workflow-lab-__codelineno-22-30"></a>        <span class="c1"># Skip if no age</span>
</span><span id="__span-22-31"><a id="__codelineno-22-31" name="__codelineno-22-31" href="#lab06-mcp-workflow-lab-__codelineno-22-31"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">u_age</span><span class="p">:</span>
</span><span id="__span-22-32"><a id="__codelineno-22-32" name="__codelineno-22-32" href="#lab06-mcp-workflow-lab-__codelineno-22-32"></a>            <span class="k">continue</span>
</span><span id="__span-22-33"><a id="__codelineno-22-33" name="__codelineno-22-33" href="#lab06-mcp-workflow-lab-__codelineno-22-33"></a>
</span><span id="__span-22-34"><a id="__codelineno-22-34" name="__codelineno-22-34" href="#lab06-mcp-workflow-lab-__codelineno-22-34"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-22-35"><a id="__codelineno-22-35" name="__codelineno-22-35" href="#lab06-mcp-workflow-lab-__codelineno-22-35"></a>            <span class="n">u_age</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">u_age</span><span class="p">)</span>
</span><span id="__span-22-36"><a id="__codelineno-22-36" name="__codelineno-22-36" href="#lab06-mcp-workflow-lab-__codelineno-22-36"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
</span><span id="__span-22-37"><a id="__codelineno-22-37" name="__codelineno-22-37" href="#lab06-mcp-workflow-lab-__codelineno-22-37"></a>            <span class="k">continue</span>
</span><span id="__span-22-38"><a id="__codelineno-22-38" name="__codelineno-22-38" href="#lab06-mcp-workflow-lab-__codelineno-22-38"></a>
</span><span id="__span-22-39"><a id="__codelineno-22-39" name="__codelineno-22-39" href="#lab06-mcp-workflow-lab-__codelineno-22-39"></a>        <span class="k">if</span> <span class="n">u_age</span> <span class="o">&gt;</span> <span class="n">min_age</span><span class="p">:</span>
</span><span id="__span-22-40"><a id="__codelineno-22-40" name="__codelineno-22-40" href="#lab06-mcp-workflow-lab-__codelineno-22-40"></a>            <span class="n">full_name</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;full_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
</span><span id="__span-22-41"><a id="__codelineno-22-41" name="__codelineno-22-41" href="#lab06-mcp-workflow-lab-__codelineno-22-41"></a>            <span class="n">city</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
</span><span id="__span-22-42"><a id="__codelineno-22-42" name="__codelineno-22-42" href="#lab06-mcp-workflow-lab-__codelineno-22-42"></a>            <span class="n">filtered_users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">full_name</span><span class="si">}</span><span class="s2">, Age: </span><span class="si">{</span><span class="n">u_age</span><span class="si">}</span><span class="s2">, City: </span><span class="si">{</span><span class="n">city</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-22-43"><a id="__codelineno-22-43" name="__codelineno-22-43" href="#lab06-mcp-workflow-lab-__codelineno-22-43"></a>
</span><span id="__span-22-44"><a id="__codelineno-22-44" name="__codelineno-22-44" href="#lab06-mcp-workflow-lab-__codelineno-22-44"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filtered_users</span><span class="p">:</span>
</span><span id="__span-22-45"><a id="__codelineno-22-45" name="__codelineno-22-45" href="#lab06-mcp-workflow-lab-__codelineno-22-45"></a>        <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;No users found older than </span><span class="si">{</span><span class="n">min_age</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-22-46"><a id="__codelineno-22-46" name="__codelineno-22-46" href="#lab06-mcp-workflow-lab-__codelineno-22-46"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-22-47"><a id="__codelineno-22-47" name="__codelineno-22-47" href="#lab06-mcp-workflow-lab-__codelineno-22-47"></a>        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filtered_users</span><span class="p">)</span>
</span><span id="__span-22-48"><a id="__codelineno-22-48" name="__codelineno-22-48" href="#lab06-mcp-workflow-lab-__codelineno-22-48"></a>
</span><span id="__span-22-49"><a id="__codelineno-22-49" name="__codelineno-22-49" href="#lab06-mcp-workflow-lab-__codelineno-22-49"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span></code></pre></div>
<h4 id="lab06-mcp-workflow-lab-4-test-the-rag-capabilities">4. Test the RAG Capabilities<a class="headerlink" href="#lab06-mcp-workflow-lab-4-test-the-rag-capabilities" title="Permanent link">&para;</a></h4>
<ol>
<li>Restart your MCP server.</li>
<li>Use the MCP Inspector or Client to call <code>query_users</code> with a question like &ldquo;What is a Pod?&rdquo;.</li>
<li>Verify that the tool returns the specific definition we added to the database.</li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-13-roots">Skeleton 13: Roots<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-13-roots" title="Permanent link">&para;</a></h2>
<hr />
<h2 id="lab06-mcp-workflow-lab-skeleton-14-main-entry-point">Skeleton 14: Main / Entry Point<a class="headerlink" href="#lab06-mcp-workflow-lab-skeleton-14-main-entry-point" title="Permanent link">&para;</a></h2>
<p><strong>What is the Main Entry Point?</strong></p>
<ul>
<li>The main entry point is the starting point of your Python script</li>
<li>It&rsquo;s the function that orchestrates the entire server setup and execution</li>
<li>Think of it like the conductor of an orchestra - it coordinates all the pieces</li>
<li>The <code>main()</code> function calls all setup methods in the correct order</li>
<li>The <code>if __name__ == "__main__"</code> block is what runs when you execute the script directly</li>
<li>Examples: Starts server, initializes components, handles graceful shutdown</li>
<li>Essential for any Python application that needs to run as a standalone program</li>
</ul>
<p><strong>Why This is Important:</strong></p>
<ul>
<li>Ensures all components are initialized in the correct order</li>
<li>Provides a clear execution flow that&rsquo;s easy to understand</li>
<li>Handles errors and graceful shutdown (like Ctrl+C)</li>
<li>Makes your code modular and testable</li>
<li>Standard Python pattern for executable scripts</li>
<li>Without this, your server would just be a collection of classes with no way to run</li>
</ul>
<p><strong>Orchestration Order:</strong></p>
<ol>
<li>Create server instance (constructor)</li>
<li>Register tools</li>
<li>Register tool handlers</li>
<li>Register resources</li>
<li>Register resource handlers</li>
<li>Register prompts</li>
<li>Register prompt handlers</li>
<li>Setup lifecycle handlers</li>
<li>Run the server</li>
</ol>
<hr />
<ul>
<li>Now we need to create the main function that orchestrates everything and the entry point that runs when the script is executed.</li>
<li>This is where we call all the setup methods in order and start the server.</li>
<li>This is the final piece to complete your MCP server implementation.</li>
<li>Let&rsquo;s add the main function and entry point.</li>
</ul>
<hr />
<ul>
<li>Add these functions at the end of your file (outside the class):</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#lab06-mcp-workflow-lab-__codelineno-23-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#lab06-mcp-workflow-lab-__codelineno-23-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#lab06-mcp-workflow-lab-__codelineno-23-3"></a><span class="sd">    Main entry point for the MCP server.</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#lab06-mcp-workflow-lab-__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#lab06-mcp-workflow-lab-__codelineno-23-5"></a><span class="sd">    This function orchestrates the complete server setup and execution:</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#lab06-mcp-workflow-lab-__codelineno-23-6"></a><span class="sd">    1. Creates server instance (constructor)</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#lab06-mcp-workflow-lab-__codelineno-23-7"></a><span class="sd">    2. Registers tools</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#lab06-mcp-workflow-lab-__codelineno-23-8"></a><span class="sd">    3. Registers tool handlers</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#lab06-mcp-workflow-lab-__codelineno-23-9"></a><span class="sd">    4. Registers resources</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#lab06-mcp-workflow-lab-__codelineno-23-10"></a><span class="sd">    5. Registers resource handlers</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#lab06-mcp-workflow-lab-__codelineno-23-11"></a><span class="sd">    6. Registers prompts</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#lab06-mcp-workflow-lab-__codelineno-23-12"></a><span class="sd">    7. Registers prompt handlers</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#lab06-mcp-workflow-lab-__codelineno-23-13"></a><span class="sd">    8. Sets up lifecycle handlers</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#lab06-mcp-workflow-lab-__codelineno-23-14"></a><span class="sd">    9. Runs the server</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#lab06-mcp-workflow-lab-__codelineno-23-15"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#lab06-mcp-workflow-lab-__codelineno-23-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#lab06-mcp-workflow-lab-__codelineno-23-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🌟 COMPLETE MCP SERVER - STARTING&quot;</span><span class="p">)</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#lab06-mcp-workflow-lab-__codelineno-23-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#lab06-mcp-workflow-lab-__codelineno-23-19"></a>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#lab06-mcp-workflow-lab-__codelineno-23-20"></a>    <span class="c1"># Step 1: Create server instance</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#lab06-mcp-workflow-lab-__codelineno-23-21"></a>    <span class="n">server</span> <span class="o">=</span> <span class="n">CompleteMCPServer</span><span class="p">()</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#lab06-mcp-workflow-lab-__codelineno-23-22"></a>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#lab06-mcp-workflow-lab-__codelineno-23-23"></a>    <span class="c1"># Step 2: Register tools</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#lab06-mcp-workflow-lab-__codelineno-23-24"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_tools</span><span class="p">()</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#lab06-mcp-workflow-lab-__codelineno-23-25"></a>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#lab06-mcp-workflow-lab-__codelineno-23-26"></a>    <span class="c1"># Step 3: Register tool handlers</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#lab06-mcp-workflow-lab-__codelineno-23-27"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_tool_handlers</span><span class="p">()</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#lab06-mcp-workflow-lab-__codelineno-23-28"></a>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#lab06-mcp-workflow-lab-__codelineno-23-29"></a>    <span class="c1"># Step 4: Register resources</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#lab06-mcp-workflow-lab-__codelineno-23-30"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_resources</span><span class="p">()</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#lab06-mcp-workflow-lab-__codelineno-23-31"></a>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#lab06-mcp-workflow-lab-__codelineno-23-32"></a>    <span class="c1"># Step 5: Register resource handlers</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#lab06-mcp-workflow-lab-__codelineno-23-33"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_resource_handlers</span><span class="p">()</span>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34" href="#lab06-mcp-workflow-lab-__codelineno-23-34"></a>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35" href="#lab06-mcp-workflow-lab-__codelineno-23-35"></a>    <span class="c1"># Step 6: Register prompts</span>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36" href="#lab06-mcp-workflow-lab-__codelineno-23-36"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_prompts</span><span class="p">()</span>
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37" href="#lab06-mcp-workflow-lab-__codelineno-23-37"></a>
</span><span id="__span-23-38"><a id="__codelineno-23-38" name="__codelineno-23-38" href="#lab06-mcp-workflow-lab-__codelineno-23-38"></a>    <span class="c1"># Step 7: Register prompt handlers</span>
</span><span id="__span-23-39"><a id="__codelineno-23-39" name="__codelineno-23-39" href="#lab06-mcp-workflow-lab-__codelineno-23-39"></a>    <span class="n">server</span><span class="o">.</span><span class="n">register_prompt_handlers</span><span class="p">()</span>
</span><span id="__span-23-40"><a id="__codelineno-23-40" name="__codelineno-23-40" href="#lab06-mcp-workflow-lab-__codelineno-23-40"></a>
</span><span id="__span-23-41"><a id="__codelineno-23-41" name="__codelineno-23-41" href="#lab06-mcp-workflow-lab-__codelineno-23-41"></a>    <span class="c1"># Step 8: Setup lifecycle handlers</span>
</span><span id="__span-23-42"><a id="__codelineno-23-42" name="__codelineno-23-42" href="#lab06-mcp-workflow-lab-__codelineno-23-42"></a>    <span class="n">server</span><span class="o">.</span><span class="n">setup_lifecycle_handlers</span><span class="p">()</span>
</span><span id="__span-23-43"><a id="__codelineno-23-43" name="__codelineno-23-43" href="#lab06-mcp-workflow-lab-__codelineno-23-43"></a>
</span><span id="__span-23-44"><a id="__codelineno-23-44" name="__codelineno-23-44" href="#lab06-mcp-workflow-lab-__codelineno-23-44"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
</span><span id="__span-23-45"><a id="__codelineno-23-45" name="__codelineno-23-45" href="#lab06-mcp-workflow-lab-__codelineno-23-45"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All components registered successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-23-46"><a id="__codelineno-23-46" name="__codelineno-23-46" href="#lab06-mcp-workflow-lab-__codelineno-23-46"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
</span><span id="__span-23-47"><a id="__codelineno-23-47" name="__codelineno-23-47" href="#lab06-mcp-workflow-lab-__codelineno-23-47"></a>
</span><span id="__span-23-48"><a id="__codelineno-23-48" name="__codelineno-23-48" href="#lab06-mcp-workflow-lab-__codelineno-23-48"></a>    <span class="c1"># Step 9: Run the server</span>
</span><span id="__span-23-49"><a id="__codelineno-23-49" name="__codelineno-23-49" href="#lab06-mcp-workflow-lab-__codelineno-23-49"></a>    <span class="k">await</span> <span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="__span-23-50"><a id="__codelineno-23-50" name="__codelineno-23-50" href="#lab06-mcp-workflow-lab-__codelineno-23-50"></a>
</span><span id="__span-23-51"><a id="__codelineno-23-51" name="__codelineno-23-51" href="#lab06-mcp-workflow-lab-__codelineno-23-51"></a>
</span><span id="__span-23-52"><a id="__codelineno-23-52" name="__codelineno-23-52" href="#lab06-mcp-workflow-lab-__codelineno-23-52"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-23-53"><a id="__codelineno-23-53" name="__codelineno-23-53" href="#lab06-mcp-workflow-lab-__codelineno-23-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-23-54"><a id="__codelineno-23-54" name="__codelineno-23-54" href="#lab06-mcp-workflow-lab-__codelineno-23-54"></a><span class="sd">    Entry point when script is run directly.</span>
</span><span id="__span-23-55"><a id="__codelineno-23-55" name="__codelineno-23-55" href="#lab06-mcp-workflow-lab-__codelineno-23-55"></a>
</span><span id="__span-23-56"><a id="__codelineno-23-56" name="__codelineno-23-56" href="#lab06-mcp-workflow-lab-__codelineno-23-56"></a><span class="sd">    This runs when you execute: python mcp_server.py</span>
</span><span id="__span-23-57"><a id="__codelineno-23-57" name="__codelineno-23-57" href="#lab06-mcp-workflow-lab-__codelineno-23-57"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-23-58"><a id="__codelineno-23-58" name="__codelineno-23-58" href="#lab06-mcp-workflow-lab-__codelineno-23-58"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-23-59"><a id="__codelineno-23-59" name="__codelineno-23-59" href="#lab06-mcp-workflow-lab-__codelineno-23-59"></a>        <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span><span id="__span-23-60"><a id="__codelineno-23-60" name="__codelineno-23-60" href="#lab06-mcp-workflow-lab-__codelineno-23-60"></a>    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="__span-23-61"><a id="__codelineno-23-61" name="__codelineno-23-61" href="#lab06-mcp-workflow-lab-__codelineno-23-61"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">👋 Server shutdown complete&quot;</span><span class="p">)</span>
</span><span id="__span-23-62"><a id="__codelineno-23-62" name="__codelineno-23-62" href="#lab06-mcp-workflow-lab-__codelineno-23-62"></a>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<p><strong>What&rsquo;s Happening:</strong></p>
<ul>
<li>The <code>main()</code> function calls all setup methods in order</li>
<li>The <code>if __name__ == "__main__"</code> block runs when the script is executed</li>
<li><code>asyncio.run(main())</code> starts the async event loop</li>
<li><code>KeyboardInterrupt</code> handler allows graceful shutdown with Ctrl+C</li>
<li>This is the final orchestration of the MCP server</li>
</ul>
<hr />
<h4 id="lab06-mcp-workflow-lab-code-review">Code Review<a class="headerlink" href="#lab06-mcp-workflow-lab-code-review" title="Permanent link">&para;</a></h4>
<p>At this point, your <code>mcp_server.py</code> file should have:</p>
<ol>
<li>All imports at the top</li>
<li><code>CompleteMCPServer</code> class with all 9 methods</li>
<li><code>main()</code> function</li>
<li>Entry point with <code>if __name__ == "__main__"</code></li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-testing-with-mcp-inspector">Testing with MCP Inspector<a class="headerlink" href="#lab06-mcp-workflow-lab-testing-with-mcp-inspector" title="Permanent link">&para;</a></h2>
<ul>
<li>Now that you&rsquo;ve built your complete MCP server, it&rsquo;s time to test it!</li>
<li>We&rsquo;ll use MCP Inspector, a web-based tool for debugging MCP servers.</li>
<li>Follow the steps below to install MCP Inspector, run your server, and test all the tools, resources, and prompts you implemented.</li>
</ul>
<h3 id="lab06-mcp-workflow-lab-what-is-mcp-inspector">What is MCP Inspector?<a class="headerlink" href="#lab06-mcp-workflow-lab-what-is-mcp-inspector" title="Permanent link">&para;</a></h3>
<p>MCP Inspector is a web-based debugging tool for MCP servers. Think of it like a browser developer console for your MCP server - it lets you:</p>
<ul>
<li>Connect to your server</li>
<li>See all available tools, resources, and prompts</li>
<li>Execute tools with custom parameters</li>
<li>Read resources</li>
<li>Generate prompts</li>
<li>View JSON-RPC messages</li>
<li>Debug server behavior</li>
</ul>
<h3 id="lab06-mcp-workflow-lab-installing-mcp-inspector">Installing MCP Inspector<a class="headerlink" href="#lab06-mcp-workflow-lab-installing-mcp-inspector" title="Permanent link">&para;</a></h3>
<p>Open a terminal and run:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#lab06-mcp-workflow-lab-__codelineno-24-1"></a><span class="c1"># Install MCP Inspector globally</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#lab06-mcp-workflow-lab-__codelineno-24-2"></a>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>@modelcontextprotocol/inspector
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#lab06-mcp-workflow-lab-__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#lab06-mcp-workflow-lab-__codelineno-24-4"></a><span class="c1"># Run the MCP Inspector</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#lab06-mcp-workflow-lab-__codelineno-24-5"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>python3<span class="w"> </span><span class="s2">&quot;mcp_server.py&quot;</span>
</span></code></pre></div>
<hr />
<h3 id="lab06-mcp-workflow-lab-testing-your-tools">Testing Your Tools<a class="headerlink" href="#lab06-mcp-workflow-lab-testing-your-tools" title="Permanent link">&para;</a></h3>
<p>Follow these steps in the MCP Inspector:</p>
<h2 id="lab06-mcp-workflow-lab-test-01-connect-to-the-server">Test 01: Connect to the Server<a class="headerlink" href="#lab06-mcp-workflow-lab-test-01-connect-to-the-server" title="Permanent link">&para;</a></h2>
<ol>
<li>Click the <strong>&ldquo;Connect&rdquo;</strong> button at the bottom left of the interface</li>
<li>Wait for the connection status to show &ldquo;Connected&rdquo; (green indicator)</li>
<li>If not connected, set the following:</li>
<li>transport: <code>stdio</code></li>
<li>Command: <code>python3</code></li>
<li>Arguments: <code>mcp_server.py</code></li>
<li>Click <strong>&ldquo;Connect&rdquo;</strong> again</li>
<li>You should see the server name and version in the top right corner</li>
<li>Success!</li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-test-02-explore-tools">Test 02: Explore Tools<a class="headerlink" href="#lab06-mcp-workflow-lab-test-02-explore-tools" title="Permanent link">&para;</a></h2>
<ol>
<li>Click the <strong>&ldquo;Tools&rdquo;</strong> tab in the upper menu</li>
<li>Click <strong>&ldquo;List tools&rdquo;</strong> to see all available tools</li>
<li>You should see: <code>calculate</code>, <code>store_data</code>, <code>retrieve_data</code>, <code>echo</code> + RAG tools if added</li>
<li>If you added the <code>greeting</code> tool, you should see that too!</li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-test-03-test-the-calculate-tool">Test 03: Test the Calculate Tool<a class="headerlink" href="#lab06-mcp-workflow-lab-test-03-test-the-calculate-tool" title="Permanent link">&para;</a></h2>
<ol>
<li>Click on <strong>&ldquo;calculate&rdquo;</strong> in the tools list</li>
<li>The tool interface opens on the right side</li>
<li>Fill in the parameters:</li>
<li><strong>operation</strong>: Select &ldquo;add&rdquo; from the dropdown<ul>
<li><strong>a</strong>: Enter <code>10</code></li>
<li><strong>b</strong>: Enter <code>5</code></li>
</ul>
</li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
<li>Scroll down to see the result: <code>"Result: 10 add 5 = 15"</code></li>
<li>Success!</li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-test-04-test-the-store-data-tool">Test 04: Test the Store Data Tool<a class="headerlink" href="#lab06-mcp-workflow-lab-test-04-test-the-store-data-tool" title="Permanent link">&para;</a></h2>
<ol>
<li>Click on <strong>&ldquo;store_data&rdquo;</strong> in the tools list</li>
<li>Fill in the parameters:</li>
<li><strong>key</strong>: Enter <code>username</code></li>
<li><strong>value</strong>: Enter <code>Alice</code></li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
<li>Result: <code>"Stored: username = Alice"</code></li>
<li>Try storing another key-value pair to see it works!</li>
<li>Success!</li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-test-05-test-the-retrieve-data-tool">Test 05: Test the Retrieve Data Tool<a class="headerlink" href="#lab06-mcp-workflow-lab-test-05-test-the-retrieve-data-tool" title="Permanent link">&para;</a></h2>
<ol>
<li>Click on <strong>&ldquo;retrieve_data&rdquo;</strong> in the tools list</li>
<li>Fill in the parameter:</li>
<li><strong>key</strong>: Enter <code>username</code></li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
<li>Result: <code>"Retrieved: username = Alice"</code></li>
<li>Try retrieving a non-existent key to see error handling!</li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-test-06-test-the-echo-tool">Test 06: Test the Echo Tool<a class="headerlink" href="#lab06-mcp-workflow-lab-test-06-test-the-echo-tool" title="Permanent link">&para;</a></h2>
<ol>
<li>Click on <strong>&ldquo;echo&rdquo;</strong> in the tools list</li>
<li>Fill in the parameter:</li>
<li><strong>text</strong>: Enter <code>Hello, MCP World!</code></li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
<li>Result: <code>"Echo: Hello, MCP World!"</code></li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-test-07-test-resources">Test 07: Test Resources<a class="headerlink" href="#lab06-mcp-workflow-lab-test-07-test-resources" title="Permanent link">&para;</a></h2>
<ol>
<li>Click the <strong>&ldquo;Resources&rdquo;</strong> tab in the upper menu</li>
<li>Click <strong>&ldquo;List resources&rdquo;</strong> to see all available resources</li>
<li>You should see: <code>server-info</code>, <code>data-store</code>, <code>welcome</code></li>
<li>If you added the <code>server-author</code> resource, you should see that too!</li>
</ol>
<h4 id="lab06-mcp-workflow-lab-test-resource-server-info">Test Resource: server-info<a class="headerlink" href="#lab06-mcp-workflow-lab-test-resource-server-info" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;resource://server-info&rdquo;</strong></li>
<li>View the JSON response showing server metadata</li>
<li>Notice it shows 4 tools, 3 resources, 2 prompts</li>
</ol>
<h4 id="lab06-mcp-workflow-lab-test-resource-data-store">Test Resource: data-store<a class="headerlink" href="#lab06-mcp-workflow-lab-test-resource-data-store" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;resource://data-store&rdquo;</strong></li>
<li>View the current contents of the data store</li>
<li>You should see the <code>username: Alice</code> you stored earlier!</li>
</ol>
<h4 id="lab06-mcp-workflow-lab-test-resource-welcome">Test Resource: welcome<a class="headerlink" href="#lab06-mcp-workflow-lab-test-resource-welcome" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;resource://welcome&rdquo;</strong></li>
<li>View the welcome message explaining server capabilities</li>
<li>If you added the <code>server-author</code> resource, click on it to see your name displayed</li>
<li>Success!</li>
</ol>
<hr />
<h2 id="lab06-mcp-workflow-lab-test-08-testing-your-prompts">Test 08: Testing Your Prompts<a class="headerlink" href="#lab06-mcp-workflow-lab-test-08-testing-your-prompts" title="Permanent link">&para;</a></h2>
<ol>
<li>Click the <strong>&ldquo;Prompts&rdquo;</strong> tab in the upper menu</li>
<li>Click <strong>&ldquo;List prompts&rdquo;</strong> to see all available prompts</li>
<li>You should see: <code>analyze-data</code>, <code>calculate-scenario</code></li>
</ol>
<h4 id="lab06-mcp-workflow-lab-test-prompt-calculate-scenario">Test Prompt: calculate-scenario<a class="headerlink" href="#lab06-mcp-workflow-lab-test-prompt-calculate-scenario" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;calculate-scenario&rdquo;</strong></li>
<li>Fill in the argument:</li>
<li><strong>operation</strong>: Enter <code>multiply</code></li>
<li>Click <strong>&ldquo;Get Prompt&rdquo;</strong></li>
<li>View the generated prompt that explains how to use the calculate tool</li>
</ol>
<h4 id="lab06-mcp-workflow-lab-test-prompt-analyze-data">Test Prompt: analyze-data<a class="headerlink" href="#lab06-mcp-workflow-lab-test-prompt-analyze-data" title="Permanent link">&para;</a></h4>
<ol>
<li>Click on <strong>&ldquo;analyze-data&rdquo;</strong></li>
<li>Fill in the argument:</li>
<li><strong>key</strong>: Enter <code>username</code></li>
<li>Click <strong>&ldquo;Get Prompt&rdquo;</strong></li>
<li>View the generated prompt that analyzes the stored data</li>
</ol>
<hr />
<h3 id="lab06-mcp-workflow-lab-understanding-the-inspector-interface">Understanding the Inspector Interface<a class="headerlink" href="#lab06-mcp-workflow-lab-understanding-the-inspector-interface" title="Permanent link">&para;</a></h3>
<p><strong>Left Panel: Navigation</strong></p>
<ul>
<li>Tools, Resources, Prompts tabs</li>
<li>List and select items to test</li>
</ul>
<p><strong>Right Panel: Details</strong></p>
<ul>
<li>Shows selected item details</li>
<li>Input forms for parameters</li>
<li>Execute button</li>
<li>Results display</li>
</ul>
<p><strong>Bottom Panel: JSON-RPC Messages</strong></p>
<ul>
<li>Shows raw protocol messages</li>
<li>Useful for debugging</li>
<li>See requests and responses</li>
</ul>
<p><strong>Connection Status</strong></p>
<ul>
<li>Top right corner</li>
<li>Green = Connected</li>
<li>Red = Disconnected</li>
<li>Shows server name and version</li>
</ul>
<hr />
<h2 id="lab06-mcp-workflow-lab-advanced-experiments">Advanced Experiments<a class="headerlink" href="#lab06-mcp-workflow-lab-advanced-experiments" title="Permanent link">&para;</a></h2>
<ul>
<li>Now that you have a working server, try these challenges:</li>
</ul>
<h3 id="lab06-mcp-workflow-lab-challenge-1-modify-the-calculate-tool">Challenge 1: Modify the Calculate Tool<a class="headerlink" href="#lab06-mcp-workflow-lab-challenge-1-modify-the-calculate-tool" title="Permanent link">&para;</a></h3>
<p>Add support for:</p>
<ul>
<li><code>power</code> operation (a^b)</li>
<li><code>modulus</code> operation (a % b)</li>
</ul>
<h3 id="lab06-mcp-workflow-lab-challenge-2-add-roots">Challenge 2: Add Roots<a class="headerlink" href="#lab06-mcp-workflow-lab-challenge-2-add-roots" title="Permanent link">&para;</a></h3>
<p>Add support for:</p>
<ul>
<li>Listing files in a directory (referencing client roots)</li>
<li>Reading file contents (referencing client roots)</li>
</ul>
<hr />
<h2 id="lab06-mcp-workflow-lab-bonus-task-hands-on-exercise">Bonus Task: Hands-On Exercise<a class="headerlink" href="#lab06-mcp-workflow-lab-bonus-task-hands-on-exercise" title="Permanent link">&para;</a></h2>
<h3 id="lab06-mcp-workflow-lab-add-pagination-support-for-listing-users">Add Pagination Support for Listing Users<a class="headerlink" href="#lab06-mcp-workflow-lab-add-pagination-support-for-listing-users" title="Permanent link">&para;</a></h3>
<p><strong>Objective:</strong> Implement a new tool called <code>list_all_users</code> that returns all users with pagination support.</p>
<p><strong>Requirements:</strong></p>
<ol>
<li><strong>Tool Name:</strong> <code>list_all_users</code></li>
<li><strong>Parameters:</strong></li>
<li><code>page</code> (optional, default: 1) - The page number to retrieve</li>
<li><code>per_page</code> (optional, default: 10) - Number of users per page</li>
<li><strong>Functionality:</strong></li>
<li>Return users for the specified page</li>
<li>Include metadata: total users, total pages, current page</li>
<li>Handle edge cases (invalid page numbers, empty results)</li>
</ol>
<p><strong>Your Task:</strong></p>
<ol>
<li>Add the tool definition to <code>register_tools()</code> method</li>
<li>Implement the tool handler in <code>register_tool_handlers()</code> method</li>
<li>Test your implementation using MCP Inspector</li>
</ol>
<p><strong>Hints:</strong></p>
<ul>
<li>Use Python&rsquo;s list slicing for pagination: <code>users[start:end]</code></li>
<li>Calculate start index: <code>(page - 1) * per_page</code></li>
<li>Calculate total pages: <code>math.ceil(len(users) / per_page)</code></li>
<li>Return both the user list and metadata</li>
</ul>
<hr />
<h3 id="lab06-mcp-workflow-lab-walkthrough-solution">Walkthrough Solution<a class="headerlink" href="#lab06-mcp-workflow-lab-walkthrough-solution" title="Permanent link">&para;</a></h3>
<h4 id="lab06-mcp-workflow-lab-step-1-add-tool-definition">Step 1: Add Tool Definition<a class="headerlink" href="#lab06-mcp-workflow-lab-step-1-add-tool-definition" title="Permanent link">&para;</a></h4>
<details>
<summary>Click here for the solution</summary>

Add this to your `register_tools()` method in the tools list:

<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#lab06-mcp-workflow-lab-__codelineno-25-1"></a><span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#lab06-mcp-workflow-lab-__codelineno-25-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;list_all_users&quot;</span><span class="p">,</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#lab06-mcp-workflow-lab-__codelineno-25-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;List all users with pagination support&quot;</span><span class="p">,</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#lab06-mcp-workflow-lab-__codelineno-25-4"></a>    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#lab06-mcp-workflow-lab-__codelineno-25-5"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#lab06-mcp-workflow-lab-__codelineno-25-6"></a>        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#lab06-mcp-workflow-lab-__codelineno-25-7"></a>            <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#lab06-mcp-workflow-lab-__codelineno-25-8"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#lab06-mcp-workflow-lab-__codelineno-25-9"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Page number (default: 1)&quot;</span><span class="p">,</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#lab06-mcp-workflow-lab-__codelineno-25-10"></a>                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">1</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#lab06-mcp-workflow-lab-__codelineno-25-11"></a>            <span class="p">},</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#lab06-mcp-workflow-lab-__codelineno-25-12"></a>            <span class="s2">&quot;per_page&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#lab06-mcp-workflow-lab-__codelineno-25-13"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#lab06-mcp-workflow-lab-__codelineno-25-14"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Number of users per page (default: 10)&quot;</span><span class="p">,</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#lab06-mcp-workflow-lab-__codelineno-25-15"></a>                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">10</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#lab06-mcp-workflow-lab-__codelineno-25-16"></a>            <span class="p">}</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#lab06-mcp-workflow-lab-__codelineno-25-17"></a>        <span class="p">}</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#lab06-mcp-workflow-lab-__codelineno-25-18"></a>    <span class="p">}</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#lab06-mcp-workflow-lab-__codelineno-25-19"></a><span class="p">)</span>
</span></code></pre></div>

</details>

<hr />
<h4 id="lab06-mcp-workflow-lab-step-2-add-tool-handler">Step 2: Add Tool Handler<a class="headerlink" href="#lab06-mcp-workflow-lab-step-2-add-tool-handler" title="Permanent link">&para;</a></h4>
<details>
<summary>Click here for the solution</summary>

Add this to your `register_tool_handlers()` method in the `call_tool` function:

    <div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#lab06-mcp-workflow-lab-__codelineno-26-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;list_all_users&quot;</span><span class="p">:</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#lab06-mcp-workflow-lab-__codelineno-26-2"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#lab06-mcp-workflow-lab-__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#lab06-mcp-workflow-lab-__codelineno-26-4"></a>    <span class="c1"># Get pagination parameters</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#lab06-mcp-workflow-lab-__codelineno-26-5"></a>    <span class="n">page</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;page&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#lab06-mcp-workflow-lab-__codelineno-26-6"></a>    <span class="n">per_page</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;per_page&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#lab06-mcp-workflow-lab-__codelineno-26-7"></a>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#lab06-mcp-workflow-lab-__codelineno-26-8"></a>    <span class="c1"># Validate parameters</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#lab06-mcp-workflow-lab-__codelineno-26-9"></a>    <span class="k">if</span> <span class="n">page</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#lab06-mcp-workflow-lab-__codelineno-26-10"></a>        <span class="n">page</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#lab06-mcp-workflow-lab-__codelineno-26-11"></a>    <span class="k">if</span> <span class="n">per_page</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#lab06-mcp-workflow-lab-__codelineno-26-12"></a>        <span class="n">per_page</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#lab06-mcp-workflow-lab-__codelineno-26-13"></a>    <span class="k">if</span> <span class="n">per_page</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>  <span class="c1"># Max limit</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#lab06-mcp-workflow-lab-__codelineno-26-14"></a>        <span class="n">per_page</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#lab06-mcp-workflow-lab-__codelineno-26-15"></a>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#lab06-mcp-workflow-lab-__codelineno-26-16"></a>    <span class="c1"># Calculate pagination</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#lab06-mcp-workflow-lab-__codelineno-26-17"></a>    <span class="n">total_users</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">users</span><span class="p">)</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#lab06-mcp-workflow-lab-__codelineno-26-18"></a>    <span class="n">total_pages</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">total_users</span> <span class="o">/</span> <span class="n">per_page</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_users</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#lab06-mcp-workflow-lab-__codelineno-26-19"></a>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#lab06-mcp-workflow-lab-__codelineno-26-20"></a>    <span class="c1"># Ensure page doesn&#39;t exceed total pages</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#lab06-mcp-workflow-lab-__codelineno-26-21"></a>    <span class="k">if</span> <span class="n">page</span> <span class="o">&gt;</span> <span class="n">total_pages</span><span class="p">:</span>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#lab06-mcp-workflow-lab-__codelineno-26-22"></a>        <span class="n">page</span> <span class="o">=</span> <span class="n">total_pages</span>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#lab06-mcp-workflow-lab-__codelineno-26-23"></a>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#lab06-mcp-workflow-lab-__codelineno-26-24"></a>    <span class="c1"># Calculate slice indices</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#lab06-mcp-workflow-lab-__codelineno-26-25"></a>    <span class="n">start_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">per_page</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#lab06-mcp-workflow-lab-__codelineno-26-26"></a>    <span class="n">end_idx</span> <span class="o">=</span> <span class="n">start_idx</span> <span class="o">+</span> <span class="n">per_page</span>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#lab06-mcp-workflow-lab-__codelineno-26-27"></a>
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28" href="#lab06-mcp-workflow-lab-__codelineno-26-28"></a>    <span class="c1"># Get paginated users</span>
</span><span id="__span-26-29"><a id="__codelineno-26-29" name="__codelineno-26-29" href="#lab06-mcp-workflow-lab-__codelineno-26-29"></a>    <span class="n">paginated_users</span> <span class="o">=</span> <span class="n">users</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
</span><span id="__span-26-30"><a id="__codelineno-26-30" name="__codelineno-26-30" href="#lab06-mcp-workflow-lab-__codelineno-26-30"></a>
</span><span id="__span-26-31"><a id="__codelineno-26-31" name="__codelineno-26-31" href="#lab06-mcp-workflow-lab-__codelineno-26-31"></a>    <span class="c1"># Format output</span>
</span><span id="__span-26-32"><a id="__codelineno-26-32" name="__codelineno-26-32" href="#lab06-mcp-workflow-lab-__codelineno-26-32"></a>    <span class="n">user_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-26-33"><a id="__codelineno-26-33" name="__codelineno-26-33" href="#lab06-mcp-workflow-lab-__codelineno-26-33"></a>    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">paginated_users</span><span class="p">:</span>
</span><span id="__span-26-34"><a id="__codelineno-26-34" name="__codelineno-26-34" href="#lab06-mcp-workflow-lab-__codelineno-26-34"></a>        <span class="n">full_name</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;full_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
</span><span id="__span-26-35"><a id="__codelineno-26-35" name="__codelineno-26-35" href="#lab06-mcp-workflow-lab-__codelineno-26-35"></a>        <span class="n">age</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
</span><span id="__span-26-36"><a id="__codelineno-26-36" name="__codelineno-26-36" href="#lab06-mcp-workflow-lab-__codelineno-26-36"></a>        <span class="n">city</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
</span><span id="__span-26-37"><a id="__codelineno-26-37" name="__codelineno-26-37" href="#lab06-mcp-workflow-lab-__codelineno-26-37"></a>        <span class="n">user_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">full_name</span><span class="si">}</span><span class="s2">, Age: </span><span class="si">{</span><span class="n">age</span><span class="si">}</span><span class="s2">, City: </span><span class="si">{</span><span class="n">city</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-26-38"><a id="__codelineno-26-38" name="__codelineno-26-38" href="#lab06-mcp-workflow-lab-__codelineno-26-38"></a>
</span><span id="__span-26-39"><a id="__codelineno-26-39" name="__codelineno-26-39" href="#lab06-mcp-workflow-lab-__codelineno-26-39"></a>    <span class="c1"># Build result with metadata</span>
</span><span id="__span-26-40"><a id="__codelineno-26-40" name="__codelineno-26-40" href="#lab06-mcp-workflow-lab-__codelineno-26-40"></a>    <span class="n">metadata</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Page </span><span class="si">{</span><span class="n">page</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">total_pages</span><span class="si">}</span><span class="s2"> | Total Users: </span><span class="si">{</span><span class="n">total_users</span><span class="si">}</span><span class="s2"> | Showing: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">paginated_users</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-26-41"><a id="__codelineno-26-41" name="__codelineno-26-41" href="#lab06-mcp-workflow-lab-__codelineno-26-41"></a>    <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metadata</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">user_list</span><span class="p">)</span>
</span><span id="__span-26-42"><a id="__codelineno-26-42" name="__codelineno-26-42" href="#lab06-mcp-workflow-lab-__codelineno-26-42"></a>
</span><span id="__span-26-43"><a id="__codelineno-26-43" name="__codelineno-26-43" href="#lab06-mcp-workflow-lab-__codelineno-26-43"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span></code></pre></div>

</details>

<hr />
<h3 id="lab06-mcp-workflow-lab-step-3-test-in-mcp-inspector">Step 3: Test in MCP Inspector<a class="headerlink" href="#lab06-mcp-workflow-lab-step-3-test-in-mcp-inspector" title="Permanent link">&para;</a></h3>
<ol>
<li>Restart your MCP server</li>
<li>Open MCP Inspector</li>
<li>Go to the <strong>Tools</strong> tab</li>
<li>Click on <strong>&ldquo;list_all_users&rdquo;</strong></li>
<li>Test with different parameters:</li>
<li>Default (page: 1, per_page: 10)</li>
<li>Page 2 with 5 users per page</li>
<li>Page 5 with 20 users per page</li>
</ol>
<p><strong>Expected Output Format:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#lab06-mcp-workflow-lab-__codelineno-27-1"></a>Page 1 of 10 | Total Users: 100 | Showing: 10
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#lab06-mcp-workflow-lab-__codelineno-27-2"></a>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#lab06-mcp-workflow-lab-__codelineno-27-3"></a>User 1: James Smith, Age: 24, City: New York
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#lab06-mcp-workflow-lab-__codelineno-27-4"></a>User 2: Maria Garcia, Age: 31, City: Los Angeles
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#lab06-mcp-workflow-lab-__codelineno-27-5"></a>...
</span></code></pre></div>
</details>
<hr />
<h2 id="lab06-mcp-workflow-lab-congratulations">Congratulations! 🎉<a class="headerlink" href="#lab06-mcp-workflow-lab-congratulations" title="Permanent link">&para;</a></h2>
<p>You&rsquo;ve successfully built a complete MCP server with:</p>
<ul>
<li>Multiple tools (calculate, data storage, echo, user filters, pagination)</li>
<li>Resources (server info, data store, welcome message)</li>
<li>Prompts (data analysis, calculation scenarios)</li>
<li>RAG capabilities (user filtering and search)</li>
<li>Pagination support (bonus feature)</li>
</ul>
<p>Keep exploring and building more advanced MCP servers!</p></section><section class="print-page" id="lab07-mcp-ollama-lab" heading-number="2.9"><h1 id="lab07-mcp-ollama-lab-complete-mcp-server-with-ollama-integration-hands-on-lab">Complete MCP Server with Ollama Integration - Hands-On Lab<a class="headerlink" href="#lab07-mcp-ollama-lab-complete-mcp-server-with-ollama-integration-hands-on-lab" title="Permanent link">&para;</a></h1>
<h2 id="lab07-mcp-ollama-lab-lab-objective">Lab Objective<a class="headerlink" href="#lab07-mcp-ollama-lab-lab-objective" title="Permanent link">&para;</a></h2>
<ul>
<li>In this hands-on lab, you&rsquo;ll build a complete MCP (Model Context Protocol) server from scratch with Ollama integration.</li>
<li>You&rsquo;ll learn how each component works by implementing it yourself, understanding why each piece is necessary, and seeing the complete architecture come together.</li>
<li>You&rsquo;ll implement advanced tools: Country Information with RAG (Retrieval-Augmented Generation) using separate CSV-based databases for different information types covering all 193 UN member states, File Operations, and Database Query, along with best practices for error handling, async operations, and tool composition.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Important Instructions</p>
<ul>
<li>This lab is designed to be followed step-by-step.</li>
<li>Each code block builds upon the previous ones.</li>
<li>Do not copy all code blocks at once, as this may lead to duplicate methods or incorrect structure.</li>
<li>Follow the instructions sequentially, updating existing code as indicated.</li>
</ul>
</div>
<hr />
<h2 id="lab07-mcp-ollama-lab-prerequisites">Prerequisites<a class="headerlink" href="#lab07-mcp-ollama-lab-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li><code>Python 3.10</code> or higher installed</li>
<li><code>Ollama</code> installed and running locally with models available (e.g., llama3.2)</li>
<li>Basic knowledge of <code>MCP</code> concepts</li>
<li>Basic understanding of <code>REST APIs</code> and <code>JSON</code></li>
<li>Familiarity with <code>CSV</code> files and data handling</li>
<li>Basic understanding of <code>Python</code> programming</li>
<li>Terminal / command line (<code>CLI</code>) access</li>
<li>Text editor or IDE (<code>VS Code</code> is recommended)</li>
</ul>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-00-getting-started">Step 00: Getting Started<a class="headerlink" href="#lab07-mcp-ollama-lab-step-00-getting-started" title="Permanent link">&para;</a></h2>
<ol>
<li>Create a new file called <code>mcp_ollama.py</code> as your project file, inside the lab&rsquo;s directory.</li>
<li>Open it in your chosen text editor.</li>
<li>
<p>See the following CSV files, containing data of all 193 UN member states, have been created for you in the lab&rsquo;s directory (you can open these files in VSCode etc.):</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Columns</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>capitals.csv</code></td>
<td><code>country</code>, <code>capital</code></td>
<td>Capital cities of countries</td>
</tr>
<tr>
<td><code>population.csv</code></td>
<td><code>country</code>, <code>population</code></td>
<td>Population data</td>
</tr>
<tr>
<td><code>height.csv</code></td>
<td><code>country</code>, <code>height</code></td>
<td>Average topographic height in meters</td>
</tr>
<tr>
<td><code>foundation_year.csv</code></td>
<td><code>country</code>, <code>foundation_year</code></td>
<td>Year the country was founded</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Important:</strong> Ensure all CSV files are in the same directory as your <code>mcp_ollama.py</code> file, as the code loads them from the current working directory.</p>
</li>
<li>
<p>Create a file named <code>requirements.txt</code> with the following content, inside the lab’s directory:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab07-mcp-ollama-lab-__codelineno-0-1"></a>mcp&gt;=0.1.0
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab07-mcp-ollama-lab-__codelineno-0-2"></a>ollama&gt;=0.1.0
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab07-mcp-ollama-lab-__codelineno-0-3"></a>pandas&gt;=1.3.0
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab07-mcp-ollama-lab-__codelineno-0-4"></a>requests&gt;=2.25.0
</span></code></pre></div>
</li>
<li>
<p>Install the dependencies by running the following from the same directory as your <code>requirements.txt</code> file, inside the lab’s directory:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab07-mcp-ollama-lab-__codelineno-1-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span></code></pre></div>
</li>
</ol>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-01-adding-imports">Step 01: Adding Imports<a class="headerlink" href="#lab07-mcp-ollama-lab-step-01-adding-imports" title="Permanent link">&para;</a></h2>
<ul>
<li>Before we write any code, we need to understand which Python libraries we&rsquo;ll be using, and why.</li>
</ul>
<h3 id="lab07-mcp-ollama-lab-asyncio-asynchronous-io"><code>asyncio</code> - Asynchronous I/O<a class="headerlink" href="#lab07-mcp-ollama-lab-asyncio-asynchronous-io" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">asyncio</p>
<h4 id="lab07-mcp-ollama-lab-definition">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition" title="Permanent link">&para;</a></h4>
<ul>
<li>A library for writing concurrent code using the async/await syntax.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why" title="Permanent link">&para;</a></h4>
<ul>
<li>Enables non-blocking I/O operations, crucial for handling multiple client requests simultaneously without freezing the server.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage" title="Permanent link">&para;</a></h4>
<ul>
<li>Used for async functions, event loops, and coordinating concurrent tasks in the MCP server.</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-json-javascript-object-notation"><code>json</code> - JavaScript Object Notation<a class="headerlink" href="#lab07-mcp-ollama-lab-json-javascript-object-notation" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">json</p>
<h4 id="lab07-mcp-ollama-lab-definition_1">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_1" title="Permanent link">&para;</a></h4>
<ul>
<li>A module for parsing and generating JSON data.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_1">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_1" title="Permanent link">&para;</a></h4>
<ul>
<li>MCP uses JSON-RPC for communication between clients and servers.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_1">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_1" title="Permanent link">&para;</a></h4>
<ul>
<li>Serializing/deserializing data sent over stdio transport.</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-typing-type-hints"><code>typing</code> - Type Hints<a class="headerlink" href="#lab07-mcp-ollama-lab-typing-type-hints" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">typing</p>
<h4 id="lab07-mcp-ollama-lab-definition_2">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Provides runtime support for type hints.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_2">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Improves code readability, enables better IDE support, and catches type-related errors early.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_2">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Defining function signatures and data structures with proper types.</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-mcpserver-core-mcp-server"><code>mcp.server</code> - Core MCP Server<a class="headerlink" href="#lab07-mcp-ollama-lab-mcpserver-core-mcp-server" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.server</p>
<h4 id="lab07-mcp-ollama-lab-definition_3">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_3" title="Permanent link">&para;</a></h4>
<ul>
<li>The main server class for implementing MCP servers.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_3">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Provides the framework for registering tools, resources, and prompts, and handling client requests.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_3">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Creating the server instance and setting up request handlers.</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-mcpserverstdio-standard-io-transport"><code>mcp.server.stdio</code> - Standard I/O Transport<a class="headerlink" href="#lab07-mcp-ollama-lab-mcpserverstdio-standard-io-transport" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.server.stdio</p>
<h4 id="lab07-mcp-ollama-lab-definition_4">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_4" title="Permanent link">&para;</a></h4>
<ul>
<li>Transport layer for communication via standard input/output streams.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_4">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_4" title="Permanent link">&para;</a></h4>
<ul>
<li>Enables MCP servers to communicate with clients through stdin/stdout, making them easily integrable with various applications.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_4">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_4" title="Permanent link">&para;</a></h4>
<ul>
<li>Establishing the communication channel for the server.</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-mcptypes-protocol-types"><code>mcp.types</code> - Protocol Types<a class="headerlink" href="#lab07-mcp-ollama-lab-mcptypes-protocol-types" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">mcp.types</p>
<h4 id="lab07-mcp-ollama-lab-definition_5">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_5" title="Permanent link">&para;</a></h4>
<ul>
<li>Type definitions for MCP protocol messages and data structures.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_5">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_5" title="Permanent link">&para;</a></h4>
<ul>
<li>Ensures type safety and consistency when working with MCP messages.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_5">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_5" title="Permanent link">&para;</a></h4>
<ul>
<li>Defining request/response schemas and content types.</li>
</ul>
<p><strong>Key Types Used:</strong></p>
<ul>
<li><strong><code>Resource</code></strong>: Defines a resource (readable data/content) with URI, name, description, and MIME type</li>
<li><strong><code>Tool</code></strong>: Defines a tool (executable function) with name, description, and input schema</li>
<li><strong><code>TextContent</code></strong>, <strong><code>ImageContent</code></strong>: Content types for tool/resource responses</li>
<li><strong><code>Prompt</code></strong>: Defines a prompt template with name, description, and required arguments</li>
<li><strong><code>GetPromptResult</code></strong>: Result structure when retrieving a prompt</li>
<li><strong><code>CallToolResult</code></strong>: Result structure when calling a tool</li>
<li><strong><code>ListResourcesResult</code></strong>, <strong><code>ListToolsResult</code></strong>, <strong><code>ListPromptsResult</code></strong>: Results when listing available resources/tools/prompts</li>
<li><strong><code>ReadResourceResult</code></strong>: Result structure when reading a resource</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-sys-system-functions"><code>sys</code> - System Functions<a class="headerlink" href="#lab07-mcp-ollama-lab-sys-system-functions" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">sys</p>
<h4 id="lab07-mcp-ollama-lab-definition_6">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_6" title="Permanent link">&para;</a></h4>
<ul>
<li>Provides access to system-specific parameters and functions.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_6">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_6" title="Permanent link">&para;</a></h4>
<ul>
<li>Needed for handling command-line arguments and system-level operations.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_6">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_6" title="Permanent link">&para;</a></h4>
<ul>
<li>Accessing stdin/stdout streams and handling program exit.</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-requests-http-library"><code>requests</code> - HTTP Library<a class="headerlink" href="#lab07-mcp-ollama-lab-requests-http-library" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">requests</p>
<h4 id="lab07-mcp-ollama-lab-definition_7">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_7" title="Permanent link">&para;</a></h4>
<ul>
<li>A simple HTTP library for making web requests.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_7">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_7" title="Permanent link">&para;</a></h4>
<ul>
<li>Used for interacting with external APIs and services.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_7">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_7" title="Permanent link">&para;</a></h4>
<ul>
<li>Making HTTP calls to fetch data from web services.</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-sqlite3-sqlite-database"><code>sqlite3</code> - SQLite Database<a class="headerlink" href="#lab07-mcp-ollama-lab-sqlite3-sqlite-database" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">sqlite3</p>
<h4 id="lab07-mcp-ollama-lab-definition_8">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_8" title="Permanent link">&para;</a></h4>
<ul>
<li>Python&rsquo;s built-in SQLite database module.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_8">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_8" title="Permanent link">&para;</a></h4>
<ul>
<li>Provides a lightweight, file-based database for data storage and querying.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_8">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_8" title="Permanent link">&para;</a></h4>
<ul>
<li>Executing SQL queries and managing database operations.</li>
</ul>
</div>
<hr />
<h3 id="lab07-mcp-ollama-lab-pandas-data-analysis-library"><code>pandas</code> - Data Analysis Library<a class="headerlink" href="#lab07-mcp-ollama-lab-pandas-data-analysis-library" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">pandas</p>
<h4 id="lab07-mcp-ollama-lab-definition_9">Definition:<a class="headerlink" href="#lab07-mcp-ollama-lab-definition_9" title="Permanent link">&para;</a></h4>
<ul>
<li>A powerful data manipulation and analysis library.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-why_9">Why:<a class="headerlink" href="#lab07-mcp-ollama-lab-why_9" title="Permanent link">&para;</a></h4>
<ul>
<li>Used for reading CSV files and managing structured data.</li>
</ul>
<h4 id="lab07-mcp-ollama-lab-usage_9">Usage:<a class="headerlink" href="#lab07-mcp-ollama-lab-usage_9" title="Permanent link">&para;</a></h4>
<ul>
<li>Loading country data from CSV files for RAG retrieval.</li>
</ul>
</div>
<hr />
<p>Paste the following imports code inside the <code>mcp_ollama.py</code> file:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab07-mcp-ollama-lab-__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#lab07-mcp-ollama-lab-__codelineno-2-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#lab07-mcp-ollama-lab-__codelineno-2-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#lab07-mcp-ollama-lab-__codelineno-2-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#lab07-mcp-ollama-lab-__codelineno-2-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#lab07-mcp-ollama-lab-__codelineno-2-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#lab07-mcp-ollama-lab-__codelineno-2-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#lab07-mcp-ollama-lab-__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#lab07-mcp-ollama-lab-__codelineno-2-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ollama</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#lab07-mcp-ollama-lab-__codelineno-2-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#lab07-mcp-ollama-lab-__codelineno-2-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#lab07-mcp-ollama-lab-__codelineno-2-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#lab07-mcp-ollama-lab-__codelineno-2-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#lab07-mcp-ollama-lab-__codelineno-2-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#lab07-mcp-ollama-lab-__codelineno-2-15"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#lab07-mcp-ollama-lab-__codelineno-2-16"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#lab07-mcp-ollama-lab-__codelineno-2-17"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#lab07-mcp-ollama-lab-__codelineno-2-18"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#lab07-mcp-ollama-lab-__codelineno-2-19"></a>    <span class="n">TextResourceContents</span><span class="p">,</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#lab07-mcp-ollama-lab-__codelineno-2-20"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#lab07-mcp-ollama-lab-__codelineno-2-21"></a>    <span class="n">GetPromptResult</span><span class="p">,</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#lab07-mcp-ollama-lab-__codelineno-2-22"></a>    <span class="n">CallToolResult</span><span class="p">,</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#lab07-mcp-ollama-lab-__codelineno-2-23"></a>    <span class="n">ListResourcesResult</span><span class="p">,</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#lab07-mcp-ollama-lab-__codelineno-2-24"></a>    <span class="n">ListToolsResult</span><span class="p">,</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#lab07-mcp-ollama-lab-__codelineno-2-25"></a>    <span class="n">ReadResourceResult</span><span class="p">,</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#lab07-mcp-ollama-lab-__codelineno-2-26"></a>    <span class="n">ListPromptsResult</span><span class="p">,</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#lab07-mcp-ollama-lab-__codelineno-2-27"></a><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-02-skeleton-code-class">Step 02: Skeleton Code - Class<a class="headerlink" href="#lab07-mcp-ollama-lab-step-02-skeleton-code-class" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-class-definition">Class Definition<a class="headerlink" href="#lab07-mcp-ollama-lab-class-definition" title="Permanent link">&para;</a></h3>
<p>Append this class definition code after the imports in your <code>mcp_ollama.py</code> file:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab07-mcp-ollama-lab-__codelineno-3-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteOllamaMCPServer</span><span class="p">:</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#lab07-mcp-ollama-lab-__codelineno-3-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#lab07-mcp-ollama-lab-__codelineno-3-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-ollama-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#lab07-mcp-ollama-lab-__codelineno-3-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_handlers</span><span class="p">()</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#lab07-mcp-ollama-lab-__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#lab07-mcp-ollama-lab-__codelineno-3-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#lab07-mcp-ollama-lab-__codelineno-3-7"></a>        <span class="c1"># Will be implemented in subsequent steps</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#lab07-mcp-ollama-lab-__codelineno-3-8"></a>        <span class="k">pass</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-03-constructor">Step 03: Constructor<a class="headerlink" href="#lab07-mcp-ollama-lab-step-03-constructor" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-__init__-constructor">Method <code>__init__</code> (Constructor)<a class="headerlink" href="#lab07-mcp-ollama-lab-method-__init__-constructor" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Initializes the MCP server with a name</li>
<li>Sets up data structures for tools, resources, and prompts</li>
<li>Prepares database connection</li>
<li>Initializes Ollama client</li>
<li>Loads country data from Excel files for RAG retrieval</li>
</ul>
<p><strong>Why This Runs First:</strong></p>
<ul>
<li>Establishes the foundation for all server operations</li>
<li>Sets up the basic state of the server</li>
<li>Ensures all dependencies are ready before registering components</li>
</ul>
<hr />
<p><strong>Update the <code>__init__</code> method</strong> inside your <code>CompleteOllamaMCPServer</code> class to include the full initialization:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab07-mcp-ollama-lab-__codelineno-4-1"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#lab07-mcp-ollama-lab-__codelineno-4-2"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-ollama-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#lab07-mcp-ollama-lab-__codelineno-4-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="s2">&quot;data.db&quot;</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#lab07-mcp-ollama-lab-__codelineno-4-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ollama_client</span> <span class="o">=</span> <span class="n">ollama</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#lab07-mcp-ollama-lab-__codelineno-4-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">country_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_country_data</span><span class="p">()</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#lab07-mcp-ollama-lab-__codelineno-4-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_handlers</span><span class="p">()</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#lab07-mcp-ollama-lab-__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#lab07-mcp-ollama-lab-__codelineno-4-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_country_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#lab07-mcp-ollama-lab-__codelineno-4-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load country information from CSV files for RAG retrieval.&quot;&quot;&quot;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#lab07-mcp-ollama-lab-__codelineno-4-10"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#lab07-mcp-ollama-lab-__codelineno-4-11"></a>        <span class="n">script_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#lab07-mcp-ollama-lab-__codelineno-4-12"></a>        <span class="n">info_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;capital&#39;</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;foundation_year&#39;</span><span class="p">]</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#lab07-mcp-ollama-lab-__codelineno-4-13"></a>        <span class="k">for</span> <span class="n">info_type</span> <span class="ow">in</span> <span class="n">info_types</span><span class="p">:</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#lab07-mcp-ollama-lab-__codelineno-4-14"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#lab07-mcp-ollama-lab-__codelineno-4-15"></a>                <span class="n">file_path</span> <span class="o">=</span> <span class="n">script_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">info_type</span><span class="si">}</span><span class="s1">.csv&#39;</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#lab07-mcp-ollama-lab-__codelineno-4-16"></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#lab07-mcp-ollama-lab-__codelineno-4-17"></a>                <span class="c1"># Convert country names to lowercase for case-insensitive matching</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#lab07-mcp-ollama-lab-__codelineno-4-18"></a>                <span class="n">data</span><span class="p">[</span><span class="n">info_type</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">info_type</span><span class="p">]))</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#lab07-mcp-ollama-lab-__codelineno-4-19"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#lab07-mcp-ollama-lab-__codelineno-4-20"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">info_type</span><span class="si">}</span><span class="s2">.csv: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#lab07-mcp-ollama-lab-__codelineno-4-21"></a>                <span class="n">data</span><span class="p">[</span><span class="n">info_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#lab07-mcp-ollama-lab-__codelineno-4-22"></a>        <span class="k">return</span> <span class="n">data</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-04-register-tools">Step 04: Register Tools<a class="headerlink" href="#lab07-mcp-ollama-lab-step-04-register-tools" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-register_tools">Method <code>register_tools</code><a class="headerlink" href="#lab07-mcp-ollama-lab-method-register_tools" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Registers tool definitions for discovery</li>
<li>Defines tool schemas and capabilities</li>
<li>Makes tools available to clients</li>
</ul>
<p><strong>Why This Runs Second:</strong></p>
<ul>
<li>Tools must be registered before they can be called</li>
<li>Defines the capabilities clients can invoke</li>
</ul>
<p><strong>What is a Tool?</strong></p>
<ul>
<li>A tool is an executable function that clients can invoke.</li>
<li>Tools have names, descriptions, and input parameters.</li>
<li>Clients can discover and call these tools to perform operations.</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab07-mcp-ollama-lab-__codelineno-5-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#lab07-mcp-ollama-lab-__codelineno-5-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#lab07-mcp-ollama-lab-__codelineno-5-3"></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#lab07-mcp-ollama-lab-__codelineno-5-4"></a>        <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#lab07-mcp-ollama-lab-__codelineno-5-5"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;country_info&quot;</span><span class="p">,</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#lab07-mcp-ollama-lab-__codelineno-5-6"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Get country information using RAG from CSV databases&quot;</span><span class="p">,</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#lab07-mcp-ollama-lab-__codelineno-5-7"></a>            <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#lab07-mcp-ollama-lab-__codelineno-5-8"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#lab07-mcp-ollama-lab-__codelineno-5-9"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#lab07-mcp-ollama-lab-__codelineno-5-10"></a>                    <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#lab07-mcp-ollama-lab-__codelineno-5-11"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#lab07-mcp-ollama-lab-__codelineno-5-12"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The country name to get information for&quot;</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#lab07-mcp-ollama-lab-__codelineno-5-13"></a>                    <span class="p">},</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#lab07-mcp-ollama-lab-__codelineno-5-14"></a>                    <span class="s2">&quot;info_types&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#lab07-mcp-ollama-lab-__codelineno-5-15"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#lab07-mcp-ollama-lab-__codelineno-5-16"></a>                        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;capital&quot;</span><span class="p">,</span> <span class="s2">&quot;population&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;foundation_year&quot;</span><span class="p">]},</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#lab07-mcp-ollama-lab-__codelineno-5-17"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Types of information to retrieve&quot;</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#lab07-mcp-ollama-lab-__codelineno-5-18"></a>                    <span class="p">}</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#lab07-mcp-ollama-lab-__codelineno-5-19"></a>                <span class="p">},</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#lab07-mcp-ollama-lab-__codelineno-5-20"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;country&quot;</span><span class="p">]</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#lab07-mcp-ollama-lab-__codelineno-5-21"></a>            <span class="p">}</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#lab07-mcp-ollama-lab-__codelineno-5-22"></a>        <span class="p">),</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#lab07-mcp-ollama-lab-__codelineno-5-23"></a>        <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#lab07-mcp-ollama-lab-__codelineno-5-24"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;read_file&quot;</span><span class="p">,</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#lab07-mcp-ollama-lab-__codelineno-5-25"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Read and analyze file contents with metadata&quot;</span><span class="p">,</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#lab07-mcp-ollama-lab-__codelineno-5-26"></a>            <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#lab07-mcp-ollama-lab-__codelineno-5-27"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#lab07-mcp-ollama-lab-__codelineno-5-28"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#lab07-mcp-ollama-lab-__codelineno-5-29"></a>                    <span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#lab07-mcp-ollama-lab-__codelineno-5-30"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#lab07-mcp-ollama-lab-__codelineno-5-31"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Absolute path to the file to read&quot;</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#lab07-mcp-ollama-lab-__codelineno-5-32"></a>                    <span class="p">},</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#lab07-mcp-ollama-lab-__codelineno-5-33"></a>                    <span class="s2">&quot;max_size&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#lab07-mcp-ollama-lab-__codelineno-5-34"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#lab07-mcp-ollama-lab-__codelineno-5-35"></a>                        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">1048576</span><span class="p">,</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#lab07-mcp-ollama-lab-__codelineno-5-36"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Maximum file size in bytes (default 1MB)&quot;</span>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#lab07-mcp-ollama-lab-__codelineno-5-37"></a>                    <span class="p">},</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#lab07-mcp-ollama-lab-__codelineno-5-38"></a>                    <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#lab07-mcp-ollama-lab-__codelineno-5-39"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#lab07-mcp-ollama-lab-__codelineno-5-40"></a>                        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#lab07-mcp-ollama-lab-__codelineno-5-41"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;File encoding&quot;</span>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#lab07-mcp-ollama-lab-__codelineno-5-42"></a>                    <span class="p">}</span>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#lab07-mcp-ollama-lab-__codelineno-5-43"></a>                <span class="p">},</span>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#lab07-mcp-ollama-lab-__codelineno-5-44"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;filepath&quot;</span><span class="p">]</span>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#lab07-mcp-ollama-lab-__codelineno-5-45"></a>            <span class="p">}</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#lab07-mcp-ollama-lab-__codelineno-5-46"></a>        <span class="p">),</span>
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#lab07-mcp-ollama-lab-__codelineno-5-47"></a>        <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#lab07-mcp-ollama-lab-__codelineno-5-48"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;query_database&quot;</span><span class="p">,</span>
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#lab07-mcp-ollama-lab-__codelineno-5-49"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Execute SELECT queries on SQLite database&quot;</span><span class="p">,</span>
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#lab07-mcp-ollama-lab-__codelineno-5-50"></a>            <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#lab07-mcp-ollama-lab-__codelineno-5-51"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#lab07-mcp-ollama-lab-__codelineno-5-52"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#lab07-mcp-ollama-lab-__codelineno-5-53"></a>                    <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#lab07-mcp-ollama-lab-__codelineno-5-54"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#lab07-mcp-ollama-lab-__codelineno-5-55"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT SQL query to execute&quot;</span>
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#lab07-mcp-ollama-lab-__codelineno-5-56"></a>                    <span class="p">},</span>
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#lab07-mcp-ollama-lab-__codelineno-5-57"></a>                    <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#lab07-mcp-ollama-lab-__codelineno-5-58"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#lab07-mcp-ollama-lab-__codelineno-5-59"></a>                        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s2">&quot;data.db&quot;</span><span class="p">,</span>
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#lab07-mcp-ollama-lab-__codelineno-5-60"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Database file path&quot;</span>
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#lab07-mcp-ollama-lab-__codelineno-5-61"></a>                    <span class="p">}</span>
</span><span id="__span-5-62"><a id="__codelineno-5-62" name="__codelineno-5-62" href="#lab07-mcp-ollama-lab-__codelineno-5-62"></a>                <span class="p">},</span>
</span><span id="__span-5-63"><a id="__codelineno-5-63" name="__codelineno-5-63" href="#lab07-mcp-ollama-lab-__codelineno-5-63"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>
</span><span id="__span-5-64"><a id="__codelineno-5-64" name="__codelineno-5-64" href="#lab07-mcp-ollama-lab-__codelineno-5-64"></a>            <span class="p">}</span>
</span><span id="__span-5-65"><a id="__codelineno-5-65" name="__codelineno-5-65" href="#lab07-mcp-ollama-lab-__codelineno-5-65"></a>        <span class="p">)</span>
</span><span id="__span-5-66"><a id="__codelineno-5-66" name="__codelineno-5-66" href="#lab07-mcp-ollama-lab-__codelineno-5-66"></a>    <span class="p">]</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-05-tool-handlers">Step 05: Tool Handlers<a class="headerlink" href="#lab07-mcp-ollama-lab-step-05-tool-handlers" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-register_tool_handlers">Method <code>register_tool_handlers</code><a class="headerlink" href="#lab07-mcp-ollama-lab-method-register_tool_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Implements the logic for each tool</li>
<li>Handles tool execution and error management</li>
<li>Returns formatted results</li>
</ul>
<p><strong>Why This Runs Third:</strong></p>
<ul>
<li>Connects tool schemas to actual functionality</li>
<li>Makes tools operational</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab07-mcp-ollama-lab-__codelineno-6-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab07-mcp-ollama-lab-__codelineno-6-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#lab07-mcp-ollama-lab-__codelineno-6-3"></a>    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;country_info&quot;</span><span class="p">:</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#lab07-mcp-ollama-lab-__codelineno-6-4"></a>        <span class="n">country</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#lab07-mcp-ollama-lab-__codelineno-6-5"></a>        <span class="n">info_types</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;info_types&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#lab07-mcp-ollama-lab-__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#lab07-mcp-ollama-lab-__codelineno-6-7"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">country</span><span class="p">:</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#lab07-mcp-ollama-lab-__codelineno-6-8"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Country name is required&quot;</span><span class="p">)</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#lab07-mcp-ollama-lab-__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#lab07-mcp-ollama-lab-__codelineno-6-10"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">info_types</span><span class="p">:</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#lab07-mcp-ollama-lab-__codelineno-6-11"></a>            <span class="n">info_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;capital&quot;</span><span class="p">,</span> <span class="s2">&quot;population&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;foundation_year&quot;</span><span class="p">]</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#lab07-mcp-ollama-lab-__codelineno-6-12"></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#lab07-mcp-ollama-lab-__codelineno-6-13"></a>        <span class="n">retrieved_info</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#lab07-mcp-ollama-lab-__codelineno-6-14"></a>        <span class="k">for</span> <span class="n">info_type</span> <span class="ow">in</span> <span class="n">info_types</span><span class="p">:</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#lab07-mcp-ollama-lab-__codelineno-6-15"></a>            <span class="c1"># Safe access to nested dictionary</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#lab07-mcp-ollama-lab-__codelineno-6-16"></a>            <span class="n">type_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">info_type</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#lab07-mcp-ollama-lab-__codelineno-6-17"></a>            <span class="k">if</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">type_data</span><span class="p">:</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#lab07-mcp-ollama-lab-__codelineno-6-18"></a>                <span class="n">retrieved_info</span><span class="p">[</span><span class="n">info_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_data</span><span class="p">[</span><span class="n">country</span><span class="p">]</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#lab07-mcp-ollama-lab-__codelineno-6-19"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#lab07-mcp-ollama-lab-__codelineno-6-20"></a>                <span class="n">retrieved_info</span><span class="p">[</span><span class="n">info_type</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Information not available (Data loaded: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> records)&quot;</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#lab07-mcp-ollama-lab-__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#lab07-mcp-ollama-lab-__codelineno-6-22"></a>        <span class="c1"># Use Ollama to generate a formatted response</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#lab07-mcp-ollama-lab-__codelineno-6-23"></a>        <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Format the following information about </span><span class="si">{</span><span class="n">country</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> into a nice, readable response: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">retrieved_info</span><span class="p">,</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#lab07-mcp-ollama-lab-__codelineno-6-24"></a>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#lab07-mcp-ollama-lab-__codelineno-6-25"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#lab07-mcp-ollama-lab-__codelineno-6-26"></a>            <span class="c1"># Use llama3.2 as detected on your system</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#lab07-mcp-ollama-lab-__codelineno-6-27"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ollama_client</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#lab07-mcp-ollama-lab-__codelineno-6-28"></a>                <span class="n">model</span><span class="o">=</span><span class="s1">&#39;llama3.2&#39;</span><span class="p">,</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#lab07-mcp-ollama-lab-__codelineno-6-29"></a>                <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#lab07-mcp-ollama-lab-__codelineno-6-30"></a>                <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;temperature&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;max_tokens&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">}</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#lab07-mcp-ollama-lab-__codelineno-6-31"></a>            <span class="p">)</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#lab07-mcp-ollama-lab-__codelineno-6-32"></a>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#lab07-mcp-ollama-lab-__codelineno-6-33"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#lab07-mcp-ollama-lab-__codelineno-6-34"></a>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#lab07-mcp-ollama-lab-__codelineno-6-35"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#lab07-mcp-ollama-lab-__codelineno-6-36"></a>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#lab07-mcp-ollama-lab-__codelineno-6-37"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#lab07-mcp-ollama-lab-__codelineno-6-38"></a>            <span class="c1"># Fallback if Ollama fails</span>
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#lab07-mcp-ollama-lab-__codelineno-6-39"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error getting AI response: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Raw Data: </span><span class="si">{</span><span class="n">retrieved_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#lab07-mcp-ollama-lab-__codelineno-6-40"></a>
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#lab07-mcp-ollama-lab-__codelineno-6-41"></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;read_file&quot;</span><span class="p">:</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#lab07-mcp-ollama-lab-__codelineno-6-42"></a>        <span class="n">filepath</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filepath&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#lab07-mcp-ollama-lab-__codelineno-6-43"></a>        <span class="n">max_size</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_size&quot;</span><span class="p">,</span> <span class="mi">1048576</span><span class="p">)</span>
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#lab07-mcp-ollama-lab-__codelineno-6-44"></a>        <span class="n">encoding</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#lab07-mcp-ollama-lab-__codelineno-6-45"></a>
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#lab07-mcp-ollama-lab-__codelineno-6-46"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="p">:</span>
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#lab07-mcp-ollama-lab-__codelineno-6-47"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;File path is required&quot;</span><span class="p">)</span>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#lab07-mcp-ollama-lab-__codelineno-6-48"></a>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#lab07-mcp-ollama-lab-__codelineno-6-49"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#lab07-mcp-ollama-lab-__codelineno-6-50"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#lab07-mcp-ollama-lab-__codelineno-6-51"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#lab07-mcp-ollama-lab-__codelineno-6-52"></a>
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#lab07-mcp-ollama-lab-__codelineno-6-53"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#lab07-mcp-ollama-lab-__codelineno-6-54"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path is not a file: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#lab07-mcp-ollama-lab-__codelineno-6-55"></a>
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#lab07-mcp-ollama-lab-__codelineno-6-56"></a>        <span class="n">file_size</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#lab07-mcp-ollama-lab-__codelineno-6-57"></a>        <span class="k">if</span> <span class="n">file_size</span> <span class="o">&gt;</span> <span class="n">max_size</span><span class="p">:</span>
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#lab07-mcp-ollama-lab-__codelineno-6-58"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File too large: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}</span><span class="s2"> bytes (max: </span><span class="si">{</span><span class="n">max_size</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#lab07-mcp-ollama-lab-__codelineno-6-59"></a>
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#lab07-mcp-ollama-lab-__codelineno-6-60"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#lab07-mcp-ollama-lab-__codelineno-6-61"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#lab07-mcp-ollama-lab-__codelineno-6-62"></a>                <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#lab07-mcp-ollama-lab-__codelineno-6-63"></a>
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#lab07-mcp-ollama-lab-__codelineno-6-64"></a>            <span class="n">metadata</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">Size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}</span><span class="s2"> bytes</span><span class="se">\n</span><span class="s2">Encoding: </span><span class="si">{</span><span class="n">encoding</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#lab07-mcp-ollama-lab-__codelineno-6-65"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">metadata</span> <span class="o">+</span> <span class="s2">&quot;Content:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">content</span>
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#lab07-mcp-ollama-lab-__codelineno-6-66"></a>
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#lab07-mcp-ollama-lab-__codelineno-6-67"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#lab07-mcp-ollama-lab-__codelineno-6-68"></a>
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#lab07-mcp-ollama-lab-__codelineno-6-69"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-6-70"><a id="__codelineno-6-70" name="__codelineno-6-70" href="#lab07-mcp-ollama-lab-__codelineno-6-70"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error reading file: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="__span-6-71"><a id="__codelineno-6-71" name="__codelineno-6-71" href="#lab07-mcp-ollama-lab-__codelineno-6-71"></a>
</span><span id="__span-6-72"><a id="__codelineno-6-72" name="__codelineno-6-72" href="#lab07-mcp-ollama-lab-__codelineno-6-72"></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;query_database&quot;</span><span class="p">:</span>
</span><span id="__span-6-73"><a id="__codelineno-6-73" name="__codelineno-6-73" href="#lab07-mcp-ollama-lab-__codelineno-6-73"></a>        <span class="n">query</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;query&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-6-74"><a id="__codelineno-6-74" name="__codelineno-6-74" href="#lab07-mcp-ollama-lab-__codelineno-6-74"></a>        <span class="n">database</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="__span-6-75"><a id="__codelineno-6-75" name="__codelineno-6-75" href="#lab07-mcp-ollama-lab-__codelineno-6-75"></a>
</span><span id="__span-6-76"><a id="__codelineno-6-76" name="__codelineno-6-76" href="#lab07-mcp-ollama-lab-__codelineno-6-76"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="p">:</span>
</span><span id="__span-6-77"><a id="__codelineno-6-77" name="__codelineno-6-77" href="#lab07-mcp-ollama-lab-__codelineno-6-77"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Query is required&quot;</span><span class="p">)</span>
</span><span id="__span-6-78"><a id="__codelineno-6-78" name="__codelineno-6-78" href="#lab07-mcp-ollama-lab-__codelineno-6-78"></a>
</span><span id="__span-6-79"><a id="__codelineno-6-79" name="__codelineno-6-79" href="#lab07-mcp-ollama-lab-__codelineno-6-79"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;SELECT&quot;</span><span class="p">):</span>
</span><span id="__span-6-80"><a id="__codelineno-6-80" name="__codelineno-6-80" href="#lab07-mcp-ollama-lab-__codelineno-6-80"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only SELECT queries are allowed&quot;</span><span class="p">)</span>
</span><span id="__span-6-81"><a id="__codelineno-6-81" name="__codelineno-6-81" href="#lab07-mcp-ollama-lab-__codelineno-6-81"></a>
</span><span id="__span-6-82"><a id="__codelineno-6-82" name="__codelineno-6-82" href="#lab07-mcp-ollama-lab-__codelineno-6-82"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-6-83"><a id="__codelineno-6-83" name="__codelineno-6-83" href="#lab07-mcp-ollama-lab-__codelineno-6-83"></a>            <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
</span><span id="__span-6-84"><a id="__codelineno-6-84" name="__codelineno-6-84" href="#lab07-mcp-ollama-lab-__codelineno-6-84"></a>            <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="__span-6-85"><a id="__codelineno-6-85" name="__codelineno-6-85" href="#lab07-mcp-ollama-lab-__codelineno-6-85"></a>
</span><span id="__span-6-86"><a id="__codelineno-6-86" name="__codelineno-6-86" href="#lab07-mcp-ollama-lab-__codelineno-6-86"></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-6-87"><a id="__codelineno-6-87" name="__codelineno-6-87" href="#lab07-mcp-ollama-lab-__codelineno-6-87"></a>            <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="__span-6-88"><a id="__codelineno-6-88" name="__codelineno-6-88" href="#lab07-mcp-ollama-lab-__codelineno-6-88"></a>            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
</span><span id="__span-6-89"><a id="__codelineno-6-89" name="__codelineno-6-89" href="#lab07-mcp-ollama-lab-__codelineno-6-89"></a>
</span><span id="__span-6-90"><a id="__codelineno-6-90" name="__codelineno-6-90" href="#lab07-mcp-ollama-lab-__codelineno-6-90"></a>            <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-6-91"><a id="__codelineno-6-91" name="__codelineno-6-91" href="#lab07-mcp-ollama-lab-__codelineno-6-91"></a>
</span><span id="__span-6-92"><a id="__codelineno-6-92" name="__codelineno-6-92" href="#lab07-mcp-ollama-lab-__codelineno-6-92"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">rows</span><span class="p">:</span>
</span><span id="__span-6-93"><a id="__codelineno-6-93" name="__codelineno-6-93" href="#lab07-mcp-ollama-lab-__codelineno-6-93"></a>                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;No results found.&quot;</span>
</span><span id="__span-6-94"><a id="__codelineno-6-94" name="__codelineno-6-94" href="#lab07-mcp-ollama-lab-__codelineno-6-94"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-6-95"><a id="__codelineno-6-95" name="__codelineno-6-95" href="#lab07-mcp-ollama-lab-__codelineno-6-95"></a>                <span class="c1"># Format as table</span>
</span><span id="__span-6-96"><a id="__codelineno-6-96" name="__codelineno-6-96" href="#lab07-mcp-ollama-lab-__codelineno-6-96"></a>                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;| &quot;</span> <span class="o">+</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; |</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-6-97"><a id="__codelineno-6-97" name="__codelineno-6-97" href="#lab07-mcp-ollama-lab-__codelineno-6-97"></a>                <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;---&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;|</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-6-98"><a id="__codelineno-6-98" name="__codelineno-6-98" href="#lab07-mcp-ollama-lab-__codelineno-6-98"></a>                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
</span><span id="__span-6-99"><a id="__codelineno-6-99" name="__codelineno-6-99" href="#lab07-mcp-ollama-lab-__codelineno-6-99"></a>                    <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;| &quot;</span> <span class="o">+</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; |</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-6-100"><a id="__codelineno-6-100" name="__codelineno-6-100" href="#lab07-mcp-ollama-lab-__codelineno-6-100"></a>
</span><span id="__span-6-101"><a id="__codelineno-6-101" name="__codelineno-6-101" href="#lab07-mcp-ollama-lab-__codelineno-6-101"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-6-102"><a id="__codelineno-6-102" name="__codelineno-6-102" href="#lab07-mcp-ollama-lab-__codelineno-6-102"></a>
</span><span id="__span-6-103"><a id="__codelineno-6-103" name="__codelineno-6-103" href="#lab07-mcp-ollama-lab-__codelineno-6-103"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-6-104"><a id="__codelineno-6-104" name="__codelineno-6-104" href="#lab07-mcp-ollama-lab-__codelineno-6-104"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Database error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="__span-6-105"><a id="__codelineno-6-105" name="__codelineno-6-105" href="#lab07-mcp-ollama-lab-__codelineno-6-105"></a>
</span><span id="__span-6-106"><a id="__codelineno-6-106" name="__codelineno-6-106" href="#lab07-mcp-ollama-lab-__codelineno-6-106"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-6-107"><a id="__codelineno-6-107" name="__codelineno-6-107" href="#lab07-mcp-ollama-lab-__codelineno-6-107"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown tool: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-06-register-resources">Step 06: Register Resources<a class="headerlink" href="#lab07-mcp-ollama-lab-step-06-register-resources" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-register_resources">Method <code>register_resources</code><a class="headerlink" href="#lab07-mcp-ollama-lab-method-register_resources" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Registers resource definitions for discovery</li>
<li>Provides additional data for clients</li>
</ul>
<p><strong>Why This Runs Fourth:</strong></p>
<ul>
<li>Resources enhance the server&rsquo;s functionality</li>
<li>Allows clients to access static or dynamic data</li>
</ul>
<p><strong>What is a Resource?</strong></p>
<ul>
<li>A resource is readable data or content.</li>
<li>Resources have URIs and metadata.</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab07-mcp-ollama-lab-__codelineno-7-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#lab07-mcp-ollama-lab-__codelineno-7-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#lab07-mcp-ollama-lab-__codelineno-7-3"></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#lab07-mcp-ollama-lab-__codelineno-7-4"></a>        <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#lab07-mcp-ollama-lab-__codelineno-7-5"></a>            <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#lab07-mcp-ollama-lab-__codelineno-7-6"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#lab07-mcp-ollama-lab-__codelineno-7-7"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Basic information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#lab07-mcp-ollama-lab-__codelineno-7-8"></a>            <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#lab07-mcp-ollama-lab-__codelineno-7-9"></a>        <span class="p">),</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#lab07-mcp-ollama-lab-__codelineno-7-10"></a>        <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#lab07-mcp-ollama-lab-__codelineno-7-11"></a>            <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://ollama-models&quot;</span><span class="p">,</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#lab07-mcp-ollama-lab-__codelineno-7-12"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Available Ollama Models&quot;</span><span class="p">,</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#lab07-mcp-ollama-lab-__codelineno-7-13"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;List of available Ollama models&quot;</span><span class="p">,</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#lab07-mcp-ollama-lab-__codelineno-7-14"></a>            <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#lab07-mcp-ollama-lab-__codelineno-7-15"></a>        <span class="p">)</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#lab07-mcp-ollama-lab-__codelineno-7-16"></a>    <span class="p">]</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-07-resource-handlers">Step 07: Resource Handlers<a class="headerlink" href="#lab07-mcp-ollama-lab-step-07-resource-handlers" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-register_resource_handlers">Method <code>register_resource_handlers</code><a class="headerlink" href="#lab07-mcp-ollama-lab-method-register_resource_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Implements resource reading logic</li>
<li>Handles resource requests and returns content</li>
</ul>
<p><strong>Why This Runs Fifth:</strong></p>
<ul>
<li>Connects resource URIs to actual content</li>
<li>Makes resources accessible to clients</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab07-mcp-ollama-lab-__codelineno-8-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#lab07-mcp-ollama-lab-__codelineno-8-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#lab07-mcp-ollama-lab-__codelineno-8-3"></a>    <span class="n">uri_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#lab07-mcp-ollama-lab-__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#lab07-mcp-ollama-lab-__codelineno-8-5"></a>    <span class="c1"># Debug log to help diagnose the mismatch</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#lab07-mcp-ollama-lab-__codelineno-8-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DEBUG: Requesting URI: &#39;</span><span class="si">{</span><span class="n">uri_str</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#lab07-mcp-ollama-lab-__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#lab07-mcp-ollama-lab-__codelineno-8-8"></a>    <span class="c1"># Allow exact match or match without scheme to be robust</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#lab07-mcp-ollama-lab-__codelineno-8-9"></a>    <span class="k">if</span> <span class="n">uri_str</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span> <span class="ow">or</span> <span class="n">uri_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;server-info&quot;</span><span class="p">):</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#lab07-mcp-ollama-lab-__codelineno-8-10"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#lab07-mcp-ollama-lab-__codelineno-8-11"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Complete Ollama MCP Server&quot;</span><span class="p">,</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#lab07-mcp-ollama-lab-__codelineno-8-12"></a>            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#lab07-mcp-ollama-lab-__codelineno-8-13"></a>            <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tools&quot;</span><span class="p">,</span> <span class="s2">&quot;resources&quot;</span><span class="p">,</span> <span class="s2">&quot;ollama-integration&quot;</span><span class="p">],</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#lab07-mcp-ollama-lab-__codelineno-8-14"></a>            <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;country_info&quot;</span><span class="p">,</span> <span class="s2">&quot;read_file&quot;</span><span class="p">,</span> <span class="s2">&quot;query_database&quot;</span><span class="p">],</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#lab07-mcp-ollama-lab-__codelineno-8-15"></a>            <span class="s2">&quot;country_database&quot;</span><span class="p">:</span> <span class="s2">&quot;193 UN member states with capitals, populations, topographic heights, and foundation years&quot;</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#lab07-mcp-ollama-lab-__codelineno-8-16"></a>        <span class="p">}</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#lab07-mcp-ollama-lab-__codelineno-8-17"></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#lab07-mcp-ollama-lab-__codelineno-8-18"></a>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#lab07-mcp-ollama-lab-__codelineno-8-19"></a>    <span class="k">elif</span> <span class="n">uri_str</span> <span class="o">==</span> <span class="s2">&quot;resource://ollama-models&quot;</span> <span class="ow">or</span> <span class="n">uri_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;ollama-models&quot;</span><span class="p">):</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#lab07-mcp-ollama-lab-__codelineno-8-20"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#lab07-mcp-ollama-lab-__codelineno-8-21"></a>            <span class="n">models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ollama_client</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#lab07-mcp-ollama-lab-__codelineno-8-22"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#lab07-mcp-ollama-lab-__codelineno-8-23"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#lab07-mcp-ollama-lab-__codelineno-8-24"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)},</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#lab07-mcp-ollama-lab-__codelineno-8-25"></a>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#lab07-mcp-ollama-lab-__codelineno-8-26"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#lab07-mcp-ollama-lab-__codelineno-8-27"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-08-register-prompts">Step 08: Register Prompts<a class="headerlink" href="#lab07-mcp-ollama-lab-step-08-register-prompts" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-register_prompts">Method <code>register_prompts</code><a class="headerlink" href="#lab07-mcp-ollama-lab-method-register_prompts" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Registers prompt templates</li>
<li>Defines structured prompts for AI interactions</li>
</ul>
<p><strong>Why This Runs Sixth:</strong></p>
<ul>
<li>Provides structured prompts for AI interactions</li>
<li>Enables clients to request specific prompt templates</li>
</ul>
<p><strong>What is a Prompt?</strong></p>
<ul>
<li>A prompt is a template that guides AI assistants.</li>
<li>Prompts have names, descriptions, and required arguments.</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab07-mcp-ollama-lab-__codelineno-9-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_prompts</span><span class="p">()</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#lab07-mcp-ollama-lab-__codelineno-9-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_prompts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Prompt</span><span class="p">]:</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#lab07-mcp-ollama-lab-__codelineno-9-3"></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#lab07-mcp-ollama-lab-__codelineno-9-4"></a>        <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#lab07-mcp-ollama-lab-__codelineno-9-5"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analyze-country-data&quot;</span><span class="p">,</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#lab07-mcp-ollama-lab-__codelineno-9-6"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze country data and provide insights&quot;</span><span class="p">,</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#lab07-mcp-ollama-lab-__codelineno-9-7"></a>            <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#lab07-mcp-ollama-lab-__codelineno-9-8"></a>                <span class="p">{</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#lab07-mcp-ollama-lab-__codelineno-9-9"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#lab07-mcp-ollama-lab-__codelineno-9-10"></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Country to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#lab07-mcp-ollama-lab-__codelineno-9-11"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#lab07-mcp-ollama-lab-__codelineno-9-12"></a>                <span class="p">}</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#lab07-mcp-ollama-lab-__codelineno-9-13"></a>            <span class="p">]</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#lab07-mcp-ollama-lab-__codelineno-9-14"></a>        <span class="p">)</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#lab07-mcp-ollama-lab-__codelineno-9-15"></a>    <span class="p">]</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-09-prompt-handlers">Step 09: Prompt Handlers<a class="headerlink" href="#lab07-mcp-ollama-lab-step-09-prompt-handlers" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-register_prompt_handlers">Method <code>register_prompt_handlers</code><a class="headerlink" href="#lab07-mcp-ollama-lab-method-register_prompt_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Generates prompt content.</li>
<li>Handles prompt requests and returns structured messages.</li>
</ul>
<p><strong>Why This Runs Seventh:</strong></p>
<ul>
<li>Connects prompt templates to actual content.</li>
<li>Makes prompts usable by clients.</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab07-mcp-ollama-lab-__codelineno-10-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">get_prompt</span><span class="p">()</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#lab07-mcp-ollama-lab-__codelineno-10-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prompt</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">GetPromptResult</span><span class="p">:</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#lab07-mcp-ollama-lab-__codelineno-10-3"></a>    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;analyze-country-data&quot;</span><span class="p">:</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#lab07-mcp-ollama-lab-__codelineno-10-4"></a>        <span class="n">country</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown Country&quot;</span><span class="p">)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#lab07-mcp-ollama-lab-__codelineno-10-5"></a>        <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Analyze the data for </span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2"> and provide insights:</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#lab07-mcp-ollama-lab-__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#lab07-mcp-ollama-lab-__codelineno-10-7"></a><span class="s2">1. Use the country_info tool to get information about the country&#39;s capital, population, topographic height, and foundation year</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#lab07-mcp-ollama-lab-__codelineno-10-8"></a><span class="s2">2. Analyze the retrieved information and provide interesting facts</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#lab07-mcp-ollama-lab-__codelineno-10-9"></a><span class="s2">3. Consider historical context and geographical significance</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#lab07-mcp-ollama-lab-__codelineno-10-10"></a><span class="s2">4. Provide recommendations or interesting trivia based on the data</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#lab07-mcp-ollama-lab-__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#lab07-mcp-ollama-lab-__codelineno-10-12"></a><span class="s2">Please provide a comprehensive country analysis.&quot;&quot;&quot;</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#lab07-mcp-ollama-lab-__codelineno-10-13"></a>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#lab07-mcp-ollama-lab-__codelineno-10-14"></a>        <span class="k">return</span> <span class="n">GetPromptResult</span><span class="p">(</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#lab07-mcp-ollama-lab-__codelineno-10-15"></a>            <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Country analysis prompt for </span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#lab07-mcp-ollama-lab-__codelineno-10-16"></a>            <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#lab07-mcp-ollama-lab-__codelineno-10-17"></a>                <span class="p">{</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#lab07-mcp-ollama-lab-__codelineno-10-18"></a>                    <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#lab07-mcp-ollama-lab-__codelineno-10-19"></a>                    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#lab07-mcp-ollama-lab-__codelineno-10-20"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#lab07-mcp-ollama-lab-__codelineno-10-21"></a>                        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">prompt_text</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#lab07-mcp-ollama-lab-__codelineno-10-22"></a>                    <span class="p">}</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#lab07-mcp-ollama-lab-__codelineno-10-23"></a>                <span class="p">}</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#lab07-mcp-ollama-lab-__codelineno-10-24"></a>            <span class="p">]</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#lab07-mcp-ollama-lab-__codelineno-10-25"></a>        <span class="p">)</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#lab07-mcp-ollama-lab-__codelineno-10-26"></a>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#lab07-mcp-ollama-lab-__codelineno-10-27"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#lab07-mcp-ollama-lab-__codelineno-10-28"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown prompt: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-10-setup-handlers">Step 10: Setup Handlers<a class="headerlink" href="#lab07-mcp-ollama-lab-step-10-setup-handlers" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-_setup_handlers">Method <code>_setup_handlers</code><a class="headerlink" href="#lab07-mcp-ollama-lab-method-_setup_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Placeholder for handler setup (decorators handle registration automatically).</li>
<li>Adds structure for future setup logic.</li>
</ul>
<p><strong>Why This Runs:</strong></p>
<ul>
<li>Ensures the initialization completes properly.</li>
<li>Maintains structure for potential future setup logic.</li>
</ul>
<hr />
<p>Update the <code>_setup_handlers</code> method in your class (it should already exist from Step 02):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#lab07-mcp-ollama-lab-__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">_setup_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#lab07-mcp-ollama-lab-__codelineno-11-2"></a>    <span class="c1"># Handlers are registered automatically via decorators</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#lab07-mcp-ollama-lab-__codelineno-11-3"></a>    <span class="k">pass</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-11-run-the-server">Step 11: Run the Server<a class="headerlink" href="#lab07-mcp-ollama-lab-step-11-run-the-server" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-method-run">Method <code>run</code><a class="headerlink" href="#lab07-mcp-ollama-lab-method-run" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Starts the MCP server.</li>
<li>Handles stdio communication.</li>
<li>Manages server lifecycle.</li>
</ul>
<p><strong>Why This Runs Last:</strong></p>
<ul>
<li>Initiates the server operation.</li>
<li>Begins listening for client requests.</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab07-mcp-ollama-lab-__codelineno-12-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#lab07-mcp-ollama-lab-__codelineno-12-2"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">stdio_server</span><span class="p">()</span> <span class="k">as</span> <span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">):</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#lab07-mcp-ollama-lab-__codelineno-12-3"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">create_initialization_options</span><span class="p">())</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-step-12-main-entry-point">Step 12: Main / Entry Point<a class="headerlink" href="#lab07-mcp-ollama-lab-step-12-main-entry-point" title="Permanent link">&para;</a></h2>
<p><strong>What is the Main Entry Point?</strong></p>
<ul>
<li>The starting point of the script.</li>
<li>Initializes and runs the MCP server.</li>
<li>Ensures the server starts when the script is executed.</li>
<li>Uses <code>asyncio.run()</code> to manage the event loop for async operations.</li>
</ul>
<p><strong>Why this runs at the end:</strong></p>
<ul>
<li>Ensures all class definitions and methods are in place before starting the server.</li>
<li>Provides a clear entry point for execution.</li>
<li>Manages the asynchronous nature of the server.</li>
</ul>
<hr />
<p>Add this code at the end of your <code>mcp_ollama.py</code> file:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab07-mcp-ollama-lab-__codelineno-13-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#lab07-mcp-ollama-lab-__codelineno-13-2"></a>    <span class="n">server</span> <span class="o">=</span> <span class="n">CompleteOllamaMCPServer</span><span class="p">()</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#lab07-mcp-ollama-lab-__codelineno-13-3"></a>    <span class="k">await</span> <span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#lab07-mcp-ollama-lab-__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#lab07-mcp-ollama-lab-__codelineno-13-5"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#lab07-mcp-ollama-lab-__codelineno-13-6"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></code></pre></div>
<hr />
<h2 id="lab07-mcp-ollama-lab-error-handling-patterns">Error Handling Patterns<a class="headerlink" href="#lab07-mcp-ollama-lab-error-handling-patterns" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-pattern-1-input-validation">Pattern 1: Input Validation<a class="headerlink" href="#lab07-mcp-ollama-lab-pattern-1-input-validation" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">Input Validation</p>
</div>
<p><strong>Definition:</strong> Ensures tool arguments meet requirements before processing.
<strong>Why:</strong> Prevents runtime errors and provides clear feedback.
<strong>Usage:</strong> Validate inputs early in tool handlers.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab07-mcp-ollama-lab-__codelineno-14-1"></a><span class="k">if</span> <span class="ow">not</span> <span class="n">country</span><span class="p">:</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#lab07-mcp-ollama-lab-__codelineno-14-2"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Country name is required&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For all tool inputs and external data:</p>
<ul>
<li>User-provided parameters and arguments</li>
<li>File paths and resource identifiers</li>
<li>Network requests and API parameters</li>
<li>Database queries and data inputs</li>
<li>Any data that could be malformed or malicious</li>
</ul>
<p><strong>Why it matters:</strong> Prevents crashes, security vulnerabilities, and unexpected behavior by catching invalid inputs early with clear error messages.</p>
<h3 id="lab07-mcp-ollama-lab-pattern-2-graceful-degradation">Pattern 2: Graceful Degradation<a class="headerlink" href="#lab07-mcp-ollama-lab-pattern-2-graceful-degradation" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">Graceful Degradation</p>
</div>
<p><strong>Definition:</strong> Provides partial functionality when full operation isn&rsquo;t possible.
<strong>Why:</strong> Users get some value even when systems fail partially.
<strong>Usage:</strong> Return useful information or fallbacks.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab07-mcp-ollama-lab-__codelineno-15-1"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab07-mcp-ollama-lab-__codelineno-15-2"></a>    <span class="c1"># Attempt to generate AI response with Ollama</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#lab07-mcp-ollama-lab-__codelineno-15-3"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ollama_client</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;llama3.2&#39;</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">)</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#lab07-mcp-ollama-lab-__codelineno-15-4"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#lab07-mcp-ollama-lab-__codelineno-15-5"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#lab07-mcp-ollama-lab-__codelineno-15-6"></a><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#lab07-mcp-ollama-lab-__codelineno-15-7"></a>    <span class="c1"># Return partial results with raw data</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#lab07-mcp-ollama-lab-__codelineno-15-8"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error getting AI response: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Raw Data: </span><span class="si">{</span><span class="n">retrieved_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For external dependencies that might be unreliable:</p>
<ul>
<li>API calls that could timeout or fail</li>
<li>Network-dependent operations</li>
<li>Services with occasional downtime</li>
<li>When partial results are better than no results</li>
</ul>
<p><strong>Why it matters:</strong> Users get some value even when systems are partially broken, improving overall reliability and user experience.</p>
<h3 id="lab07-mcp-ollama-lab-pattern-3-detailed-error-context">Pattern 3: Detailed Error Context<a class="headerlink" href="#lab07-mcp-ollama-lab-pattern-3-detailed-error-context" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">Detailed Error Context</p>
</div>
<p><strong>Definition:</strong> Provides comprehensive debugging information.
<strong>Why:</strong> Enables effective troubleshooting while keeping user messages clean.
<strong>Usage:</strong> Log details internally, expose safe messages to users.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#lab07-mcp-ollama-lab-__codelineno-16-1"></a><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#lab07-mcp-ollama-lab-__codelineno-16-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Internal error loading country data: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#lab07-mcp-ollama-lab-__codelineno-16-3"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;An error occurred while processing country information. Please try again.&quot;</span><span class="p">)]</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For complex operations where debugging might be needed:</p>
<ul>
<li>Multi-step processes with potential failure points</li>
<li>Operations involving external systems</li>
<li>When you need to track error patterns over time</li>
<li>Production environments where detailed logging is crucial</li>
</ul>
<p><strong>Why it matters:</strong> Developers can diagnose issues effectively while users get clear, non-technical error messages.</p>
<hr />
<h2 id="lab07-mcp-ollama-lab-async-operations-and-performance">Async Operations and Performance<a class="headerlink" href="#lab07-mcp-ollama-lab-async-operations-and-performance" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-long-running-operations">Long-Running Operations<a class="headerlink" href="#lab07-mcp-ollama-lab-long-running-operations" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">Long-Running Operations</p>
</div>
<p><strong>Definition:</strong> Operations that take significant time to complete.
<strong>Why:</strong> Prevents timeouts and provides feedback.
<strong>Usage:</strong> Use async/await and provide progress updates.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab07-mcp-ollama-lab-__codelineno-17-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">analyze_country_data</span><span class="p">(</span><span class="n">country</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#lab07-mcp-ollama-lab-__codelineno-17-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting analysis for </span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#lab07-mcp-ollama-lab-__codelineno-17-3"></a>    <span class="c1"># Simulate data processing</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#lab07-mcp-ollama-lab-__codelineno-17-4"></a>    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#lab07-mcp-ollama-lab-__codelineno-17-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analysis completed.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#lab07-mcp-ollama-lab-__codelineno-17-6"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Analysis result for </span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2">&quot;</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For operations that take more than a few seconds:</p>
<ul>
<li>Large file processing or analysis</li>
<li>Complex computations</li>
<li>External API calls with potential delays</li>
<li>Batch operations on multiple items</li>
</ul>
<p><strong>Why it matters:</strong> Prevents timeouts, provides user feedback, enables monitoring and debugging of slow operations.</p>
<h3 id="lab07-mcp-ollama-lab-caching-results">Caching Results<a class="headerlink" href="#lab07-mcp-ollama-lab-caching-results" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">Caching Results</p>
</div>
<p><strong>Definition:</strong> Stores results of expensive operations.
<strong>Why:</strong> Improves response times for repeated requests.
<strong>Usage:</strong> Implement a simple cache with expiration.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab07-mcp-ollama-lab-__codelineno-18-1"></a><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#lab07-mcp-ollama-lab-__codelineno-18-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_cached_country_info</span><span class="p">(</span><span class="n">country</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#lab07-mcp-ollama-lab-__codelineno-18-3"></a>    <span class="k">if</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">cache</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">cache</span><span class="p">[</span><span class="n">country</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3600</span><span class="p">:</span>  <span class="c1"># 1 hour</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#lab07-mcp-ollama-lab-__codelineno-18-4"></a>        <span class="k">return</span> <span class="n">cache</span><span class="p">[</span><span class="n">country</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#lab07-mcp-ollama-lab-__codelineno-18-5"></a>    <span class="c1"># Fetch fresh data</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#lab07-mcp-ollama-lab-__codelineno-18-6"></a>    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fetch_country_data</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#lab07-mcp-ollama-lab-__codelineno-18-7"></a>    <span class="n">cache</span><span class="p">[</span><span class="n">country</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()}</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#lab07-mcp-ollama-lab-__codelineno-18-8"></a>    <span class="k">return</span> <span class="n">result</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For expensive operations that return consistent results:</p>
<ul>
<li>API calls to external services</li>
<li>Complex calculations or data processing</li>
<li>Database queries with static data</li>
<li>File analysis that doesn&rsquo;t change frequently</li>
</ul>
<p><strong>Why it matters:</strong> Dramatically improves response times, reduces resource usage, and provides better user experience for repeated requests.</p>
<hr />
<h2 id="lab07-mcp-ollama-lab-tool-composition">Tool Composition<a class="headerlink" href="#lab07-mcp-ollama-lab-tool-composition" title="Permanent link">&para;</a></h2>
<h3 id="lab07-mcp-ollama-lab-example-multi-step-analysis">Example: Multi-Step Analysis<a class="headerlink" href="#lab07-mcp-ollama-lab-example-multi-step-analysis" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">Multi-Step Analysis</p>
</div>
<p><strong>Definition:</strong> Combining simple tools for complex workflows.
<strong>Why:</strong> Enables sophisticated operations through tool chaining.
<strong>Usage:</strong> Design tools that work well together.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#lab07-mcp-ollama-lab-__codelineno-19-1"></a><span class="c1"># Tool 1: Get country info</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#lab07-mcp-ollama-lab-__codelineno-19-2"></a><span class="c1"># Tool 2: Analyze data</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#lab07-mcp-ollama-lab-__codelineno-19-3"></a><span class="c1"># Tool 3: Generate report</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#lab07-mcp-ollama-lab-__codelineno-19-4"></a><span class="c1"># LLM can chain: country_info -&gt; analyze -&gt; report</span>
</span></code></pre></div>
<p><strong>When to use -</strong> For workflows that require multiple processing steps:</p>
<ul>
<li>Data analysis pipelines</li>
<li>File processing workflows</li>
<li>Multi-stage computations</li>
<li>Complex research tasks</li>
</ul>
<p><strong>Why it matters:</strong> Breaks down complex problems into manageable, reusable components that can be combined in flexible ways.</p>
<h3 id="lab07-mcp-ollama-lab-llm-tool-chaining">LLM Tool Chaining<a class="headerlink" href="#lab07-mcp-ollama-lab-llm-tool-chaining" title="Permanent link">&para;</a></h3>
<div class="admonition question">
<p class="admonition-title">LLM Tool Chaining</p>
</div>
<p><strong>Definition:</strong> AI automatically sequences tool calls.
<strong>Why:</strong> Enables complex reasoning without explicit programming.
<strong>Usage:</strong> Design tool outputs as inputs for other tools.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#lab07-mcp-ollama-lab-__codelineno-20-1"></a><span class="c1"># Example of how an LLM might chain tools:</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#lab07-mcp-ollama-lab-__codelineno-20-2"></a><span class="c1"># 1. Use country_info to get country data</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#lab07-mcp-ollama-lab-__codelineno-20-3"></a><span class="c1"># 2. Use read_file to get historical data file</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#lab07-mcp-ollama-lab-__codelineno-20-4"></a><span class="c1"># 3. Use query_database to store analysis results</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#lab07-mcp-ollama-lab-__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#lab07-mcp-ollama-lab-__codelineno-20-6"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">analyze_country_trends</span><span class="p">(</span><span class="n">country</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#lab07-mcp-ollama-lab-__codelineno-20-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;LLM can automatically chain these calls&quot;&quot;&quot;</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#lab07-mcp-ollama-lab-__codelineno-20-8"></a>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#lab07-mcp-ollama-lab-__codelineno-20-9"></a>    <span class="c1"># Step 1: Get country information</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#lab07-mcp-ollama-lab-__codelineno-20-10"></a>    <span class="n">country_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">call_tool</span><span class="p">(</span><span class="s2">&quot;country_info&quot;</span><span class="p">,</span> <span class="p">{</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#lab07-mcp-ollama-lab-__codelineno-20-11"></a>        <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="n">country</span><span class="p">,</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#lab07-mcp-ollama-lab-__codelineno-20-12"></a>        <span class="s2">&quot;info_types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;capital&quot;</span><span class="p">,</span> <span class="s2">&quot;population&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;foundation_year&quot;</span><span class="p">]</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#lab07-mcp-ollama-lab-__codelineno-20-13"></a>    <span class="p">})</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#lab07-mcp-ollama-lab-__codelineno-20-14"></a>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#lab07-mcp-ollama-lab-__codelineno-20-15"></a>    <span class="c1"># Step 2: Read historical data file</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#lab07-mcp-ollama-lab-__codelineno-20-16"></a>    <span class="n">historical_data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">call_tool</span><span class="p">(</span><span class="s2">&quot;read_file&quot;</span><span class="p">,</span> <span class="p">{</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#lab07-mcp-ollama-lab-__codelineno-20-17"></a>        <span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;data/</span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2">_history.txt&quot;</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#lab07-mcp-ollama-lab-__codelineno-20-18"></a>    <span class="p">})</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#lab07-mcp-ollama-lab-__codelineno-20-19"></a>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#lab07-mcp-ollama-lab-__codelineno-20-20"></a>    <span class="c1"># Step 3: Store analysis in database</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#lab07-mcp-ollama-lab-__codelineno-20-21"></a>    <span class="n">analysis_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#lab07-mcp-ollama-lab-__codelineno-20-22"></a><span class="s2">    INSERT INTO country_analysis (country, info, historical_data, timestamp)</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#lab07-mcp-ollama-lab-__codelineno-20-23"></a><span class="s2">    VALUES (&#39;</span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2">&#39;, &#39;</span><span class="si">{</span><span class="n">country_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#39;, &#39;</span><span class="si">{</span><span class="n">historical_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#39;, datetime(&#39;now&#39;))</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#lab07-mcp-ollama-lab-__codelineno-20-24"></a><span class="s2">    &quot;&quot;&quot;</span>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#lab07-mcp-ollama-lab-__codelineno-20-25"></a>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#lab07-mcp-ollama-lab-__codelineno-20-26"></a>    <span class="n">db_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">call_tool</span><span class="p">(</span><span class="s2">&quot;query_database&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">analysis_query</span><span class="p">})</span>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#lab07-mcp-ollama-lab-__codelineno-20-27"></a>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#lab07-mcp-ollama-lab-__codelineno-20-28"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#lab07-mcp-ollama-lab-__codelineno-20-29"></a>        <span class="s2">&quot;country_info&quot;</span><span class="p">:</span> <span class="n">country_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#lab07-mcp-ollama-lab-__codelineno-20-30"></a>        <span class="s2">&quot;historical&quot;</span><span class="p">:</span> <span class="n">historical_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#lab07-mcp-ollama-lab-__codelineno-20-31"></a>        <span class="s2">&quot;stored&quot;</span><span class="p">:</span> <span class="n">db_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#lab07-mcp-ollama-lab-__codelineno-20-32"></a>    <span class="p">}</span>
</span></code></pre></div>
<p><strong>When to use -</strong> When tasks naturally break down into sequential steps:</p>
<ul>
<li>Research and analysis workflows</li>
<li>Data processing pipelines</li>
<li>Content generation chains</li>
<li>Problem-solving sequences</li>
</ul>
<p><strong>Why it matters:</strong> Enables complex, multi-step reasoning and problem-solving that would be difficult to implement in single tools.</p>
<hr />
<h2 id="lab07-mcp-ollama-lab-hands-on-exercises">Hands-On Exercises<a class="headerlink" href="#lab07-mcp-ollama-lab-hands-on-exercises" title="Permanent link">&para;</a></h2>
<div class="admonition question">
<p class="admonition-title">Exercise 1: Text Processing Tool</p>
</div>
<p><strong>Definition:</strong> A tool for analyzing and processing text content.
<strong>Why:</strong> Enables text manipulation and analysis operations.
<strong>Usage:</strong> Process text for counting, patterns, and metrics.</p>
<div class="codehilite"><pre><span></span><code><span class="o">**</span><span class="n">Task</span><span class="o">:**</span><span class="w"> </span><span class="k">Create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MCP</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n n-Quoted">`process_text`</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">analyzes</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">processes</span><span class="w"> </span><span class="kt">text</span><span class="w"> </span><span class="n">content</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">operations</span><span class="o">:</span><span class="w"> </span><span class="n">counting</span><span class="w"> </span><span class="n">words</span><span class="o">/</span><span class="n">characters</span><span class="o">/</span><span class="k">lines</span><span class="p">,</span><span class="w"> </span><span class="n">finding</span><span class="w"> </span><span class="n">regex</span><span class="w"> </span><span class="n">patterns</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">calculating</span><span class="w"> </span><span class="n">reading</span><span class="w"> </span><span class="kt">time</span><span class="p">.</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n n-Quoted">`CompleteOllamaMCPServer`</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">updating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n n-Quoted">`list_tools()`</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n n-Quoted">`call_tool()`</span><span class="w"> </span><span class="k">handler</span><span class="p">.</span>
</code></pre></div>

<details>
<summary>💡 Complete Exercise 1 Solution</summary>

<h4>Step 1: Add Tool Definition</h4>

Add to `list_tools()`:

<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#lab07-mcp-ollama-lab-__codelineno-21-1"></a><span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#lab07-mcp-ollama-lab-__codelineno-21-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;process_text&quot;</span><span class="p">,</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#lab07-mcp-ollama-lab-__codelineno-21-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze and process text content&quot;</span><span class="p">,</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#lab07-mcp-ollama-lab-__codelineno-21-4"></a>    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#lab07-mcp-ollama-lab-__codelineno-21-5"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#lab07-mcp-ollama-lab-__codelineno-21-6"></a>        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#lab07-mcp-ollama-lab-__codelineno-21-7"></a>            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Text to process&quot;</span><span class="p">},</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#lab07-mcp-ollama-lab-__codelineno-21-8"></a>            <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#lab07-mcp-ollama-lab-__codelineno-21-9"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#lab07-mcp-ollama-lab-__codelineno-21-10"></a>                <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;find_pattern&quot;</span><span class="p">,</span> <span class="s2">&quot;reading_time&quot;</span><span class="p">]},</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#lab07-mcp-ollama-lab-__codelineno-21-11"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Operations to perform&quot;</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#lab07-mcp-ollama-lab-__codelineno-21-12"></a>            <span class="p">},</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#lab07-mcp-ollama-lab-__codelineno-21-13"></a>            <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Regex pattern for find_pattern&quot;</span><span class="p">}</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#lab07-mcp-ollama-lab-__codelineno-21-14"></a>        <span class="p">},</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#lab07-mcp-ollama-lab-__codelineno-21-15"></a>        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;operations&quot;</span><span class="p">]</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#lab07-mcp-ollama-lab-__codelineno-21-16"></a>    <span class="p">}</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#lab07-mcp-ollama-lab-__codelineno-21-17"></a><span class="p">)</span>
</span></code></pre></div>

<h4>Step 2: Add Handler Logic</h4>

Add to `call_tool()`:

<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#lab07-mcp-ollama-lab-__codelineno-22-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;process_text&quot;</span><span class="p">:</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#lab07-mcp-ollama-lab-__codelineno-22-2"></a>    <span class="n">text</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#lab07-mcp-ollama-lab-__codelineno-22-3"></a>    <span class="n">operations</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operations&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#lab07-mcp-ollama-lab-__codelineno-22-4"></a>    <span class="n">pattern</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#lab07-mcp-ollama-lab-__codelineno-22-5"></a>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#lab07-mcp-ollama-lab-__codelineno-22-6"></a>    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#lab07-mcp-ollama-lab-__codelineno-22-7"></a>    <span class="k">if</span> <span class="s2">&quot;count&quot;</span> <span class="ow">in</span> <span class="n">operations</span><span class="p">:</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#lab07-mcp-ollama-lab-__codelineno-22-8"></a>        <span class="n">words</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#lab07-mcp-ollama-lab-__codelineno-22-9"></a>        <span class="n">chars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#lab07-mcp-ollama-lab-__codelineno-22-10"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#lab07-mcp-ollama-lab-__codelineno-22-11"></a>        <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Words: </span><span class="si">{</span><span class="n">words</span><span class="si">}</span><span class="s2">, Characters: </span><span class="si">{</span><span class="n">chars</span><span class="si">}</span><span class="s2">, Lines: </span><span class="si">{</span><span class="n">lines</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#lab07-mcp-ollama-lab-__codelineno-22-12"></a>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#lab07-mcp-ollama-lab-__codelineno-22-13"></a>    <span class="k">if</span> <span class="s2">&quot;find_pattern&quot;</span> <span class="ow">in</span> <span class="n">operations</span> <span class="ow">and</span> <span class="n">pattern</span><span class="p">:</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#lab07-mcp-ollama-lab-__codelineno-22-14"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#lab07-mcp-ollama-lab-__codelineno-22-15"></a>        <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#lab07-mcp-ollama-lab-__codelineno-22-16"></a>        <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Pattern matches: </span><span class="si">{</span><span class="n">matches</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#lab07-mcp-ollama-lab-__codelineno-22-17"></a>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#lab07-mcp-ollama-lab-__codelineno-22-18"></a>    <span class="k">if</span> <span class="s2">&quot;reading_time&quot;</span> <span class="ow">in</span> <span class="n">operations</span><span class="p">:</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#lab07-mcp-ollama-lab-__codelineno-22-19"></a>        <span class="n">words_per_minute</span> <span class="o">=</span> <span class="mi">200</span>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20" href="#lab07-mcp-ollama-lab-__codelineno-22-20"></a>        <span class="n">minutes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">/</span> <span class="n">words_per_minute</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21" href="#lab07-mcp-ollama-lab-__codelineno-22-21"></a>        <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Estimated reading time: </span><span class="si">{</span><span class="n">minutes</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> minutes</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22" href="#lab07-mcp-ollama-lab-__codelineno-22-22"></a>
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23" href="#lab07-mcp-ollama-lab-__codelineno-22-23"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span></code></pre></div>

<h4>Step 3: Test the Tool</h4>

Test with various inputs to verify functionality.

</details>

<hr />
<div class="admonition question">
<p class="admonition-title">Exercise 2: JSON Validator Tool</p>
</div>
<p><strong>Definition:</strong> A tool for validating and processing JSON data.
<strong>Why:</strong> Ensures data integrity and provides JSON utilities.
<strong>Usage:</strong> Validate, format, and compare JSON structures.</p>
<div class="codehilite"><pre><span></span><code><span class="o">**</span><span class="n">Task</span><span class="o">:**</span><span class="w"> </span><span class="k">Create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MCP</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n n-Quoted">`validate_json`</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">validates</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">processes</span><span class="w"> </span><span class="kt">JSON</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">four</span><span class="w"> </span><span class="n">operations</span><span class="o">:</span><span class="w"> </span><span class="n">validating</span><span class="w"> </span><span class="kt">JSON</span><span class="w"> </span><span class="n">syntax</span><span class="p">,</span><span class="w"> </span><span class="n">formatting</span><span class="o">/</span><span class="n">pretty</span><span class="o">-</span><span class="n">printing</span><span class="w"> </span><span class="kt">JSON</span><span class="p">,</span><span class="w"> </span><span class="n">validating</span><span class="w"> </span><span class="k">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="kt">JSON</span><span class="w"> </span><span class="k">schema</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">comparing</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="kt">JSON</span><span class="w"> </span><span class="n">objects</span><span class="p">.</span><span class="w"> </span><span class="n">You</span><span class="s1">&#39;ll need to install the `jsonschema` package and add the necessary imports. Update your server class to include this tool in the `list_tools()` method and `call_tool()` handler.</span>
</code></pre></div>

<details>
<summary>💡 Complete Exercise 2 Solution</summary>

<h4>Step 1: Install Dependencies</h4>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#lab07-mcp-ollama-lab-__codelineno-23-1"></a>pip<span class="w"> </span>install<span class="w"> </span>jsonschema
</span></code></pre></div>

<h4>Step 2: Add Imports</h4>

<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#lab07-mcp-ollama-lab-__codelineno-24-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jsonschema</span>
</span></code></pre></div>

<h4>Step 3: Add Tool Definition</h4>

Add to `list_tools()`:

<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#lab07-mcp-ollama-lab-__codelineno-25-1"></a><span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#lab07-mcp-ollama-lab-__codelineno-25-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;validate_json&quot;</span><span class="p">,</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#lab07-mcp-ollama-lab-__codelineno-25-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Validate and process JSON data&quot;</span><span class="p">,</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#lab07-mcp-ollama-lab-__codelineno-25-4"></a>    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#lab07-mcp-ollama-lab-__codelineno-25-5"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#lab07-mcp-ollama-lab-__codelineno-25-6"></a>        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#lab07-mcp-ollama-lab-__codelineno-25-7"></a>            <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;JSON string to validate&quot;</span><span class="p">},</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#lab07-mcp-ollama-lab-__codelineno-25-8"></a>            <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;validate&quot;</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s2">&quot;schema_validate&quot;</span><span class="p">,</span> <span class="s2">&quot;compare&quot;</span><span class="p">]},</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#lab07-mcp-ollama-lab-__codelineno-25-9"></a>            <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;JSON schema for validation&quot;</span><span class="p">},</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#lab07-mcp-ollama-lab-__codelineno-25-10"></a>            <span class="s2">&quot;json2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second JSON for comparison&quot;</span><span class="p">}</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#lab07-mcp-ollama-lab-__codelineno-25-11"></a>        <span class="p">},</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#lab07-mcp-ollama-lab-__codelineno-25-12"></a>        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s2">&quot;operation&quot;</span><span class="p">]</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#lab07-mcp-ollama-lab-__codelineno-25-13"></a>    <span class="p">}</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#lab07-mcp-ollama-lab-__codelineno-25-14"></a><span class="p">)</span>
</span></code></pre></div>

<h4>Step 4: Add Handler Logic</h4>

Add to `call_tool()`:

<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#lab07-mcp-ollama-lab-__codelineno-26-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;validate_json&quot;</span><span class="p">:</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#lab07-mcp-ollama-lab-__codelineno-26-2"></a>    <span class="n">json_str</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#lab07-mcp-ollama-lab-__codelineno-26-3"></a>    <span class="n">operation</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">,</span> <span class="s2">&quot;validate&quot;</span><span class="p">)</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#lab07-mcp-ollama-lab-__codelineno-26-4"></a>    <span class="n">schema_str</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;schema&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#lab07-mcp-ollama-lab-__codelineno-26-5"></a>    <span class="n">json2_str</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json2&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#lab07-mcp-ollama-lab-__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#lab07-mcp-ollama-lab-__codelineno-26-7"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#lab07-mcp-ollama-lab-__codelineno-26-8"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#lab07-mcp-ollama-lab-__codelineno-26-9"></a>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#lab07-mcp-ollama-lab-__codelineno-26-10"></a>        <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;validate&quot;</span><span class="p">:</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#lab07-mcp-ollama-lab-__codelineno-26-11"></a>            <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;JSON is valid&quot;</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#lab07-mcp-ollama-lab-__codelineno-26-12"></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#lab07-mcp-ollama-lab-__codelineno-26-13"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#lab07-mcp-ollama-lab-__codelineno-26-14"></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;schema_validate&quot;</span> <span class="ow">and</span> <span class="n">schema_str</span><span class="p">:</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#lab07-mcp-ollama-lab-__codelineno-26-15"></a>            <span class="n">schema</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">schema_str</span><span class="p">)</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#lab07-mcp-ollama-lab-__codelineno-26-16"></a>            <span class="n">jsonschema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#lab07-mcp-ollama-lab-__codelineno-26-17"></a>            <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;JSON validates against schema&quot;</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#lab07-mcp-ollama-lab-__codelineno-26-18"></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;compare&quot;</span> <span class="ow">and</span> <span class="n">json2_str</span><span class="p">:</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#lab07-mcp-ollama-lab-__codelineno-26-19"></a>            <span class="n">data2</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json2_str</span><span class="p">)</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#lab07-mcp-ollama-lab-__codelineno-26-20"></a>            <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="n">data2</span><span class="p">:</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#lab07-mcp-ollama-lab-__codelineno-26-21"></a>                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;JSON objects are identical&quot;</span>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#lab07-mcp-ollama-lab-__codelineno-26-22"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#lab07-mcp-ollama-lab-__codelineno-26-23"></a>                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;JSON objects differ&quot;</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#lab07-mcp-ollama-lab-__codelineno-26-24"></a>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#lab07-mcp-ollama-lab-__codelineno-26-25"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#lab07-mcp-ollama-lab-__codelineno-26-26"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#lab07-mcp-ollama-lab-__codelineno-26-27"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span></code></pre></div>

<h4>Step 5: Test the Tool</h4>

Test validation, formatting, and comparison operations.

</details>

<hr />
<div class="admonition question">
<p class="admonition-title">Exercise 3: Web Scraper Tool</p>
</div>
<p><strong>Definition:</strong> A tool for extracting content from web pages.
<strong>Why:</strong> Enables data collection from web sources.
<strong>Usage:</strong> Fetch and parse web content safely.</p>
<div class="codehilite"><pre><span></span><code><span class="o">**</span><span class="n">Task</span><span class="o">:**</span><span class="w"> </span><span class="k">Create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MCP</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n n-Quoted">`scrape_web`</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">extracts</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">web</span><span class="w"> </span><span class="n">pages</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="k">fetch</span><span class="w"> </span><span class="n">web</span><span class="w"> </span><span class="n">pages</span><span class="p">,</span><span class="w"> </span><span class="n">extract</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">CSS</span><span class="w"> </span><span class="n">selectors</span><span class="p">,</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">clean</span><span class="w"> </span><span class="kt">text</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="k">errors</span><span class="w"> </span><span class="n">gracefully</span><span class="p">.</span><span class="w"> </span><span class="n">You</span><span class="s1">&#39;ll need to install the `beautifulsoup4` and `lxml` packages and add the necessary imports. Update your server class to include this tool in the `list_tools()` method and `call_tool()` handler.</span>
</code></pre></div>

<details>
<summary>💡 Complete Exercise 3 Solution</summary>

<h4>Step 1: Install Dependencies</h4>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#lab07-mcp-ollama-lab-__codelineno-27-1"></a>pip<span class="w"> </span>install<span class="w"> </span>beautifulsoup4<span class="w"> </span>lxml
</span></code></pre></div>

<h4>Step 2: Add Imports</h4>

<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#lab07-mcp-ollama-lab-__codelineno-28-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></code></pre></div>

<h4>Step 3: Add Tool Definition</h4>

Add to `list_tools()`:

<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#lab07-mcp-ollama-lab-__codelineno-29-1"></a><span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#lab07-mcp-ollama-lab-__codelineno-29-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;scrape_web&quot;</span><span class="p">,</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#lab07-mcp-ollama-lab-__codelineno-29-3"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extract content from web pages&quot;</span><span class="p">,</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#lab07-mcp-ollama-lab-__codelineno-29-4"></a>    <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#lab07-mcp-ollama-lab-__codelineno-29-5"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#lab07-mcp-ollama-lab-__codelineno-29-6"></a>        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#lab07-mcp-ollama-lab-__codelineno-29-7"></a>            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;URL to scrape&quot;</span><span class="p">},</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#lab07-mcp-ollama-lab-__codelineno-29-8"></a>            <span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CSS selector for content&quot;</span><span class="p">},</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#lab07-mcp-ollama-lab-__codelineno-29-9"></a>            <span class="s2">&quot;include_html&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Include HTML tags&quot;</span><span class="p">}</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#lab07-mcp-ollama-lab-__codelineno-29-10"></a>        <span class="p">},</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#lab07-mcp-ollama-lab-__codelineno-29-11"></a>        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#lab07-mcp-ollama-lab-__codelineno-29-12"></a>    <span class="p">}</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#lab07-mcp-ollama-lab-__codelineno-29-13"></a><span class="p">)</span>
</span></code></pre></div>

<h4>Step 4: Add Handler Logic</h4>

Add to `call_tool()`:

<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#lab07-mcp-ollama-lab-__codelineno-30-1"></a><span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;scrape_web&quot;</span><span class="p">:</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#lab07-mcp-ollama-lab-__codelineno-30-2"></a>    <span class="n">url</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#lab07-mcp-ollama-lab-__codelineno-30-3"></a>    <span class="n">selector</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;selector&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#lab07-mcp-ollama-lab-__codelineno-30-4"></a>    <span class="n">include_html</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;include_html&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#lab07-mcp-ollama-lab-__codelineno-30-5"></a>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#lab07-mcp-ollama-lab-__codelineno-30-6"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#lab07-mcp-ollama-lab-__codelineno-30-7"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#lab07-mcp-ollama-lab-__codelineno-30-8"></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#lab07-mcp-ollama-lab-__codelineno-30-9"></a>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#lab07-mcp-ollama-lab-__codelineno-30-10"></a>        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#lab07-mcp-ollama-lab-__codelineno-30-11"></a>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#lab07-mcp-ollama-lab-__codelineno-30-12"></a>        <span class="k">if</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#lab07-mcp-ollama-lab-__codelineno-30-13"></a>            <span class="n">elements</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#lab07-mcp-ollama-lab-__codelineno-30-14"></a>            <span class="k">if</span> <span class="n">include_html</span><span class="p">:</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#lab07-mcp-ollama-lab-__codelineno-30-15"></a>                <span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">)</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#lab07-mcp-ollama-lab-__codelineno-30-16"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#lab07-mcp-ollama-lab-__codelineno-30-17"></a>                <span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">)</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#lab07-mcp-ollama-lab-__codelineno-30-18"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#lab07-mcp-ollama-lab-__codelineno-30-19"></a>            <span class="n">content</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">include_html</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#lab07-mcp-ollama-lab-__codelineno-30-20"></a>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#lab07-mcp-ollama-lab-__codelineno-30-21"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">content</span><span class="p">)]</span>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#lab07-mcp-ollama-lab-__codelineno-30-22"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#lab07-mcp-ollama-lab-__codelineno-30-23"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error scraping web: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span></code></pre></div>

<h4>Step 5: Test the Tool</h4>

Test with different URLs and selectors, handling errors gracefully.

</details></section><section class="print-page" id="lab08-kagent-lab" heading-number="2.10"><h1 id="lab08-kagent-lab-lab-08-k-agent-integration">Lab 08: K-Agent Integration<a class="headerlink" href="#lab08-kagent-lab-lab-08-k-agent-integration" title="Permanent link">&para;</a></h1>
<h2 id="lab08-kagent-lab-overview">Overview<a class="headerlink" href="#lab08-kagent-lab-overview" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Welcome to the advanced MCP lab!</p>
</li>
<li>
<p>Now that you&rsquo;ve mastered the fundamentals of MCP servers, tools, resources, and prompts, it&rsquo;s time to apply your knowledge to a real-world scenario: <strong>building and implementing a K-Agent</strong>.</p>
</li>
<li>
<p>A K-Agent is an MCP server specifically designed to interact with Kubernetes clusters.</p>
</li>
<li>
<p>In this lab, you&rsquo;ll build a focused K-Agent that communicates with a Kubernetes cluster and collects logs from all pods - a critical capability for monitoring, debugging, and operational intelligence.</p>
</li>
<li>
<p>This lab bridges the gap between MCP theory and practical Kubernetes operations, showing how MCP servers can enhance DevOps workflows and provide AI-powered insights into cluster health and application behavior.</p>
</li>
</ul>
<hr />
<h2 id="lab08-kagent-lab-learning-objectives">Learning Objectives<a class="headerlink" href="#lab08-kagent-lab-learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lab, you will:</p>
<ul>
<li>Understand the concept and value of K-Agents (Kubernetes MCP servers)</li>
<li>Use pre-configured Kubernetes cluster access</li>
<li>Build MCP tools for pod log collection</li>
<li>Implement error handling for cluster operations</li>
</ul>
<hr />
<h2 id="lab08-kagent-lab-prerequisites">Prerequisites<a class="headerlink" href="#lab08-kagent-lab-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Completed <a href="#lab08-kagent-lab05-mcp-prompts">Lab 5 - MCP Prompts and Integration</a></li>
<li><strong>A running Kubernetes cluster</strong> (OrbStack, Docker Desktop, Minikube, kind, or remote cluster)</li>
<li><strong>kubectl installed and configured</strong> with access to your cluster (<code>kubectl cluster-info</code> should work)</li>
<li>Basic understanding of Kubernetes concepts (pods, namespaces, kubectl)</li>
<li>Familiarity with container orchestration principles</li>
<li>Understanding of log aggregation and monitoring concepts</li>
</ul>
<div class="admonition debug">
<p class="admonition-title">Verify Kubernetes Setup</p>
<ul>
<li>
<p>Before starting this lab, ensure your Kubernetes environment is ready:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#lab08-kagent-lab-__codelineno-0-1"></a><span class="c1"># Check cluster access</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#lab08-kagent-lab-__codelineno-0-2"></a>kubectl<span class="w"> </span>cluster-info
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#lab08-kagent-lab-__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#lab08-kagent-lab-__codelineno-0-4"></a><span class="c1"># Verify you can list pods</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#lab08-kagent-lab-__codelineno-0-5"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--all-namespaces
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#lab08-kagent-lab-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#lab08-kagent-lab-__codelineno-0-7"></a><span class="c1"># Check your kubeconfig</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#lab08-kagent-lab-__codelineno-0-8"></a>kubectl<span class="w"> </span>config<span class="w"> </span>view
</span></code></pre></div>
</li>
</ul>
</div>
<hr />
<h2 id="lab08-kagent-lab-what-is-a-k-agent">What is a K-Agent?<a class="headerlink" href="#lab08-kagent-lab-what-is-a-k-agent" title="Permanent link">&para;</a></h2>
<p>A <code>**K-Agent**</code> is an <code>MCP server</code> that specializes in Kubernetes operations.</p>
<p>Unlike generic MCP servers, K-Agents are designed specifically for:</p>
<ul>
<li><strong>Cluster Communication</strong>: Secure, authenticated access to Kubernetes APIs</li>
<li><strong>Operational Intelligence</strong>: Real-time insights into cluster health and performance</li>
<li><strong>Log Analytics</strong>: Collection and analysis of application and system logs</li>
<li><strong>Resource Management</strong>: Monitoring and managing Kubernetes resources</li>
<li><strong>Troubleshooting</strong>: Automated diagnosis of cluster and application issues</li>
</ul>
<hr />
<h3 id="lab08-kagent-lab-why-k-agents-matter">Why K-Agents Matter<a class="headerlink" href="#lab08-kagent-lab-why-k-agents-matter" title="Permanent link">&para;</a></h3>
<ul>
<li>In modern DevOps environments, Kubernetes clusters generate enormous amounts of operational data.</li>
</ul>
<p>K-Agents provide:</p>
<ul>
<li><strong>AI-Powered Monitoring</strong>: Intelligent analysis of logs and metrics</li>
<li><strong>Automated Troubleshooting</strong>: AI-assisted diagnosis of issues</li>
<li><strong>Operational Insights</strong>: Pattern recognition in cluster behavior</li>
<li><strong>Enhanced Observability</strong>: Structured access to distributed system data</li>
<li><strong>Seamless Integration</strong>: MCP tools that interact directly with Kubernetes resources</li>
<li><strong>Improved DevOps Workflows</strong>: Streamlined operations through AI-driven tools</li>
<li><strong>Dashboarding and Alerts</strong>: Proactive monitoring with AI-generated alerts</li>
<li><strong>Custom Tooling</strong>: Tailored MCP tools for specific Kubernetes tasks</li>
</ul>
<hr />
<h2 id="lab08-kagent-lab-lab-architecture">Lab Architecture<a class="headerlink" href="#lab08-kagent-lab-lab-architecture" title="Permanent link">&para;</a></h2>
<p>Your K-Agent will implement a focused set of capabilities:</p>
<pre class="mermaid"><code>graph TB
    subgraph "MCP Client (AI/Inspector)"
        Client[MCP Client]
    end

    subgraph "K-Agent MCP Server"
        Server[K-Agent Server]
        Tools[MCP Tools]
        K8sClient[Kubernetes Client]

        Server --&gt; Tools
        Tools --&gt; K8sClient
    end

    subgraph "Kubernetes Cluster"
        API[Kubernetes API]
        Pods[Pods]
        Logs[Container Logs]

        API --&gt; Pods
        Pods --&gt; Logs
    end

    Client --&gt;|"stdio/JSON-RPC"| Server
    K8sClient --&gt;|"REST API"| API

    Tools -.-&gt;|"list_pods"| API
    Tools -.-&gt;|"collect_pod_logs"| Logs

    style Server fill:#4CAF50
    style Tools fill:#2196F3
    style K8sClient fill:#FF9800
    style API fill:#9C27B0</code></pre>
<hr />
<h3 id="lab08-kagent-lab-core-components">Core Components<a class="headerlink" href="#lab08-kagent-lab-core-components" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Kubernetes Client Integration</strong></p>
<ul>
<li>Secure cluster authentication</li>
<li>API communication handling</li>
<li>Error management for cluster operations</li>
</ul>
</li>
<li>
<p><strong>Log Collection Tools</strong></p>
<ul>
<li>Pod discovery across namespaces</li>
<li>Log retrieval from all containers</li>
<li>Structured log formatting</li>
</ul>
</li>
<li>
<p><strong>Resource Management</strong></p>
<ul>
<li>Namespace enumeration</li>
<li>Pod status monitoring</li>
<li>Health check capabilities</li>
</ul>
</li>
</ol>
<hr />
<h2 id="lab08-kagent-lab-hands-on-exercise">Hands-On Exercise<a class="headerlink" href="#lab08-kagent-lab-hands-on-exercise" title="Permanent link">&para;</a></h2>
<h3 id="lab08-kagent-lab-step-1-project-setup">Step 1: Project Setup<a class="headerlink" href="#lab08-kagent-lab-step-1-project-setup" title="Permanent link">&para;</a></h3>
<p>Create a new MCP server project with Kubernetes dependencies:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#lab08-kagent-lab-__codelineno-1-1"></a><span class="c1"># Create project directory and navigate to it</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#lab08-kagent-lab-__codelineno-1-2"></a>mkdir<span class="w"> </span>k-agent-logs
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#lab08-kagent-lab-__codelineno-1-3"></a><span class="nb">cd</span><span class="w"> </span>k-agent-logs
</span></code></pre></div>
<p><br></p>
<ul>
<li>Create a new <code>package.json</code> file inside the <code>k-agent-logs</code> directory with the following content:</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#lab08-kagent-lab-__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#lab08-kagent-lab-__codelineno-2-2"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k-agent-logs&quot;</span><span class="p">,</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#lab08-kagent-lab-__codelineno-2-3"></a><span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#lab08-kagent-lab-__codelineno-2-4"></a><span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;K-Agent MCP server for Kubernetes log collection&quot;</span><span class="p">,</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#lab08-kagent-lab-__codelineno-2-5"></a><span class="w">  </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dist/index.js&quot;</span><span class="p">,</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#lab08-kagent-lab-__codelineno-2-6"></a><span class="w">  </span><span class="nt">&quot;scripts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#lab08-kagent-lab-__codelineno-2-7"></a><span class="w">    </span><span class="nt">&quot;build&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tsc&quot;</span><span class="p">,</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#lab08-kagent-lab-__codelineno-2-8"></a><span class="w">    </span><span class="nt">&quot;dev&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tsx src/index.ts&quot;</span><span class="p">,</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#lab08-kagent-lab-__codelineno-2-9"></a><span class="w">    </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;node dist/index.js&quot;</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#lab08-kagent-lab-__codelineno-2-10"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#lab08-kagent-lab-__codelineno-2-11"></a><span class="w">  </span><span class="nt">&quot;keywords&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;kubernetes&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;mcp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;logs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;monitoring&quot;</span><span class="p">],</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#lab08-kagent-lab-__codelineno-2-12"></a><span class="w">  </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#lab08-kagent-lab-__codelineno-2-13"></a><span class="w">  </span><span class="nt">&quot;license&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ISC&quot;</span><span class="p">,</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#lab08-kagent-lab-__codelineno-2-14"></a><span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;commonjs&quot;</span><span class="p">,</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#lab08-kagent-lab-__codelineno-2-15"></a><span class="w">  </span><span class="nt">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#lab08-kagent-lab-__codelineno-2-16"></a><span class="w">    </span><span class="nt">&quot;@kubernetes/client-node&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^1.4.0&quot;</span><span class="p">,</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#lab08-kagent-lab-__codelineno-2-17"></a><span class="w">    </span><span class="nt">&quot;@modelcontextprotocol/sdk&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^1.25.2&quot;</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#lab08-kagent-lab-__codelineno-2-18"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#lab08-kagent-lab-__codelineno-2-19"></a><span class="w">  </span><span class="nt">&quot;devDependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#lab08-kagent-lab-__codelineno-2-20"></a><span class="w">    </span><span class="nt">&quot;@types/node&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^25.0.3&quot;</span><span class="p">,</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#lab08-kagent-lab-__codelineno-2-21"></a><span class="w">    </span><span class="nt">&quot;tsx&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^4.21.0&quot;</span><span class="p">,</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#lab08-kagent-lab-__codelineno-2-22"></a><span class="w">    </span><span class="nt">&quot;typescript&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^5.9.3&quot;</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#lab08-kagent-lab-__codelineno-2-23"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#lab08-kagent-lab-__codelineno-2-24"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<ul>
<li>Run the following command to install the dependencies:</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#lab08-kagent-lab-__codelineno-3-1"></a>npm<span class="w"> </span>install
</span></code></pre></div>
<p>This will create <code>node_modules/</code> and <code>package-lock.json</code> in your <code>k-agent-logs</code> directory.</p>
<hr />
<h3 id="lab08-kagent-lab-step-2-kubernetes-client-configuration-complete-server-setup">Step 2: Kubernetes Client Configuration &amp; Complete Server Setup<a class="headerlink" href="#lab08-kagent-lab-step-2-kubernetes-client-configuration-complete-server-setup" title="Permanent link">&para;</a></h3>
<p>Create an <code>src</code> directory, inside the <code>k-agent-logs</code> directory, and an empty file named <code>index.ts</code> inside it:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#lab08-kagent-lab-__codelineno-4-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>src<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>touch<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><br></p>
<p>Create your complete K-Agent server by pasting the following code inside <code>src/index.ts</code>:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#lab08-kagent-lab-__codelineno-5-1"></a><span class="c1">// Import MCP SDK components and Kubernetes client</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#lab08-kagent-lab-__codelineno-5-2"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#lab08-kagent-lab-__codelineno-5-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#lab08-kagent-lab-__codelineno-5-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#lab08-kagent-lab-__codelineno-5-5"></a><span class="w">  </span><span class="nx">CallToolRequestSchema</span><span class="p">,</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#lab08-kagent-lab-__codelineno-5-6"></a><span class="w">  </span><span class="nx">ErrorCode</span><span class="p">,</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#lab08-kagent-lab-__codelineno-5-7"></a><span class="w">  </span><span class="nx">ListResourcesRequestSchema</span><span class="p">,</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#lab08-kagent-lab-__codelineno-5-8"></a><span class="w">  </span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#lab08-kagent-lab-__codelineno-5-9"></a><span class="w">  </span><span class="nx">McpError</span><span class="p">,</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#lab08-kagent-lab-__codelineno-5-10"></a><span class="w">  </span><span class="nx">ReadResourceRequestSchema</span><span class="p">,</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#lab08-kagent-lab-__codelineno-5-11"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#lab08-kagent-lab-__codelineno-5-12"></a><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">k8s</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@kubernetes/client-node&quot;</span><span class="p">;</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#lab08-kagent-lab-__codelineno-5-13"></a>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#lab08-kagent-lab-__codelineno-5-14"></a><span class="kd">class</span><span class="w"> </span><span class="nx">KAgentServer</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#lab08-kagent-lab-__codelineno-5-15"></a><span class="w">  </span><span class="c1">// Store Kubernetes API clients (for talking to your cluster)</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#lab08-kagent-lab-__codelineno-5-16"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">k8sConfig</span><span class="o">:</span><span class="w"> </span><span class="kt">k8s.KubeConfig</span><span class="p">;</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#lab08-kagent-lab-__codelineno-5-17"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">k8sAppsApi</span><span class="o">:</span><span class="w"> </span><span class="kt">k8s.AppsV1Api</span><span class="p">;</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#lab08-kagent-lab-__codelineno-5-18"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">k8sCoreApi</span><span class="o">:</span><span class="w"> </span><span class="kt">k8s.CoreV1Api</span><span class="p">;</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#lab08-kagent-lab-__codelineno-5-19"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">server</span><span class="o">:</span><span class="w"> </span><span class="kt">Server</span><span class="p">;</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#lab08-kagent-lab-__codelineno-5-20"></a>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#lab08-kagent-lab-__codelineno-5-21"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#lab08-kagent-lab-__codelineno-5-22"></a><span class="w">    </span><span class="c1">// Initialize connection to your Kubernetes cluster (uses ~/.kube/config)</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#lab08-kagent-lab-__codelineno-5-23"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">k8s</span><span class="p">.</span><span class="nx">KubeConfig</span><span class="p">();</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#lab08-kagent-lab-__codelineno-5-24"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sConfig</span><span class="p">.</span><span class="nx">loadFromDefault</span><span class="p">();</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#lab08-kagent-lab-__codelineno-5-25"></a>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#lab08-kagent-lab-__codelineno-5-26"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sAppsApi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sConfig</span><span class="p">.</span><span class="nx">makeApiClient</span><span class="p">(</span><span class="nx">k8s</span><span class="p">.</span><span class="nx">AppsV1Api</span><span class="p">);</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#lab08-kagent-lab-__codelineno-5-27"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sCoreApi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sConfig</span><span class="p">.</span><span class="nx">makeApiClient</span><span class="p">(</span><span class="nx">k8s</span><span class="p">.</span><span class="nx">CoreV1Api</span><span class="p">);</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#lab08-kagent-lab-__codelineno-5-28"></a>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#lab08-kagent-lab-__codelineno-5-29"></a><span class="w">    </span><span class="c1">// Create MCP server that AI tools can connect to</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#lab08-kagent-lab-__codelineno-5-30"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Server</span><span class="p">(</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#lab08-kagent-lab-__codelineno-5-31"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#lab08-kagent-lab-__codelineno-5-32"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;k-agent-logs&quot;</span><span class="p">,</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#lab08-kagent-lab-__codelineno-5-33"></a><span class="w">        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#lab08-kagent-lab-__codelineno-5-34"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#lab08-kagent-lab-__codelineno-5-35"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#lab08-kagent-lab-__codelineno-5-36"></a><span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#lab08-kagent-lab-__codelineno-5-37"></a><span class="w">          </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#lab08-kagent-lab-__codelineno-5-38"></a><span class="w">          </span><span class="nx">resources</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#lab08-kagent-lab-__codelineno-5-39"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#lab08-kagent-lab-__codelineno-5-40"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#lab08-kagent-lab-__codelineno-5-41"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#lab08-kagent-lab-__codelineno-5-42"></a>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#lab08-kagent-lab-__codelineno-5-43"></a><span class="w">    </span><span class="c1">// Handle incoming MCP requests (you&#39;ll add tools here next)</span>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#lab08-kagent-lab-__codelineno-5-44"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupHandlers</span><span class="p">();</span>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#lab08-kagent-lab-__codelineno-5-45"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#lab08-kagent-lab-__codelineno-5-46"></a>
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#lab08-kagent-lab-__codelineno-5-47"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#lab08-kagent-lab-__codelineno-5-48"></a><span class="w">    </span><span class="c1">// TODO: Implement MCP handlers</span>
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#lab08-kagent-lab-__codelineno-5-49"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#lab08-kagent-lab-__codelineno-5-50"></a>
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#lab08-kagent-lab-__codelineno-5-51"></a><span class="w">  </span><span class="c1">// Start the server and listen for connections</span>
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#lab08-kagent-lab-__codelineno-5-52"></a><span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#lab08-kagent-lab-__codelineno-5-53"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdioServerTransport</span><span class="p">();</span>
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#lab08-kagent-lab-__codelineno-5-54"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">transport</span><span class="p">);</span>
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#lab08-kagent-lab-__codelineno-5-55"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;K-Agent MCP server running on stdio&quot;</span><span class="p">);</span>
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#lab08-kagent-lab-__codelineno-5-56"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#lab08-kagent-lab-__codelineno-5-57"></a><span class="p">}</span>
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#lab08-kagent-lab-__codelineno-5-58"></a>
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#lab08-kagent-lab-__codelineno-5-59"></a><span class="c1">// Actually run the server</span>
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#lab08-kagent-lab-__codelineno-5-60"></a><span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">KAgentServer</span><span class="p">();</span>
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#lab08-kagent-lab-__codelineno-5-61"></a><span class="nx">server</span><span class="p">.</span><span class="nx">run</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
</span></code></pre></div>
<p><br></p>
<p>Create a file named <code>tsconfig.json</code> inside the <code>k-agent-logs</code> directory (not inside <code>src</code>):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#lab08-kagent-lab-__codelineno-6-1"></a><span class="nb">cd</span><span class="w"> </span>..<span class="w">  </span><span class="c1"># Go back to k-agent-logs directory</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#lab08-kagent-lab-__codelineno-6-2"></a>touch<span class="w"> </span>tsconfig.json
</span></code></pre></div>
<p><br></p>
<p>Paste the following content into <code>tsconfig.json</code>:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#lab08-kagent-lab-__codelineno-7-1"></a><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#lab08-kagent-lab-__codelineno-7-2"></a><span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#lab08-kagent-lab-__codelineno-7-3"></a><span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES2022&quot;</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#lab08-kagent-lab-__codelineno-7-4"></a><span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;commonjs&quot;</span><span class="p">,</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#lab08-kagent-lab-__codelineno-7-5"></a><span class="w">    </span><span class="nt">&quot;lib&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ES2022&quot;</span><span class="p">],</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#lab08-kagent-lab-__codelineno-7-6"></a><span class="w">    </span><span class="nt">&quot;outDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./dist&quot;</span><span class="p">,</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#lab08-kagent-lab-__codelineno-7-7"></a><span class="w">    </span><span class="nt">&quot;rootDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src&quot;</span><span class="p">,</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#lab08-kagent-lab-__codelineno-7-8"></a><span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#lab08-kagent-lab-__codelineno-7-9"></a><span class="w">    </span><span class="nt">&quot;esModuleInterop&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#lab08-kagent-lab-__codelineno-7-10"></a><span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#lab08-kagent-lab-__codelineno-7-11"></a><span class="w">    </span><span class="nt">&quot;forceConsistentCasingInFileNames&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#lab08-kagent-lab-__codelineno-7-12"></a><span class="w">    </span><span class="nt">&quot;resolveJsonModule&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#lab08-kagent-lab-__codelineno-7-13"></a><span class="w">    </span><span class="nt">&quot;declaration&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#lab08-kagent-lab-__codelineno-7-14"></a><span class="w">    </span><span class="nt">&quot;declarationMap&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#lab08-kagent-lab-__codelineno-7-15"></a><span class="w">    </span><span class="nt">&quot;sourceMap&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#lab08-kagent-lab-__codelineno-7-16"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#lab08-kagent-lab-__codelineno-7-17"></a><span class="w">  </span><span class="nt">&quot;include&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/**/*&quot;</span><span class="p">],</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#lab08-kagent-lab-__codelineno-7-18"></a><span class="w">  </span><span class="nt">&quot;exclude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node_modules&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dist&quot;</span><span class="p">]</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#lab08-kagent-lab-__codelineno-7-19"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Test that it works:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#lab08-kagent-lab-__codelineno-8-1"></a>npm<span class="w"> </span>run<span class="w"> </span>dev
</span></code></pre></div>
<p>You should see: <code>K-Agent MCP server running on stdio</code></p>
<p><br></p>
<p>!!! warning &ldquo;If you get errors:&rdquo; - <code>Missing script: "dev"</code> → You didn&rsquo;t update package.json (go back to step 2) - <code>Cannot find module</code> → Make sure you&rsquo;re in the k-agent-logs directory - Other errors → Check that src/index.ts has the correct code</p>
<hr />
<h3 id="lab08-kagent-lab-step-3-pod-discovery-tool">Step 3: Pod Discovery Tool<a class="headerlink" href="#lab08-kagent-lab-step-3-pod-discovery-tool" title="Permanent link">&para;</a></h3>
<p>Implement pod enumeration across namespaces with the <code>list_pods</code> tool.</p>
<p><br></p>
<h4 id="lab08-kagent-lab-update-setuphandlers-method">Update setupHandlers() Method<a class="headerlink" href="#lab08-kagent-lab-update-setuphandlers-method" title="Permanent link">&para;</a></h4>
<p>Open your <code>src/index.ts</code> file and find the <code>setupHandlers()</code> method. Replace the entire method with the following code:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#lab08-kagent-lab-__codelineno-9-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#lab08-kagent-lab-__codelineno-9-2"></a><span class="w">  </span><span class="c1">// List available tools</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#lab08-kagent-lab-__codelineno-9-3"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#lab08-kagent-lab-__codelineno-9-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#lab08-kagent-lab-__codelineno-9-5"></a><span class="w">      </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#lab08-kagent-lab-__codelineno-9-6"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#lab08-kagent-lab-__codelineno-9-7"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;list_pods&quot;</span><span class="p">,</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#lab08-kagent-lab-__codelineno-9-8"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;List all pods across namespaces with their status&quot;</span><span class="p">,</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#lab08-kagent-lab-__codelineno-9-9"></a><span class="w">          </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#lab08-kagent-lab-__codelineno-9-10"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#lab08-kagent-lab-__codelineno-9-11"></a><span class="w">            </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#lab08-kagent-lab-__codelineno-9-12"></a><span class="w">              </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#lab08-kagent-lab-__codelineno-9-13"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#lab08-kagent-lab-__codelineno-9-14"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Optional: Filter by specific namespace&quot;</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#lab08-kagent-lab-__codelineno-9-15"></a><span class="w">              </span><span class="p">}</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#lab08-kagent-lab-__codelineno-9-16"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#lab08-kagent-lab-__codelineno-9-17"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#lab08-kagent-lab-__codelineno-9-18"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#lab08-kagent-lab-__codelineno-9-19"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#lab08-kagent-lab-__codelineno-9-20"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#lab08-kagent-lab-__codelineno-9-21"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#lab08-kagent-lab-__codelineno-9-22"></a>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#lab08-kagent-lab-__codelineno-9-23"></a><span class="w">  </span><span class="c1">// Handle tool calls</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#lab08-kagent-lab-__codelineno-9-24"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">CallToolRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#lab08-kagent-lab-__codelineno-9-25"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="o">:</span><span class="w"> </span><span class="kt">args</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#lab08-kagent-lab-__codelineno-9-26"></a>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#lab08-kagent-lab-__codelineno-9-27"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#lab08-kagent-lab-__codelineno-9-28"></a><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#lab08-kagent-lab-__codelineno-9-29"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;list_pods&quot;</span><span class="o">:</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#lab08-kagent-lab-__codelineno-9-30"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleListPods</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#lab08-kagent-lab-__codelineno-9-31"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#lab08-kagent-lab-__codelineno-9-32"></a><span class="w">          </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">McpError</span><span class="p">(</span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#lab08-kagent-lab-__codelineno-9-33"></a><span class="w">            </span><span class="nx">ErrorCode</span><span class="p">.</span><span class="nx">MethodNotFound</span><span class="p">,</span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#lab08-kagent-lab-__codelineno-9-34"></a><span class="w">            </span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#lab08-kagent-lab-__codelineno-9-35"></a><span class="w">          </span><span class="p">);</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#lab08-kagent-lab-__codelineno-9-36"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#lab08-kagent-lab-__codelineno-9-37"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#lab08-kagent-lab-__codelineno-9-38"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">McpError</span><span class="p">(</span>
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#lab08-kagent-lab-__codelineno-9-39"></a><span class="w">        </span><span class="nx">ErrorCode</span><span class="p">.</span><span class="ne">InternalError</span><span class="p">,</span>
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40" href="#lab08-kagent-lab-__codelineno-9-40"></a><span class="w">        </span><span class="sb">`Tool execution failed: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error.message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">String</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-9-41"><a id="__codelineno-9-41" name="__codelineno-9-41" href="#lab08-kagent-lab-__codelineno-9-41"></a><span class="w">      </span><span class="p">);</span>
</span><span id="__span-9-42"><a id="__codelineno-9-42" name="__codelineno-9-42" href="#lab08-kagent-lab-__codelineno-9-42"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-43"><a id="__codelineno-9-43" name="__codelineno-9-43" href="#lab08-kagent-lab-__codelineno-9-43"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-9-44"><a id="__codelineno-9-44" name="__codelineno-9-44" href="#lab08-kagent-lab-__codelineno-9-44"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<h4 id="lab08-kagent-lab-add-handler-methods">Add Handler Methods<a class="headerlink" href="#lab08-kagent-lab-add-handler-methods" title="Permanent link">&para;</a></h4>
<p>Below the <code>setupHandlers()</code> method, <strong>before the <code>async run()</code> method</strong>, add the following new methods:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#lab08-kagent-lab-__codelineno-10-1"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">handleListPods</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#lab08-kagent-lab-__codelineno-10-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">namespace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="o">?</span><span class="p">.</span><span class="nx">namespace</span><span class="p">;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#lab08-kagent-lab-__codelineno-10-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">pods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getPods</span><span class="p">(</span><span class="nx">namespace</span><span class="p">);</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#lab08-kagent-lab-__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#lab08-kagent-lab-__codelineno-10-5"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">podList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pods</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">pod</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#lab08-kagent-lab-__codelineno-10-6"></a><span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata?.name</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#lab08-kagent-lab-__codelineno-10-7"></a><span class="w">    </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata?.namespace</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#lab08-kagent-lab-__codelineno-10-8"></a><span class="w">    </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.status?.phase</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#lab08-kagent-lab-__codelineno-10-9"></a><span class="w">    </span><span class="nx">containers</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.spec?.containers?.map</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[]</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#lab08-kagent-lab-__codelineno-10-10"></a><span class="w">  </span><span class="p">}));</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#lab08-kagent-lab-__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#lab08-kagent-lab-__codelineno-10-12"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#lab08-kagent-lab-__codelineno-10-13"></a><span class="w">    </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#lab08-kagent-lab-__codelineno-10-14"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#lab08-kagent-lab-__codelineno-10-15"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#lab08-kagent-lab-__codelineno-10-16"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">podList</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#lab08-kagent-lab-__codelineno-10-17"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#lab08-kagent-lab-__codelineno-10-18"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#lab08-kagent-lab-__codelineno-10-19"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#lab08-kagent-lab-__codelineno-10-20"></a><span class="p">}</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#lab08-kagent-lab-__codelineno-10-21"></a>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#lab08-kagent-lab-__codelineno-10-22"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">getPods</span><span class="p">(</span><span class="nx">namespace?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">k8s</span><span class="p">.</span><span class="nx">V1Pod</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#lab08-kagent-lab-__codelineno-10-23"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#lab08-kagent-lab-__codelineno-10-24"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">namespace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#lab08-kagent-lab-__codelineno-10-25"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sCoreApi</span><span class="p">.</span><span class="nx">listNamespacedPod</span><span class="p">({</span><span class="w"> </span><span class="nx">namespace</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#lab08-kagent-lab-__codelineno-10-26"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#lab08-kagent-lab-__codelineno-10-27"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#lab08-kagent-lab-__codelineno-10-28"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sCoreApi</span><span class="p">.</span><span class="nx">listPodForAllNamespaces</span><span class="p">();</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#lab08-kagent-lab-__codelineno-10-29"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#lab08-kagent-lab-__codelineno-10-30"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#lab08-kagent-lab-__codelineno-10-31"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#lab08-kagent-lab-__codelineno-10-32"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleK8sError</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#lab08-kagent-lab-__codelineno-10-33"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#lab08-kagent-lab-__codelineno-10-34"></a><span class="p">}</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#lab08-kagent-lab-__codelineno-10-35"></a>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#lab08-kagent-lab-__codelineno-10-36"></a><span class="k">private</span><span class="w"> </span><span class="nx">handleK8sError</span><span class="p">(</span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#lab08-kagent-lab-__codelineno-10-37"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="o">?</span><span class="p">.</span><span class="nx">statusCode</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">403</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#lab08-kagent-lab-__codelineno-10-38"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Access denied: Insufficient permissions to access Kubernetes resources&#39;</span><span class="p">);</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#lab08-kagent-lab-__codelineno-10-39"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#lab08-kagent-lab-__codelineno-10-40"></a>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#lab08-kagent-lab-__codelineno-10-41"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="o">?</span><span class="p">.</span><span class="nx">statusCode</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">404</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#lab08-kagent-lab-__codelineno-10-42"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Resource not found: The specified pod or namespace may not exist&#39;</span><span class="p">);</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#lab08-kagent-lab-__codelineno-10-43"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#lab08-kagent-lab-__codelineno-10-44"></a>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#lab08-kagent-lab-__codelineno-10-45"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Kubernetes operation failed: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#lab08-kagent-lab-__codelineno-10-46"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<div class="admonition success">
<p class="admonition-title">Complete <code>src/index.ts</code> After Step 3</p>
</div>
<p>Here&rsquo;s what your complete <code>src/index.ts</code> file should look like after completing Step 3:</p>
<div class="codehilite"><pre><span></span><code><span class="err">```</span><span class="n">typescript</span>
<span class="o">//</span> <span class="n">Import</span> <span class="n">MCP</span> <span class="n">SDK</span> <span class="n">components</span> <span class="ow">and</span> <span class="n">Kubernetes</span> <span class="n">client</span>
<span class="kn">import</span><span class="w"> </span><span class="p">{</span> <span class="n">Server</span> <span class="p">}</span> <span class="kn">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="p">{</span> <span class="n">StdioServerTransport</span> <span class="p">}</span> <span class="kn">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="p">{</span>
  <span class="n">CallToolRequestSchema</span><span class="p">,</span>
  <span class="n">ErrorCode</span><span class="p">,</span>
  <span class="n">ListResourcesRequestSchema</span><span class="p">,</span>
  <span class="n">ListToolsRequestSchema</span><span class="p">,</span>
  <span class="n">McpError</span><span class="p">,</span>
  <span class="n">ReadResourceRequestSchema</span><span class="p">,</span>
<span class="p">}</span> <span class="kn">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="o">*</span> <span class="k">as</span> <span class="n">k8s</span> <span class="kn">from</span><span class="w"> </span><span class="s1">&#39;@kubernetes/client-node&#39;</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KAgentServer</span> <span class="p">{</span>
  <span class="o">//</span> <span class="n">Store</span> <span class="n">Kubernetes</span> <span class="n">API</span> <span class="n">clients</span> <span class="p">(</span><span class="k">for</span> <span class="n">talking</span> <span class="n">to</span> <span class="n">your</span> <span class="n">cluster</span><span class="p">)</span>
  <span class="n">private</span> <span class="n">k8sConfig</span><span class="p">:</span> <span class="n">k8s</span><span class="o">.</span><span class="n">KubeConfig</span><span class="p">;</span>
  <span class="n">private</span> <span class="n">k8sAppsApi</span><span class="p">:</span> <span class="n">k8s</span><span class="o">.</span><span class="n">AppsV1Api</span><span class="p">;</span>
  <span class="n">private</span> <span class="n">k8sCoreApi</span><span class="p">:</span> <span class="n">k8s</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">;</span>
  <span class="n">private</span> <span class="n">server</span><span class="p">:</span> <span class="n">Server</span><span class="p">;</span>

  <span class="n">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">Initialize</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">your</span> <span class="n">Kubernetes</span> <span class="n">cluster</span> <span class="p">(</span><span class="n">uses</span> <span class="o">~/.</span><span class="n">kube</span><span class="o">/</span><span class="n">config</span><span class="p">)</span>
    <span class="n">this</span><span class="o">.</span><span class="n">k8sConfig</span> <span class="o">=</span> <span class="n">new</span> <span class="n">k8s</span><span class="o">.</span><span class="n">KubeConfig</span><span class="p">();</span>
    <span class="n">this</span><span class="o">.</span><span class="n">k8sConfig</span><span class="o">.</span><span class="n">loadFromDefault</span><span class="p">();</span>

    <span class="n">this</span><span class="o">.</span><span class="n">k8sAppsApi</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sConfig</span><span class="o">.</span><span class="n">makeApiClient</span><span class="p">(</span><span class="n">k8s</span><span class="o">.</span><span class="n">AppsV1Api</span><span class="p">);</span>
    <span class="n">this</span><span class="o">.</span><span class="n">k8sCoreApi</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sConfig</span><span class="o">.</span><span class="n">makeApiClient</span><span class="p">(</span><span class="n">k8s</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">);</span>

    <span class="o">//</span> <span class="n">Create</span> <span class="n">MCP</span> <span class="n">server</span> <span class="n">that</span> <span class="n">AI</span> <span class="n">tools</span> <span class="n">can</span> <span class="n">connect</span> <span class="n">to</span>
    <span class="n">this</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Server</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;k-agent-logs&quot;</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="n">capabilities</span><span class="p">:</span> <span class="p">{</span>
          <span class="n">tools</span><span class="p">:</span> <span class="p">{},</span>
          <span class="n">resources</span><span class="p">:</span> <span class="p">{},</span>
        <span class="p">},</span>
      <span class="p">}</span>
    <span class="p">);</span>

    <span class="o">//</span> <span class="n">Handle</span> <span class="n">incoming</span> <span class="n">MCP</span> <span class="n">requests</span>
    <span class="n">this</span><span class="o">.</span><span class="n">setupHandlers</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="n">setupHandlers</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">List</span> <span class="n">available</span> <span class="n">tools</span>
    <span class="n">this</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">setRequestHandler</span><span class="p">(</span><span class="n">ListToolsRequestSchema</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="n">tools</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;list_pods&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;List all pods across namespaces with their status&quot;</span><span class="p">,</span>
            <span class="n">inputSchema</span><span class="p">:</span> <span class="p">{</span>
              <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
              <span class="n">properties</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">namespace</span><span class="p">:</span> <span class="p">{</span>
                  <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                  <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;Optional: Filter by specific namespace&quot;</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">};</span>
    <span class="p">});</span>

    <span class="o">//</span> <span class="n">Handle</span> <span class="n">tool</span> <span class="n">calls</span>
    <span class="n">this</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">setRequestHandler</span><span class="p">(</span><span class="n">CallToolRequestSchema</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="n">const</span> <span class="p">{</span> <span class="n">name</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">args</span> <span class="p">}</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">;</span>

      <span class="k">try</span> <span class="p">{</span>
        <span class="n">switch</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">case</span> <span class="s2">&quot;list_pods&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">handleListPods</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
          <span class="n">default</span><span class="p">:</span>
            <span class="n">throw</span> <span class="n">new</span> <span class="n">McpError</span><span class="p">(</span>
              <span class="n">ErrorCode</span><span class="o">.</span><span class="n">MethodNotFound</span><span class="p">,</span>
              <span class="err">`</span><span class="n">Unknown</span> <span class="n">tool</span><span class="p">:</span> <span class="err">$</span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="err">`</span>
            <span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">throw</span> <span class="n">new</span> <span class="n">McpError</span><span class="p">(</span>
          <span class="n">ErrorCode</span><span class="o">.</span><span class="n">InternalError</span><span class="p">,</span>
          <span class="err">`</span><span class="n">Tool</span> <span class="n">execution</span> <span class="n">failed</span><span class="p">:</span> <span class="err">$</span><span class="p">{</span><span class="n">error</span> <span class="n">instanceof</span> <span class="n">Error</span> <span class="err">?</span> <span class="n">error</span><span class="o">.</span><span class="n">message</span> <span class="p">:</span> <span class="n">String</span><span class="p">(</span><span class="n">error</span><span class="p">)}</span><span class="err">`</span>
        <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="k">async</span> <span class="n">handleListPods</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">namespace</span> <span class="o">=</span> <span class="n">args</span><span class="err">?</span><span class="o">.</span><span class="n">namespace</span><span class="p">;</span>
    <span class="n">const</span> <span class="n">pods</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">getPods</span><span class="p">(</span><span class="n">namespace</span><span class="p">);</span>

    <span class="n">const</span> <span class="n">podList</span> <span class="o">=</span> <span class="n">pods</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">pod</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="n">name</span><span class="p">:</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="err">?</span><span class="o">.</span><span class="n">name</span> <span class="o">||</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
      <span class="n">namespace</span><span class="p">:</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="err">?</span><span class="o">.</span><span class="n">namespace</span> <span class="o">||</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
      <span class="n">status</span><span class="p">:</span> <span class="n">pod</span><span class="o">.</span><span class="n">status</span><span class="err">?</span><span class="o">.</span><span class="n">phase</span> <span class="o">||</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
      <span class="n">containers</span><span class="p">:</span> <span class="n">pod</span><span class="o">.</span><span class="n">spec</span><span class="err">?</span><span class="o">.</span><span class="n">containers</span><span class="err">?</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">c</span> <span class="o">=&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">||</span> <span class="p">[]</span>
    <span class="p">}));</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="n">content</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="n">text</span><span class="p">:</span> <span class="n">JSON</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">podList</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="k">async</span> <span class="n">getPods</span><span class="p">(</span><span class="n">namespace</span><span class="err">?</span><span class="p">:</span> <span class="n">string</span><span class="p">):</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Pod</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">namespace</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">const</span> <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sCoreApi</span><span class="o">.</span><span class="n">listNamespacedPod</span><span class="p">({</span> <span class="n">namespace</span> <span class="p">});</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">items</span> <span class="o">||</span> <span class="p">[];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">const</span> <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sCoreApi</span><span class="o">.</span><span class="n">listPodForAllNamespaces</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">items</span> <span class="o">||</span> <span class="p">[];</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">throw</span> <span class="n">this</span><span class="o">.</span><span class="n">handleK8sError</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="n">handleK8sError</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="nb">any</span><span class="p">):</span> <span class="n">Error</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">response</span><span class="err">?</span><span class="o">.</span><span class="n">statusCode</span> <span class="o">===</span> <span class="mi">403</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">new</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;Access denied: Insufficient permissions to access Kubernetes resources&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">response</span><span class="err">?</span><span class="o">.</span><span class="n">statusCode</span> <span class="o">===</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">new</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;Resource not found: The specified pod or namespace may not exist&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">new</span> <span class="n">Error</span><span class="p">(</span><span class="err">`</span><span class="n">Kubernetes</span> <span class="n">operation</span> <span class="n">failed</span><span class="p">:</span> <span class="err">$</span><span class="p">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="p">}</span><span class="err">`</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="n">Start</span> <span class="n">the</span> <span class="n">server</span> <span class="ow">and</span> <span class="n">listen</span> <span class="k">for</span> <span class="n">connections</span>
  <span class="k">async</span> <span class="n">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">transport</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StdioServerTransport</span><span class="p">();</span>
    <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">transport</span><span class="p">);</span>
    <span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;K-Agent MCP server running on stdio&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">Actually</span> <span class="n">run</span> <span class="n">the</span> <span class="n">server</span>
<span class="n">const</span> <span class="n">server</span> <span class="o">=</span> <span class="n">new</span> <span class="n">KAgentServer</span><span class="p">();</span>
<span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">catch</span><span class="p">(</span><span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">);</span>
<span class="err">```</span>
</code></pre></div>

<p><br></p>
<h4 id="lab08-kagent-lab-test-pod-discovery">Test Pod Discovery<a class="headerlink" href="#lab08-kagent-lab-test-pod-discovery" title="Permanent link">&para;</a></h4>
<p>Test the pod listing functionality using the MCP Inspector by running:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#lab08-kagent-lab-__codelineno-12-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node_modules/.bin/tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p>This will start the MCP Inspector connected to your K-Agent server and open a browser window.</p>
<p><strong>Inside the MCP Inspector UI browser window:</strong></p>
<ol>
<li>Click the <strong>&ldquo;Connect&rdquo;</strong> button</li>
<li>Click the <strong>&ldquo;Tools&rdquo;</strong> tab</li>
<li>Click <strong>&ldquo;List Tools&rdquo;</strong> - you&rsquo;ll see the <code>list_pods</code> tool</li>
<li>Click on <strong><code>list_pods</code></strong></li>
<li>Optionally enter a namespace name</li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong> to test it</li>
</ol>
<p>You should see a JSON list of all pods with their status and container names.</p>
<hr />
<h3 id="lab08-kagent-lab-step-4-log-collection-tool">Step 4: Log Collection Tool<a class="headerlink" href="#lab08-kagent-lab-step-4-log-collection-tool" title="Permanent link">&para;</a></h3>
<p>Build the core log collection functionality with the <code>collect_pod_logs</code> tool.</p>
<p><br></p>
<h4 id="lab08-kagent-lab-add-collect_pod_logs-to-tools-array">Add collect_pod_logs to Tools Array<a class="headerlink" href="#lab08-kagent-lab-add-collect_pod_logs-to-tools-array" title="Permanent link">&para;</a></h4>
<p>In your <code>src/index.ts</code> file, locate the tools array inside <code>setupHandlers()</code> method.</p>
<p>Add the following second tool code to the array:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#lab08-kagent-lab-__codelineno-13-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">setupHandlers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#lab08-kagent-lab-__codelineno-13-2"></a><span class="w">  </span><span class="c1">// List available tools</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#lab08-kagent-lab-__codelineno-13-3"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">setRequestHandler</span><span class="p">(</span><span class="nx">ListToolsRequestSchema</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#lab08-kagent-lab-__codelineno-13-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#lab08-kagent-lab-__codelineno-13-5"></a><span class="w">      </span><span class="nx">tools</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#lab08-kagent-lab-__codelineno-13-6"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#lab08-kagent-lab-__codelineno-13-7"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;list_pods&quot;</span><span class="p">,</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#lab08-kagent-lab-__codelineno-13-8"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;List all pods across namespaces with their status&quot;</span><span class="p">,</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#lab08-kagent-lab-__codelineno-13-9"></a><span class="w">          </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#lab08-kagent-lab-__codelineno-13-10"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#lab08-kagent-lab-__codelineno-13-11"></a><span class="w">            </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#lab08-kagent-lab-__codelineno-13-12"></a><span class="w">              </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#lab08-kagent-lab-__codelineno-13-13"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#lab08-kagent-lab-__codelineno-13-14"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Optional: Filter by specific namespace&quot;</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#lab08-kagent-lab-__codelineno-13-15"></a><span class="w">              </span><span class="p">}</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#lab08-kagent-lab-__codelineno-13-16"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#lab08-kagent-lab-__codelineno-13-17"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#lab08-kagent-lab-__codelineno-13-18"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#lab08-kagent-lab-__codelineno-13-19"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#lab08-kagent-lab-__codelineno-13-20"></a><span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;collect_pod_logs&quot;</span><span class="p">,</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#lab08-kagent-lab-__codelineno-13-21"></a><span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Collect logs from all containers in specified pods&quot;</span><span class="p">,</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#lab08-kagent-lab-__codelineno-13-22"></a><span class="w">          </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#lab08-kagent-lab-__codelineno-13-23"></a><span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#lab08-kagent-lab-__codelineno-13-24"></a><span class="w">            </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#lab08-kagent-lab-__codelineno-13-25"></a><span class="w">              </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#lab08-kagent-lab-__codelineno-13-26"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#lab08-kagent-lab-__codelineno-13-27"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Namespace to collect logs from&quot;</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#lab08-kagent-lab-__codelineno-13-28"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#lab08-kagent-lab-__codelineno-13-29"></a><span class="w">              </span><span class="nx">podName</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#lab08-kagent-lab-__codelineno-13-30"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#lab08-kagent-lab-__codelineno-13-31"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Specific pod name (optional - collects from all if not specified)&quot;</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#lab08-kagent-lab-__codelineno-13-32"></a><span class="w">              </span><span class="p">},</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#lab08-kagent-lab-__codelineno-13-33"></a><span class="w">              </span><span class="nx">tailLines</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#lab08-kagent-lab-__codelineno-13-34"></a><span class="w">                </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#lab08-kagent-lab-__codelineno-13-35"></a><span class="w">                </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Number of recent log lines to retrieve&quot;</span><span class="p">,</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#lab08-kagent-lab-__codelineno-13-36"></a><span class="w">                </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#lab08-kagent-lab-__codelineno-13-37"></a><span class="w">              </span><span class="p">}</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#lab08-kagent-lab-__codelineno-13-38"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#lab08-kagent-lab-__codelineno-13-39"></a><span class="w">            </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#lab08-kagent-lab-__codelineno-13-40"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#lab08-kagent-lab-__codelineno-13-41"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42" href="#lab08-kagent-lab-__codelineno-13-42"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43" href="#lab08-kagent-lab-__codelineno-13-43"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-13-44"><a id="__codelineno-13-44" name="__codelineno-13-44" href="#lab08-kagent-lab-__codelineno-13-44"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-13-45"><a id="__codelineno-13-45" name="__codelineno-13-45" href="#lab08-kagent-lab-__codelineno-13-45"></a><span class="w">  </span><span class="c1">// ... rest of setupHandlers</span>
</span><span id="__span-13-46"><a id="__codelineno-13-46" name="__codelineno-13-46" href="#lab08-kagent-lab-__codelineno-13-46"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<h4 id="lab08-kagent-lab-update-tool-handler-switch">Update Tool Handler Switch<a class="headerlink" href="#lab08-kagent-lab-update-tool-handler-switch" title="Permanent link">&para;</a></h4>
<p>In the same <code>setupHandlers()</code> method, locate the switch statement and add the following case for <code>collect_pod_logs</code>:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#lab08-kagent-lab-__codelineno-14-1"></a><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#lab08-kagent-lab-__codelineno-14-2"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;list_pods&quot;</span><span class="o">:</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#lab08-kagent-lab-__codelineno-14-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleListPods</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#lab08-kagent-lab-__codelineno-14-4"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;collect_pod_logs&quot;</span><span class="o">:</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#lab08-kagent-lab-__codelineno-14-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleCollectPodLogs</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#lab08-kagent-lab-__codelineno-14-6"></a><span class="w">  </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#lab08-kagent-lab-__codelineno-14-7"></a><span class="w">    </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">McpError</span><span class="p">(</span><span class="nx">ErrorCode</span><span class="p">.</span><span class="nx">MethodNotFound</span><span class="p">,</span><span class="w"> </span><span class="sb">`Unknown tool: </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#lab08-kagent-lab-__codelineno-14-8"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<h4 id="lab08-kagent-lab-implement-log-collection-methods">Implement Log Collection Methods<a class="headerlink" href="#lab08-kagent-lab-implement-log-collection-methods" title="Permanent link">&para;</a></h4>
<p>Below your existing handler methods (after <code>handleK8sError()</code>), <strong>before the <code>async run()</code> method</strong>, add the following new methods:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#lab08-kagent-lab-__codelineno-15-1"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">handleCollectPodLogs</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#lab08-kagent-lab-__codelineno-15-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">podName</span><span class="p">,</span><span class="w"> </span><span class="nx">tailLines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">;</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#lab08-kagent-lab-__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#lab08-kagent-lab-__codelineno-15-4"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">namespace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#lab08-kagent-lab-__codelineno-15-5"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Namespace is required&quot;</span><span class="p">);</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#lab08-kagent-lab-__codelineno-15-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#lab08-kagent-lab-__codelineno-15-7"></a>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#lab08-kagent-lab-__codelineno-15-8"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">logs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">collectPodLogs</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">podName</span><span class="p">,</span><span class="w"> </span><span class="nx">tailLines</span><span class="p">);</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#lab08-kagent-lab-__codelineno-15-9"></a>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#lab08-kagent-lab-__codelineno-15-10"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#lab08-kagent-lab-__codelineno-15-11"></a><span class="w">    </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#lab08-kagent-lab-__codelineno-15-12"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#lab08-kagent-lab-__codelineno-15-13"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#lab08-kagent-lab-__codelineno-15-14"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">logs</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#lab08-kagent-lab-__codelineno-15-15"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#lab08-kagent-lab-__codelineno-15-16"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#lab08-kagent-lab-__codelineno-15-17"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#lab08-kagent-lab-__codelineno-15-18"></a><span class="p">}</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#lab08-kagent-lab-__codelineno-15-19"></a>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#lab08-kagent-lab-__codelineno-15-20"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">collectPodLogs</span><span class="p">(</span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">podName?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">tailLines</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#lab08-kagent-lab-__codelineno-15-21"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">pods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">podName</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#lab08-kagent-lab-__codelineno-15-22"></a><span class="w">    </span><span class="o">?</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getPods</span><span class="p">(</span><span class="nx">namespace</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">pods</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">pods</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">metadata</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">podName</span><span class="p">))</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#lab08-kagent-lab-__codelineno-15-23"></a><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getPods</span><span class="p">(</span><span class="nx">namespace</span><span class="p">);</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#lab08-kagent-lab-__codelineno-15-24"></a>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#lab08-kagent-lab-__codelineno-15-25"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allLogs</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#lab08-kagent-lab-__codelineno-15-26"></a>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#lab08-kagent-lab-__codelineno-15-27"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">pod</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">pods</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#lab08-kagent-lab-__codelineno-15-28"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">pod</span><span class="p">.</span><span class="nx">metadata</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#lab08-kagent-lab-__codelineno-15-29"></a>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#lab08-kagent-lab-__codelineno-15-30"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">containers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pod</span><span class="p">.</span><span class="nx">spec</span><span class="o">?</span><span class="p">.</span><span class="nx">containers</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#lab08-kagent-lab-__codelineno-15-31"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">container</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">containers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#lab08-kagent-lab-__codelineno-15-32"></a><span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#lab08-kagent-lab-__codelineno-15-33"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">logs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getPodLogs</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">pod</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">tailLines</span><span class="p">);</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#lab08-kagent-lab-__codelineno-15-34"></a><span class="w">        </span><span class="nx">allLogs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`=== </span><span class="si">${</span><span class="nx">pod</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">container</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> ===\n</span><span class="si">${</span><span class="nx">logs</span><span class="si">}</span><span class="sb">\n`</span><span class="p">);</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#lab08-kagent-lab-__codelineno-15-35"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#lab08-kagent-lab-__codelineno-15-36"></a><span class="w">        </span><span class="nx">allLogs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`=== </span><span class="si">${</span><span class="nx">pod</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">container</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> ===\nError retrieving logs: </span><span class="si">${</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error.message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">String</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="si">}</span><span class="sb">\n`</span><span class="p">);</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#lab08-kagent-lab-__codelineno-15-37"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#lab08-kagent-lab-__codelineno-15-38"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39" href="#lab08-kagent-lab-__codelineno-15-39"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40" href="#lab08-kagent-lab-__codelineno-15-40"></a>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41" href="#lab08-kagent-lab-__codelineno-15-41"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">allLogs</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42" href="#lab08-kagent-lab-__codelineno-15-42"></a><span class="p">}</span>
</span><span id="__span-15-43"><a id="__codelineno-15-43" name="__codelineno-15-43" href="#lab08-kagent-lab-__codelineno-15-43"></a>
</span><span id="__span-15-44"><a id="__codelineno-15-44" name="__codelineno-15-44" href="#lab08-kagent-lab-__codelineno-15-44"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">getPodLogs</span><span class="p">(</span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">podName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">containerName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">tailLines</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-45"><a id="__codelineno-15-45" name="__codelineno-15-45" href="#lab08-kagent-lab-__codelineno-15-45"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-46"><a id="__codelineno-15-46" name="__codelineno-15-46" href="#lab08-kagent-lab-__codelineno-15-46"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sCoreApi</span><span class="p">.</span><span class="nx">readNamespacedPodLog</span><span class="p">({</span>
</span><span id="__span-15-47"><a id="__codelineno-15-47" name="__codelineno-15-47" href="#lab08-kagent-lab-__codelineno-15-47"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">podName</span><span class="p">,</span>
</span><span id="__span-15-48"><a id="__codelineno-15-48" name="__codelineno-15-48" href="#lab08-kagent-lab-__codelineno-15-48"></a><span class="w">      </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="kt">namespace</span><span class="p">,</span>
</span><span id="__span-15-49"><a id="__codelineno-15-49" name="__codelineno-15-49" href="#lab08-kagent-lab-__codelineno-15-49"></a><span class="w">      </span><span class="nx">container</span><span class="o">:</span><span class="w"> </span><span class="kt">containerName</span><span class="p">,</span>
</span><span id="__span-15-50"><a id="__codelineno-15-50" name="__codelineno-15-50" href="#lab08-kagent-lab-__codelineno-15-50"></a><span class="w">      </span><span class="nx">tailLines</span><span class="o">:</span><span class="w"> </span><span class="kt">tailLines</span><span class="p">,</span>
</span><span id="__span-15-51"><a id="__codelineno-15-51" name="__codelineno-15-51" href="#lab08-kagent-lab-__codelineno-15-51"></a><span class="w">      </span><span class="nx">timestamps</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span>
</span><span id="__span-15-52"><a id="__codelineno-15-52" name="__codelineno-15-52" href="#lab08-kagent-lab-__codelineno-15-52"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-15-53"><a id="__codelineno-15-53" name="__codelineno-15-53" href="#lab08-kagent-lab-__codelineno-15-53"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="__span-15-54"><a id="__codelineno-15-54" name="__codelineno-15-54" href="#lab08-kagent-lab-__codelineno-15-54"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-55"><a id="__codelineno-15-55" name="__codelineno-15-55" href="#lab08-kagent-lab-__codelineno-15-55"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleK8sError</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-15-56"><a id="__codelineno-15-56" name="__codelineno-15-56" href="#lab08-kagent-lab-__codelineno-15-56"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-15-57"><a id="__codelineno-15-57" name="__codelineno-15-57" href="#lab08-kagent-lab-__codelineno-15-57"></a><span class="p">}</span>
</span></code></pre></div>
<div class="admonition success">
<p class="admonition-title">Complete <code>src/index.ts</code> After Step 4</p>
</div>
<p>Here&rsquo;s what your complete <code>src/index.ts</code> file should look like after completing Step 4:</p>
<div class="codehilite"><pre><span></span><code><span class="err">```</span><span class="n">typescript</span>
<span class="o">//</span> <span class="n">Import</span> <span class="n">MCP</span> <span class="n">SDK</span> <span class="n">components</span> <span class="ow">and</span> <span class="n">Kubernetes</span> <span class="n">client</span>
<span class="kn">import</span><span class="w"> </span><span class="p">{</span> <span class="n">Server</span> <span class="p">}</span> <span class="kn">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/index.js&quot;</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="p">{</span> <span class="n">StdioServerTransport</span> <span class="p">}</span> <span class="kn">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="p">{</span>
  <span class="n">CallToolRequestSchema</span><span class="p">,</span>
  <span class="n">ErrorCode</span><span class="p">,</span>
  <span class="n">ListResourcesRequestSchema</span><span class="p">,</span>
  <span class="n">ListToolsRequestSchema</span><span class="p">,</span>
  <span class="n">McpError</span><span class="p">,</span>
  <span class="n">ReadResourceRequestSchema</span><span class="p">,</span>
<span class="p">}</span> <span class="kn">from</span><span class="w"> </span><span class="s2">&quot;@modelcontextprotocol/sdk/types.js&quot;</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="o">*</span> <span class="k">as</span> <span class="n">k8s</span> <span class="kn">from</span><span class="w"> </span><span class="s1">&#39;@kubernetes/client-node&#39;</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KAgentServer</span> <span class="p">{</span>
  <span class="o">//</span> <span class="n">Store</span> <span class="n">Kubernetes</span> <span class="n">API</span> <span class="n">clients</span> <span class="p">(</span><span class="k">for</span> <span class="n">talking</span> <span class="n">to</span> <span class="n">your</span> <span class="n">cluster</span><span class="p">)</span>
  <span class="n">private</span> <span class="n">k8sConfig</span><span class="p">:</span> <span class="n">k8s</span><span class="o">.</span><span class="n">KubeConfig</span><span class="p">;</span>
  <span class="n">private</span> <span class="n">k8sAppsApi</span><span class="p">:</span> <span class="n">k8s</span><span class="o">.</span><span class="n">AppsV1Api</span><span class="p">;</span>
  <span class="n">private</span> <span class="n">k8sCoreApi</span><span class="p">:</span> <span class="n">k8s</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">;</span>
  <span class="n">private</span> <span class="n">server</span><span class="p">:</span> <span class="n">Server</span><span class="p">;</span>

  <span class="n">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">Initialize</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">your</span> <span class="n">Kubernetes</span> <span class="n">cluster</span> <span class="p">(</span><span class="n">uses</span> <span class="o">~/.</span><span class="n">kube</span><span class="o">/</span><span class="n">config</span><span class="p">)</span>
    <span class="n">this</span><span class="o">.</span><span class="n">k8sConfig</span> <span class="o">=</span> <span class="n">new</span> <span class="n">k8s</span><span class="o">.</span><span class="n">KubeConfig</span><span class="p">();</span>
    <span class="n">this</span><span class="o">.</span><span class="n">k8sConfig</span><span class="o">.</span><span class="n">loadFromDefault</span><span class="p">();</span>

    <span class="n">this</span><span class="o">.</span><span class="n">k8sAppsApi</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sConfig</span><span class="o">.</span><span class="n">makeApiClient</span><span class="p">(</span><span class="n">k8s</span><span class="o">.</span><span class="n">AppsV1Api</span><span class="p">);</span>
    <span class="n">this</span><span class="o">.</span><span class="n">k8sCoreApi</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sConfig</span><span class="o">.</span><span class="n">makeApiClient</span><span class="p">(</span><span class="n">k8s</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">);</span>

    <span class="o">//</span> <span class="n">Create</span> <span class="n">MCP</span> <span class="n">server</span> <span class="n">that</span> <span class="n">AI</span> <span class="n">tools</span> <span class="n">can</span> <span class="n">connect</span> <span class="n">to</span>
    <span class="n">this</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Server</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;k-agent-logs&quot;</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="n">capabilities</span><span class="p">:</span> <span class="p">{</span>
          <span class="n">tools</span><span class="p">:</span> <span class="p">{},</span>
          <span class="n">resources</span><span class="p">:</span> <span class="p">{},</span>
        <span class="p">},</span>
      <span class="p">}</span>
    <span class="p">);</span>

    <span class="o">//</span> <span class="n">Handle</span> <span class="n">incoming</span> <span class="n">MCP</span> <span class="n">requests</span>
    <span class="n">this</span><span class="o">.</span><span class="n">setupHandlers</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="n">setupHandlers</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">List</span> <span class="n">available</span> <span class="n">tools</span>
    <span class="n">this</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">setRequestHandler</span><span class="p">(</span><span class="n">ListToolsRequestSchema</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="n">tools</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;list_pods&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;List all pods across namespaces with their status&quot;</span><span class="p">,</span>
            <span class="n">inputSchema</span><span class="p">:</span> <span class="p">{</span>
              <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
              <span class="n">properties</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">namespace</span><span class="p">:</span> <span class="p">{</span>
                  <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                  <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;Optional: Filter by specific namespace&quot;</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;collect_pod_logs&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;Collect logs from all containers in specified pods&quot;</span><span class="p">,</span>
            <span class="n">inputSchema</span><span class="p">:</span> <span class="p">{</span>
              <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
              <span class="n">properties</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">namespace</span><span class="p">:</span> <span class="p">{</span>
                  <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                  <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;Namespace to collect logs from&quot;</span>
                <span class="p">},</span>
                <span class="n">podName</span><span class="p">:</span> <span class="p">{</span>
                  <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                  <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;Specific pod name (optional - collects from all if not specified)&quot;</span>
                <span class="p">},</span>
                <span class="n">tailLines</span><span class="p">:</span> <span class="p">{</span>
                  <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
                  <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;Number of recent log lines to retrieve&quot;</span><span class="p">,</span>
                  <span class="n">default</span><span class="p">:</span> <span class="mi">100</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="n">required</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">};</span>
    <span class="p">});</span>

    <span class="o">//</span> <span class="n">Handle</span> <span class="n">tool</span> <span class="n">calls</span>
    <span class="n">this</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">setRequestHandler</span><span class="p">(</span><span class="n">CallToolRequestSchema</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="n">const</span> <span class="p">{</span> <span class="n">name</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">args</span> <span class="p">}</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">;</span>

      <span class="k">try</span> <span class="p">{</span>
        <span class="n">switch</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">case</span> <span class="s2">&quot;list_pods&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">handleListPods</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
          <span class="k">case</span> <span class="s2">&quot;collect_pod_logs&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">handleCollectPodLogs</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
          <span class="n">default</span><span class="p">:</span>
            <span class="n">throw</span> <span class="n">new</span> <span class="n">McpError</span><span class="p">(</span>
              <span class="n">ErrorCode</span><span class="o">.</span><span class="n">MethodNotFound</span><span class="p">,</span>
              <span class="err">`</span><span class="n">Unknown</span> <span class="n">tool</span><span class="p">:</span> <span class="err">$</span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="err">`</span>
            <span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">throw</span> <span class="n">new</span> <span class="n">McpError</span><span class="p">(</span>
          <span class="n">ErrorCode</span><span class="o">.</span><span class="n">InternalError</span><span class="p">,</span>
          <span class="err">`</span><span class="n">Tool</span> <span class="n">execution</span> <span class="n">failed</span><span class="p">:</span> <span class="err">$</span><span class="p">{</span><span class="n">error</span> <span class="n">instanceof</span> <span class="n">Error</span> <span class="err">?</span> <span class="n">error</span><span class="o">.</span><span class="n">message</span> <span class="p">:</span> <span class="n">String</span><span class="p">(</span><span class="n">error</span><span class="p">)}</span><span class="err">`</span>
        <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="k">async</span> <span class="n">handleListPods</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">namespace</span> <span class="o">=</span> <span class="n">args</span><span class="err">?</span><span class="o">.</span><span class="n">namespace</span><span class="p">;</span>
    <span class="n">const</span> <span class="n">pods</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">getPods</span><span class="p">(</span><span class="n">namespace</span><span class="p">);</span>

    <span class="n">const</span> <span class="n">podList</span> <span class="o">=</span> <span class="n">pods</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">pod</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="n">name</span><span class="p">:</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="err">?</span><span class="o">.</span><span class="n">name</span> <span class="o">||</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
      <span class="n">namespace</span><span class="p">:</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="err">?</span><span class="o">.</span><span class="n">namespace</span> <span class="o">||</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
      <span class="n">status</span><span class="p">:</span> <span class="n">pod</span><span class="o">.</span><span class="n">status</span><span class="err">?</span><span class="o">.</span><span class="n">phase</span> <span class="o">||</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
      <span class="n">containers</span><span class="p">:</span> <span class="n">pod</span><span class="o">.</span><span class="n">spec</span><span class="err">?</span><span class="o">.</span><span class="n">containers</span><span class="err">?</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">c</span> <span class="o">=&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">||</span> <span class="p">[]</span>
    <span class="p">}));</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="n">content</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="n">text</span><span class="p">:</span> <span class="n">JSON</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">podList</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="k">async</span> <span class="n">handleCollectPodLogs</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">const</span> <span class="p">{</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">podName</span><span class="p">,</span> <span class="n">tailLines</span> <span class="o">=</span> <span class="mi">100</span> <span class="p">}</span> <span class="o">=</span> <span class="n">args</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="err">!</span><span class="n">namespace</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">throw</span> <span class="n">new</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;Namespace is required&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">const</span> <span class="n">logs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">collectPodLogs</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">podName</span><span class="p">,</span> <span class="n">tailLines</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="n">content</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="n">text</span><span class="p">:</span> <span class="n">logs</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="k">async</span> <span class="n">collectPodLogs</span><span class="p">(</span><span class="n">namespace</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">podName</span><span class="err">?</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">tailLines</span><span class="p">:</span> <span class="n">number</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">pods</span> <span class="o">=</span> <span class="n">podName</span>
      <span class="err">?</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">getPods</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">pods</span> <span class="o">=&gt;</span> <span class="n">pods</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">metadata</span><span class="err">?</span><span class="o">.</span><span class="n">name</span> <span class="o">===</span> <span class="n">podName</span><span class="p">))</span>
      <span class="p">:</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">getPods</span><span class="p">(</span><span class="n">namespace</span><span class="p">);</span>

    <span class="n">const</span> <span class="n">allLogs</span><span class="p">:</span> <span class="n">string</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">const</span> <span class="n">pod</span> <span class="n">of</span> <span class="n">pods</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="err">!</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="err">?</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>

      <span class="n">const</span> <span class="n">containers</span> <span class="o">=</span> <span class="n">pod</span><span class="o">.</span><span class="n">spec</span><span class="err">?</span><span class="o">.</span><span class="n">containers</span> <span class="o">||</span> <span class="p">[];</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">const</span> <span class="n">container</span> <span class="n">of</span> <span class="n">containers</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
          <span class="n">const</span> <span class="n">logs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">getPodLogs</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">container</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">tailLines</span><span class="p">);</span>
          <span class="n">allLogs</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="err">`</span><span class="o">===</span> <span class="err">$</span><span class="p">{</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">}</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">container</span><span class="o">.</span><span class="n">name</span><span class="p">}</span> <span class="o">===</span>\<span class="n">n</span><span class="err">$</span><span class="p">{</span><span class="n">logs</span><span class="p">}</span>\<span class="n">n</span><span class="err">`</span><span class="p">);</span>
        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">allLogs</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="err">`</span><span class="o">===</span> <span class="err">$</span><span class="p">{</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">}</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">container</span><span class="o">.</span><span class="n">name</span><span class="p">}</span> <span class="o">===</span>\<span class="n">nError</span> <span class="n">retrieving</span> <span class="n">logs</span><span class="p">:</span> <span class="err">$</span><span class="p">{</span><span class="n">error</span> <span class="n">instanceof</span> <span class="n">Error</span> <span class="err">?</span> <span class="n">error</span><span class="o">.</span><span class="n">message</span> <span class="p">:</span> <span class="n">String</span><span class="p">(</span><span class="n">error</span><span class="p">)}</span>\<span class="n">n</span><span class="err">`</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">allLogs</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="k">async</span> <span class="n">getPods</span><span class="p">(</span><span class="n">namespace</span><span class="err">?</span><span class="p">:</span> <span class="n">string</span><span class="p">):</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Pod</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">namespace</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">const</span> <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sCoreApi</span><span class="o">.</span><span class="n">listNamespacedPod</span><span class="p">({</span> <span class="n">namespace</span> <span class="p">});</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">items</span> <span class="o">||</span> <span class="p">[];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">const</span> <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sCoreApi</span><span class="o">.</span><span class="n">listPodForAllNamespaces</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">items</span> <span class="o">||</span> <span class="p">[];</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">throw</span> <span class="n">this</span><span class="o">.</span><span class="n">handleK8sError</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="k">async</span> <span class="n">getPodLogs</span><span class="p">(</span><span class="n">namespace</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">podName</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">containerName</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">tailLines</span><span class="p">:</span> <span class="n">number</span><span class="p">):</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">const</span> <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">k8sCoreApi</span><span class="o">.</span><span class="n">readNamespacedPodLog</span><span class="p">({</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">podName</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="n">namespace</span><span class="p">,</span>
        <span class="n">container</span><span class="p">:</span> <span class="n">containerName</span><span class="p">,</span>
        <span class="n">tailLines</span><span class="p">:</span> <span class="n">tailLines</span><span class="p">,</span>
        <span class="n">timestamps</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="n">response</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">throw</span> <span class="n">this</span><span class="o">.</span><span class="n">handleK8sError</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">private</span> <span class="n">handleK8sError</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="nb">any</span><span class="p">):</span> <span class="n">Error</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">response</span><span class="err">?</span><span class="o">.</span><span class="n">statusCode</span> <span class="o">===</span> <span class="mi">403</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">new</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;Access denied: Insufficient permissions to access Kubernetes resources&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">response</span><span class="err">?</span><span class="o">.</span><span class="n">statusCode</span> <span class="o">===</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">new</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;Resource not found: The specified pod or namespace may not exist&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">new</span> <span class="n">Error</span><span class="p">(</span><span class="err">`</span><span class="n">Kubernetes</span> <span class="n">operation</span> <span class="n">failed</span><span class="p">:</span> <span class="err">$</span><span class="p">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="p">}</span><span class="err">`</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="n">Start</span> <span class="n">the</span> <span class="n">server</span> <span class="ow">and</span> <span class="n">listen</span> <span class="k">for</span> <span class="n">connections</span>
  <span class="k">async</span> <span class="n">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">transport</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StdioServerTransport</span><span class="p">();</span>
    <span class="k">await</span> <span class="n">this</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">transport</span><span class="p">);</span>
    <span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;K-Agent MCP server running on stdio&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">Actually</span> <span class="n">run</span> <span class="n">the</span> <span class="n">server</span>
<span class="n">const</span> <span class="n">server</span> <span class="o">=</span> <span class="n">new</span> <span class="n">KAgentServer</span><span class="p">();</span>
<span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">catch</span><span class="p">(</span><span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">);</span>
<span class="err">```</span>
</code></pre></div>

<p><br></p>
<h4 id="lab08-kagent-lab-test-log-collection">Test Log Collection<a class="headerlink" href="#lab08-kagent-lab-test-log-collection" title="Permanent link">&para;</a></h4>
<p>Test the log collection functionality with the MCP Inspector:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#lab08-kagent-lab-__codelineno-17-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node_modules/.bin/tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p>This will start the MCP Inspector connected to your K-Agent server and open a browser window.</p>
<p><strong>In the MCP Inspector UI browser window:</strong></p>
<ol>
<li>Click the <strong>&ldquo;Connect&rdquo;</strong> button</li>
<li>Click the <strong>&ldquo;Tools&rdquo;</strong> tab</li>
<li>Click <strong>&ldquo;List Tools&rdquo;</strong> - you&rsquo;ll see both <code>list_pods</code> and <code>collect_pod_logs</code></li>
<li>Click on <strong><code>collect_pod_logs</code></strong></li>
<li>In the <strong>namespace</strong> field, enter: <code>default</code></li>
<li>Click <strong>&ldquo;Run Tool&rdquo;</strong></li>
</ol>
<p>You should see logs from all pods in the default namespace, formatted with pod and container names.</p>
<hr />
<h2 id="lab08-kagent-lab-optional-extensions">Optional Extensions<a class="headerlink" href="#lab08-kagent-lab-optional-extensions" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Prerequisites</p>
</div>
<p>These exercises assume you have completed <strong>Steps 1-4</strong> and have a fully functional K-Agent server with <code>list_pods</code> and <code>collect_pod_logs</code> tools. These exercises extend the functionality beyond the core implementation.</p>
<hr />
<h3 id="lab08-kagent-lab-exercise-1-advanced-pod-filtering-and-sorting">Exercise 1: Advanced Pod Filtering and Sorting<a class="headerlink" href="#lab08-kagent-lab-exercise-1-advanced-pod-filtering-and-sorting" title="Permanent link">&para;</a></h3>
<p>Enhance the <code>list_pods</code> tool to support filtering by status, labels, and sorting by various criteria.</p>
<p><strong>Update the list_pods tool schema</strong> in your <code>setupHandlers()</code> method to include new parameters:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#lab08-kagent-lab-__codelineno-18-1"></a><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#lab08-kagent-lab-__codelineno-18-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;list_pods&quot;</span><span class="p">,</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#lab08-kagent-lab-__codelineno-18-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;List all pods across namespaces with their status, with filtering and sorting options&quot;</span><span class="p">,</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#lab08-kagent-lab-__codelineno-18-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#lab08-kagent-lab-__codelineno-18-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#lab08-kagent-lab-__codelineno-18-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#lab08-kagent-lab-__codelineno-18-7"></a><span class="w">      </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#lab08-kagent-lab-__codelineno-18-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#lab08-kagent-lab-__codelineno-18-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Optional: Filter by specific namespace&quot;</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#lab08-kagent-lab-__codelineno-18-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#lab08-kagent-lab-__codelineno-18-11"></a><span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#lab08-kagent-lab-__codelineno-18-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#lab08-kagent-lab-__codelineno-18-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Optional: Filter by pod status (Running, Pending, Failed, etc.)&quot;</span><span class="p">,</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#lab08-kagent-lab-__codelineno-18-14"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Running&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Pending&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Succeeded&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Unknown&quot;</span><span class="p">]</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#lab08-kagent-lab-__codelineno-18-15"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#lab08-kagent-lab-__codelineno-18-16"></a><span class="w">      </span><span class="nx">labelSelector</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#lab08-kagent-lab-__codelineno-18-17"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#lab08-kagent-lab-__codelineno-18-18"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Optional: Filter by label selector (e.g., &#39;app=nginx,env=prod&#39;)&quot;</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#lab08-kagent-lab-__codelineno-18-19"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#lab08-kagent-lab-__codelineno-18-20"></a><span class="w">      </span><span class="nx">sortBy</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#lab08-kagent-lab-__codelineno-18-21"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#lab08-kagent-lab-__codelineno-18-22"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Sort results by field&quot;</span><span class="p">,</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#lab08-kagent-lab-__codelineno-18-23"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;namespace&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;status&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;age&quot;</span><span class="p">],</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#lab08-kagent-lab-__codelineno-18-24"></a><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;name&quot;</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#lab08-kagent-lab-__codelineno-18-25"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#lab08-kagent-lab-__codelineno-18-26"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#lab08-kagent-lab-__codelineno-18-27"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28" href="#lab08-kagent-lab-__codelineno-18-28"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Update the handleListPods method</strong> to support the new parameters:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#lab08-kagent-lab-__codelineno-19-1"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">handleListPods</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#lab08-kagent-lab-__codelineno-19-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="p">,</span><span class="w"> </span><span class="nx">labelSelector</span><span class="p">,</span><span class="w"> </span><span class="nx">sortBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">;</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#lab08-kagent-lab-__codelineno-19-3"></a><span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">pods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getPods</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">labelSelector</span><span class="p">);</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#lab08-kagent-lab-__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#lab08-kagent-lab-__codelineno-19-5"></a><span class="w">  </span><span class="c1">// Filter by status if specified</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#lab08-kagent-lab-__codelineno-19-6"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#lab08-kagent-lab-__codelineno-19-7"></a><span class="w">    </span><span class="nx">pods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pods</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">pod</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">pod</span><span class="p">.</span><span class="nx">status</span><span class="o">?</span><span class="p">.</span><span class="nx">phase</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">status</span><span class="p">);</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#lab08-kagent-lab-__codelineno-19-8"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#lab08-kagent-lab-__codelineno-19-9"></a>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#lab08-kagent-lab-__codelineno-19-10"></a><span class="w">  </span><span class="c1">// Map to simplified format</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#lab08-kagent-lab-__codelineno-19-11"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">podList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pods</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">pod</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#lab08-kagent-lab-__codelineno-19-12"></a><span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata?.name</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#lab08-kagent-lab-__codelineno-19-13"></a><span class="w">    </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata?.namespace</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#lab08-kagent-lab-__codelineno-19-14"></a><span class="w">    </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.status?.phase</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#lab08-kagent-lab-__codelineno-19-15"></a><span class="w">    </span><span class="nx">containers</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.spec?.containers?.map</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[],</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#lab08-kagent-lab-__codelineno-19-16"></a><span class="w">    </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata?.creationTimestamp</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#lab08-kagent-lab-__codelineno-19-17"></a><span class="w">      </span><span class="o">?</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">pod</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">creationTimestamp</span><span class="p">).</span><span class="nx">getTime</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">60</span><span class="p">)</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#lab08-kagent-lab-__codelineno-19-18"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#lab08-kagent-lab-__codelineno-19-19"></a><span class="w">    </span><span class="nx">labels</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata?.labels</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#lab08-kagent-lab-__codelineno-19-20"></a><span class="w">  </span><span class="p">}));</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#lab08-kagent-lab-__codelineno-19-21"></a>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#lab08-kagent-lab-__codelineno-19-22"></a><span class="w">  </span><span class="c1">// Sort results</span>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#lab08-kagent-lab-__codelineno-19-23"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedPods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sortPods</span><span class="p">(</span><span class="nx">podList</span><span class="p">,</span><span class="w"> </span><span class="nx">sortBy</span><span class="p">);</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24" href="#lab08-kagent-lab-__codelineno-19-24"></a>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25" href="#lab08-kagent-lab-__codelineno-19-25"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26" href="#lab08-kagent-lab-__codelineno-19-26"></a><span class="w">    </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-19-27"><a id="__codelineno-19-27" name="__codelineno-19-27" href="#lab08-kagent-lab-__codelineno-19-27"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-19-28"><a id="__codelineno-19-28" name="__codelineno-19-28" href="#lab08-kagent-lab-__codelineno-19-28"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-19-29"><a id="__codelineno-19-29" name="__codelineno-19-29" href="#lab08-kagent-lab-__codelineno-19-29"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">sortedPods</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
</span><span id="__span-19-30"><a id="__codelineno-19-30" name="__codelineno-19-30" href="#lab08-kagent-lab-__codelineno-19-30"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-19-31"><a id="__codelineno-19-31" name="__codelineno-19-31" href="#lab08-kagent-lab-__codelineno-19-31"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-19-32"><a id="__codelineno-19-32" name="__codelineno-19-32" href="#lab08-kagent-lab-__codelineno-19-32"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-19-33"><a id="__codelineno-19-33" name="__codelineno-19-33" href="#lab08-kagent-lab-__codelineno-19-33"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Update the getPods method</strong> to support label selectors:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#lab08-kagent-lab-__codelineno-20-1"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">getPods</span><span class="p">(</span><span class="nx">namespace?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">labelSelector?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">k8s</span><span class="p">.</span><span class="nx">V1Pod</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#lab08-kagent-lab-__codelineno-20-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#lab08-kagent-lab-__codelineno-20-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">namespace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#lab08-kagent-lab-__codelineno-20-4"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sCoreApi</span><span class="p">.</span><span class="nx">listNamespacedPod</span><span class="p">({</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#lab08-kagent-lab-__codelineno-20-5"></a><span class="w">        </span><span class="nx">namespace</span><span class="p">,</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#lab08-kagent-lab-__codelineno-20-6"></a><span class="w">        </span><span class="nx">labelSelector</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#lab08-kagent-lab-__codelineno-20-7"></a><span class="w">      </span><span class="p">});</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#lab08-kagent-lab-__codelineno-20-8"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#lab08-kagent-lab-__codelineno-20-9"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#lab08-kagent-lab-__codelineno-20-10"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sCoreApi</span><span class="p">.</span><span class="nx">listPodForAllNamespaces</span><span class="p">({</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#lab08-kagent-lab-__codelineno-20-11"></a><span class="w">        </span><span class="nx">labelSelector</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#lab08-kagent-lab-__codelineno-20-12"></a><span class="w">      </span><span class="p">});</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#lab08-kagent-lab-__codelineno-20-13"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#lab08-kagent-lab-__codelineno-20-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#lab08-kagent-lab-__codelineno-20-15"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#lab08-kagent-lab-__codelineno-20-16"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleK8sError</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#lab08-kagent-lab-__codelineno-20-17"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#lab08-kagent-lab-__codelineno-20-18"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Add a sorting helper method</strong> after the <code>getPods</code> method:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#lab08-kagent-lab-__codelineno-21-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">sortPods</span><span class="p">(</span><span class="nx">pods</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[],</span><span class="w"> </span><span class="nx">sortBy</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#lab08-kagent-lab-__codelineno-21-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">pods</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#lab08-kagent-lab-__codelineno-21-3"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">sortBy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#lab08-kagent-lab-__codelineno-21-4"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;namespace&#39;</span><span class="o">:</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#lab08-kagent-lab-__codelineno-21-5"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">namespace</span><span class="p">.</span><span class="nx">localeCompare</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">namespace</span><span class="p">);</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#lab08-kagent-lab-__codelineno-21-6"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;status&#39;</span><span class="o">:</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#lab08-kagent-lab-__codelineno-21-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">localeCompare</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#lab08-kagent-lab-__codelineno-21-8"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;age&#39;</span><span class="o">:</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#lab08-kagent-lab-__codelineno-21-9"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">age</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span><span class="w"> </span><span class="c1">// Newest first</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#lab08-kagent-lab-__codelineno-21-10"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="o">:</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#lab08-kagent-lab-__codelineno-21-11"></a><span class="w">      </span><span class="nx">default</span><span class="o">:</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#lab08-kagent-lab-__codelineno-21-12"></a><span class="w">        </span><span class="kt">return</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">localeCompare</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#lab08-kagent-lab-__codelineno-21-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#lab08-kagent-lab-__codelineno-21-14"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#lab08-kagent-lab-__codelineno-21-15"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Test the enhanced filtering:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#lab08-kagent-lab-__codelineno-22-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node_modules/.bin/tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><strong>Try these test cases:</strong></p>
<ul>
<li>List only Running pods: Set <code>status</code> to &ldquo;Running&rdquo;</li>
<li>Filter by labels: Set <code>labelSelector</code> to &ldquo;app=nginx&rdquo;</li>
<li>Sort by age: Set <code>sortBy</code> to &ldquo;age&rdquo;</li>
<li>Combine filters: Use namespace + status + sortBy together</li>
</ul>
<hr />
<h3 id="lab08-kagent-lab-exercise-2-enhanced-log-analysis-with-search-and-export">Exercise 2: Enhanced Log Analysis with Search and Export<a class="headerlink" href="#lab08-kagent-lab-exercise-2-enhanced-log-analysis-with-search-and-export" title="Permanent link">&para;</a></h3>
<p>Extend the <code>collect_pod_logs</code> tool to support log searching, filtering by severity, and exporting logs to files.</p>
<p><strong>Add a new tool <code>analyze_logs</code></strong> to your tools array in <code>setupHandlers()</code>:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#lab08-kagent-lab-__codelineno-23-1"></a><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#lab08-kagent-lab-__codelineno-23-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;analyze_logs&quot;</span><span class="p">,</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#lab08-kagent-lab-__codelineno-23-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Analyze and search through pod logs with filtering and export capabilities&quot;</span><span class="p">,</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#lab08-kagent-lab-__codelineno-23-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#lab08-kagent-lab-__codelineno-23-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#lab08-kagent-lab-__codelineno-23-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#lab08-kagent-lab-__codelineno-23-7"></a><span class="w">      </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#lab08-kagent-lab-__codelineno-23-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#lab08-kagent-lab-__codelineno-23-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Namespace to analyze logs from&quot;</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#lab08-kagent-lab-__codelineno-23-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#lab08-kagent-lab-__codelineno-23-11"></a><span class="w">      </span><span class="nx">podName</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#lab08-kagent-lab-__codelineno-23-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#lab08-kagent-lab-__codelineno-23-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Specific pod name (optional)&quot;</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#lab08-kagent-lab-__codelineno-23-14"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#lab08-kagent-lab-__codelineno-23-15"></a><span class="w">      </span><span class="nx">searchPattern</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#lab08-kagent-lab-__codelineno-23-16"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#lab08-kagent-lab-__codelineno-23-17"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Regex pattern to search for in logs&quot;</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#lab08-kagent-lab-__codelineno-23-18"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#lab08-kagent-lab-__codelineno-23-19"></a><span class="w">      </span><span class="nx">severityLevel</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#lab08-kagent-lab-__codelineno-23-20"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#lab08-kagent-lab-__codelineno-23-21"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Filter by log severity&quot;</span><span class="p">,</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#lab08-kagent-lab-__codelineno-23-22"></a><span class="w">        </span><span class="kd">enum</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ERROR&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;WARN&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DEBUG&quot;</span><span class="p">]</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#lab08-kagent-lab-__codelineno-23-23"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#lab08-kagent-lab-__codelineno-23-24"></a><span class="w">      </span><span class="nx">tailLines</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#lab08-kagent-lab-__codelineno-23-25"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#lab08-kagent-lab-__codelineno-23-26"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Number of recent log lines to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#lab08-kagent-lab-__codelineno-23-27"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#lab08-kagent-lab-__codelineno-23-28"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#lab08-kagent-lab-__codelineno-23-29"></a><span class="w">      </span><span class="nx">exportToFile</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#lab08-kagent-lab-__codelineno-23-30"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#lab08-kagent-lab-__codelineno-23-31"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Export matching logs to a file&quot;</span><span class="p">,</span>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#lab08-kagent-lab-__codelineno-23-32"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#lab08-kagent-lab-__codelineno-23-33"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34" href="#lab08-kagent-lab-__codelineno-23-34"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35" href="#lab08-kagent-lab-__codelineno-23-35"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36" href="#lab08-kagent-lab-__codelineno-23-36"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37" href="#lab08-kagent-lab-__codelineno-23-37"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Add the case to your switch statement:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#lab08-kagent-lab-__codelineno-24-1"></a><span class="k">case</span><span class="w"> </span><span class="s2">&quot;analyze_logs&quot;</span><span class="o">:</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#lab08-kagent-lab-__codelineno-24-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleAnalyzeLogs</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Implement the log analysis handler</strong> after your <code>handleCollectPodLogs</code> method:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#lab08-kagent-lab-__codelineno-25-1"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">handleAnalyzeLogs</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#lab08-kagent-lab-__codelineno-25-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">podName</span><span class="p">,</span><span class="w"> </span><span class="nx">searchPattern</span><span class="p">,</span><span class="w"> </span><span class="nx">severityLevel</span><span class="p">,</span><span class="w"> </span><span class="nx">tailLines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="nx">exportToFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">;</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#lab08-kagent-lab-__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#lab08-kagent-lab-__codelineno-25-4"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">namespace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#lab08-kagent-lab-__codelineno-25-5"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Namespace is required&quot;</span><span class="p">);</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#lab08-kagent-lab-__codelineno-25-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#lab08-kagent-lab-__codelineno-25-7"></a>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#lab08-kagent-lab-__codelineno-25-8"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">logs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">collectPodLogs</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">podName</span><span class="p">,</span><span class="w"> </span><span class="nx">tailLines</span><span class="p">);</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#lab08-kagent-lab-__codelineno-25-9"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">analyzedLogs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzeLogs</span><span class="p">(</span><span class="nx">logs</span><span class="p">,</span><span class="w"> </span><span class="nx">searchPattern</span><span class="p">,</span><span class="w"> </span><span class="nx">severityLevel</span><span class="p">);</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#lab08-kagent-lab-__codelineno-25-10"></a>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#lab08-kagent-lab-__codelineno-25-11"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">exportToFile</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#lab08-kagent-lab-__codelineno-25-12"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">exportLogs</span><span class="p">(</span><span class="nx">analyzedLogs</span><span class="p">,</span><span class="w"> </span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">podName</span><span class="p">);</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#lab08-kagent-lab-__codelineno-25-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#lab08-kagent-lab-__codelineno-25-14"></a><span class="w">      </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#lab08-kagent-lab-__codelineno-25-15"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#lab08-kagent-lab-__codelineno-25-16"></a><span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#lab08-kagent-lab-__codelineno-25-17"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Analysis complete. </span><span class="si">${</span><span class="nx">analyzedLogs</span><span class="p">.</span><span class="nx">totalLines</span><span class="si">}</span><span class="sb"> lines analyzed, </span><span class="si">${</span><span class="nx">analyzedLogs</span><span class="p">.</span><span class="nx">matchingLines</span><span class="si">}</span><span class="sb"> matches found.\nExported to: </span><span class="si">${</span><span class="nx">filename</span><span class="si">}</span><span class="sb">\n\n</span><span class="si">${</span><span class="nx">analyzedLogs</span><span class="p">.</span><span class="nx">summary</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#lab08-kagent-lab-__codelineno-25-18"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#lab08-kagent-lab-__codelineno-25-19"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#lab08-kagent-lab-__codelineno-25-20"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#lab08-kagent-lab-__codelineno-25-21"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#lab08-kagent-lab-__codelineno-25-22"></a>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#lab08-kagent-lab-__codelineno-25-23"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#lab08-kagent-lab-__codelineno-25-24"></a><span class="w">    </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#lab08-kagent-lab-__codelineno-25-25"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#lab08-kagent-lab-__codelineno-25-26"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#lab08-kagent-lab-__codelineno-25-27"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="sb">`Analysis Results:\n</span><span class="si">${</span><span class="nx">analyzedLogs</span><span class="p">.</span><span class="nx">summary</span><span class="si">}</span><span class="sb">\n\nMatching Logs:\n</span><span class="si">${</span><span class="nx">analyzedLogs</span><span class="p">.</span><span class="nx">matches</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#lab08-kagent-lab-__codelineno-25-28"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#lab08-kagent-lab-__codelineno-25-29"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#lab08-kagent-lab-__codelineno-25-30"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#lab08-kagent-lab-__codelineno-25-31"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Add the log analysis helper method:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#lab08-kagent-lab-__codelineno-26-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">analyzeLogs</span><span class="p">(</span><span class="nx">logs</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">searchPattern?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">severityLevel?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#lab08-kagent-lab-__codelineno-26-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">logs</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#lab08-kagent-lab-__codelineno-26-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">matches</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#lab08-kagent-lab-__codelineno-26-4"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errors</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#lab08-kagent-lab-__codelineno-26-5"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">warnings</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#lab08-kagent-lab-__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#lab08-kagent-lab-__codelineno-26-7"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">line</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">lines</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#lab08-kagent-lab-__codelineno-26-8"></a><span class="w">    </span><span class="c1">// Filter by severity if specified</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#lab08-kagent-lab-__codelineno-26-9"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">severityLevel</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#lab08-kagent-lab-__codelineno-26-10"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">line</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">severityLevel</span><span class="p">))</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#lab08-kagent-lab-__codelineno-26-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#lab08-kagent-lab-__codelineno-26-12"></a>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#lab08-kagent-lab-__codelineno-26-13"></a><span class="w">    </span><span class="c1">// Search for pattern if specified</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#lab08-kagent-lab-__codelineno-26-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">searchPattern</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#lab08-kagent-lab-__codelineno-26-15"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">RegExp</span><span class="p">(</span><span class="nx">searchPattern</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;i&#39;</span><span class="p">);</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#lab08-kagent-lab-__codelineno-26-16"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">regex</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">line</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#lab08-kagent-lab-__codelineno-26-17"></a><span class="w">        </span><span class="nx">matches</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#lab08-kagent-lab-__codelineno-26-18"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#lab08-kagent-lab-__codelineno-26-19"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#lab08-kagent-lab-__codelineno-26-20"></a><span class="w">      </span><span class="nx">matches</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#lab08-kagent-lab-__codelineno-26-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#lab08-kagent-lab-__codelineno-26-22"></a>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#lab08-kagent-lab-__codelineno-26-23"></a><span class="w">    </span><span class="c1">// Categorize by severity</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#lab08-kagent-lab-__codelineno-26-24"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">line</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;ERROR&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">line</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#lab08-kagent-lab-__codelineno-26-25"></a><span class="w">      </span><span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#lab08-kagent-lab-__codelineno-26-26"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">line</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;WARN&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">line</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;warning&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#lab08-kagent-lab-__codelineno-26-27"></a><span class="w">      </span><span class="nx">warnings</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28" href="#lab08-kagent-lab-__codelineno-26-28"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-26-29"><a id="__codelineno-26-29" name="__codelineno-26-29" href="#lab08-kagent-lab-__codelineno-26-29"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-26-30"><a id="__codelineno-26-30" name="__codelineno-26-30" href="#lab08-kagent-lab-__codelineno-26-30"></a>
</span><span id="__span-26-31"><a id="__codelineno-26-31" name="__codelineno-26-31" href="#lab08-kagent-lab-__codelineno-26-31"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-26-32"><a id="__codelineno-26-32" name="__codelineno-26-32" href="#lab08-kagent-lab-__codelineno-26-32"></a><span class="w">    </span><span class="sb">`Total Lines: </span><span class="si">${</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-26-33"><a id="__codelineno-26-33" name="__codelineno-26-33" href="#lab08-kagent-lab-__codelineno-26-33"></a><span class="w">    </span><span class="sb">`Matching Lines: </span><span class="si">${</span><span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-26-34"><a id="__codelineno-26-34" name="__codelineno-26-34" href="#lab08-kagent-lab-__codelineno-26-34"></a><span class="w">    </span><span class="sb">`Errors Found: </span><span class="si">${</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-26-35"><a id="__codelineno-26-35" name="__codelineno-26-35" href="#lab08-kagent-lab-__codelineno-26-35"></a><span class="w">    </span><span class="sb">`Warnings Found: </span><span class="si">${</span><span class="nx">warnings</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-26-36"><a id="__codelineno-26-36" name="__codelineno-26-36" href="#lab08-kagent-lab-__codelineno-26-36"></a><span class="w">    </span><span class="nx">searchPattern</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`Search Pattern: </span><span class="si">${</span><span class="nx">searchPattern</span><span class="si">}</span><span class="sb">`</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="__span-26-37"><a id="__codelineno-26-37" name="__codelineno-26-37" href="#lab08-kagent-lab-__codelineno-26-37"></a><span class="w">    </span><span class="nx">severityLevel</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`Severity Filter: </span><span class="si">${</span><span class="nx">severityLevel</span><span class="si">}</span><span class="sb">`</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
</span><span id="__span-26-38"><a id="__codelineno-26-38" name="__codelineno-26-38" href="#lab08-kagent-lab-__codelineno-26-38"></a><span class="w">  </span><span class="p">].</span><span class="nx">filter</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
</span><span id="__span-26-39"><a id="__codelineno-26-39" name="__codelineno-26-39" href="#lab08-kagent-lab-__codelineno-26-39"></a>
</span><span id="__span-26-40"><a id="__codelineno-26-40" name="__codelineno-26-40" href="#lab08-kagent-lab-__codelineno-26-40"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-41"><a id="__codelineno-26-41" name="__codelineno-26-41" href="#lab08-kagent-lab-__codelineno-26-41"></a><span class="w">    </span><span class="nx">totalLines</span><span class="o">:</span><span class="w"> </span><span class="kt">lines.length</span><span class="p">,</span>
</span><span id="__span-26-42"><a id="__codelineno-26-42" name="__codelineno-26-42" href="#lab08-kagent-lab-__codelineno-26-42"></a><span class="w">    </span><span class="nx">matchingLines</span><span class="o">:</span><span class="w"> </span><span class="kt">matches.length</span><span class="p">,</span>
</span><span id="__span-26-43"><a id="__codelineno-26-43" name="__codelineno-26-43" href="#lab08-kagent-lab-__codelineno-26-43"></a><span class="w">    </span><span class="nx">matches</span><span class="o">:</span><span class="w"> </span><span class="kt">matches.slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">),</span><span class="w"> </span><span class="c1">// Limit to first 100 matches</span>
</span><span id="__span-26-44"><a id="__codelineno-26-44" name="__codelineno-26-44" href="#lab08-kagent-lab-__codelineno-26-44"></a><span class="w">    </span><span class="nx">errors</span><span class="p">,</span>
</span><span id="__span-26-45"><a id="__codelineno-26-45" name="__codelineno-26-45" href="#lab08-kagent-lab-__codelineno-26-45"></a><span class="w">    </span><span class="nx">warnings</span><span class="p">,</span>
</span><span id="__span-26-46"><a id="__codelineno-26-46" name="__codelineno-26-46" href="#lab08-kagent-lab-__codelineno-26-46"></a><span class="w">    </span><span class="nx">summary</span>
</span><span id="__span-26-47"><a id="__codelineno-26-47" name="__codelineno-26-47" href="#lab08-kagent-lab-__codelineno-26-47"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-26-48"><a id="__codelineno-26-48" name="__codelineno-26-48" href="#lab08-kagent-lab-__codelineno-26-48"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Add the export helper method</strong> (requires fs module - add <code>import * as fs from 'fs';</code> at the top):</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#lab08-kagent-lab-__codelineno-27-1"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">exportLogs</span><span class="p">(</span><span class="nx">analyzedLogs</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">,</span><span class="w"> </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">podName?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#lab08-kagent-lab-__codelineno-27-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[:.]/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">);</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#lab08-kagent-lab-__codelineno-27-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`logs_</span><span class="si">${</span><span class="nx">namespace</span><span class="si">}</span><span class="sb">_</span><span class="si">${</span><span class="nx">podName</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="si">}</span><span class="sb">_</span><span class="si">${</span><span class="nx">timestamp</span><span class="si">}</span><span class="sb">.txt`</span><span class="p">;</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#lab08-kagent-lab-__codelineno-27-4"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filepath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`/tmp/</span><span class="si">${</span><span class="nx">filename</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#lab08-kagent-lab-__codelineno-27-5"></a>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#lab08-kagent-lab-__codelineno-27-6"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#lab08-kagent-lab-__codelineno-27-7"></a><span class="w">    </span><span class="sb">`Kubernetes Log Analysis Report`</span><span class="p">,</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#lab08-kagent-lab-__codelineno-27-8"></a><span class="w">    </span><span class="sb">`Generated: </span><span class="si">${</span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#lab08-kagent-lab-__codelineno-27-9"></a><span class="w">    </span><span class="sb">`Namespace: </span><span class="si">${</span><span class="nx">namespace</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#lab08-kagent-lab-__codelineno-27-10"></a><span class="w">    </span><span class="nx">podName</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`Pod: </span><span class="si">${</span><span class="nx">podName</span><span class="si">}</span><span class="sb">`</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;All Pods&#39;</span><span class="p">,</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#lab08-kagent-lab-__codelineno-27-11"></a><span class="w">    </span><span class="sb">``</span><span class="p">,</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#lab08-kagent-lab-__codelineno-27-12"></a><span class="w">    </span><span class="nx">analyzedLogs</span><span class="p">.</span><span class="nx">summary</span><span class="p">,</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#lab08-kagent-lab-__codelineno-27-13"></a><span class="w">    </span><span class="sb">``</span><span class="p">,</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#lab08-kagent-lab-__codelineno-27-14"></a><span class="w">    </span><span class="sb">`=== Matching Log Entries ===`</span><span class="p">,</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#lab08-kagent-lab-__codelineno-27-15"></a><span class="w">    </span><span class="nx">analyzedLogs</span><span class="p">.</span><span class="nx">matches</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#lab08-kagent-lab-__codelineno-27-16"></a><span class="w">  </span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#lab08-kagent-lab-__codelineno-27-17"></a>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#lab08-kagent-lab-__codelineno-27-18"></a><span class="w">  </span><span class="c1">// Note: In a real implementation, you&#39;d want to handle file system operations more carefully</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#lab08-kagent-lab-__codelineno-27-19"></a><span class="w">  </span><span class="c1">// For this exercise, we&#39;ll just return the intended filename</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#lab08-kagent-lab-__codelineno-27-20"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">filepath</span><span class="p">;</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#lab08-kagent-lab-__codelineno-27-21"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Test the log analysis:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#lab08-kagent-lab-__codelineno-28-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node_modules/.bin/tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><strong>Try these test cases:</strong></p>
<ul>
<li>Search for errors: Set <code>searchPattern</code> to &ldquo;error&rdquo; and <code>severityLevel</code> to &ldquo;ERROR&rdquo;</li>
<li>Find warnings: Set <code>severityLevel</code> to &ldquo;WARN&rdquo;</li>
<li>Export logs: Set <code>exportToFile</code> to true</li>
<li>Pattern matching: Set <code>searchPattern</code> to a specific error code or message</li>
</ul>
<hr />
<h3 id="lab08-kagent-lab-exercise-3-real-time-pod-monitoring">Exercise 3: Real-Time Pod Monitoring<a class="headerlink" href="#lab08-kagent-lab-exercise-3-real-time-pod-monitoring" title="Permanent link">&para;</a></h3>
<p>Create a new tool to monitor pod health and events in real-time, providing insights into pod lifecycle changes.</p>
<p><strong>Add the <code>monitor_pod_health</code> tool</strong> to your tools array:</p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#lab08-kagent-lab-__codelineno-29-1"></a><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#lab08-kagent-lab-__codelineno-29-2"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;monitor_pod_health&quot;</span><span class="p">,</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#lab08-kagent-lab-__codelineno-29-3"></a><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Monitor pod health, restart counts, and recent events&quot;</span><span class="p">,</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#lab08-kagent-lab-__codelineno-29-4"></a><span class="w">  </span><span class="nx">inputSchema</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#lab08-kagent-lab-__codelineno-29-5"></a><span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#lab08-kagent-lab-__codelineno-29-6"></a><span class="w">    </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#lab08-kagent-lab-__codelineno-29-7"></a><span class="w">      </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#lab08-kagent-lab-__codelineno-29-8"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#lab08-kagent-lab-__codelineno-29-9"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Namespace to monitor&quot;</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#lab08-kagent-lab-__codelineno-29-10"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#lab08-kagent-lab-__codelineno-29-11"></a><span class="w">      </span><span class="nx">podName</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#lab08-kagent-lab-__codelineno-29-12"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#lab08-kagent-lab-__codelineno-29-13"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Specific pod to monitor (optional)&quot;</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#lab08-kagent-lab-__codelineno-29-14"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#lab08-kagent-lab-__codelineno-29-15"></a><span class="w">      </span><span class="nx">includeEvents</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#lab08-kagent-lab-__codelineno-29-16"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#lab08-kagent-lab-__codelineno-29-17"></a><span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Include recent Kubernetes events&quot;</span><span class="p">,</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#lab08-kagent-lab-__codelineno-29-18"></a><span class="w">        </span><span class="nx">default</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#lab08-kagent-lab-__codelineno-29-19"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#lab08-kagent-lab-__codelineno-29-20"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21" href="#lab08-kagent-lab-__codelineno-29-21"></a><span class="w">    </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22" href="#lab08-kagent-lab-__codelineno-29-22"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23" href="#lab08-kagent-lab-__codelineno-29-23"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Add the case to your switch statement:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#lab08-kagent-lab-__codelineno-30-1"></a><span class="k">case</span><span class="w"> </span><span class="s2">&quot;monitor_pod_health&quot;</span><span class="o">:</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#lab08-kagent-lab-__codelineno-30-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleMonitorPodHealth</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Implement the monitoring handler:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#lab08-kagent-lab-__codelineno-31-1"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">handleMonitorPodHealth</span><span class="p">(</span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#lab08-kagent-lab-__codelineno-31-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">podName</span><span class="p">,</span><span class="w"> </span><span class="nx">includeEvents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">;</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#lab08-kagent-lab-__codelineno-31-3"></a>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#lab08-kagent-lab-__codelineno-31-4"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">namespace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#lab08-kagent-lab-__codelineno-31-5"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Namespace is required&quot;</span><span class="p">);</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#lab08-kagent-lab-__codelineno-31-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#lab08-kagent-lab-__codelineno-31-7"></a>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#lab08-kagent-lab-__codelineno-31-8"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">pods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">podName</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#lab08-kagent-lab-__codelineno-31-9"></a><span class="w">    </span><span class="o">?</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getPods</span><span class="p">(</span><span class="nx">namespace</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">pods</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">pods</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">metadata</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">podName</span><span class="p">))</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#lab08-kagent-lab-__codelineno-31-10"></a><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getPods</span><span class="p">(</span><span class="nx">namespace</span><span class="p">);</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#lab08-kagent-lab-__codelineno-31-11"></a>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#lab08-kagent-lab-__codelineno-31-12"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">healthReports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#lab08-kagent-lab-__codelineno-31-13"></a>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#lab08-kagent-lab-__codelineno-31-14"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">pod</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">pods</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#lab08-kagent-lab-__codelineno-31-15"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">pod</span><span class="p">.</span><span class="nx">metadata</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#lab08-kagent-lab-__codelineno-31-16"></a>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#lab08-kagent-lab-__codelineno-31-17"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">health</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzePodHealth</span><span class="p">(</span><span class="nx">pod</span><span class="p">);</span>
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#lab08-kagent-lab-__codelineno-31-18"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">includeEvents</span>
</span><span id="__span-31-19"><a id="__codelineno-31-19" name="__codelineno-31-19" href="#lab08-kagent-lab-__codelineno-31-19"></a><span class="w">      </span><span class="o">?</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getPodEvents</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">pod</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
</span><span id="__span-31-20"><a id="__codelineno-31-20" name="__codelineno-31-20" href="#lab08-kagent-lab-__codelineno-31-20"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-31-21"><a id="__codelineno-31-21" name="__codelineno-31-21" href="#lab08-kagent-lab-__codelineno-31-21"></a>
</span><span id="__span-31-22"><a id="__codelineno-31-22" name="__codelineno-31-22" href="#lab08-kagent-lab-__codelineno-31-22"></a><span class="w">    </span><span class="nx">healthReports</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span><span id="__span-31-23"><a id="__codelineno-31-23" name="__codelineno-31-23" href="#lab08-kagent-lab-__codelineno-31-23"></a><span class="w">      </span><span class="nx">pod</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata.name</span><span class="p">,</span>
</span><span id="__span-31-24"><a id="__codelineno-31-24" name="__codelineno-31-24" href="#lab08-kagent-lab-__codelineno-31-24"></a><span class="w">      </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata.namespace</span><span class="p">,</span>
</span><span id="__span-31-25"><a id="__codelineno-31-25" name="__codelineno-31-25" href="#lab08-kagent-lab-__codelineno-31-25"></a><span class="w">      </span><span class="nx">health</span><span class="p">,</span>
</span><span id="__span-31-26"><a id="__codelineno-31-26" name="__codelineno-31-26" href="#lab08-kagent-lab-__codelineno-31-26"></a><span class="w">      </span><span class="nx">events</span>
</span><span id="__span-31-27"><a id="__codelineno-31-27" name="__codelineno-31-27" href="#lab08-kagent-lab-__codelineno-31-27"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-31-28"><a id="__codelineno-31-28" name="__codelineno-31-28" href="#lab08-kagent-lab-__codelineno-31-28"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-31-29"><a id="__codelineno-31-29" name="__codelineno-31-29" href="#lab08-kagent-lab-__codelineno-31-29"></a>
</span><span id="__span-31-30"><a id="__codelineno-31-30" name="__codelineno-31-30" href="#lab08-kagent-lab-__codelineno-31-30"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-31"><a id="__codelineno-31-31" name="__codelineno-31-31" href="#lab08-kagent-lab-__codelineno-31-31"></a><span class="w">    </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-31-32"><a id="__codelineno-31-32" name="__codelineno-31-32" href="#lab08-kagent-lab-__codelineno-31-32"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-31-33"><a id="__codelineno-31-33" name="__codelineno-31-33" href="#lab08-kagent-lab-__codelineno-31-33"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-31-34"><a id="__codelineno-31-34" name="__codelineno-31-34" href="#lab08-kagent-lab-__codelineno-31-34"></a><span class="w">        </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">healthReports</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
</span><span id="__span-31-35"><a id="__codelineno-31-35" name="__codelineno-31-35" href="#lab08-kagent-lab-__codelineno-31-35"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-31-36"><a id="__codelineno-31-36" name="__codelineno-31-36" href="#lab08-kagent-lab-__codelineno-31-36"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-31-37"><a id="__codelineno-31-37" name="__codelineno-31-37" href="#lab08-kagent-lab-__codelineno-31-37"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-31-38"><a id="__codelineno-31-38" name="__codelineno-31-38" href="#lab08-kagent-lab-__codelineno-31-38"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Add the health analysis method:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#lab08-kagent-lab-__codelineno-32-1"></a><span class="k">private</span><span class="w"> </span><span class="nx">analyzePodHealth</span><span class="p">(</span><span class="nx">pod</span><span class="o">:</span><span class="w"> </span><span class="kt">k8s.V1Pod</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#lab08-kagent-lab-__codelineno-32-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pod</span><span class="p">.</span><span class="nx">status</span><span class="p">;</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#lab08-kagent-lab-__codelineno-32-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">conditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">status</span><span class="o">?</span><span class="p">.</span><span class="nx">conditions</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#lab08-kagent-lab-__codelineno-32-4"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">containerStatuses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">status</span><span class="o">?</span><span class="p">.</span><span class="nx">containerStatuses</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#lab08-kagent-lab-__codelineno-32-5"></a>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#lab08-kagent-lab-__codelineno-32-6"></a><span class="w">  </span><span class="c1">// Calculate restart counts</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#lab08-kagent-lab-__codelineno-32-7"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalRestarts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">containerStatuses</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#lab08-kagent-lab-__codelineno-32-8"></a><span class="w">    </span><span class="p">(</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">cs</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">cs</span><span class="p">.</span><span class="nx">restartCount</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">),</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#lab08-kagent-lab-__codelineno-32-9"></a><span class="w">    </span><span class="mf">0</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#lab08-kagent-lab-__codelineno-32-10"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#lab08-kagent-lab-__codelineno-32-11"></a>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#lab08-kagent-lab-__codelineno-32-12"></a><span class="w">  </span><span class="c1">// Check readiness</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#lab08-kagent-lab-__codelineno-32-13"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">readyCondition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">conditions</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="kr">type</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Ready&#39;</span><span class="p">);</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#lab08-kagent-lab-__codelineno-32-14"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">isReady</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">readyCondition</span><span class="o">?</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;True&#39;</span><span class="p">;</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#lab08-kagent-lab-__codelineno-32-15"></a>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#lab08-kagent-lab-__codelineno-32-16"></a><span class="w">  </span><span class="c1">// Check container states</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#lab08-kagent-lab-__codelineno-32-17"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">containerHealth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">containerStatuses</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">cs</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#lab08-kagent-lab-__codelineno-32-18"></a><span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">cs.name</span><span class="p">,</span>
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#lab08-kagent-lab-__codelineno-32-19"></a><span class="w">    </span><span class="nx">ready</span><span class="o">:</span><span class="w"> </span><span class="kt">cs.ready</span><span class="p">,</span>
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#lab08-kagent-lab-__codelineno-32-20"></a><span class="w">    </span><span class="nx">restartCount</span><span class="o">:</span><span class="w"> </span><span class="kt">cs.restartCount</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21" href="#lab08-kagent-lab-__codelineno-32-21"></a><span class="w">    </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">cs.state?.running</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Running&#39;</span>
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22" href="#lab08-kagent-lab-__codelineno-32-22"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="nx">cs</span><span class="p">.</span><span class="nx">state</span><span class="o">?</span><span class="p">.</span><span class="nx">waiting</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`Waiting: </span><span class="si">${</span><span class="nx">cs</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">waiting</span><span class="p">.</span><span class="nx">reason</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-32-23"><a id="__codelineno-32-23" name="__codelineno-32-23" href="#lab08-kagent-lab-__codelineno-32-23"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="nx">cs</span><span class="p">.</span><span class="nx">state</span><span class="o">?</span><span class="p">.</span><span class="nx">terminated</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`Terminated: </span><span class="si">${</span><span class="nx">cs</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">terminated</span><span class="p">.</span><span class="nx">reason</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-32-24"><a id="__codelineno-32-24" name="__codelineno-32-24" href="#lab08-kagent-lab-__codelineno-32-24"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
</span><span id="__span-32-25"><a id="__codelineno-32-25" name="__codelineno-32-25" href="#lab08-kagent-lab-__codelineno-32-25"></a><span class="w">    </span><span class="nx">lastState</span><span class="o">:</span><span class="w"> </span><span class="kt">cs.lastState?.terminated</span>
</span><span id="__span-32-26"><a id="__codelineno-32-26" name="__codelineno-32-26" href="#lab08-kagent-lab-__codelineno-32-26"></a><span class="w">      </span><span class="o">?</span><span class="w"> </span><span class="sb">`Previously terminated: </span><span class="si">${</span><span class="nx">cs</span><span class="p">.</span><span class="nx">lastState</span><span class="p">.</span><span class="nx">terminated</span><span class="p">.</span><span class="nx">reason</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-32-27"><a id="__codelineno-32-27" name="__codelineno-32-27" href="#lab08-kagent-lab-__codelineno-32-27"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="kc">undefined</span>
</span><span id="__span-32-28"><a id="__codelineno-32-28" name="__codelineno-32-28" href="#lab08-kagent-lab-__codelineno-32-28"></a><span class="w">  </span><span class="p">}));</span>
</span><span id="__span-32-29"><a id="__codelineno-32-29" name="__codelineno-32-29" href="#lab08-kagent-lab-__codelineno-32-29"></a>
</span><span id="__span-32-30"><a id="__codelineno-32-30" name="__codelineno-32-30" href="#lab08-kagent-lab-__codelineno-32-30"></a><span class="w">  </span><span class="c1">// Overall health assessment</span>
</span><span id="__span-32-31"><a id="__codelineno-32-31" name="__codelineno-32-31" href="#lab08-kagent-lab-__codelineno-32-31"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">healthStatus</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-32-32"><a id="__codelineno-32-32" name="__codelineno-32-32" href="#lab08-kagent-lab-__codelineno-32-32"></a><span class="w">    </span><span class="nx">status</span><span class="o">?</span><span class="p">.</span><span class="nx">phase</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Running&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">isReady</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">totalRestarts</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Healthy&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="__span-32-33"><a id="__codelineno-32-33" name="__codelineno-32-33" href="#lab08-kagent-lab-__codelineno-32-33"></a><span class="w">    </span><span class="nx">status</span><span class="o">?</span><span class="p">.</span><span class="nx">phase</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Running&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">totalRestarts</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Unstable&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="__span-32-34"><a id="__codelineno-32-34" name="__codelineno-32-34" href="#lab08-kagent-lab-__codelineno-32-34"></a><span class="w">    </span><span class="nx">status</span><span class="o">?</span><span class="p">.</span><span class="nx">phase</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Pending&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Starting&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="__span-32-35"><a id="__codelineno-32-35" name="__codelineno-32-35" href="#lab08-kagent-lab-__codelineno-32-35"></a><span class="w">    </span><span class="nx">status</span><span class="o">?</span><span class="p">.</span><span class="nx">phase</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Failed&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Failed&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="__span-32-36"><a id="__codelineno-32-36" name="__codelineno-32-36" href="#lab08-kagent-lab-__codelineno-32-36"></a><span class="w">    </span><span class="s1">&#39;Unknown&#39;</span><span class="p">;</span>
</span><span id="__span-32-37"><a id="__codelineno-32-37" name="__codelineno-32-37" href="#lab08-kagent-lab-__codelineno-32-37"></a>
</span><span id="__span-32-38"><a id="__codelineno-32-38" name="__codelineno-32-38" href="#lab08-kagent-lab-__codelineno-32-38"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-39"><a id="__codelineno-32-39" name="__codelineno-32-39" href="#lab08-kagent-lab-__codelineno-32-39"></a><span class="w">    </span><span class="nx">phase</span><span class="o">:</span><span class="w"> </span><span class="kt">status?.phase</span><span class="p">,</span>
</span><span id="__span-32-40"><a id="__codelineno-32-40" name="__codelineno-32-40" href="#lab08-kagent-lab-__codelineno-32-40"></a><span class="w">    </span><span class="nx">healthStatus</span><span class="p">,</span>
</span><span id="__span-32-41"><a id="__codelineno-32-41" name="__codelineno-32-41" href="#lab08-kagent-lab-__codelineno-32-41"></a><span class="w">    </span><span class="nx">isReady</span><span class="p">,</span>
</span><span id="__span-32-42"><a id="__codelineno-32-42" name="__codelineno-32-42" href="#lab08-kagent-lab-__codelineno-32-42"></a><span class="w">    </span><span class="nx">totalRestarts</span><span class="p">,</span>
</span><span id="__span-32-43"><a id="__codelineno-32-43" name="__codelineno-32-43" href="#lab08-kagent-lab-__codelineno-32-43"></a><span class="w">    </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="kt">pod.metadata?.creationTimestamp</span>
</span><span id="__span-32-44"><a id="__codelineno-32-44" name="__codelineno-32-44" href="#lab08-kagent-lab-__codelineno-32-44"></a><span class="w">      </span><span class="o">?</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">pod</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">creationTimestamp</span><span class="p">).</span><span class="nx">getTime</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">60</span><span class="p">)</span>
</span><span id="__span-32-45"><a id="__codelineno-32-45" name="__codelineno-32-45" href="#lab08-kagent-lab-__codelineno-32-45"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
</span><span id="__span-32-46"><a id="__codelineno-32-46" name="__codelineno-32-46" href="#lab08-kagent-lab-__codelineno-32-46"></a><span class="w">    </span><span class="nx">conditions</span><span class="o">:</span><span class="w"> </span><span class="kt">conditions.map</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-32-47"><a id="__codelineno-32-47" name="__codelineno-32-47" href="#lab08-kagent-lab-__codelineno-32-47"></a><span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="kr">type</span><span class="p">,</span>
</span><span id="__span-32-48"><a id="__codelineno-32-48" name="__codelineno-32-48" href="#lab08-kagent-lab-__codelineno-32-48"></a><span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">c.status</span><span class="p">,</span>
</span><span id="__span-32-49"><a id="__codelineno-32-49" name="__codelineno-32-49" href="#lab08-kagent-lab-__codelineno-32-49"></a><span class="w">      </span><span class="nx">reason</span><span class="o">:</span><span class="w"> </span><span class="kt">c.reason</span><span class="p">,</span>
</span><span id="__span-32-50"><a id="__codelineno-32-50" name="__codelineno-32-50" href="#lab08-kagent-lab-__codelineno-32-50"></a><span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">c.message</span>
</span><span id="__span-32-51"><a id="__codelineno-32-51" name="__codelineno-32-51" href="#lab08-kagent-lab-__codelineno-32-51"></a><span class="w">    </span><span class="p">})),</span>
</span><span id="__span-32-52"><a id="__codelineno-32-52" name="__codelineno-32-52" href="#lab08-kagent-lab-__codelineno-32-52"></a><span class="w">    </span><span class="nx">containers</span><span class="o">:</span><span class="w"> </span><span class="kt">containerHealth</span>
</span><span id="__span-32-53"><a id="__codelineno-32-53" name="__codelineno-32-53" href="#lab08-kagent-lab-__codelineno-32-53"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-32-54"><a id="__codelineno-32-54" name="__codelineno-32-54" href="#lab08-kagent-lab-__codelineno-32-54"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Add the events retrieval method:</strong></p>
<div class="language-typescript highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#lab08-kagent-lab-__codelineno-33-1"></a><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">getPodEvents</span><span class="p">(</span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">podName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#lab08-kagent-lab-__codelineno-33-2"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#lab08-kagent-lab-__codelineno-33-3"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">k8sCoreApi</span><span class="p">.</span><span class="nx">listNamespacedEvent</span><span class="p">({</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#lab08-kagent-lab-__codelineno-33-4"></a><span class="w">      </span><span class="nx">namespace</span><span class="p">,</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#lab08-kagent-lab-__codelineno-33-5"></a><span class="w">      </span><span class="nx">fieldSelector</span><span class="o">:</span><span class="w"> </span><span class="sb">`involvedObject.name=</span><span class="si">${</span><span class="nx">podName</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#lab08-kagent-lab-__codelineno-33-6"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#lab08-kagent-lab-__codelineno-33-7"></a>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#lab08-kagent-lab-__codelineno-33-8"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[])</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#lab08-kagent-lab-__codelineno-33-9"></a><span class="w">      </span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#lab08-kagent-lab-__codelineno-33-10"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">lastTimestamp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">firstTimestamp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#lab08-kagent-lab-__codelineno-33-11"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">lastTimestamp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">firstTimestamp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#lab08-kagent-lab-__codelineno-33-12"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">timeB</span><span class="p">.</span><span class="nx">localeCompare</span><span class="p">(</span><span class="nx">timeA</span><span class="p">);</span>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#lab08-kagent-lab-__codelineno-33-13"></a><span class="w">      </span><span class="p">})</span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#lab08-kagent-lab-__codelineno-33-14"></a><span class="w">      </span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">)</span><span class="w"> </span><span class="c1">// Last 10 events</span>
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#lab08-kagent-lab-__codelineno-33-15"></a><span class="w">      </span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">event</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#lab08-kagent-lab-__codelineno-33-16"></a><span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="kr">type</span><span class="p">,</span>
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17" href="#lab08-kagent-lab-__codelineno-33-17"></a><span class="w">        </span><span class="nx">reason</span><span class="o">:</span><span class="w"> </span><span class="kt">event.reason</span><span class="p">,</span>
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18" href="#lab08-kagent-lab-__codelineno-33-18"></a><span class="w">        </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">event.message</span><span class="p">,</span>
</span><span id="__span-33-19"><a id="__codelineno-33-19" name="__codelineno-33-19" href="#lab08-kagent-lab-__codelineno-33-19"></a><span class="w">        </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">event.count</span><span class="p">,</span>
</span><span id="__span-33-20"><a id="__codelineno-33-20" name="__codelineno-33-20" href="#lab08-kagent-lab-__codelineno-33-20"></a><span class="w">        </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="kt">event.lastTimestamp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">firstTimestamp</span>
</span><span id="__span-33-21"><a id="__codelineno-33-21" name="__codelineno-33-21" href="#lab08-kagent-lab-__codelineno-33-21"></a><span class="w">      </span><span class="p">}));</span>
</span><span id="__span-33-22"><a id="__codelineno-33-22" name="__codelineno-33-22" href="#lab08-kagent-lab-__codelineno-33-22"></a>
</span><span id="__span-33-23"><a id="__codelineno-33-23" name="__codelineno-33-23" href="#lab08-kagent-lab-__codelineno-33-23"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">events</span><span class="p">;</span>
</span><span id="__span-33-24"><a id="__codelineno-33-24" name="__codelineno-33-24" href="#lab08-kagent-lab-__codelineno-33-24"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-25"><a id="__codelineno-33-25" name="__codelineno-33-25" href="#lab08-kagent-lab-__codelineno-33-25"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Failed to retrieve events:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-33-26"><a id="__codelineno-33-26" name="__codelineno-33-26" href="#lab08-kagent-lab-__codelineno-33-26"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-33-27"><a id="__codelineno-33-27" name="__codelineno-33-27" href="#lab08-kagent-lab-__codelineno-33-27"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-33-28"><a id="__codelineno-33-28" name="__codelineno-33-28" href="#lab08-kagent-lab-__codelineno-33-28"></a><span class="p">}</span>
</span></code></pre></div>
<p><br></p>
<p><strong>Test the monitoring functionality:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#lab08-kagent-lab-__codelineno-34-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>node_modules/.bin/tsx<span class="w"> </span>src/index.ts
</span></code></pre></div>
<p><strong>Try these test cases:</strong></p>
<ul>
<li>Monitor a specific pod: Set <code>namespace</code> and <code>podName</code></li>
<li>Check all pods in namespace: Set only <code>namespace</code></li>
<li>Include events: Set <code>includeEvents</code> to true</li>
<li>Look for unhealthy pods with high restart counts</li>
</ul>
<hr />
<div class="admonition tip">
<p class="admonition-title">Extension Ideas</p>
</div>
<p>Now that you have a robust K-Agent, consider these additional enhancements:</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Resource</span><span class="w"> </span><span class="n">Metrics</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">CPU</span><span class="o">/</span><span class="n">memory</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">monitoring</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Metrics</span><span class="w"> </span><span class="n">API</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Multi</span><span class="o">-</span><span class="n">Cluster</span><span class="w"> </span><span class="n">Support</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">Extend</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">Kubernetes</span><span class="w"> </span><span class="n">clusters</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Alerting</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">Implement</span><span class="w"> </span><span class="n">threshold</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">alerts</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="n">counts</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">rates</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Log</span><span class="w"> </span><span class="n">Aggregation</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">Integrate</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="n">aggregation</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">ELK</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">Loki</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Historical</span><span class="w"> </span><span class="n">Analysis</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">Store</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">analyze</span><span class="w"> </span><span class="n">trends</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">time</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Auto</span><span class="o">-</span><span class="n">Remediation</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="n">problematic</span><span class="w"> </span><span class="n">pods</span>
</code></pre></div>

<hr />
<h2 id="lab08-kagent-lab-troubleshooting">Troubleshooting<a class="headerlink" href="#lab08-kagent-lab-troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="lab08-kagent-lab-common-issues">Common Issues<a class="headerlink" href="#lab08-kagent-lab-common-issues" title="Permanent link">&para;</a></h3>
<p><strong>&ldquo;Kubernetes configuration not found&rdquo;</strong></p>
<ul>
<li>Ensure <code>kubectl</code> is installed and configured</li>
<li>Check <code>~/.kube/config</code> exists and is readable</li>
</ul>
<p><strong>&ldquo;Pod not found&rdquo; errors</strong></p>
<ul>
<li>Confirm pod names and namespaces are correct</li>
<li>Check pod status with <code>kubectl get pods</code></li>
</ul>
<h3 id="lab08-kagent-lab-debug-commands">Debug Commands<a class="headerlink" href="#lab08-kagent-lab-debug-commands" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#lab08-kagent-lab-__codelineno-35-1"></a><span class="c1"># Check cluster access</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#lab08-kagent-lab-__codelineno-35-2"></a>kubectl<span class="w"> </span>cluster-info
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#lab08-kagent-lab-__codelineno-35-3"></a>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#lab08-kagent-lab-__codelineno-35-4"></a><span class="c1"># Verify service account permissions</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#lab08-kagent-lab-__codelineno-35-5"></a>kubectl<span class="w"> </span>auth<span class="w"> </span>can-i<span class="w"> </span>list<span class="w"> </span>pods<span class="w"> </span>--as<span class="o">=</span>system:serviceaccount:default:k-agent-sa
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#lab08-kagent-lab-__codelineno-35-6"></a>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#lab08-kagent-lab-__codelineno-35-7"></a><span class="c1"># Check pod logs</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#lab08-kagent-lab-__codelineno-35-8"></a>kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>your-namespace<span class="w"> </span>your-pod-name
</span></code></pre></div>
<hr />
<h2 id="lab08-kagent-lab-key-takeaways">Key Takeaways<a class="headerlink" href="#lab08-kagent-lab-key-takeaways" title="Permanent link">&para;</a></h2>
<p>!!! success &ldquo;What You Learned&rdquo; - <strong>K-Agent Architecture</strong>: Building specialized MCP servers for Kubernetes operations - <strong>MCP Server Setup</strong>: Configuring TypeScript-based MCP servers with proper dependencies - <strong>Kubernetes Client Integration</strong>: Using the @kubernetes/client-node library to interact with clusters - <strong>Tool Implementation</strong>: Creating MCP tools for pod discovery and log collection - <strong>Error Handling</strong>: Managing Kubernetes API errors and edge cases - <strong>Testing with MCP Inspector</strong>: Using the Inspector to test and debug MCP tools</p>
<p>Congratulations! You&rsquo;ve built a functional K-Agent with two core capabilities:</p>
<ul>
<li><strong>Pod Discovery</strong> - List all pods across namespaces with status information</li>
<li><strong>Log Collection</strong> - Retrieve logs from pod containers with timestamp support</li>
</ul>
<hr />
<h2 id="lab08-kagent-lab-whats-next">What&rsquo;s Next?<a class="headerlink" href="#lab08-kagent-lab-whats-next" title="Permanent link">&para;</a></h2>
<p>Your K-Agent provides a foundation for more advanced Kubernetes automation.</p>
<p>Consider exploring:</p>
<ul>
<li>Adding filtering, log analysis, and health monitoring</li>
<li>Integrating your K-Agent with other MCP clients</li>
<li>Adding more tools for resource management (deployments, services, configmaps)</li>
<li>Implementing resource watching for real-time cluster monitoring</li>
<li>Building custom tools specific to your set Kubernetes workflows</li>
</ul>
<hr />
<h2 id="lab08-kagent-lab-additional-resources">Additional Resources<a class="headerlink" href="#lab08-kagent-lab-additional-resources" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://kubernetes.io/docs/reference/kubernetes-api/">Kubernetes API Documentation</a></li>
<li><a href="https://github.com/modelcontextprotocol/sdk">MCP SDK Reference</a></li>
<li><a href="https://kubernetes.io/docs/concepts/cluster-administration/logging/">Log Aggregation Patterns</a></content></li>
</ul></section></section>
                    <section class='print-page md-section' id='section-3' heading-number='3'>
                        <h1>Resources<a class='headerlink' href='#section-3' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="index" heading-number="3.1"><h1 id="index-mcp-labs-learning-series">MCP Labs - Learning Series<a class="headerlink" href="#index-mcp-labs-learning-series" title="Permanent link">&para;</a></h1>
<p>Welcome to the Model Context Protocol (MCP) hands-on learning series! </p>
<p>This comprehensive set of labs will take you from MCP fundamentals to building production-ready MCP servers.</p>
<hr />
<h2 id="index-what-youll-learn">What You&rsquo;ll Learn<a class="headerlink" href="#index-what-youll-learn" title="Permanent link">&para;</a></h2>
<p>Through these five progressive <a href="#.">labs</a>, you&rsquo;ll master:</p>
<ul>
<li><strong>MCP Architecture</strong> - Understanding the client-server model and core concepts</li>
<li><strong>Server Development</strong> - Building MCP servers from scratch with TypeScript</li>
<li><strong>Tools Implementation</strong> - Creating sophisticated tools that interact with external systems</li>
<li><strong>Resource Management</strong> - Exposing contextual data through MCP resources</li>
<li><strong>Prompt Engineering</strong> - Building reusable prompt templates for common tasks</li>
</ul>
<h2 id="index-lab-overview">Lab Overview<a class="headerlink" href="#index-lab-overview" title="Permanent link">&para;</a></h2>
<h3 id="index-lab-1-mcp-fundamentals"><a href="#lab01-mcp-fundamentals-index.md">Lab 1: MCP Fundamentals</a><a class="headerlink" href="#index-lab-1-mcp-fundamentals" title="Permanent link">&para;</a></h3>
<p>Get started with the basics! Learn what MCP is, why it exists, and understand its architecture and core components.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>What is MCP and the problem it solves</li>
<li>Client-server architecture</li>
<li>Core capabilities: Tools, Resources, and Prompts</li>
<li>MCP communication model and lifecycle</li>
<li>Common use cases</li>
</ul>
<hr />
<h3 id="index-lab-2-building-your-first-mcp-server"><a href="#lab02-first-mcp-server-index.md">Lab 2: Building Your First MCP Server</a><a class="headerlink" href="#index-lab-2-building-your-first-mcp-server" title="Permanent link">&para;</a></h3>
<p>Build a complete, working MCP server from the ground up.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Project setup with Node.js and TypeScript</li>
<li>Implementing the MCP protocol</li>
<li>Creating your first tool</li>
<li>Testing with MCP Inspector</li>
<li>Connecting to Claude Desktop</li>
</ul>
<hr />
<h3 id="index-lab-3-implementing-mcp-tools"><a href="#lab03-mcp-tools-index.md">Lab 3: Implementing MCP Tools</a><a class="headerlink" href="#index-lab-3-implementing-mcp-tools" title="Permanent link">&para;</a></h3>
<p>Master the art of creating sophisticated, production-ready tools.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Advanced input validation with JSON Schema</li>
<li>Real-world tool examples (Weather API, File operations, Database queries)</li>
<li>Returning rich content types</li>
<li>Error handling patterns</li>
<li>Performance optimization and caching</li>
</ul>
<hr />
<h3 id="index-lab-4-working-with-mcp-resources"><a href="#lab04-mcp-resources-index.md">Lab 4: Working with MCP Resources</a><a class="headerlink" href="#index-lab-4-working-with-mcp-resources" title="Permanent link">&para;</a></h3>
<p>Learn to expose contextual data that LLMs can read and reference.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Understanding tools vs. resources</li>
<li>Implementing different resource types</li>
<li>Resource URI schemes and templates</li>
<li>Resource subscriptions for live updates</li>
<li>Combining tools and resources</li>
</ul>
<hr />
<h3 id="index-lab-5-mcp-prompts-and-complete-integration"><a href="#lab05-mcp-prompts-index.md">Lab 5: MCP Prompts and Complete Integration</a><a class="headerlink" href="#index-lab-5-mcp-prompts-and-complete-integration" title="Permanent link">&para;</a></h3>
<p>Complete your MCP education with prompts and production best practices.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>Creating reusable prompt templates</li>
<li>Embedding resources in prompts</li>
<li>Building a complete server with all capabilities</li>
<li>Production deployment and configuration</li>
<li>Debugging and troubleshooting</li>
</ul>
<hr />
<h3 id="index-lab-6-k-agent-integration"><a href="#lab06-k-agent-index.md">Lab 6: K-Agent Integration</a><a class="headerlink" href="#index-lab-6-k-agent-integration" title="Permanent link">&para;</a></h3>
<p>Implement a specialized MCP server (K-Agent) that interacts with Kubernetes clusters to provide AI-driven log collection and analysis.</p>
<p><strong>Topics:</strong></p>
<ul>
<li>MCP server architecture for Kubernetes</li>
<li>Secure communication with Kubernetes API</li>
<li>Implementing tools for pod discovery and log retrieval</li>
<li>Collecting and structuring logs for LLM consumption</li>
<li>Containerizing and deploying the K-Agent server</li>
</ul>
<hr />
<h3 id="index-tasks"><a href="#lab01-mcp-fundamentals-lab1-tasks">Tasks</a><a class="headerlink" href="#index-tasks" title="Permanent link">&para;</a></h3>
<p>A dedicated section with exercises and challenges to reinforce your learning from all labs.</p>
<hr />
<h1 id="index-getting-started">Getting Started<a class="headerlink" href="#index-getting-started" title="Permanent link">&para;</a></h1>
<p><br></p>
<h3 id="index-prerequisites">Prerequisites<a class="headerlink" href="#index-prerequisites" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Node.js</strong> v18 or later</li>
<li>Basic knowledge of JavaScript/TypeScript</li>
<li>A code editor (VS Code recommended)</li>
<li>Terminal/command line familiarity</li>
</ul>
<hr />
<h3 id="index-recommended-path">Recommended Path<a class="headerlink" href="#index-recommended-path" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Start with <a href="#lab01-mcp-fundamentals-index.md">Lab 1</a></strong> - Even if you&rsquo;re experienced, the fundamentals are important</li>
<li><strong>Complete labs in order</strong> - Each builds on previous knowledge</li>
<li><strong>Do the <a href="#lab01-mcp-fundamentals-lab1-tasks">hands-on exercises</a></strong> - Practice is key to mastery</li>
<li><strong>Experiment freely</strong> - Try variations and explore beyond the examples</li>
</ol>
<hr />
<h3 id="index-lab-format">Lab Format<a class="headerlink" href="#index-lab-format" title="Permanent link">&para;</a></h3>
<p>Each lab includes:</p>
<ul>
<li>Clear learning objectives</li>
<li>Detailed explanations</li>
<li>Complete code examples</li>
<li>Hands-on exercises</li>
<li>Key takeaways</li>
<li>Links to additional resources</li>
</ul>
<hr />
<h2 id="index-tips-for-success">Tips for Success<a class="headerlink" href="#index-tips-for-success" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Set aside focused time</strong> - Labs require concentration and experimentation</li>
<li><strong>Type the code yourself</strong> - Don&rsquo;t just copy-paste; understand each line</li>
<li><strong>Test frequently</strong> - Run your code after each major change</li>
<li><strong>Read error messages carefully</strong> - They often tell you exactly what&rsquo;s wrong</li>
<li><strong>Experiment with modifications</strong> - Try changing parameters and adding features</li>
<li><strong>Join the community</strong> - Connect with other MCP learners and developers</li>
</ol>
<hr />
<h2 id="index-development-tools">Development Tools<a class="headerlink" href="#index-development-tools" title="Permanent link">&para;</a></h2>
<p>You&rsquo;ll use these tools throughout the labs:</p>
<ul>
<li><strong><a href="https://github.com/modelcontextprotocol/typescript-sdk">MCP TypeScript SDK</a></strong> - Official SDK for building servers</li>
<li><strong><a href="https://github.com/modelcontextprotocol/inspector">MCP Inspector</a></strong> - Essential testing tool</li>
</ul>
<hr />
<h2 id="index-additional-resources">Additional Resources<a class="headerlink" href="#index-additional-resources" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://modelcontextprotocol.io">MCP Official Documentation</a></li>
<li><a href="https://spec.modelcontextprotocol.io">MCP Specification</a></li>
<li><a href="https://github.com/modelcontextprotocol">MCP GitHub Organization</a></li>
<li><a href="https://github.com/modelcontextprotocol/servers">Example Servers Repository</a></li>
<li><a href="https://www.jsonrpc.org/specification">JSON-RPC 2.0 Specification</a></li>
</ul>
<hr />
<h2 id="index-after-completing-the-labs">After Completing the Labs<a class="headerlink" href="#index-after-completing-the-labs" title="Permanent link">&para;</a></h2>
<p>Once you&rsquo;ve finished all five labs, you&rsquo;ll be ready to:</p>
<ul>
<li>Build custom MCP servers for your specific needs</li>
<li>Integrate LLMs with your company&rsquo;s tools and data</li>
<li>Contribute to the MCP open source ecosystem</li>
<li>Share your servers with the community</li>
<li>Help others learn MCP</li>
</ul>
<hr />
<h2 id="index-community-and-support">Community and Support<a class="headerlink" href="#index-community-and-support" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><a href="https://stackoverflow.com/questions/tagged/model-context-protocol">Stack Overflow</a></strong> - Tag questions with <code>model-context-protocol</code></li>
<li><strong><a href="https://discord.gg/modelcontextprotocol">MCP Discord</a></strong> - Ask questions, share projects</li>
<li><strong><a href="https://github.com/modelcontextprotocol">GitHub Organization</a></strong> - Contribute to the ecosystem</li>
<li><strong><a href="https://modelcontextprotocol.io">Official Documentation</a></strong> - Comprehensive reference</li>
<li><strong><a href="https://spec.modelcontextprotocol.io">MCP Specification</a></strong> - Protocol details</li>
</ul>
<hr />
<h2 id="index-ready-to-begin">Ready to Begin?<a class="headerlink" href="#index-ready-to-begin" title="Permanent link">&para;</a></h2>
<p><strong><a href="#lab01-mcp-fundamentals-index.md">Start with Lab 1: MCP Fundamentals →</a></strong></p>
<p>Let&rsquo;s build something amazing with MCP!</p></section><section class="print-page" id="resources-lab09-k8s-event-monitor-step01-install-kagent" heading-number="3.2"><h1 id="resources-lab09-k8s-event-monitor-step01-install-kagent-step-1-install-kagent">Step 1: Install Kagent<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-step-1-install-kagent" title="Permanent link">&para;</a></h1>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-__codelineno-0-1"></a><span class="c1"># 1.1 Install Kagent CLI</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-__codelineno-0-2"></a>curl<span class="w"> </span>https://raw.githubusercontent.com/kagent-dev/kagent/refs/heads/main/scripts/get-kagent<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-__codelineno-0-4"></a><span class="c1"># Install Kagent Platform</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-__codelineno-0-5"></a>kagent<span class="w"> </span>install<span class="w"> </span>--profile<span class="w"> </span>demo
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-__codelineno-0-7"></a><span class="c1"># 1.3 Verify Installation</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab09-k8s-event-monitor-step01-install-kagent-__codelineno-0-8"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kagent
</span></code></pre></div></section><section class="print-page" id="resources-lab09-k8s-event-monitor-step02-create-mcp-server" heading-number="3.3"><h1 id="resources-lab09-k8s-event-monitor-step02-create-mcp-server-step-2-create-custom-mcp-tool-python">Step 2: Create Custom MCP Tool (Python)<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-step-2-create-custom-mcp-tool-python" title="Permanent link">&para;</a></h1>
<h2 id="resources-lab09-k8s-event-monitor-step02-create-mcp-server-21-project-setup">2.1 Project Setup<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-21-project-setup" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-0-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>kagent-monitor/src
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>kagent-monitor
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-0-3"></a>python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>venv
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-0-4"></a><span class="nb">source</span><span class="w"> </span>venv/bin/activate
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step02-create-mcp-server-22-create-requirementstxt">2.2 Create requirements.txt<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-22-create-requirementstxt" title="Permanent link">&para;</a></h2>
<p>Create the file <code>requirements.txt</code> with the following content:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-1-1"></a>mcp&gt;=1.0.0
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-1-2"></a>kubernetes&gt;=28.1.0
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-1-3"></a>prometheus-client&gt;=0.19.0
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step02-create-mcp-server-23-install-dependencies">2.3 Install Dependencies<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-23-install-dependencies" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-2-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step02-create-mcp-server-24-create-monitorpy">2.4 Create monitor.py<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-24-create-monitorpy" title="Permanent link">&para;</a></h2>
<p>Create the file <code>src/monitor.py</code> with the following content:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">kubernetes</span><span class="w"> </span><span class="kn">import</span> <span class="n">client</span><span class="p">,</span> <span class="n">config</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tool</span><span class="p">,</span> <span class="n">TextContent</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">prometheus_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">start_http_server</span><span class="p">,</span> <span class="n">Counter</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-9"></a><span class="c1"># Prometheus Metrics</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-10"></a><span class="n">EVENTS_FETCHED</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;k8s_events_fetched_total&#39;</span><span class="p">,</span> <span class="s1">&#39;Total number of K8s events fetched&#39;</span><span class="p">)</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-12"></a><span class="c1"># Connect to K8s</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-13"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-14"></a>    <span class="n">config</span><span class="o">.</span><span class="n">load_kube_config</span><span class="p">()</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-15"></a><span class="k">except</span><span class="p">:</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-16"></a>    <span class="n">config</span><span class="o">.</span><span class="n">load_incluster_config</span><span class="p">()</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-17"></a>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-18"></a><span class="n">v1</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-19"></a><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;k8s-monitor&quot;</span><span class="p">)</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-20"></a>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-21"></a><span class="nd">@server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-22"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-23"></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-24"></a>        <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-25"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;collect_logs&quot;</span><span class="p">,</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-26"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Collect logs and events from the Kubernetes cluster&quot;</span><span class="p">,</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-27"></a>            <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-28"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-29"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-30"></a>                    <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Namespace to filter (default: default)&quot;</span><span class="p">},</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-31"></a>                <span class="p">}</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-32"></a>            <span class="p">}</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-33"></a>        <span class="p">)</span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-34"></a>    <span class="p">]</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-35"></a>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-36"></a><span class="nd">@server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-37"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-38"></a>    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;collect_logs&quot;</span><span class="p">:</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-39"></a>        <span class="n">ns</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;namespace&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-40"></a>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-41"></a>        <span class="c1"># 1. Fetch Events</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-42"></a>        <span class="n">events</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">list_namespaced_event</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-43"></a>        <span class="n">EVENTS_FETCHED</span><span class="o">.</span><span class="n">inc</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="o">.</span><span class="n">items</span><span class="p">))</span>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-44"></a>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-45"></a>        <span class="n">event_logs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-46"></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">events</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-47"></a>            <span class="n">event_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[EVENT] </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">last_timestamp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-48"></a>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-49"></a>        <span class="c1"># 2. Fetch Pod Logs (Sample from first pod)</span>
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-50"></a>        <span class="n">pods</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">list_namespaced_pod</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-51"></a>        <span class="n">pod_logs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-52"></a>        <span class="k">if</span> <span class="n">pods</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-53"></a>            <span class="n">p</span> <span class="o">=</span> <span class="n">pods</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-54"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-55"></a>                <span class="n">logs</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">read_namespaced_pod_log</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ns</span><span class="p">,</span> <span class="n">tail_lines</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-56"></a>                <span class="n">pod_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[POD </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">logs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-57"></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-58"></a>                <span class="n">pod_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[POD </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">] Could not read logs&quot;</span><span class="p">)</span>
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-59"></a>
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-60"></a>        <span class="n">full_log</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">event_logs</span> <span class="o">+</span> <span class="n">pod_logs</span><span class="p">)</span>
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-61"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">full_log</span><span class="p">)]</span>
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-62"></a>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-63"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown tool: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-64"></a>
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-65"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-66"></a>    <span class="c1"># Start Prometheus Metrics endpoint on port 8000</span>
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-67"></a>    <span class="n">start_http_server</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-68"></a>
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-69"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">stdio_server</span><span class="p">()</span> <span class="k">as</span> <span class="p">(</span><span class="n">read</span><span class="p">,</span> <span class="n">write</span><span class="p">):</span>
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-70"></a>        <span class="k">await</span> <span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">read</span><span class="p">,</span> <span class="n">write</span><span class="p">,</span> <span class="n">server</span><span class="o">.</span><span class="n">create_initialization_options</span><span class="p">())</span>
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-71"></a>
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-72"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-3-73"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step02-create-mcp-server-25-test-the-tool">2.5 Test the Tool<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-25-test-the-tool" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#resources-lab09-k8s-event-monitor-step02-create-mcp-server-__codelineno-4-1"></a>npx<span class="w"> </span>@modelcontextprotocol/inspector<span class="w"> </span>python3<span class="w"> </span>src/monitor.py
</span></code></pre></div></section><section class="print-page" id="resources-lab09-k8s-event-monitor-step03-kmcp-build" heading-number="3.4"><h1 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-step-3-use-kmcp-to-build-the-server">Step 3: Use kmcp to Build the Server<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-step-3-use-kmcp-to-build-the-server" title="Permanent link">&para;</a></h1>
<h2 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-31-install-kmcp-cli">3.1 Install kmcp CLI<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-31-install-kmcp-cli" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-0-1"></a>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://raw.githubusercontent.com/kagent-dev/kmcp/refs/heads/main/scripts/get-kmcp.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-32-initialize-project">3.2 Initialize Project<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-32-initialize-project" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-1-1"></a><span class="nb">cd</span><span class="w"> </span>~
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-1-2"></a>kmcp<span class="w"> </span>init<span class="w"> </span>python<span class="w"> </span>kagent-monitor-kmcp
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-1-3"></a><span class="nb">cd</span><span class="w"> </span>kagent-monitor-kmcp
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-33-add-dependencies">3.3 Add Dependencies<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-33-add-dependencies" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-2-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;kubernetes&gt;=28.1.0&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>requirements.txt
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-2-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;prometheus-client&gt;=0.19.0&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>requirements.txt
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-34-create-k8s_toolspy">3.4 Create k8s_tools.py<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-34-create-k8s_toolspy" title="Permanent link">&para;</a></h2>
<p>Create the file <code>src/k8s_tools.py</code> with the following content:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">core.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">mcp</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">kubernetes</span><span class="w"> </span><span class="kn">import</span> <span class="n">client</span><span class="p">,</span> <span class="n">config</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-4"></a><span class="c1"># Initialize K8s client</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-5"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-6"></a>    <span class="n">config</span><span class="o">.</span><span class="n">load_kube_config</span><span class="p">()</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-7"></a><span class="k">except</span><span class="p">:</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-8"></a>    <span class="n">config</span><span class="o">.</span><span class="n">load_incluster_config</span><span class="p">()</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-9"></a><span class="n">v1</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-10"></a>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-11"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Collect logs and events from the Kubernetes cluster&quot;</span><span class="p">)</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-12"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">collect_logs</span><span class="p">(</span><span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Collect logs and events from the Kubernetes cluster&quot;&quot;&quot;</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-14"></a>    <span class="c1"># Fetch events</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-15"></a>    <span class="n">events</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">list_namespaced_event</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-16"></a>    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-17"></a>    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">events</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-18"></a>        <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[EVENT] </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">last_timestamp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-3-19"></a>    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-35-run-locally">3.5 Run Locally<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-35-run-locally" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-4-1"></a>kmcp<span class="w"> </span>run<span class="w"> </span>--project-dir<span class="w"> </span>.
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-36-build-docker-image">3.6 Build Docker Image<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-36-build-docker-image" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-5-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>nirgeier/my-kagent-monitor:v1<span class="w"> </span>.
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-37-push-or-load-image">3.7 Push or Load Image<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-37-push-or-load-image" title="Permanent link">&para;</a></h2>
<h3 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-docker-hub">Docker Hub<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-docker-hub" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-6-1"></a>docker<span class="w"> </span>push<span class="w"> </span>nirgeier/my-kagent-monitor:v1
</span></code></pre></div>
<h3 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-kind">Kind<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-kind" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-7-1"></a>kind<span class="w"> </span>load<span class="w"> </span>docker-image<span class="w"> </span>my-kagent-monitor:v1<span class="w"> </span>--name<span class="w"> </span>&lt;cluster-name&gt;
</span></code></pre></div>
<h3 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-minikube">Minikube<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-minikube" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-8-1"></a>minikube<span class="w"> </span>image<span class="w"> </span>load<span class="w"> </span>my-kagent-monitor:v1
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step03-kmcp-build-38-deploy-to-kubernetes">3.8 Deploy to Kubernetes<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-38-deploy-to-kubernetes" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#resources-lab09-k8s-event-monitor-step03-kmcp-build-__codelineno-9-1"></a>kmcp<span class="w"> </span>deploy<span class="w"> </span>--namespace<span class="w"> </span>default<span class="w"> </span>--image<span class="w"> </span>nirgeier/my-kagent-monitor:v1
</span></code></pre></div></section><section class="print-page" id="resources-lab09-k8s-event-monitor-step04-verify-registration" heading-number="3.5"><h1 id="resources-lab09-k8s-event-monitor-step04-verify-registration-step-4-verify-tool-registration">Step 4: Verify Tool Registration<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-step-4-verify-tool-registration" title="Permanent link">&para;</a></h1>
<h2 id="resources-lab09-k8s-event-monitor-step04-verify-registration-41-check-deployment-status">4.1 Check Deployment Status<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-41-check-deployment-status" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-0-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>default<span class="w"> </span>-l<span class="w"> </span><span class="nv">app</span><span class="o">=</span>kagent-monitor-kmcp
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step04-verify-registration-42-verify-mcp-server-registration">4.2 Verify MCP Server Registration<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-42-verify-mcp-server-registration" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-1-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>mcpservers<span class="w"> </span>-n<span class="w"> </span>default
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step04-verify-registration-43-manual-registration-optional">4.3 Manual Registration (Optional)<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-43-manual-registration-optional" title="Permanent link">&para;</a></h2>
<p>Create the file <code>mcpserver.yaml</code> with the following content:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kagent.dev/v1alpha1</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MCPServer</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s-monitor</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-5"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-6"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-7"></a><span class="w">    </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s-monitor</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-8"></a><span class="w">    </span><span class="nt">app.kubernetes.io/part-of</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kagent</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-9"></a><span class="w">    </span><span class="nt">app.kubernetes.io/component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mcp-server</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-10"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-11"></a><span class="w">  </span><span class="nt">deployment</span><span class="p">:</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-12"></a><span class="w">    </span><span class="nt">args</span><span class="p">:</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-13"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/main.py</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-14"></a><span class="w">    </span><span class="nt">cmd</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-15"></a><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nirgeier/my-kagent-monitor:v1</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-16"></a><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3000</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-17"></a><span class="w">  </span><span class="nt">stdioTransport</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-2-18"></a><span class="w">  </span><span class="nt">transportType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stdio</span>
</span></code></pre></div>
<p>Then apply it:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#resources-lab09-k8s-event-monitor-step04-verify-registration-__codelineno-3-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>mcpserver.yaml
</span></code></pre></div></section><section class="print-page" id="resources-lab09-k8s-event-monitor-step05-create-agent" heading-number="3.6"><h1 id="resources-lab09-k8s-event-monitor-step05-create-agent-step-5-create-the-agent">Step 5: Create the Agent<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step05-create-agent-step-5-create-the-agent" title="Permanent link">&para;</a></h1>
<h2 id="resources-lab09-k8s-event-monitor-step05-create-agent-51-create-remotemcpserver">5.1 Create RemoteMCPServer<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step05-create-agent-51-create-remotemcpserver" title="Permanent link">&para;</a></h2>
<p>Create the file <code>remotemcpserver.yaml</code> with the following content:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kagent.dev/v1alpha2</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RemoteMCPServer</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s-monitor-mcp</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-5"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-6"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-7"></a><span class="w">    </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s-monitor-mcp</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-8"></a><span class="w">    </span><span class="nt">app.kubernetes.io/part-of</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kagent</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-9"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-10"></a><span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">K8s Event and Log Monitor MCP Server</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-11"></a><span class="w">  </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">STREAMABLE_HTTP</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-0-12"></a><span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://k8s-monitor.default:3000/mcp</span>
</span></code></pre></div>
<p>Then apply it:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-1-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>remotemcpserver.yaml
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step05-create-agent-52-create-agent">5.2 Create Agent<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step05-create-agent-52-create-agent" title="Permanent link">&para;</a></h2>
<p>Create the file <code>agent.yaml</code> with the following content:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kagent.dev/v1alpha2</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Agent</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s-monitor-agent</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-5"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-6"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-7"></a><span class="w">    </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s-monitor-agent</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-8"></a><span class="w">    </span><span class="nt">app.kubernetes.io/part-of</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kagent</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-9"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-10"></a><span class="w">  </span><span class="nt">declarative</span><span class="p">:</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-11"></a><span class="w">    </span><span class="nt">modelConfig</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-model-config</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-12"></a><span class="w">    </span><span class="nt">systemMessage</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-13"></a><span class="w">      </span><span class="no">You are a Kubernetes monitoring agent that can collect logs and events from a Kubernetes cluster.</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-14"></a><span class="w">      </span><span class="no">Use the collect_logs tool to gather information about events and pod logs in a given namespace.</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-15"></a><span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-16"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">McpServer</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-17"></a><span class="w">        </span><span class="nt">mcpServer</span><span class="p">:</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-18"></a><span class="w">          </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kagent.dev</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-19"></a><span class="w">          </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RemoteMCPServer</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-20"></a><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s-monitor-mcp</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-21"></a><span class="w">          </span><span class="nt">toolNames</span><span class="p">:</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-22"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trace</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-23"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fail</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-24"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sleep</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-25"></a><span class="w">    </span><span class="nt">deployment</span><span class="p">:</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-26"></a><span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-27"></a><span class="w">        </span><span class="nt">requests</span><span class="p">:</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-28"></a><span class="w">          </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100m</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-29"></a><span class="w">          </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256Mi</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-30"></a><span class="w">        </span><span class="nt">limits</span><span class="p">:</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-31"></a><span class="w">          </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500m</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-2-32"></a><span class="w">          </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512Mi</span>
</span></code></pre></div>
<p>Then apply it:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-3-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>agent.yaml
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step05-create-agent-53-verify-the-agent">5.3 Verify the Agent<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step05-create-agent-53-verify-the-agent" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-4-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>agents<span class="w"> </span>-n<span class="w"> </span>default
</span></code></pre></div>
<p>Expected output:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-5-1"></a>NAME                TYPE          READY   ACCEPTED
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-5-2"></a>k8s-monitor-agent   Declarative   True    True
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step05-create-agent-54-verify-remotemcpserver">5.4 Verify RemoteMCPServer<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step05-create-agent-54-verify-remotemcpserver" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-6-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>remotemcpservers<span class="w"> </span>-n<span class="w"> </span>default
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step05-create-agent-55-debug-if-ready-false">5.5 Debug (if READY: False)<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step05-create-agent-55-debug-if-ready-false" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#resources-lab09-k8s-event-monitor-step05-create-agent-__codelineno-7-1"></a>kubectl<span class="w"> </span>logs<span class="w"> </span>-l<span class="w"> </span>app.kubernetes.io/name<span class="o">=</span>k8s-monitor-agent<span class="w"> </span>-n<span class="w"> </span>default
</span></code></pre></div></section><section class="print-page" id="resources-lab09-k8s-event-monitor-step06-install-ingress" heading-number="3.7"><h1 id="resources-lab09-k8s-event-monitor-step06-install-ingress-step-6-install-nginx-ingress-controller">Step 6: Install NGINX Ingress Controller<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-step-6-install-nginx-ingress-controller" title="Permanent link">&para;</a></h1>
<h2 id="resources-lab09-k8s-event-monitor-step06-install-ingress-61-install-via-helm">6.1 Install via Helm<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-61-install-via-helm" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-__codelineno-0-1"></a>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>ingress-nginx<span class="w"> </span>https://kubernetes.github.io/ingress-nginx
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-__codelineno-0-2"></a>helm<span class="w"> </span>repo<span class="w"> </span>update
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-__codelineno-0-4"></a>helm<span class="w"> </span>install<span class="w"> </span>ingress-nginx<span class="w"> </span>ingress-nginx/ingress-nginx<span class="w"> </span><span class="se">\</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-__codelineno-0-5"></a><span class="w">  </span>--namespace<span class="w"> </span>ingress-nginx<span class="w"> </span><span class="se">\</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-__codelineno-0-6"></a><span class="w">  </span>--create-namespace
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step06-install-ingress-62-verify-installation">6.2 Verify Installation<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-62-verify-installation" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#resources-lab09-k8s-event-monitor-step06-install-ingress-__codelineno-1-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>ingress-nginx
</span></code></pre></div></section><section class="print-page" id="resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana" heading-number="3.8"><h1 id="resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-step-7-deploy-prometheus-grafana">Step 7: Deploy Prometheus &amp; Grafana<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-step-7-deploy-prometheus-grafana" title="Permanent link">&para;</a></h1>
<h2 id="resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-71-add-helm-repos">7.1 Add Helm Repos<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-71-add-helm-repos" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-0-1"></a>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>prometheus-community<span class="w"> </span>https://prometheus-community.github.io/helm-charts
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-0-2"></a>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>grafana<span class="w"> </span>https://grafana.github.io/helm-charts
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-0-3"></a>helm<span class="w"> </span>repo<span class="w"> </span>update
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-72-create-prometheus-config">7.2 Create Prometheus Config<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-72-create-prometheus-config" title="Permanent link">&para;</a></h2>
<p>Create the file <code>prometheus-config.yaml</code> with the following content:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-1"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-2"></a><span class="w">  </span><span class="nt">baseURL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/prometheus</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-4"></a><span class="w">  </span><span class="c1"># Fix probes to check status at /prometheus/-/ready instead of /-/ready</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-5"></a><span class="w">  </span><span class="nt">readinessProbe</span><span class="p">:</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-6"></a><span class="w">    </span><span class="nt">httpGet</span><span class="p">:</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-7"></a><span class="w">      </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/prometheus/-/ready</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-8"></a><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9090</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-9"></a><span class="w">      </span><span class="nt">scheme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTP</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-10"></a><span class="w">    </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-11"></a><span class="w">    </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-12"></a><span class="w">    </span><span class="nt">timeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-13"></a><span class="w">    </span><span class="nt">failureThreshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-14"></a><span class="w">    </span><span class="nt">successThreshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-15"></a>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-16"></a><span class="w">  </span><span class="nt">livenessProbe</span><span class="p">:</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-17"></a><span class="w">    </span><span class="nt">httpGet</span><span class="p">:</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-18"></a><span class="w">      </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/prometheus/-/healthy</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-19"></a><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9090</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-20"></a><span class="w">      </span><span class="nt">scheme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTP</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-21"></a><span class="w">    </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-22"></a><span class="w">    </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-23"></a><span class="w">    </span><span class="nt">timeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-24"></a><span class="w">    </span><span class="nt">failureThreshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-25"></a><span class="w">    </span><span class="nt">successThreshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-26"></a>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-27"></a><span class="nt">extraScrapeConfigs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-28"></a><span class="w">  </span><span class="no">- job_name: &#39;mcp-monitor&#39;</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-29"></a><span class="w">    </span><span class="no">kubernetes_sd_configs:</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-30"></a><span class="w">      </span><span class="no">- role: pod</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-31"></a><span class="w">    </span><span class="no">relabel_configs:</span>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-32"></a><span class="w">      </span><span class="no">- source_labels: [__meta_kubernetes_pod_name]</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-33"></a><span class="w">        </span><span class="no">regex: .*monitor.*</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-34"></a><span class="w">        </span><span class="no">action: keep</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-35"></a><span class="w">      </span><span class="no">- source_labels: [__address__]</span>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-36"></a><span class="w">        </span><span class="no">regex: ([^:]+)(?::\d+)?</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-37"></a><span class="w">        </span><span class="no">replacement: ${1}:8000</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-1-38"></a><span class="w">        </span><span class="no">target_label: __address__</span>
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-73-create-grafana-config">7.3 Create Grafana Config<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-73-create-grafana-config" title="Permanent link">&para;</a></h2>
<p>Create the file <code>grafana-config.yaml</code> with the following content:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-2-1"></a><span class="nt">adminPassword</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin123</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-2-2"></a><span class="nt">grafana.ini</span><span class="p">:</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-2-3"></a><span class="w">  </span><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-2-4"></a><span class="w">    </span><span class="nt">domain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster.local</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-2-5"></a><span class="w">    </span><span class="nt">root_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%(protocol)s://%(domain)s/grafana&quot;</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-2-6"></a><span class="w">    </span><span class="nt">serve_from_sub_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-74-install-prometheus">7.4 Install Prometheus<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-74-install-prometheus" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-3-1"></a>helm<span class="w"> </span>upgrade<span class="w"> </span>--install<span class="w"> </span>prometheus<span class="w"> </span>prometheus-community/prometheus<span class="w"> </span>-f<span class="w"> </span>prometheus-config.yaml
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-75-install-grafana">7.5 Install Grafana<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-75-install-grafana" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-4-1"></a>helm<span class="w"> </span>upgrade<span class="w"> </span>--install<span class="w"> </span>grafana<span class="w"> </span>grafana/grafana<span class="w"> </span>-f<span class="w"> </span>grafana-config.yaml
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-76-verify-deployments">7.6 Verify Deployments<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-76-verify-deployments" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-5-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>default
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-__codelineno-5-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>ingress-nginx
</span></code></pre></div></section><section class="print-page" id="resources-lab09-k8s-event-monitor-step08-expose-ingress" heading-number="3.9"><h1 id="resources-lab09-k8s-event-monitor-step08-expose-ingress-step-8-expose-services-via-ingress">Step 8: Expose Services via Ingress<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-step-8-expose-services-via-ingress" title="Permanent link">&para;</a></h1>
<h2 id="resources-lab09-k8s-event-monitor-step08-expose-ingress-81-create-ingress-manifest">8.1 Create Ingress Manifest<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-81-create-ingress-manifest" title="Permanent link">&para;</a></h2>
<p>Create the file <code>observability-ingress.yaml</code> with the following content:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">observability-ingress</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-5"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-6"></a><span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-7"></a><span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-8"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster.local</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-9"></a><span class="w">      </span><span class="nt">http</span><span class="p">:</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-10"></a><span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-11"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/prometheus</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-12"></a><span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-13"></a><span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-14"></a><span class="w">              </span><span class="nt">service</span><span class="p">:</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-15"></a><span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus-server</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-16"></a><span class="w">                </span><span class="nt">port</span><span class="p">:</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-17"></a><span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-18"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/grafana</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-19"></a><span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-20"></a><span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-21"></a><span class="w">              </span><span class="nt">service</span><span class="p">:</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-22"></a><span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grafana</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-23"></a><span class="w">                </span><span class="nt">port</span><span class="p">:</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-24"></a><span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-25"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-26"></a><span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-27"></a><span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-28"></a><span class="w">              </span><span class="nt">service</span><span class="p">:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-29"></a><span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kagent-ui</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-30"></a><span class="w">                </span><span class="nt">port</span><span class="p">:</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-0-31"></a><span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step08-expose-ingress-82-apply-ingress">8.2 Apply Ingress<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-82-apply-ingress" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-1-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>observability-ingress.yaml
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step08-expose-ingress-83-update-hosts-file">8.3 Update Hosts File<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-83-update-hosts-file" title="Permanent link">&para;</a></h2>
<h3 id="resources-lab09-k8s-event-monitor-step08-expose-ingress-find-the-ip">Find the IP<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-find-the-ip" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Docker Desktop / OrbStack</strong>: Use <code>127.0.0.1</code></li>
<li><strong>Minikube</strong>: Run <code>minikube ip</code></li>
</ul>
<h3 id="resources-lab09-k8s-event-monitor-step08-expose-ingress-edit-host-file">Edit Host File<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-edit-host-file" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Linux/macOS</strong>: <code>/etc/hosts</code></li>
<li><strong>Windows</strong>: <code>C:\Windows\System32\drivers\etc\hosts</code></li>
</ul>
<p>Add:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-__codelineno-2-1"></a>127.0.0.1  cluster.local
</span></code></pre></div>
<h2 id="resources-lab09-k8s-event-monitor-step08-expose-ingress-84-access-services">8.4 Access Services<a class="headerlink" href="#resources-lab09-k8s-event-monitor-step08-expose-ingress-84-access-services" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Kagent Dashboard</strong>: http://cluster.local</li>
<li><strong>Grafana</strong>: http://cluster.local/grafana</li>
<li>User: <code>admin</code></li>
<li>Password: <code>admin123</code></li>
<li><strong>Prometheus</strong>: http://cluster.local/prometheus</li>
</ul></section><section class="print-page" id="resources-lab07-mcp-ollama-step00-getting-started" heading-number="3.11"><h1 id="resources-lab07-mcp-ollama-step00-getting-started-resources-lab07-mcp-ollama-step00-getting-started">Lab 07 - 00: Getting Started</h1><h4 id="step-00-prerequisites-data-files">Step 00 - Prerequisites data files<a class="headerlink" href="#resources-lab07-mcp-ollama-step00-getting-started-step-00-prerequisites-data-files" title="Permanent link">&para;</a></h4>
<div class="tabbed-set tabbed-alternate" data-tabs="1:5"><input checked="checked" id="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_1" name="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1" type="radio" /><input id="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_2" name="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1" type="radio" /><input id="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_3" name="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1" type="radio" /><input id="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_4" name="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1" type="radio" /><input id="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_5" name="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_1">capitals.csv</label><label for="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_2">foundation_year.csv</label><label for="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_3">height.csv</label><label for="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_4">population.csv</label><label for="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_1_5">requirements.txt</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-1"></a>country,capital
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-2"></a>Afghanistan,Kabul
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-3"></a>Albania,Tirana
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-4"></a>Algeria,Algiers
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-5"></a>Andorra,Andorra la Vella
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-6"></a>Angola,Luanda
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-7"></a>Antigua and Barbuda,Saint John&#39;s
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-8"></a>Argentina,Buenos Aires
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-9"></a>Armenia,Yerevan
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-10"></a>Australia,Canberra
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-11"></a>Austria,Vienna
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-12"></a>Azerbaijan,Baku
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-13"></a>Bahamas,Nassau
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-14"></a>Bahrain,Manama
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-15"></a>Bangladesh,Dhaka
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-16"></a>Barbados,Bridgetown
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-17"></a>Belarus,Minsk
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-18"></a>Belgium,Brussels
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-19"></a>Belize,Belmopan
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-20"></a>Benin,Porto-Novo
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-21"></a>Bhutan,Thimphu
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-22"></a>Bolivia,Sucre
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-23"></a>Bosnia and Herzegovina,Sarajevo
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-24"></a>Botswana,Gaborone
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-25"></a>Brazil,Brasília
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-26"></a>Brunei,Bandar Seri Begawan
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-27"></a>Bulgaria,Sofia
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-28"></a>Burkina Faso,Ouagadougou
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-29"></a>Burundi,Gitega
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-30"></a>Cabo Verde,Praia
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-31"></a>Cambodia,Phnom Penh
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-32"></a>Cameroon,Yaoundé
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-33"></a>Canada,Ottawa
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-34"></a>Central African Republic,Bangui
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-35"></a>Chad,N&#39;Djamena
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-36"></a>Chile,Santiago
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-37"></a>China,Beijing
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-38"></a>Colombia,Bogotá
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-39"></a>Comoros,Moroni
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-40"></a>Congo,Brazzaville
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-41"></a>Costa Rica,San José
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-42"></a>Côte d&#39;Ivoire,Yamoussoukro
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-43"></a>Croatia,Zagreb
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-44"></a>Cuba,Havana
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-45"></a>Cyprus,Nicosia
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-46"></a>Czechia,Prague
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-47"></a>Denmark,Copenhagen
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-48"></a>Djibouti,Djibouti
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-49"></a>Dominica,Roseau
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-50"></a>Dominican Republic,Santo Domingo
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-51"></a>DRC,Kinshasa
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-52"></a>Ecuador,Quito
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-53"></a>Egypt,Cairo
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-54"></a>El Salvador,San Salvador
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-55"></a>Equatorial Guinea,Malabo
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-56"></a>Eritrea,Asmara
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-57"></a>Estonia,Tallinn
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-58"></a>Eswatini,Mbabane
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-59"></a>Ethiopia,Addis Ababa
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-60"></a>Fiji,Suva
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-61"></a>Finland,Helsinki
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-62"></a>France,Paris
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-63"></a>Gabon,Libreville
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-64"></a>Gambia,Banjul
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-65"></a>Georgia,Tbilisi
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-66"></a>Germany,Berlin
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-67"></a>Ghana,Accra
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-68"></a>Greece,Athens
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-69"></a>Grenada,Saint George&#39;s
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-70"></a>Guatemala,Guatemala City
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-71"></a>Guinea,Conakry
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-72"></a>Guinea-Bissau,Bissau
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-73"></a>Guyana,Georgetown
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-74"></a>Haiti,Port-au-Prince
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-75"></a>Honduras,Tegucigalpa
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-76"></a>Hungary,Budapest
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-77"></a>Iceland,Reykjavík
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-78"></a>India,New Delhi
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-79"></a>Indonesia,Jakarta
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-80"></a>Iran,Tehran
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-81"></a>Iraq,Baghdad
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-82"></a>Ireland,Dublin
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-83"></a>Israel,Jerusalem
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-84"></a>Italy,Rome
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-85"></a>Jamaica,Kingston
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-86"></a>Japan,Tokyo
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-87"></a>Jordan,Amman
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-88"></a>Kazakhstan,Astana
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-89"></a>Kenya,Nairobi
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-90"></a>Kiribati,Tarawa
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-91"></a>Kuwait,Kuwait City
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-92"></a>Kyrgyzstan,Bishkek
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-93"></a>Laos,Vientiane
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-94"></a>Latvia,Riga
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-95"></a>Lebanon,Beirut
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-96"></a>Lesotho,Maseru
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-97"></a>Liberia,Monrovia
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-98"></a>Libya,Tripoli
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-99"></a>Liechtenstein,Vaduz
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-100"></a>Lithuania,Vilnius
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-101"></a>Luxembourg,Luxembourg
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-102"></a>Madagascar,Antananarivo
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-103"></a>Malawi,Lilongwe
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-104"></a>Malaysia,Kuala Lumpur
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-105"></a>Maldives,Malé
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-106"></a>Mali,Bamako
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-107"></a>Malta,Valletta
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-108"></a>Marshall Islands,Majuro
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-109"></a>Mauritania,Nouakchott
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-110"></a>Mauritius,Port Louis
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-111"></a>Mexico,Mexico City
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-112"></a>Micronesia,Palikir
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-113"></a>Moldova,Chisinau
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-114"></a>Monaco,Monaco
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-115"></a>Mongolia,Ulaanbaatar
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-116"></a>Montenegro,Podgorica
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-117"></a>Morocco,Rabat
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-118"></a>Mozambique,Maputo
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-119"></a>Myanmar,Naypyidaw
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-120"></a>Namibia,Windhoek
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-121"></a>Nauru,Yaren
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-122"></a>Nepal,Kathmandu
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-123"></a>Netherlands,Amsterdam
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-124"></a>New Zealand,Wellington
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-125"></a>Nicaragua,Managua
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-126"></a>Niger,Niamey
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-127"></a>Nigeria,Abuja
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-128"></a>North Korea,Pyongyang
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-129"></a>North Macedonia,Skopje
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-130"></a>Norway,Oslo
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-131"></a>Oman,Muscat
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-132"></a>Pakistan,Islamabad
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-133"></a>Palau,Ngerulmud
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-134"></a>Panama,Panama City
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-135"></a>Papua New Guinea,Port Moresby
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-136"></a>Paraguay,Asunción
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-137"></a>Peru,Lima
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-138"></a>Philippines,Manila
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-139"></a>Poland,Warsaw
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-140"></a>Portugal,Lisbon
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-141"></a>Qatar,Doha
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-142"></a>Romania,Bucharest
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-143"></a>Russia,Moscow
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-144"></a>Rwanda,Kigali
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-145"></a>Saint Kitts and Nevis,Basseterre
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-146"></a>Saint Lucia,Castries
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-147"></a>Saint Vincent and the Grenadines,Kingstown
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-148"></a>Samoa,Apia
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-149"></a>San Marino,San Marino
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-150"></a>São Tomé and Príncipe,São Tomé
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-151"></a>Saudi Arabia,Riyadh
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-152"></a>Senegal,Dakar
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-153"></a>Serbia,Belgrade
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-154"></a>Seychelles,Victoria
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-155"></a>Sierra Leone,Freetown
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-156"></a>Singapore,Singapore
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-157"></a>Slovakia,Bratislava
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-158"></a>Slovenia,Ljubljana
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-159"></a>Solomon Islands,Honiara
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-160"></a>Somalia,Mogadishu
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-161"></a>South Africa,Pretoria
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-162"></a>South Korea,Seoul
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-163"></a>South Sudan,Juba
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-164"></a>Spain,Madrid
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-165"></a>Sri Lanka,Sri Jayawardenepura Kotte
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-166"></a>Sudan,Khartoum
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-167"></a>Suriname,Paramaribo
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-168"></a>Sweden,Stockholm
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-169"></a>Switzerland,Bern
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-170"></a>Syria,Damascus
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-171"></a>Taiwan,Taipei
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-172"></a>Tajikistan,Dushanbe
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-173"></a>Tanzania,Dodoma
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-174"></a>Thailand,Bangkok
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-175"></a>Timor-Leste,Dili
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-176"></a>Togo,Lomé
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-177"></a>Tonga,Nuku&#39;alofa
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-178"></a>Trinidad and Tobago,Port of Spain
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-179"></a>Tunisia,Tunis
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-180"></a>Turkey,Ankara
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-181"></a>Turkmenistan,Ashgabat
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-182"></a>Tuvalu,Funafuti
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-183"></a>Uganda,Kampala
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-184"></a>Ukraine,Kyiv
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-185"></a>United Arab Emirates,Abu Dhabi
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-186"></a>United Kingdom,London
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-187"></a>United States,Washington D.C.
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-188"></a>Uruguay,Montevideo
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-189"></a>Uzbekistan,Tashkent
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-190"></a>Vanuatu,Port Vila
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-191"></a>Venezuela,Caracas
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-192"></a>Vietnam,Hanoi
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-193"></a>Yemen,Sana&#39;a
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-194"></a>Zambia,Lusaka
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-0-195"></a>Zimbabwe,Harare
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-1"></a>country,foundation_year
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-2"></a>Afghanistan,1919
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-3"></a>Albania,1912
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-4"></a>Algeria,1962
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-5"></a>Andorra,1278
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-6"></a>Angola,1975
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-7"></a>Antigua and Barbuda,1981
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-8"></a>Argentina,1816
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-9"></a>Armenia,1991
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-10"></a>Australia,1901
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-11"></a>Austria,1955
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-12"></a>Azerbaijan,1991
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-13"></a>Bahamas,1973
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-14"></a>Bahrain,1971
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-15"></a>Bangladesh,1971
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-16"></a>Barbados,1966
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-17"></a>Belarus,1991
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-18"></a>Belgium,1830
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-19"></a>Belize,1981
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-20"></a>Benin,1960
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-21"></a>Bhutan,1907
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-22"></a>Bolivia,1825
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-23"></a>Bosnia and Herzegovina,1992
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-24"></a>Botswana,1966
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-25"></a>Brazil,1822
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-26"></a>Brunei,1984
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-27"></a>Bulgaria,1908
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-28"></a>Burkina Faso,1960
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-29"></a>Burundi,1962
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-30"></a>Cabo Verde,1975
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-31"></a>Cambodia,1953
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-32"></a>Cameroon,1960
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-33"></a>Canada,1867
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-34"></a>Central African Republic,1960
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-35"></a>Chad,1960
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-36"></a>Chile,1818
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-37"></a>China,1949
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-38"></a>Colombia,1810
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-39"></a>Comoros,1975
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-40"></a>Congo,1960
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-41"></a>Costa Rica,1821
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-42"></a>Côte d&#39;Ivoire,1960
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-43"></a>Croatia,1991
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-44"></a>Cuba,1902
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-45"></a>Cyprus,1960
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-46"></a>Czechia,1993
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-47"></a>Denmark,1849
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-48"></a>Djibouti,1977
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-49"></a>Dominica,1978
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-50"></a>Dominican Republic,1844
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-51"></a>DRC,1960
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-52"></a>Ecuador,1830
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-53"></a>Egypt,1922
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-54"></a>El Salvador,1821
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-55"></a>Equatorial Guinea,1968
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-56"></a>Eritrea,1993
</span><span id="__span-1-57"><a id="__codelineno-1-57" name="__codelineno-1-57" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-57"></a>Estonia,1991
</span><span id="__span-1-58"><a id="__codelineno-1-58" name="__codelineno-1-58" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-58"></a>Eswatini,1968
</span><span id="__span-1-59"><a id="__codelineno-1-59" name="__codelineno-1-59" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-59"></a>Ethiopia,-100
</span><span id="__span-1-60"><a id="__codelineno-1-60" name="__codelineno-1-60" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-60"></a>Fiji,1970
</span><span id="__span-1-61"><a id="__codelineno-1-61" name="__codelineno-1-61" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-61"></a>Finland,1917
</span><span id="__span-1-62"><a id="__codelineno-1-62" name="__codelineno-1-62" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-62"></a>France,843
</span><span id="__span-1-63"><a id="__codelineno-1-63" name="__codelineno-1-63" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-63"></a>Gabon,1960
</span><span id="__span-1-64"><a id="__codelineno-1-64" name="__codelineno-1-64" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-64"></a>Gambia,1965
</span><span id="__span-1-65"><a id="__codelineno-1-65" name="__codelineno-1-65" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-65"></a>Georgia,1991
</span><span id="__span-1-66"><a id="__codelineno-1-66" name="__codelineno-1-66" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-66"></a>Germany,1871
</span><span id="__span-1-67"><a id="__codelineno-1-67" name="__codelineno-1-67" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-67"></a>Ghana,1957
</span><span id="__span-1-68"><a id="__codelineno-1-68" name="__codelineno-1-68" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-68"></a>Greece,1821
</span><span id="__span-1-69"><a id="__codelineno-1-69" name="__codelineno-1-69" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-69"></a>Grenada,1974
</span><span id="__span-1-70"><a id="__codelineno-1-70" name="__codelineno-1-70" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-70"></a>Guatemala,1821
</span><span id="__span-1-71"><a id="__codelineno-1-71" name="__codelineno-1-71" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-71"></a>Guinea,1958
</span><span id="__span-1-72"><a id="__codelineno-1-72" name="__codelineno-1-72" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-72"></a>Guinea-Bissau,1973
</span><span id="__span-1-73"><a id="__codelineno-1-73" name="__codelineno-1-73" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-73"></a>Guyana,1966
</span><span id="__span-1-74"><a id="__codelineno-1-74" name="__codelineno-1-74" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-74"></a>Haiti,1804
</span><span id="__span-1-75"><a id="__codelineno-1-75" name="__codelineno-1-75" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-75"></a>Honduras,1821
</span><span id="__span-1-76"><a id="__codelineno-1-76" name="__codelineno-1-76" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-76"></a>Hungary,1000
</span><span id="__span-1-77"><a id="__codelineno-1-77" name="__codelineno-1-77" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-77"></a>Iceland,1944
</span><span id="__span-1-78"><a id="__codelineno-1-78" name="__codelineno-1-78" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-78"></a>India,1947
</span><span id="__span-1-79"><a id="__codelineno-1-79" name="__codelineno-1-79" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-79"></a>Indonesia,1945
</span><span id="__span-1-80"><a id="__codelineno-1-80" name="__codelineno-1-80" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-80"></a>Iran,1501
</span><span id="__span-1-81"><a id="__codelineno-1-81" name="__codelineno-1-81" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-81"></a>Iraq,1932
</span><span id="__span-1-82"><a id="__codelineno-1-82" name="__codelineno-1-82" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-82"></a>Ireland,1921
</span><span id="__span-1-83"><a id="__codelineno-1-83" name="__codelineno-1-83" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-83"></a>Israel,1948
</span><span id="__span-1-84"><a id="__codelineno-1-84" name="__codelineno-1-84" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-84"></a>Italy,1861
</span><span id="__span-1-85"><a id="__codelineno-1-85" name="__codelineno-1-85" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-85"></a>Jamaica,1962
</span><span id="__span-1-86"><a id="__codelineno-1-86" name="__codelineno-1-86" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-86"></a>Japan,660
</span><span id="__span-1-87"><a id="__codelineno-1-87" name="__codelineno-1-87" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-87"></a>Jordan,1946
</span><span id="__span-1-88"><a id="__codelineno-1-88" name="__codelineno-1-88" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-88"></a>Kazakhstan,1991
</span><span id="__span-1-89"><a id="__codelineno-1-89" name="__codelineno-1-89" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-89"></a>Kenya,1963
</span><span id="__span-1-90"><a id="__codelineno-1-90" name="__codelineno-1-90" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-90"></a>Kiribati,1979
</span><span id="__span-1-91"><a id="__codelineno-1-91" name="__codelineno-1-91" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-91"></a>Kuwait,1961
</span><span id="__span-1-92"><a id="__codelineno-1-92" name="__codelineno-1-92" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-92"></a>Kyrgyzstan,1991
</span><span id="__span-1-93"><a id="__codelineno-1-93" name="__codelineno-1-93" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-93"></a>Laos,1953
</span><span id="__span-1-94"><a id="__codelineno-1-94" name="__codelineno-1-94" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-94"></a>Latvia,1991
</span><span id="__span-1-95"><a id="__codelineno-1-95" name="__codelineno-1-95" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-95"></a>Lebanon,1943
</span><span id="__span-1-96"><a id="__codelineno-1-96" name="__codelineno-1-96" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-96"></a>Lesotho,1966
</span><span id="__span-1-97"><a id="__codelineno-1-97" name="__codelineno-1-97" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-97"></a>Liberia,1847
</span><span id="__span-1-98"><a id="__codelineno-1-98" name="__codelineno-1-98" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-98"></a>Libya,1951
</span><span id="__span-1-99"><a id="__codelineno-1-99" name="__codelineno-1-99" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-99"></a>Liechtenstein,1719
</span><span id="__span-1-100"><a id="__codelineno-1-100" name="__codelineno-1-100" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-100"></a>Lithuania,1990
</span><span id="__span-1-101"><a id="__codelineno-1-101" name="__codelineno-1-101" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-101"></a>Luxembourg,1890
</span><span id="__span-1-102"><a id="__codelineno-1-102" name="__codelineno-1-102" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-102"></a>Madagascar,1960
</span><span id="__span-1-103"><a id="__codelineno-1-103" name="__codelineno-1-103" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-103"></a>Malawi,1964
</span><span id="__span-1-104"><a id="__codelineno-1-104" name="__codelineno-1-104" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-104"></a>Malaysia,1957
</span><span id="__span-1-105"><a id="__codelineno-1-105" name="__codelineno-1-105" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-105"></a>Maldives,1965
</span><span id="__span-1-106"><a id="__codelineno-1-106" name="__codelineno-1-106" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-106"></a>Mali,1960
</span><span id="__span-1-107"><a id="__codelineno-1-107" name="__codelineno-1-107" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-107"></a>Malta,1964
</span><span id="__span-1-108"><a id="__codelineno-1-108" name="__codelineno-1-108" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-108"></a>Marshall Islands,1986
</span><span id="__span-1-109"><a id="__codelineno-1-109" name="__codelineno-1-109" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-109"></a>Mauritania,1960
</span><span id="__span-1-110"><a id="__codelineno-1-110" name="__codelineno-1-110" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-110"></a>Mauritius,1968
</span><span id="__span-1-111"><a id="__codelineno-1-111" name="__codelineno-1-111" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-111"></a>Mexico,1821
</span><span id="__span-1-112"><a id="__codelineno-1-112" name="__codelineno-1-112" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-112"></a>Micronesia,1986
</span><span id="__span-1-113"><a id="__codelineno-1-113" name="__codelineno-1-113" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-113"></a>Moldova,1991
</span><span id="__span-1-114"><a id="__codelineno-1-114" name="__codelineno-1-114" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-114"></a>Monaco,1297
</span><span id="__span-1-115"><a id="__codelineno-1-115" name="__codelineno-1-115" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-115"></a>Mongolia,1921
</span><span id="__span-1-116"><a id="__codelineno-1-116" name="__codelineno-1-116" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-116"></a>Montenegro,2006
</span><span id="__span-1-117"><a id="__codelineno-1-117" name="__codelineno-1-117" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-117"></a>Morocco,1956
</span><span id="__span-1-118"><a id="__codelineno-1-118" name="__codelineno-1-118" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-118"></a>Mozambique,1975
</span><span id="__span-1-119"><a id="__codelineno-1-119" name="__codelineno-1-119" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-119"></a>Myanmar,1948
</span><span id="__span-1-120"><a id="__codelineno-1-120" name="__codelineno-1-120" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-120"></a>Namibia,1990
</span><span id="__span-1-121"><a id="__codelineno-1-121" name="__codelineno-1-121" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-121"></a>Nauru,1968
</span><span id="__span-1-122"><a id="__codelineno-1-122" name="__codelineno-1-122" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-122"></a>Nepal,1768
</span><span id="__span-1-123"><a id="__codelineno-1-123" name="__codelineno-1-123" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-123"></a>Netherlands,1581
</span><span id="__span-1-124"><a id="__codelineno-1-124" name="__codelineno-1-124" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-124"></a>New Zealand,1907
</span><span id="__span-1-125"><a id="__codelineno-1-125" name="__codelineno-1-125" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-125"></a>Nicaragua,1821
</span><span id="__span-1-126"><a id="__codelineno-1-126" name="__codelineno-1-126" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-126"></a>Niger,1960
</span><span id="__span-1-127"><a id="__codelineno-1-127" name="__codelineno-1-127" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-127"></a>Nigeria,1960
</span><span id="__span-1-128"><a id="__codelineno-1-128" name="__codelineno-1-128" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-128"></a>North Korea,1948
</span><span id="__span-1-129"><a id="__codelineno-1-129" name="__codelineno-1-129" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-129"></a>North Macedonia,1991
</span><span id="__span-1-130"><a id="__codelineno-1-130" name="__codelineno-1-130" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-130"></a>Norway,1905
</span><span id="__span-1-131"><a id="__codelineno-1-131" name="__codelineno-1-131" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-131"></a>Oman,1650
</span><span id="__span-1-132"><a id="__codelineno-1-132" name="__codelineno-1-132" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-132"></a>Pakistan,1947
</span><span id="__span-1-133"><a id="__codelineno-1-133" name="__codelineno-1-133" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-133"></a>Palau,1994
</span><span id="__span-1-134"><a id="__codelineno-1-134" name="__codelineno-1-134" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-134"></a>Panama,1903
</span><span id="__span-1-135"><a id="__codelineno-1-135" name="__codelineno-1-135" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-135"></a>Papua New Guinea,1975
</span><span id="__span-1-136"><a id="__codelineno-1-136" name="__codelineno-1-136" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-136"></a>Paraguay,1811
</span><span id="__span-1-137"><a id="__codelineno-1-137" name="__codelineno-1-137" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-137"></a>Peru,1821
</span><span id="__span-1-138"><a id="__codelineno-1-138" name="__codelineno-1-138" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-138"></a>Philippines,1898
</span><span id="__span-1-139"><a id="__codelineno-1-139" name="__codelineno-1-139" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-139"></a>Poland,1918
</span><span id="__span-1-140"><a id="__codelineno-1-140" name="__codelineno-1-140" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-140"></a>Portugal,1143
</span><span id="__span-1-141"><a id="__codelineno-1-141" name="__codelineno-1-141" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-141"></a>Qatar,1971
</span><span id="__span-1-142"><a id="__codelineno-1-142" name="__codelineno-1-142" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-142"></a>Romania,1859
</span><span id="__span-1-143"><a id="__codelineno-1-143" name="__codelineno-1-143" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-143"></a>Russia,1991
</span><span id="__span-1-144"><a id="__codelineno-1-144" name="__codelineno-1-144" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-144"></a>Rwanda,1962
</span><span id="__span-1-145"><a id="__codelineno-1-145" name="__codelineno-1-145" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-145"></a>Saint Kitts and Nevis,1983
</span><span id="__span-1-146"><a id="__codelineno-1-146" name="__codelineno-1-146" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-146"></a>Saint Lucia,1979
</span><span id="__span-1-147"><a id="__codelineno-1-147" name="__codelineno-1-147" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-147"></a>Saint Vincent and the Grenadines,1979
</span><span id="__span-1-148"><a id="__codelineno-1-148" name="__codelineno-1-148" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-148"></a>Samoa,1962
</span><span id="__span-1-149"><a id="__codelineno-1-149" name="__codelineno-1-149" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-149"></a>San Marino,301
</span><span id="__span-1-150"><a id="__codelineno-1-150" name="__codelineno-1-150" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-150"></a>São Tomé and Príncipe,1975
</span><span id="__span-1-151"><a id="__codelineno-1-151" name="__codelineno-1-151" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-151"></a>Saudi Arabia,1932
</span><span id="__span-1-152"><a id="__codelineno-1-152" name="__codelineno-1-152" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-152"></a>Senegal,1960
</span><span id="__span-1-153"><a id="__codelineno-1-153" name="__codelineno-1-153" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-153"></a>Serbia,2006
</span><span id="__span-1-154"><a id="__codelineno-1-154" name="__codelineno-1-154" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-154"></a>Seychelles,1976
</span><span id="__span-1-155"><a id="__codelineno-1-155" name="__codelineno-1-155" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-155"></a>Sierra Leone,1961
</span><span id="__span-1-156"><a id="__codelineno-1-156" name="__codelineno-1-156" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-156"></a>Singapore,1965
</span><span id="__span-1-157"><a id="__codelineno-1-157" name="__codelineno-1-157" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-157"></a>Slovakia,1993
</span><span id="__span-1-158"><a id="__codelineno-1-158" name="__codelineno-1-158" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-158"></a>Slovenia,1991
</span><span id="__span-1-159"><a id="__codelineno-1-159" name="__codelineno-1-159" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-159"></a>Solomon Islands,1978
</span><span id="__span-1-160"><a id="__codelineno-1-160" name="__codelineno-1-160" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-160"></a>Somalia,1960
</span><span id="__span-1-161"><a id="__codelineno-1-161" name="__codelineno-1-161" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-161"></a>South Africa,1910
</span><span id="__span-1-162"><a id="__codelineno-1-162" name="__codelineno-1-162" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-162"></a>South Korea,1948
</span><span id="__span-1-163"><a id="__codelineno-1-163" name="__codelineno-1-163" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-163"></a>South Sudan,2011
</span><span id="__span-1-164"><a id="__codelineno-1-164" name="__codelineno-1-164" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-164"></a>Spain,1469
</span><span id="__span-1-165"><a id="__codelineno-1-165" name="__codelineno-1-165" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-165"></a>Sri Lanka,1948
</span><span id="__span-1-166"><a id="__codelineno-1-166" name="__codelineno-1-166" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-166"></a>Sudan,1956
</span><span id="__span-1-167"><a id="__codelineno-1-167" name="__codelineno-1-167" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-167"></a>Suriname,1975
</span><span id="__span-1-168"><a id="__codelineno-1-168" name="__codelineno-1-168" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-168"></a>Sweden,1523
</span><span id="__span-1-169"><a id="__codelineno-1-169" name="__codelineno-1-169" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-169"></a>Switzerland,1291
</span><span id="__span-1-170"><a id="__codelineno-1-170" name="__codelineno-1-170" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-170"></a>Syria,1946
</span><span id="__span-1-171"><a id="__codelineno-1-171" name="__codelineno-1-171" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-171"></a>Taiwan,1949
</span><span id="__span-1-172"><a id="__codelineno-1-172" name="__codelineno-1-172" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-172"></a>Tajikistan,1991
</span><span id="__span-1-173"><a id="__codelineno-1-173" name="__codelineno-1-173" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-173"></a>Tanzania,1961
</span><span id="__span-1-174"><a id="__codelineno-1-174" name="__codelineno-1-174" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-174"></a>Thailand,1238
</span><span id="__span-1-175"><a id="__codelineno-1-175" name="__codelineno-1-175" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-175"></a>Timor-Leste,2002
</span><span id="__span-1-176"><a id="__codelineno-1-176" name="__codelineno-1-176" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-176"></a>Togo,1960
</span><span id="__span-1-177"><a id="__codelineno-1-177" name="__codelineno-1-177" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-177"></a>Tonga,1839
</span><span id="__span-1-178"><a id="__codelineno-1-178" name="__codelineno-1-178" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-178"></a>Trinidad and Tobago,1962
</span><span id="__span-1-179"><a id="__codelineno-1-179" name="__codelineno-1-179" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-179"></a>Tunisia,1956
</span><span id="__span-1-180"><a id="__codelineno-1-180" name="__codelineno-1-180" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-180"></a>Turkey,1923
</span><span id="__span-1-181"><a id="__codelineno-1-181" name="__codelineno-1-181" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-181"></a>Turkmenistan,1991
</span><span id="__span-1-182"><a id="__codelineno-1-182" name="__codelineno-1-182" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-182"></a>Tuvalu,1978
</span><span id="__span-1-183"><a id="__codelineno-1-183" name="__codelineno-1-183" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-183"></a>Uganda,1962
</span><span id="__span-1-184"><a id="__codelineno-1-184" name="__codelineno-1-184" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-184"></a>Ukraine,1991
</span><span id="__span-1-185"><a id="__codelineno-1-185" name="__codelineno-1-185" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-185"></a>United Arab Emirates,1971
</span><span id="__span-1-186"><a id="__codelineno-1-186" name="__codelineno-1-186" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-186"></a>United Kingdom,1066
</span><span id="__span-1-187"><a id="__codelineno-1-187" name="__codelineno-1-187" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-187"></a>United States,1776
</span><span id="__span-1-188"><a id="__codelineno-1-188" name="__codelineno-1-188" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-188"></a>Uruguay,1825
</span><span id="__span-1-189"><a id="__codelineno-1-189" name="__codelineno-1-189" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-189"></a>Uzbekistan,1991
</span><span id="__span-1-190"><a id="__codelineno-1-190" name="__codelineno-1-190" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-190"></a>Vanuatu,1980
</span><span id="__span-1-191"><a id="__codelineno-1-191" name="__codelineno-1-191" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-191"></a>Venezuela,1811
</span><span id="__span-1-192"><a id="__codelineno-1-192" name="__codelineno-1-192" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-192"></a>Vietnam,1945
</span><span id="__span-1-193"><a id="__codelineno-1-193" name="__codelineno-1-193" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-193"></a>Yemen,1990
</span><span id="__span-1-194"><a id="__codelineno-1-194" name="__codelineno-1-194" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-194"></a>Zambia,1964
</span><span id="__span-1-195"><a id="__codelineno-1-195" name="__codelineno-1-195" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-1-195"></a>Zimbabwe,1980
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-1"></a>country,height
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-2"></a>Afghanistan,1884
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-3"></a>Albania,708
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-4"></a>Algeria,800
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-5"></a>Andorra,1996
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-6"></a>Angola,1112
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-7"></a>Antigua and Barbuda,65
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-8"></a>Argentina,595
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-9"></a>Armenia,1792
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-10"></a>Australia,330
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-11"></a>Austria,910
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-12"></a>Azerbaijan,384
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-13"></a>Bahamas,13
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-14"></a>Bahrain,35
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-15"></a>Bangladesh,85
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-16"></a>Barbados,180
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-17"></a>Belarus,160
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-18"></a>Belgium,181
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-19"></a>Belize,173
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-20"></a>Benin,273
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-21"></a>Bhutan,3280
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-22"></a>Bolivia,1192
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-23"></a>Bosnia and Herzegovina,500
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-24"></a>Botswana,1013
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-25"></a>Brazil,320
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-26"></a>Brunei,478
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-27"></a>Bulgaria,472
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-28"></a>Burkina Faso,297
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-29"></a>Burundi,1504
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-30"></a>Cabo Verde,450
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-31"></a>Cambodia,126
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-32"></a>Cameroon,667
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-33"></a>Canada,487
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-34"></a>Central African Republic,635
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-35"></a>Chad,543
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-36"></a>Chile,1871
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-37"></a>China,1840
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-38"></a>Colombia,593
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-39"></a>Comoros,719
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-40"></a>Congo,430
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-41"></a>Costa Rica,746
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-42"></a>Côte d&#39;Ivoire,250
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-43"></a>Croatia,331
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-44"></a>Cuba,108
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-45"></a>Cyprus,91
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-46"></a>Czechia,433
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-47"></a>Denmark,34
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-48"></a>Djibouti,430
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-49"></a>Dominica,572
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-50"></a>Dominican Republic,424
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-51"></a>DRC,726
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-52"></a>Ecuador,1117
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-53"></a>Egypt,321
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-54"></a>El Salvador,442
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-55"></a>Equatorial Guinea,577
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-56"></a>Eritrea,853
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-57"></a>Estonia,61
</span><span id="__span-2-58"><a id="__codelineno-2-58" name="__codelineno-2-58" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-58"></a>Eswatini,305
</span><span id="__span-2-59"><a id="__codelineno-2-59" name="__codelineno-2-59" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-59"></a>Ethiopia,1330
</span><span id="__span-2-60"><a id="__codelineno-2-60" name="__codelineno-2-60" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-60"></a>Fiji,132
</span><span id="__span-2-61"><a id="__codelineno-2-61" name="__codelineno-2-61" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-61"></a>Finland,164
</span><span id="__span-2-62"><a id="__codelineno-2-62" name="__codelineno-2-62" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-62"></a>France,375
</span><span id="__span-2-63"><a id="__codelineno-2-63" name="__codelineno-2-63" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-63"></a>Gabon,377
</span><span id="__span-2-64"><a id="__codelineno-2-64" name="__codelineno-2-64" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-64"></a>Gambia,34
</span><span id="__span-2-65"><a id="__codelineno-2-65" name="__codelineno-2-65" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-65"></a>Georgia,1431
</span><span id="__span-2-66"><a id="__codelineno-2-66" name="__codelineno-2-66" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-66"></a>Germany,263
</span><span id="__span-2-67"><a id="__codelineno-2-67" name="__codelineno-2-67" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-67"></a>Ghana,190
</span><span id="__span-2-68"><a id="__codelineno-2-68" name="__codelineno-2-68" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-68"></a>Greece,498
</span><span id="__span-2-69"><a id="__codelineno-2-69" name="__codelineno-2-69" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-69"></a>Grenada,260
</span><span id="__span-2-70"><a id="__codelineno-2-70" name="__codelineno-2-70" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-70"></a>Guatemala,759
</span><span id="__span-2-71"><a id="__codelineno-2-71" name="__codelineno-2-71" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-71"></a>Guinea,472
</span><span id="__span-2-72"><a id="__codelineno-2-72" name="__codelineno-2-72" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-72"></a>Guinea-Bissau,70
</span><span id="__span-2-73"><a id="__codelineno-2-73" name="__codelineno-2-73" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-73"></a>Guyana,207
</span><span id="__span-2-74"><a id="__codelineno-2-74" name="__codelineno-2-74" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-74"></a>Haiti,470
</span><span id="__span-2-75"><a id="__codelineno-2-75" name="__codelineno-2-75" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-75"></a>Honduras,684
</span><span id="__span-2-76"><a id="__codelineno-2-76" name="__codelineno-2-76" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-76"></a>Hungary,143
</span><span id="__span-2-77"><a id="__codelineno-2-77" name="__codelineno-2-77" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-77"></a>Iceland,557
</span><span id="__span-2-78"><a id="__codelineno-2-78" name="__codelineno-2-78" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-78"></a>India,160
</span><span id="__span-2-79"><a id="__codelineno-2-79" name="__codelineno-2-79" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-79"></a>Indonesia,367
</span><span id="__span-2-80"><a id="__codelineno-2-80" name="__codelineno-2-80" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-80"></a>Iran,1308
</span><span id="__span-2-81"><a id="__codelineno-2-81" name="__codelineno-2-81" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-81"></a>Iraq,312
</span><span id="__span-2-82"><a id="__codelineno-2-82" name="__codelineno-2-82" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-82"></a>Ireland,118
</span><span id="__span-2-83"><a id="__codelineno-2-83" name="__codelineno-2-83" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-83"></a>Israel,508
</span><span id="__span-2-84"><a id="__codelineno-2-84" name="__codelineno-2-84" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-84"></a>Italy,538
</span><span id="__span-2-85"><a id="__codelineno-2-85" name="__codelineno-2-85" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-85"></a>Jamaica,253
</span><span id="__span-2-86"><a id="__codelineno-2-86" name="__codelineno-2-86" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-86"></a>Japan,438
</span><span id="__span-2-87"><a id="__codelineno-2-87" name="__codelineno-2-87" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-87"></a>Jordan,812
</span><span id="__span-2-88"><a id="__codelineno-2-88" name="__codelineno-2-88" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-88"></a>Kazakhstan,387
</span><span id="__span-2-89"><a id="__codelineno-2-89" name="__codelineno-2-89" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-89"></a>Kenya,762
</span><span id="__span-2-90"><a id="__codelineno-2-90" name="__codelineno-2-90" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-90"></a>Kiribati,2
</span><span id="__span-2-91"><a id="__codelineno-2-91" name="__codelineno-2-91" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-91"></a>Kuwait,108
</span><span id="__span-2-92"><a id="__codelineno-2-92" name="__codelineno-2-92" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-92"></a>Kyrgyzstan,2988
</span><span id="__span-2-93"><a id="__codelineno-2-93" name="__codelineno-2-93" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-93"></a>Laos,710
</span><span id="__span-2-94"><a id="__codelineno-2-94" name="__codelineno-2-94" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-94"></a>Latvia,87
</span><span id="__span-2-95"><a id="__codelineno-2-95" name="__codelineno-2-95" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-95"></a>Lebanon,1250
</span><span id="__span-2-96"><a id="__codelineno-2-96" name="__codelineno-2-96" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-96"></a>Lesotho,2161
</span><span id="__span-2-97"><a id="__codelineno-2-97" name="__codelineno-2-97" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-97"></a>Liberia,243
</span><span id="__span-2-98"><a id="__codelineno-2-98" name="__codelineno-2-98" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-98"></a>Libya,423
</span><span id="__span-2-99"><a id="__codelineno-2-99" name="__codelineno-2-99" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-99"></a>Liechtenstein,1706
</span><span id="__span-2-100"><a id="__codelineno-2-100" name="__codelineno-2-100" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-100"></a>Lithuania,110
</span><span id="__span-2-101"><a id="__codelineno-2-101" name="__codelineno-2-101" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-101"></a>Luxembourg,325
</span><span id="__span-2-102"><a id="__codelineno-2-102" name="__codelineno-2-102" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-102"></a>Madagascar,615
</span><span id="__span-2-103"><a id="__codelineno-2-103" name="__codelineno-2-103" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-103"></a>Malawi,779
</span><span id="__span-2-104"><a id="__codelineno-2-104" name="__codelineno-2-104" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-104"></a>Malaysia,538
</span><span id="__span-2-105"><a id="__codelineno-2-105" name="__codelineno-2-105" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-105"></a>Maldives,2
</span><span id="__span-2-106"><a id="__codelineno-2-106" name="__codelineno-2-106" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-106"></a>Mali,343
</span><span id="__span-2-107"><a id="__codelineno-2-107" name="__codelineno-2-107" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-107"></a>Malta,91
</span><span id="__span-2-108"><a id="__codelineno-2-108" name="__codelineno-2-108" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-108"></a>Marshall Islands,2
</span><span id="__span-2-109"><a id="__codelineno-2-109" name="__codelineno-2-109" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-109"></a>Mauritania,276
</span><span id="__span-2-110"><a id="__codelineno-2-110" name="__codelineno-2-110" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-110"></a>Mauritius,370
</span><span id="__span-2-111"><a id="__codelineno-2-111" name="__codelineno-2-111" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-111"></a>Mexico,1111
</span><span id="__span-2-112"><a id="__codelineno-2-112" name="__codelineno-2-112" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-112"></a>Micronesia,107
</span><span id="__span-2-113"><a id="__codelineno-2-113" name="__codelineno-2-113" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-113"></a>Moldova,147
</span><span id="__span-2-114"><a id="__codelineno-2-114" name="__codelineno-2-114" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-114"></a>Monaco,63
</span><span id="__span-2-115"><a id="__codelineno-2-115" name="__codelineno-2-115" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-115"></a>Mongolia,1528
</span><span id="__span-2-116"><a id="__codelineno-2-116" name="__codelineno-2-116" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-116"></a>Montenegro,1086
</span><span id="__span-2-117"><a id="__codelineno-2-117" name="__codelineno-2-117" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-117"></a>Morocco,909
</span><span id="__span-2-118"><a id="__codelineno-2-118" name="__codelineno-2-118" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-118"></a>Mozambique,345
</span><span id="__span-2-119"><a id="__codelineno-2-119" name="__codelineno-2-119" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-119"></a>Myanmar,702
</span><span id="__span-2-120"><a id="__codelineno-2-120" name="__codelineno-2-120" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-120"></a>Namibia,1141
</span><span id="__span-2-121"><a id="__codelineno-2-121" name="__codelineno-2-121" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-121"></a>Nauru,21
</span><span id="__span-2-122"><a id="__codelineno-2-122" name="__codelineno-2-122" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-122"></a>Nepal,3265
</span><span id="__span-2-123"><a id="__codelineno-2-123" name="__codelineno-2-123" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-123"></a>Netherlands,30
</span><span id="__span-2-124"><a id="__codelineno-2-124" name="__codelineno-2-124" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-124"></a>New Zealand,388
</span><span id="__span-2-125"><a id="__codelineno-2-125" name="__codelineno-2-125" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-125"></a>Nicaragua,298
</span><span id="__span-2-126"><a id="__codelineno-2-126" name="__codelineno-2-126" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-126"></a>Niger,474
</span><span id="__span-2-127"><a id="__codelineno-2-127" name="__codelineno-2-127" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-127"></a>Nigeria,380
</span><span id="__span-2-128"><a id="__codelineno-2-128" name="__codelineno-2-128" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-128"></a>North Korea,440
</span><span id="__span-2-129"><a id="__codelineno-2-129" name="__codelineno-2-129" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-129"></a>North Macedonia,741
</span><span id="__span-2-130"><a id="__codelineno-2-130" name="__codelineno-2-130" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-130"></a>Norway,460
</span><span id="__span-2-131"><a id="__codelineno-2-131" name="__codelineno-2-131" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-131"></a>Oman,310
</span><span id="__span-2-132"><a id="__codelineno-2-132" name="__codelineno-2-132" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-132"></a>Pakistan,900
</span><span id="__span-2-133"><a id="__codelineno-2-133" name="__codelineno-2-133" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-133"></a>Palau,63
</span><span id="__span-2-134"><a id="__codelineno-2-134" name="__codelineno-2-134" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-134"></a>Panama,360
</span><span id="__span-2-135"><a id="__codelineno-2-135" name="__codelineno-2-135" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-135"></a>Papua New Guinea,667
</span><span id="__span-2-136"><a id="__codelineno-2-136" name="__codelineno-2-136" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-136"></a>Paraguay,178
</span><span id="__span-2-137"><a id="__codelineno-2-137" name="__codelineno-2-137" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-137"></a>Peru,1555
</span><span id="__span-2-138"><a id="__codelineno-2-138" name="__codelineno-2-138" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-138"></a>Philippines,442
</span><span id="__span-2-139"><a id="__codelineno-2-139" name="__codelineno-2-139" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-139"></a>Poland,173
</span><span id="__span-2-140"><a id="__codelineno-2-140" name="__codelineno-2-140" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-140"></a>Portugal,372
</span><span id="__span-2-141"><a id="__codelineno-2-141" name="__codelineno-2-141" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-141"></a>Qatar,28
</span><span id="__span-2-142"><a id="__codelineno-2-142" name="__codelineno-2-142" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-142"></a>Romania,414
</span><span id="__span-2-143"><a id="__codelineno-2-143" name="__codelineno-2-143" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-143"></a>Russia,600
</span><span id="__span-2-144"><a id="__codelineno-2-144" name="__codelineno-2-144" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-144"></a>Rwanda,1598
</span><span id="__span-2-145"><a id="__codelineno-2-145" name="__codelineno-2-145" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-145"></a>Saint Kitts and Nevis,261
</span><span id="__span-2-146"><a id="__codelineno-2-146" name="__codelineno-2-146" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-146"></a>Saint Lucia,301
</span><span id="__span-2-147"><a id="__codelineno-2-147" name="__codelineno-2-147" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-147"></a>Saint Vincent and the Grenadines,390
</span><span id="__span-2-148"><a id="__codelineno-2-148" name="__codelineno-2-148" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-148"></a>Samoa,109
</span><span id="__span-2-149"><a id="__codelineno-2-149" name="__codelineno-2-149" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-149"></a>San Marino,749
</span><span id="__span-2-150"><a id="__codelineno-2-150" name="__codelineno-2-150" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-150"></a>São Tomé and Príncipe,204
</span><span id="__span-2-151"><a id="__codelineno-2-151" name="__codelineno-2-151" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-151"></a>Saudi Arabia,665
</span><span id="__span-2-152"><a id="__codelineno-2-152" name="__codelineno-2-152" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-152"></a>Senegal,69
</span><span id="__span-2-153"><a id="__codelineno-2-153" name="__codelineno-2-153" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-153"></a>Serbia,442
</span><span id="__span-2-154"><a id="__codelineno-2-154" name="__codelineno-2-154" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-154"></a>Seychelles,284
</span><span id="__span-2-155"><a id="__codelineno-2-155" name="__codelineno-2-155" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-155"></a>Sierra Leone,279
</span><span id="__span-2-156"><a id="__codelineno-2-156" name="__codelineno-2-156" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-156"></a>Singapore,15
</span><span id="__span-2-157"><a id="__codelineno-2-157" name="__codelineno-2-157" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-157"></a>Slovakia,458
</span><span id="__span-2-158"><a id="__codelineno-2-158" name="__codelineno-2-158" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-158"></a>Slovenia,492
</span><span id="__span-2-159"><a id="__codelineno-2-159" name="__codelineno-2-159" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-159"></a>Solomon Islands,458
</span><span id="__span-2-160"><a id="__codelineno-2-160" name="__codelineno-2-160" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-160"></a>Somalia,410
</span><span id="__span-2-161"><a id="__codelineno-2-161" name="__codelineno-2-161" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-161"></a>South Africa,1033
</span><span id="__span-2-162"><a id="__codelineno-2-162" name="__codelineno-2-162" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-162"></a>South Korea,282
</span><span id="__span-2-163"><a id="__codelineno-2-163" name="__codelineno-2-163" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-163"></a>South Sudan,422
</span><span id="__span-2-164"><a id="__codelineno-2-164" name="__codelineno-2-164" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-164"></a>Spain,660
</span><span id="__span-2-165"><a id="__codelineno-2-165" name="__codelineno-2-165" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-165"></a>Sri Lanka,228
</span><span id="__span-2-166"><a id="__codelineno-2-166" name="__codelineno-2-166" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-166"></a>Sudan,568
</span><span id="__span-2-167"><a id="__codelineno-2-167" name="__codelineno-2-167" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-167"></a>Suriname,246
</span><span id="__span-2-168"><a id="__codelineno-2-168" name="__codelineno-2-168" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-168"></a>Sweden,320
</span><span id="__span-2-169"><a id="__codelineno-2-169" name="__codelineno-2-169" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-169"></a>Switzerland,1350
</span><span id="__span-2-170"><a id="__codelineno-2-170" name="__codelineno-2-170" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-170"></a>Syria,514
</span><span id="__span-2-171"><a id="__codelineno-2-171" name="__codelineno-2-171" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-171"></a>Taiwan,1121
</span><span id="__span-2-172"><a id="__codelineno-2-172" name="__codelineno-2-172" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-172"></a>Tajikistan,3186
</span><span id="__span-2-173"><a id="__codelineno-2-173" name="__codelineno-2-173" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-173"></a>Tanzania,1018
</span><span id="__span-2-174"><a id="__codelineno-2-174" name="__codelineno-2-174" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-174"></a>Thailand,287
</span><span id="__span-2-175"><a id="__codelineno-2-175" name="__codelineno-2-175" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-175"></a>Timor-Leste,552
</span><span id="__span-2-176"><a id="__codelineno-2-176" name="__codelineno-2-176" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-176"></a>Togo,236
</span><span id="__span-2-177"><a id="__codelineno-2-177" name="__codelineno-2-177" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-177"></a>Tonga,72
</span><span id="__span-2-178"><a id="__codelineno-2-178" name="__codelineno-2-178" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-178"></a>Trinidad and Tobago,83
</span><span id="__span-2-179"><a id="__codelineno-2-179" name="__codelineno-2-179" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-179"></a>Tunisia,246
</span><span id="__span-2-180"><a id="__codelineno-2-180" name="__codelineno-2-180" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-180"></a>Turkey,1132
</span><span id="__span-2-181"><a id="__codelineno-2-181" name="__codelineno-2-181" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-181"></a>Turkmenistan,230
</span><span id="__span-2-182"><a id="__codelineno-2-182" name="__codelineno-2-182" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-182"></a>Tuvalu,2
</span><span id="__span-2-183"><a id="__codelineno-2-183" name="__codelineno-2-183" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-183"></a>Uganda,1100
</span><span id="__span-2-184"><a id="__codelineno-2-184" name="__codelineno-2-184" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-184"></a>Ukraine,175
</span><span id="__span-2-185"><a id="__codelineno-2-185" name="__codelineno-2-185" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-185"></a>United Arab Emirates,149
</span><span id="__span-2-186"><a id="__codelineno-2-186" name="__codelineno-2-186" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-186"></a>United Kingdom,162
</span><span id="__span-2-187"><a id="__codelineno-2-187" name="__codelineno-2-187" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-187"></a>United States,760
</span><span id="__span-2-188"><a id="__codelineno-2-188" name="__codelineno-2-188" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-188"></a>Uruguay,109
</span><span id="__span-2-189"><a id="__codelineno-2-189" name="__codelineno-2-189" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-189"></a>Uzbekistan,450
</span><span id="__span-2-190"><a id="__codelineno-2-190" name="__codelineno-2-190" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-190"></a>Vanuatu,646
</span><span id="__span-2-191"><a id="__codelineno-2-191" name="__codelineno-2-191" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-191"></a>Venezuela,450
</span><span id="__span-2-192"><a id="__codelineno-2-192" name="__codelineno-2-192" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-192"></a>Vietnam,398
</span><span id="__span-2-193"><a id="__codelineno-2-193" name="__codelineno-2-193" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-193"></a>Yemen,999
</span><span id="__span-2-194"><a id="__codelineno-2-194" name="__codelineno-2-194" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-194"></a>Zambia,1138
</span><span id="__span-2-195"><a id="__codelineno-2-195" name="__codelineno-2-195" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-2-195"></a>Zimbabwe,961
</span></code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_2_1" name="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="resources-lab07-mcp-ollama-step00-getting-started-__tabbed_2_1">population.csv</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-1"></a>country,population
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-2"></a>Afghanistan,40000000
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-3"></a>Albania,2800000
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-4"></a>Algeria,45000000
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-5"></a>Andorra,80000
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-6"></a>Angola,35000000
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-7"></a>Antigua and Barbuda,100000
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-8"></a>Argentina,46000000
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-9"></a>Armenia,3000000
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-10"></a>Australia,26000000
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-11"></a>Austria,9000000
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-12"></a>Azerbaijan,10000000
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-13"></a>Bahamas,400000
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-14"></a>Bahrain,1800000
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-15"></a>Bangladesh,170000000
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-16"></a>Barbados,300000
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-17"></a>Belarus,9200000
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-18"></a>Belgium,11600000
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-19"></a>Belize,400000
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-20"></a>Benin,13000000
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-21"></a>Bhutan,800000
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-22"></a>Bolivia,12000000
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-23"></a>Bosnia and Herzegovina,3200000
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-24"></a>Botswana,2400000
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-25"></a>Brazil,216000000
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-26"></a>Brunei,450000
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-27"></a>Bulgaria,6400000
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-28"></a>Burkina Faso,23000000
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-29"></a>Burundi,13000000
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-30"></a>Cabo Verde,600000
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-31"></a>Cambodia,17000000
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-32"></a>Cameroon,28000000
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-33"></a>Canada,39000000
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-34"></a>Central African Republic,5000000
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-35"></a>Chad,18000000
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-36"></a>Chile,20000000
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-37"></a>China,1412000000
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-38"></a>Colombia,52000000
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-39"></a>Comoros,900000
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-40"></a>Congo,6000000
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-41"></a>Costa Rica,5200000
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-42"></a>Côte d&#39;Ivoire,29000000
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-43"></a>Croatia,3800000
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-44"></a>Cuba,11100000
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-45"></a>Cyprus,1300000
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-46"></a>Czechia,10700000
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-47"></a>Denmark,5900000
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-48"></a>Djibouti,1100000
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-49"></a>Dominica,72000
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-50"></a>Dominican Republic,11000000
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-51"></a>DRC,100000000
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-52"></a>Ecuador,18000000
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-53"></a>Egypt,110000000
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-54"></a>El Salvador,6500000
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-55"></a>Equatorial Guinea,1700000
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-56"></a>Eritrea,3700000
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-57"></a>Estonia,1300000
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-58"></a>Eswatini,1200000
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-59"></a>Ethiopia,125000000
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-60"></a>Fiji,900000
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-61"></a>Finland,5600000
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-62"></a>France,68000000
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-63"></a>Gabon,2400000
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-64"></a>Gambia,2700000
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-65"></a>Georgia,3700000
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-66"></a>Germany,83000000
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-67"></a>Ghana,34000000
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-68"></a>Greece,10200000
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-69"></a>Grenada,120000
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-70"></a>Guatemala,19000000
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-71"></a>Guinea,14000000
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-72"></a>Guinea-Bissau,2100000
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-73"></a>Guyana,800000
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-74"></a>Haiti,11700000
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-75"></a>Honduras,11000000
</span><span id="__span-3-76"><a id="__codelineno-3-76" name="__codelineno-3-76" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-76"></a>Hungary,9600000
</span><span id="__span-3-77"><a id="__codelineno-3-77" name="__codelineno-3-77" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-77"></a>Iceland,380000
</span><span id="__span-3-78"><a id="__codelineno-3-78" name="__codelineno-3-78" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-78"></a>India,1418000000
</span><span id="__span-3-79"><a id="__codelineno-3-79" name="__codelineno-3-79" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-79"></a>Indonesia,280000000
</span><span id="__span-3-80"><a id="__codelineno-3-80" name="__codelineno-3-80" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-80"></a>Iran,89000000
</span><span id="__span-3-81"><a id="__codelineno-3-81" name="__codelineno-3-81" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-81"></a>Iraq,44000000
</span><span id="__span-3-82"><a id="__codelineno-3-82" name="__codelineno-3-82" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-82"></a>Ireland,5200000
</span><span id="__span-3-83"><a id="__codelineno-3-83" name="__codelineno-3-83" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-83"></a>Israel,9700000
</span><span id="__span-3-84"><a id="__codelineno-3-84" name="__codelineno-3-84" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-84"></a>Italy,59000000
</span><span id="__span-3-85"><a id="__codelineno-3-85" name="__codelineno-3-85" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-85"></a>Jamaica,3000000
</span><span id="__span-3-86"><a id="__codelineno-3-86" name="__codelineno-3-86" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-86"></a>Japan,124000000
</span><span id="__span-3-87"><a id="__codelineno-3-87" name="__codelineno-3-87" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-87"></a>Jordan,11000000
</span><span id="__span-3-88"><a id="__codelineno-3-88" name="__codelineno-3-88" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-88"></a>Kazakhstan,20000000
</span><span id="__span-3-89"><a id="__codelineno-3-89" name="__codelineno-3-89" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-89"></a>Kenya,57000000
</span><span id="__span-3-90"><a id="__codelineno-3-90" name="__codelineno-3-90" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-90"></a>Kiribati,130000
</span><span id="__span-3-91"><a id="__codelineno-3-91" name="__codelineno-3-91" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-91"></a>Kuwait,4300000
</span><span id="__span-3-92"><a id="__codelineno-3-92" name="__codelineno-3-92" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-92"></a>Kyrgyzstan,6800000
</span><span id="__span-3-93"><a id="__codelineno-3-93" name="__codelineno-3-93" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-93"></a>Laos,7500000
</span><span id="__span-3-94"><a id="__codelineno-3-94" name="__codelineno-3-94" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-94"></a>Latvia,1800000
</span><span id="__span-3-95"><a id="__codelineno-3-95" name="__codelineno-3-95" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-95"></a>Lebanon,5500000
</span><span id="__span-3-96"><a id="__codelineno-3-96" name="__codelineno-3-96" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-96"></a>Lesotho,2300000
</span><span id="__span-3-97"><a id="__codelineno-3-97" name="__codelineno-3-97" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-97"></a>Liberia,5300000
</span><span id="__span-3-98"><a id="__codelineno-3-98" name="__codelineno-3-98" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-98"></a>Libya,7200000
</span><span id="__span-3-99"><a id="__codelineno-3-99" name="__codelineno-3-99" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-99"></a>Liechtenstein,39000
</span><span id="__span-3-100"><a id="__codelineno-3-100" name="__codelineno-3-100" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-100"></a>Lithuania,2700000
</span><span id="__span-3-101"><a id="__codelineno-3-101" name="__codelineno-3-101" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-101"></a>Luxembourg,660000
</span><span id="__span-3-102"><a id="__codelineno-3-102" name="__codelineno-3-102" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-102"></a>Madagascar,30000000
</span><span id="__span-3-103"><a id="__codelineno-3-103" name="__codelineno-3-103" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-103"></a>Malawi,21000000
</span><span id="__span-3-104"><a id="__codelineno-3-104" name="__codelineno-3-104" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-104"></a>Malaysia,34000000
</span><span id="__span-3-105"><a id="__codelineno-3-105" name="__codelineno-3-105" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-105"></a>Maldives,600000
</span><span id="__span-3-106"><a id="__codelineno-3-106" name="__codelineno-3-106" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-106"></a>Mali,23000000
</span><span id="__span-3-107"><a id="__codelineno-3-107" name="__codelineno-3-107" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-107"></a>Malta,570000
</span><span id="__span-3-108"><a id="__codelineno-3-108" name="__codelineno-3-108" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-108"></a>Marshall Islands,42000
</span><span id="__span-3-109"><a id="__codelineno-3-109" name="__codelineno-3-109" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-109"></a>Mauritania,4900000
</span><span id="__span-3-110"><a id="__codelineno-3-110" name="__codelineno-3-110" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-110"></a>Mauritius,1300000
</span><span id="__span-3-111"><a id="__codelineno-3-111" name="__codelineno-3-111" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-111"></a>Mexico,128000000
</span><span id="__span-3-112"><a id="__codelineno-3-112" name="__codelineno-3-112" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-112"></a>Micronesia,110000
</span><span id="__span-3-113"><a id="__codelineno-3-113" name="__codelineno-3-113" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-113"></a>Moldova,2500000
</span><span id="__span-3-114"><a id="__codelineno-3-114" name="__codelineno-3-114" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-114"></a>Monaco,40000
</span><span id="__span-3-115"><a id="__codelineno-3-115" name="__codelineno-3-115" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-115"></a>Mongolia,3400000
</span><span id="__span-3-116"><a id="__codelineno-3-116" name="__codelineno-3-116" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-116"></a>Montenegro,620000
</span><span id="__span-3-117"><a id="__codelineno-3-117" name="__codelineno-3-117" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-117"></a>Morocco,38000000
</span><span id="__span-3-118"><a id="__codelineno-3-118" name="__codelineno-3-118" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-118"></a>Mozambique,33000000
</span><span id="__span-3-119"><a id="__codelineno-3-119" name="__codelineno-3-119" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-119"></a>Myanmar,55000000
</span><span id="__span-3-120"><a id="__codelineno-3-120" name="__codelineno-3-120" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-120"></a>Namibia,2600000
</span><span id="__span-3-121"><a id="__codelineno-3-121" name="__codelineno-3-121" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-121"></a>Nauru,11000
</span><span id="__span-3-122"><a id="__codelineno-3-122" name="__codelineno-3-122" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-122"></a>Nepal,31000000
</span><span id="__span-3-123"><a id="__codelineno-3-123" name="__codelineno-3-123" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-123"></a>Netherlands,17800000
</span><span id="__span-3-124"><a id="__codelineno-3-124" name="__codelineno-3-124" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-124"></a>New Zealand,5200000
</span><span id="__span-3-125"><a id="__codelineno-3-125" name="__codelineno-3-125" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-125"></a>Nicaragua,6900000
</span><span id="__span-3-126"><a id="__codelineno-3-126" name="__codelineno-3-126" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-126"></a>Niger,27000000
</span><span id="__span-3-127"><a id="__codelineno-3-127" name="__codelineno-3-127" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-127"></a>Nigeria,230000000
</span><span id="__span-3-128"><a id="__codelineno-3-128" name="__codelineno-3-128" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-128"></a>North Korea,26000000
</span><span id="__span-3-129"><a id="__codelineno-3-129" name="__codelineno-3-129" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-129"></a>North Macedonia,1800000
</span><span id="__span-3-130"><a id="__codelineno-3-130" name="__codelineno-3-130" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-130"></a>Norway,5500000
</span><span id="__span-3-131"><a id="__codelineno-3-131" name="__codelineno-3-131" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-131"></a>Oman,5500000
</span><span id="__span-3-132"><a id="__codelineno-3-132" name="__codelineno-3-132" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-132"></a>Pakistan,240000000
</span><span id="__span-3-133"><a id="__codelineno-3-133" name="__codelineno-3-133" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-133"></a>Palau,18000
</span><span id="__span-3-134"><a id="__codelineno-3-134" name="__codelineno-3-134" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-134"></a>Panama,4500000
</span><span id="__span-3-135"><a id="__codelineno-3-135" name="__codelineno-3-135" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-135"></a>Papua New Guinea,10000000
</span><span id="__span-3-136"><a id="__codelineno-3-136" name="__codelineno-3-136" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-136"></a>Paraguay,7200000
</span><span id="__span-3-137"><a id="__codelineno-3-137" name="__codelineno-3-137" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-137"></a>Peru,34000000
</span><span id="__span-3-138"><a id="__codelineno-3-138" name="__codelineno-3-138" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-138"></a>Philippines,117000000
</span><span id="__span-3-139"><a id="__codelineno-3-139" name="__codelineno-3-139" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-139"></a>Poland,38000000
</span><span id="__span-3-140"><a id="__codelineno-3-140" name="__codelineno-3-140" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-140"></a>Portugal,10200000
</span><span id="__span-3-141"><a id="__codelineno-3-141" name="__codelineno-3-141" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-141"></a>Qatar,2900000
</span><span id="__span-3-142"><a id="__codelineno-3-142" name="__codelineno-3-142" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-142"></a>Romania,19000000
</span><span id="__span-3-143"><a id="__codelineno-3-143" name="__codelineno-3-143" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-143"></a>Russia,144000000
</span><span id="__span-3-144"><a id="__codelineno-3-144" name="__codelineno-3-144" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-144"></a>Rwanda,14000000
</span><span id="__span-3-145"><a id="__codelineno-3-145" name="__codelineno-3-145" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-145"></a>Saint Kitts and Nevis,54000
</span><span id="__span-3-146"><a id="__codelineno-3-146" name="__codelineno-3-146" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-146"></a>Saint Lucia,180000
</span><span id="__span-3-147"><a id="__codelineno-3-147" name="__codelineno-3-147" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-147"></a>Saint Vincent and the Grenadines,110000
</span><span id="__span-3-148"><a id="__codelineno-3-148" name="__codelineno-3-148" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-148"></a>Samoa,225000
</span><span id="__span-3-149"><a id="__codelineno-3-149" name="__codelineno-3-149" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-149"></a>San Marino,34000
</span><span id="__span-3-150"><a id="__codelineno-3-150" name="__codelineno-3-150" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-150"></a>São Tomé and Príncipe,230000
</span><span id="__span-3-151"><a id="__codelineno-3-151" name="__codelineno-3-151" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-151"></a>Saudi Arabia,37000000
</span><span id="__span-3-152"><a id="__codelineno-3-152" name="__codelineno-3-152" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-152"></a>Senegal,18000000
</span><span id="__span-3-153"><a id="__codelineno-3-153" name="__codelineno-3-153" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-153"></a>Serbia,6600000
</span><span id="__span-3-154"><a id="__codelineno-3-154" name="__codelineno-3-154" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-154"></a>Seychelles,100000
</span><span id="__span-3-155"><a id="__codelineno-3-155" name="__codelineno-3-155" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-155"></a>Sierra Leone,8600000
</span><span id="__span-3-156"><a id="__codelineno-3-156" name="__codelineno-3-156" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-156"></a>Singapore,6000000
</span><span id="__span-3-157"><a id="__codelineno-3-157" name="__codelineno-3-157" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-157"></a>Slovakia,5500000
</span><span id="__span-3-158"><a id="__codelineno-3-158" name="__codelineno-3-158" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-158"></a>Slovenia,2100000
</span><span id="__span-3-159"><a id="__codelineno-3-159" name="__codelineno-3-159" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-159"></a>Solomon Islands,720000
</span><span id="__span-3-160"><a id="__codelineno-3-160" name="__codelineno-3-160" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-160"></a>Somalia,18000000
</span><span id="__span-3-161"><a id="__codelineno-3-161" name="__codelineno-3-161" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-161"></a>South Africa,62000000
</span><span id="__span-3-162"><a id="__codelineno-3-162" name="__codelineno-3-162" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-162"></a>South Korea,52000000
</span><span id="__span-3-163"><a id="__codelineno-3-163" name="__codelineno-3-163" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-163"></a>South Sudan,13000000
</span><span id="__span-3-164"><a id="__codelineno-3-164" name="__codelineno-3-164" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-164"></a>Spain,48000000
</span><span id="__span-3-165"><a id="__codelineno-3-165" name="__codelineno-3-165" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-165"></a>Sri Lanka,22000000
</span><span id="__span-3-166"><a id="__codelineno-3-166" name="__codelineno-3-166" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-166"></a>Sudan,48000000
</span><span id="__span-3-167"><a id="__codelineno-3-167" name="__codelineno-3-167" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-167"></a>Suriname,620000
</span><span id="__span-3-168"><a id="__codelineno-3-168" name="__codelineno-3-168" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-168"></a>Sweden,10500000
</span><span id="__span-3-169"><a id="__codelineno-3-169" name="__codelineno-3-169" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-169"></a>Switzerland,8800000
</span><span id="__span-3-170"><a id="__codelineno-3-170" name="__codelineno-3-170" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-170"></a>Syria,23000000
</span><span id="__span-3-171"><a id="__codelineno-3-171" name="__codelineno-3-171" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-171"></a>Taiwan,23600000
</span><span id="__span-3-172"><a id="__codelineno-3-172" name="__codelineno-3-172" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-172"></a>Tajikistan,10000000
</span><span id="__span-3-173"><a id="__codelineno-3-173" name="__codelineno-3-173" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-173"></a>Tanzania,65000000
</span><span id="__span-3-174"><a id="__codelineno-3-174" name="__codelineno-3-174" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-174"></a>Thailand,72000000
</span><span id="__span-3-175"><a id="__codelineno-3-175" name="__codelineno-3-175" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-175"></a>Timor-Leste,1400000
</span><span id="__span-3-176"><a id="__codelineno-3-176" name="__codelineno-3-176" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-176"></a>Togo,9000000
</span><span id="__span-3-177"><a id="__codelineno-3-177" name="__codelineno-3-177" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-177"></a>Tonga,110000
</span><span id="__span-3-178"><a id="__codelineno-3-178" name="__codelineno-3-178" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-178"></a>Trinidad and Tobago,1400000
</span><span id="__span-3-179"><a id="__codelineno-3-179" name="__codelineno-3-179" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-179"></a>Tunisia,12400000
</span><span id="__span-3-180"><a id="__codelineno-3-180" name="__codelineno-3-180" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-180"></a>Turkey,86000000
</span><span id="__span-3-181"><a id="__codelineno-3-181" name="__codelineno-3-181" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-181"></a>Turkmenistan,6500000
</span><span id="__span-3-182"><a id="__codelineno-3-182" name="__codelineno-3-182" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-182"></a>Tuvalu,12000
</span><span id="__span-3-183"><a id="__codelineno-3-183" name="__codelineno-3-183" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-183"></a>Uganda,49000000
</span><span id="__span-3-184"><a id="__codelineno-3-184" name="__codelineno-3-184" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-184"></a>Ukraine,36000000
</span><span id="__span-3-185"><a id="__codelineno-3-185" name="__codelineno-3-185" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-185"></a>United Arab Emirates,10000000
</span><span id="__span-3-186"><a id="__codelineno-3-186" name="__codelineno-3-186" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-186"></a>United Kingdom,68000000
</span><span id="__span-3-187"><a id="__codelineno-3-187" name="__codelineno-3-187" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-187"></a>United States,345000000
</span><span id="__span-3-188"><a id="__codelineno-3-188" name="__codelineno-3-188" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-188"></a>Uruguay,3500000
</span><span id="__span-3-189"><a id="__codelineno-3-189" name="__codelineno-3-189" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-189"></a>Uzbekistan,36000000
</span><span id="__span-3-190"><a id="__codelineno-3-190" name="__codelineno-3-190" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-190"></a>Vanuatu,320000
</span><span id="__span-3-191"><a id="__codelineno-3-191" name="__codelineno-3-191" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-191"></a>Venezuela,28000000
</span><span id="__span-3-192"><a id="__codelineno-3-192" name="__codelineno-3-192" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-192"></a>Vietnam,99000000
</span><span id="__span-3-193"><a id="__codelineno-3-193" name="__codelineno-3-193" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-193"></a>Yemen,32000000
</span><span id="__span-3-194"><a id="__codelineno-3-194" name="__codelineno-3-194" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-194"></a>Zambia,20000000
</span><span id="__span-3-195"><a id="__codelineno-3-195" name="__codelineno-3-195" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-3-195"></a>Zimbabwe,16000000
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-1"></a>country,population
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-2"></a>Afghanistan,40000000
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-3"></a>Albania,2800000
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-4"></a>Algeria,45000000
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-5"></a>Andorra,80000
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-6"></a>Angola,35000000
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-7"></a>Antigua and Barbuda,100000
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-8"></a>Argentina,46000000
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-9"></a>Armenia,3000000
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-10"></a>Australia,26000000
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-11"></a>Austria,9000000
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-12"></a>Azerbaijan,10000000
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-13"></a>Bahamas,400000
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-14"></a>Bahrain,1800000
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-15"></a>Bangladesh,170000000
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-16"></a>Barbados,300000
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-17"></a>Belarus,9200000
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-18"></a>Belgium,11600000
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-19"></a>Belize,400000
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-20"></a>Benin,13000000
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-21"></a>Bhutan,800000
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-22"></a>Bolivia,12000000
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-23"></a>Bosnia and Herzegovina,3200000
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-24"></a>Botswana,2400000
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-25"></a>Brazil,216000000
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-26"></a>Brunei,450000
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-27"></a>Bulgaria,6400000
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-28"></a>Burkina Faso,23000000
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-29"></a>Burundi,13000000
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-30"></a>Cabo Verde,600000
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-31"></a>Cambodia,17000000
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-32"></a>Cameroon,28000000
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-33"></a>Canada,39000000
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-34"></a>Central African Republic,5000000
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-35"></a>Chad,18000000
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-36"></a>Chile,20000000
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-37"></a>China,1412000000
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-38"></a>Colombia,52000000
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-39"></a>Comoros,900000
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-40"></a>Congo,6000000
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-41"></a>Costa Rica,5200000
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-42"></a>Côte d&#39;Ivoire,29000000
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-43"></a>Croatia,3800000
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-44"></a>Cuba,11100000
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-45"></a>Cyprus,1300000
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-46"></a>Czechia,10700000
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-47"></a>Denmark,5900000
</span><span id="__span-4-48"><a id="__codelineno-4-48" name="__codelineno-4-48" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-48"></a>Djibouti,1100000
</span><span id="__span-4-49"><a id="__codelineno-4-49" name="__codelineno-4-49" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-49"></a>Dominica,72000
</span><span id="__span-4-50"><a id="__codelineno-4-50" name="__codelineno-4-50" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-50"></a>Dominican Republic,11000000
</span><span id="__span-4-51"><a id="__codelineno-4-51" name="__codelineno-4-51" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-51"></a>DRC,100000000
</span><span id="__span-4-52"><a id="__codelineno-4-52" name="__codelineno-4-52" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-52"></a>Ecuador,18000000
</span><span id="__span-4-53"><a id="__codelineno-4-53" name="__codelineno-4-53" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-53"></a>Egypt,110000000
</span><span id="__span-4-54"><a id="__codelineno-4-54" name="__codelineno-4-54" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-54"></a>El Salvador,6500000
</span><span id="__span-4-55"><a id="__codelineno-4-55" name="__codelineno-4-55" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-55"></a>Equatorial Guinea,1700000
</span><span id="__span-4-56"><a id="__codelineno-4-56" name="__codelineno-4-56" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-56"></a>Eritrea,3700000
</span><span id="__span-4-57"><a id="__codelineno-4-57" name="__codelineno-4-57" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-57"></a>Estonia,1300000
</span><span id="__span-4-58"><a id="__codelineno-4-58" name="__codelineno-4-58" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-58"></a>Eswatini,1200000
</span><span id="__span-4-59"><a id="__codelineno-4-59" name="__codelineno-4-59" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-59"></a>Ethiopia,125000000
</span><span id="__span-4-60"><a id="__codelineno-4-60" name="__codelineno-4-60" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-60"></a>Fiji,900000
</span><span id="__span-4-61"><a id="__codelineno-4-61" name="__codelineno-4-61" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-61"></a>Finland,5600000
</span><span id="__span-4-62"><a id="__codelineno-4-62" name="__codelineno-4-62" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-62"></a>France,68000000
</span><span id="__span-4-63"><a id="__codelineno-4-63" name="__codelineno-4-63" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-63"></a>Gabon,2400000
</span><span id="__span-4-64"><a id="__codelineno-4-64" name="__codelineno-4-64" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-64"></a>Gambia,2700000
</span><span id="__span-4-65"><a id="__codelineno-4-65" name="__codelineno-4-65" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-65"></a>Georgia,3700000
</span><span id="__span-4-66"><a id="__codelineno-4-66" name="__codelineno-4-66" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-66"></a>Germany,83000000
</span><span id="__span-4-67"><a id="__codelineno-4-67" name="__codelineno-4-67" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-67"></a>Ghana,34000000
</span><span id="__span-4-68"><a id="__codelineno-4-68" name="__codelineno-4-68" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-68"></a>Greece,10200000
</span><span id="__span-4-69"><a id="__codelineno-4-69" name="__codelineno-4-69" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-69"></a>Grenada,120000
</span><span id="__span-4-70"><a id="__codelineno-4-70" name="__codelineno-4-70" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-70"></a>Guatemala,19000000
</span><span id="__span-4-71"><a id="__codelineno-4-71" name="__codelineno-4-71" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-71"></a>Guinea,14000000
</span><span id="__span-4-72"><a id="__codelineno-4-72" name="__codelineno-4-72" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-72"></a>Guinea-Bissau,2100000
</span><span id="__span-4-73"><a id="__codelineno-4-73" name="__codelineno-4-73" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-73"></a>Guyana,800000
</span><span id="__span-4-74"><a id="__codelineno-4-74" name="__codelineno-4-74" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-74"></a>Haiti,11700000
</span><span id="__span-4-75"><a id="__codelineno-4-75" name="__codelineno-4-75" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-75"></a>Honduras,11000000
</span><span id="__span-4-76"><a id="__codelineno-4-76" name="__codelineno-4-76" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-76"></a>Hungary,9600000
</span><span id="__span-4-77"><a id="__codelineno-4-77" name="__codelineno-4-77" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-77"></a>Iceland,380000
</span><span id="__span-4-78"><a id="__codelineno-4-78" name="__codelineno-4-78" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-78"></a>India,1418000000
</span><span id="__span-4-79"><a id="__codelineno-4-79" name="__codelineno-4-79" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-79"></a>Indonesia,280000000
</span><span id="__span-4-80"><a id="__codelineno-4-80" name="__codelineno-4-80" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-80"></a>Iran,89000000
</span><span id="__span-4-81"><a id="__codelineno-4-81" name="__codelineno-4-81" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-81"></a>Iraq,44000000
</span><span id="__span-4-82"><a id="__codelineno-4-82" name="__codelineno-4-82" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-82"></a>Ireland,5200000
</span><span id="__span-4-83"><a id="__codelineno-4-83" name="__codelineno-4-83" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-83"></a>Israel,9700000
</span><span id="__span-4-84"><a id="__codelineno-4-84" name="__codelineno-4-84" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-84"></a>Italy,59000000
</span><span id="__span-4-85"><a id="__codelineno-4-85" name="__codelineno-4-85" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-85"></a>Jamaica,3000000
</span><span id="__span-4-86"><a id="__codelineno-4-86" name="__codelineno-4-86" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-86"></a>Japan,124000000
</span><span id="__span-4-87"><a id="__codelineno-4-87" name="__codelineno-4-87" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-87"></a>Jordan,11000000
</span><span id="__span-4-88"><a id="__codelineno-4-88" name="__codelineno-4-88" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-88"></a>Kazakhstan,20000000
</span><span id="__span-4-89"><a id="__codelineno-4-89" name="__codelineno-4-89" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-89"></a>Kenya,57000000
</span><span id="__span-4-90"><a id="__codelineno-4-90" name="__codelineno-4-90" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-90"></a>Kiribati,130000
</span><span id="__span-4-91"><a id="__codelineno-4-91" name="__codelineno-4-91" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-91"></a>Kuwait,4300000
</span><span id="__span-4-92"><a id="__codelineno-4-92" name="__codelineno-4-92" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-92"></a>Kyrgyzstan,6800000
</span><span id="__span-4-93"><a id="__codelineno-4-93" name="__codelineno-4-93" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-93"></a>Laos,7500000
</span><span id="__span-4-94"><a id="__codelineno-4-94" name="__codelineno-4-94" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-94"></a>Latvia,1800000
</span><span id="__span-4-95"><a id="__codelineno-4-95" name="__codelineno-4-95" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-95"></a>Lebanon,5500000
</span><span id="__span-4-96"><a id="__codelineno-4-96" name="__codelineno-4-96" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-96"></a>Lesotho,2300000
</span><span id="__span-4-97"><a id="__codelineno-4-97" name="__codelineno-4-97" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-97"></a>Liberia,5300000
</span><span id="__span-4-98"><a id="__codelineno-4-98" name="__codelineno-4-98" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-98"></a>Libya,7200000
</span><span id="__span-4-99"><a id="__codelineno-4-99" name="__codelineno-4-99" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-99"></a>Liechtenstein,39000
</span><span id="__span-4-100"><a id="__codelineno-4-100" name="__codelineno-4-100" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-100"></a>Lithuania,2700000
</span><span id="__span-4-101"><a id="__codelineno-4-101" name="__codelineno-4-101" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-101"></a>Luxembourg,660000
</span><span id="__span-4-102"><a id="__codelineno-4-102" name="__codelineno-4-102" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-102"></a>Madagascar,30000000
</span><span id="__span-4-103"><a id="__codelineno-4-103" name="__codelineno-4-103" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-103"></a>Malawi,21000000
</span><span id="__span-4-104"><a id="__codelineno-4-104" name="__codelineno-4-104" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-104"></a>Malaysia,34000000
</span><span id="__span-4-105"><a id="__codelineno-4-105" name="__codelineno-4-105" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-105"></a>Maldives,600000
</span><span id="__span-4-106"><a id="__codelineno-4-106" name="__codelineno-4-106" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-106"></a>Mali,23000000
</span><span id="__span-4-107"><a id="__codelineno-4-107" name="__codelineno-4-107" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-107"></a>Malta,570000
</span><span id="__span-4-108"><a id="__codelineno-4-108" name="__codelineno-4-108" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-108"></a>Marshall Islands,42000
</span><span id="__span-4-109"><a id="__codelineno-4-109" name="__codelineno-4-109" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-109"></a>Mauritania,4900000
</span><span id="__span-4-110"><a id="__codelineno-4-110" name="__codelineno-4-110" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-110"></a>Mauritius,1300000
</span><span id="__span-4-111"><a id="__codelineno-4-111" name="__codelineno-4-111" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-111"></a>Mexico,128000000
</span><span id="__span-4-112"><a id="__codelineno-4-112" name="__codelineno-4-112" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-112"></a>Micronesia,110000
</span><span id="__span-4-113"><a id="__codelineno-4-113" name="__codelineno-4-113" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-113"></a>Moldova,2500000
</span><span id="__span-4-114"><a id="__codelineno-4-114" name="__codelineno-4-114" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-114"></a>Monaco,40000
</span><span id="__span-4-115"><a id="__codelineno-4-115" name="__codelineno-4-115" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-115"></a>Mongolia,3400000
</span><span id="__span-4-116"><a id="__codelineno-4-116" name="__codelineno-4-116" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-116"></a>Montenegro,620000
</span><span id="__span-4-117"><a id="__codelineno-4-117" name="__codelineno-4-117" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-117"></a>Morocco,38000000
</span><span id="__span-4-118"><a id="__codelineno-4-118" name="__codelineno-4-118" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-118"></a>Mozambique,33000000
</span><span id="__span-4-119"><a id="__codelineno-4-119" name="__codelineno-4-119" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-119"></a>Myanmar,55000000
</span><span id="__span-4-120"><a id="__codelineno-4-120" name="__codelineno-4-120" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-120"></a>Namibia,2600000
</span><span id="__span-4-121"><a id="__codelineno-4-121" name="__codelineno-4-121" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-121"></a>Nauru,11000
</span><span id="__span-4-122"><a id="__codelineno-4-122" name="__codelineno-4-122" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-122"></a>Nepal,31000000
</span><span id="__span-4-123"><a id="__codelineno-4-123" name="__codelineno-4-123" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-123"></a>Netherlands,17800000
</span><span id="__span-4-124"><a id="__codelineno-4-124" name="__codelineno-4-124" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-124"></a>New Zealand,5200000
</span><span id="__span-4-125"><a id="__codelineno-4-125" name="__codelineno-4-125" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-125"></a>Nicaragua,6900000
</span><span id="__span-4-126"><a id="__codelineno-4-126" name="__codelineno-4-126" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-126"></a>Niger,27000000
</span><span id="__span-4-127"><a id="__codelineno-4-127" name="__codelineno-4-127" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-127"></a>Nigeria,230000000
</span><span id="__span-4-128"><a id="__codelineno-4-128" name="__codelineno-4-128" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-128"></a>North Korea,26000000
</span><span id="__span-4-129"><a id="__codelineno-4-129" name="__codelineno-4-129" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-129"></a>North Macedonia,1800000
</span><span id="__span-4-130"><a id="__codelineno-4-130" name="__codelineno-4-130" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-130"></a>Norway,5500000
</span><span id="__span-4-131"><a id="__codelineno-4-131" name="__codelineno-4-131" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-131"></a>Oman,5500000
</span><span id="__span-4-132"><a id="__codelineno-4-132" name="__codelineno-4-132" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-132"></a>Pakistan,240000000
</span><span id="__span-4-133"><a id="__codelineno-4-133" name="__codelineno-4-133" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-133"></a>Palau,18000
</span><span id="__span-4-134"><a id="__codelineno-4-134" name="__codelineno-4-134" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-134"></a>Panama,4500000
</span><span id="__span-4-135"><a id="__codelineno-4-135" name="__codelineno-4-135" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-135"></a>Papua New Guinea,10000000
</span><span id="__span-4-136"><a id="__codelineno-4-136" name="__codelineno-4-136" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-136"></a>Paraguay,7200000
</span><span id="__span-4-137"><a id="__codelineno-4-137" name="__codelineno-4-137" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-137"></a>Peru,34000000
</span><span id="__span-4-138"><a id="__codelineno-4-138" name="__codelineno-4-138" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-138"></a>Philippines,117000000
</span><span id="__span-4-139"><a id="__codelineno-4-139" name="__codelineno-4-139" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-139"></a>Poland,38000000
</span><span id="__span-4-140"><a id="__codelineno-4-140" name="__codelineno-4-140" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-140"></a>Portugal,10200000
</span><span id="__span-4-141"><a id="__codelineno-4-141" name="__codelineno-4-141" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-141"></a>Qatar,2900000
</span><span id="__span-4-142"><a id="__codelineno-4-142" name="__codelineno-4-142" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-142"></a>Romania,19000000
</span><span id="__span-4-143"><a id="__codelineno-4-143" name="__codelineno-4-143" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-143"></a>Russia,144000000
</span><span id="__span-4-144"><a id="__codelineno-4-144" name="__codelineno-4-144" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-144"></a>Rwanda,14000000
</span><span id="__span-4-145"><a id="__codelineno-4-145" name="__codelineno-4-145" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-145"></a>Saint Kitts and Nevis,54000
</span><span id="__span-4-146"><a id="__codelineno-4-146" name="__codelineno-4-146" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-146"></a>Saint Lucia,180000
</span><span id="__span-4-147"><a id="__codelineno-4-147" name="__codelineno-4-147" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-147"></a>Saint Vincent and the Grenadines,110000
</span><span id="__span-4-148"><a id="__codelineno-4-148" name="__codelineno-4-148" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-148"></a>Samoa,225000
</span><span id="__span-4-149"><a id="__codelineno-4-149" name="__codelineno-4-149" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-149"></a>San Marino,34000
</span><span id="__span-4-150"><a id="__codelineno-4-150" name="__codelineno-4-150" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-150"></a>São Tomé and Príncipe,230000
</span><span id="__span-4-151"><a id="__codelineno-4-151" name="__codelineno-4-151" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-151"></a>Saudi Arabia,37000000
</span><span id="__span-4-152"><a id="__codelineno-4-152" name="__codelineno-4-152" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-152"></a>Senegal,18000000
</span><span id="__span-4-153"><a id="__codelineno-4-153" name="__codelineno-4-153" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-153"></a>Serbia,6600000
</span><span id="__span-4-154"><a id="__codelineno-4-154" name="__codelineno-4-154" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-154"></a>Seychelles,100000
</span><span id="__span-4-155"><a id="__codelineno-4-155" name="__codelineno-4-155" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-155"></a>Sierra Leone,8600000
</span><span id="__span-4-156"><a id="__codelineno-4-156" name="__codelineno-4-156" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-156"></a>Singapore,6000000
</span><span id="__span-4-157"><a id="__codelineno-4-157" name="__codelineno-4-157" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-157"></a>Slovakia,5500000
</span><span id="__span-4-158"><a id="__codelineno-4-158" name="__codelineno-4-158" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-158"></a>Slovenia,2100000
</span><span id="__span-4-159"><a id="__codelineno-4-159" name="__codelineno-4-159" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-159"></a>Solomon Islands,720000
</span><span id="__span-4-160"><a id="__codelineno-4-160" name="__codelineno-4-160" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-160"></a>Somalia,18000000
</span><span id="__span-4-161"><a id="__codelineno-4-161" name="__codelineno-4-161" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-161"></a>South Africa,62000000
</span><span id="__span-4-162"><a id="__codelineno-4-162" name="__codelineno-4-162" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-162"></a>South Korea,52000000
</span><span id="__span-4-163"><a id="__codelineno-4-163" name="__codelineno-4-163" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-163"></a>South Sudan,13000000
</span><span id="__span-4-164"><a id="__codelineno-4-164" name="__codelineno-4-164" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-164"></a>Spain,48000000
</span><span id="__span-4-165"><a id="__codelineno-4-165" name="__codelineno-4-165" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-165"></a>Sri Lanka,22000000
</span><span id="__span-4-166"><a id="__codelineno-4-166" name="__codelineno-4-166" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-166"></a>Sudan,48000000
</span><span id="__span-4-167"><a id="__codelineno-4-167" name="__codelineno-4-167" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-167"></a>Suriname,620000
</span><span id="__span-4-168"><a id="__codelineno-4-168" name="__codelineno-4-168" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-168"></a>Sweden,10500000
</span><span id="__span-4-169"><a id="__codelineno-4-169" name="__codelineno-4-169" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-169"></a>Switzerland,8800000
</span><span id="__span-4-170"><a id="__codelineno-4-170" name="__codelineno-4-170" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-170"></a>Syria,23000000
</span><span id="__span-4-171"><a id="__codelineno-4-171" name="__codelineno-4-171" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-171"></a>Taiwan,23600000
</span><span id="__span-4-172"><a id="__codelineno-4-172" name="__codelineno-4-172" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-172"></a>Tajikistan,10000000
</span><span id="__span-4-173"><a id="__codelineno-4-173" name="__codelineno-4-173" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-173"></a>Tanzania,65000000
</span><span id="__span-4-174"><a id="__codelineno-4-174" name="__codelineno-4-174" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-174"></a>Thailand,72000000
</span><span id="__span-4-175"><a id="__codelineno-4-175" name="__codelineno-4-175" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-175"></a>Timor-Leste,1400000
</span><span id="__span-4-176"><a id="__codelineno-4-176" name="__codelineno-4-176" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-176"></a>Togo,9000000
</span><span id="__span-4-177"><a id="__codelineno-4-177" name="__codelineno-4-177" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-177"></a>Tonga,110000
</span><span id="__span-4-178"><a id="__codelineno-4-178" name="__codelineno-4-178" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-178"></a>Trinidad and Tobago,1400000
</span><span id="__span-4-179"><a id="__codelineno-4-179" name="__codelineno-4-179" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-179"></a>Tunisia,12400000
</span><span id="__span-4-180"><a id="__codelineno-4-180" name="__codelineno-4-180" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-180"></a>Turkey,86000000
</span><span id="__span-4-181"><a id="__codelineno-4-181" name="__codelineno-4-181" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-181"></a>Turkmenistan,6500000
</span><span id="__span-4-182"><a id="__codelineno-4-182" name="__codelineno-4-182" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-182"></a>Tuvalu,12000
</span><span id="__span-4-183"><a id="__codelineno-4-183" name="__codelineno-4-183" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-183"></a>Uganda,49000000
</span><span id="__span-4-184"><a id="__codelineno-4-184" name="__codelineno-4-184" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-184"></a>Ukraine,36000000
</span><span id="__span-4-185"><a id="__codelineno-4-185" name="__codelineno-4-185" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-185"></a>United Arab Emirates,10000000
</span><span id="__span-4-186"><a id="__codelineno-4-186" name="__codelineno-4-186" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-186"></a>United Kingdom,68000000
</span><span id="__span-4-187"><a id="__codelineno-4-187" name="__codelineno-4-187" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-187"></a>United States,345000000
</span><span id="__span-4-188"><a id="__codelineno-4-188" name="__codelineno-4-188" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-188"></a>Uruguay,3500000
</span><span id="__span-4-189"><a id="__codelineno-4-189" name="__codelineno-4-189" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-189"></a>Uzbekistan,36000000
</span><span id="__span-4-190"><a id="__codelineno-4-190" name="__codelineno-4-190" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-190"></a>Vanuatu,320000
</span><span id="__span-4-191"><a id="__codelineno-4-191" name="__codelineno-4-191" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-191"></a>Venezuela,28000000
</span><span id="__span-4-192"><a id="__codelineno-4-192" name="__codelineno-4-192" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-192"></a>Vietnam,99000000
</span><span id="__span-4-193"><a id="__codelineno-4-193" name="__codelineno-4-193" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-193"></a>Yemen,32000000
</span><span id="__span-4-194"><a id="__codelineno-4-194" name="__codelineno-4-194" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-194"></a>Zambia,20000000
</span><span id="__span-4-195"><a id="__codelineno-4-195" name="__codelineno-4-195" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-4-195"></a>Zimbabwe,16000000
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-5-1"></a>mcp&gt;=0.1.0
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-5-2"></a>ollama&gt;=0.1.0
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-5-3"></a>pandas&gt;=1.3.0
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#resources-lab07-mcp-ollama-step00-getting-started-__codelineno-5-4"></a>requests&gt;=2.25.0
</span></code></pre></div>
</div>
</div>
</div></section><section class="print-page" id="resources-lab07-mcp-ollama-step01-imports" heading-number="3.12"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-1"></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-2"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-3"></a><span class="sd">Complete MCP Server with Ollama Integration</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-4"></a><span class="sd">Step 1: Imports</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-5"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-15"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ollama</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-16"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-17"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-18"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-19"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_server</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-20"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-21"></a>    <span class="n">Resource</span><span class="p">,</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-22"></a>    <span class="n">Tool</span><span class="p">,</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-23"></a>    <span class="n">TextContent</span><span class="p">,</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-24"></a>    <span class="n">ImageContent</span><span class="p">,</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-25"></a>    <span class="n">TextResourceContents</span><span class="p">,</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-26"></a>    <span class="n">Prompt</span><span class="p">,</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-27"></a>    <span class="n">GetPromptResult</span><span class="p">,</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-28"></a>    <span class="n">CallToolResult</span><span class="p">,</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-29"></a>    <span class="n">ListResourcesResult</span><span class="p">,</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-30"></a>    <span class="n">ListToolsResult</span><span class="p">,</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-31"></a>    <span class="n">ReadResourceResult</span><span class="p">,</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-32"></a>    <span class="n">ListPromptsResult</span><span class="p">,</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-lab07-mcp-ollama-step01-imports-__codelineno-0-33"></a><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step02-skeleton-code" heading-number="3.13"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step02-skeleton-code-__codelineno-0-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CompleteOllamaMCPServer</span><span class="p">:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step02-skeleton-code-__codelineno-0-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step02-skeleton-code-__codelineno-0-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-ollama-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step02-skeleton-code-__codelineno-0-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_handlers</span><span class="p">()</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step02-skeleton-code-__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step02-skeleton-code-__codelineno-0-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step02-skeleton-code-__codelineno-0-7"></a>        <span class="c1"># Will be implemented in subsequent steps</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step02-skeleton-code-__codelineno-0-8"></a>        <span class="k">pass</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step03-constructor" heading-number="3.14"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-1"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-2"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&quot;complete-ollama-mcp-server&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="s2">&quot;data.db&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ollama_client</span> <span class="o">=</span> <span class="n">ollama</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">country_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_country_data</span><span class="p">()</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_handlers</span><span class="p">()</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_country_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load country information from CSV files for RAG retrieval.&quot;&quot;&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-10"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-11"></a>        <span class="n">script_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-12"></a>        <span class="n">info_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;capital&#39;</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;foundation_year&#39;</span><span class="p">]</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-13"></a>        <span class="k">for</span> <span class="n">info_type</span> <span class="ow">in</span> <span class="n">info_types</span><span class="p">:</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-14"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-15"></a>                <span class="n">file_path</span> <span class="o">=</span> <span class="n">script_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">info_type</span><span class="si">}</span><span class="s1">.csv&#39;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-16"></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-17"></a>                <span class="c1"># Convert country names to lowercase for case-insensitive matching</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-18"></a>                <span class="n">data</span><span class="p">[</span><span class="n">info_type</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">info_type</span><span class="p">]))</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-19"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-20"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">info_type</span><span class="si">}</span><span class="s2">.csv: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-21"></a>                <span class="n">data</span><span class="p">[</span><span class="n">info_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-lab07-mcp-ollama-step03-constructor-__codelineno-0-22"></a>        <span class="k">return</span> <span class="n">data</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step04-register-tools" heading-number="3.15"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tool</span><span class="p">]:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-3"></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-4"></a>        <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-5"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;country_info&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-6"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Get country information using RAG from CSV databases&quot;</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-7"></a>            <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-8"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-9"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-10"></a>                    <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-11"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-12"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The country name to get information for&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-13"></a>                    <span class="p">},</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-14"></a>                    <span class="s2">&quot;info_types&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-15"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-16"></a>                        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;capital&quot;</span><span class="p">,</span> <span class="s2">&quot;population&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;foundation_year&quot;</span><span class="p">]},</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-17"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Types of information to retrieve&quot;</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-18"></a>                    <span class="p">}</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-19"></a>                <span class="p">},</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-20"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;country&quot;</span><span class="p">]</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-21"></a>            <span class="p">}</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-22"></a>        <span class="p">),</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-23"></a>        <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-24"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;read_file&quot;</span><span class="p">,</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-25"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Read and analyze file contents with metadata&quot;</span><span class="p">,</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-26"></a>            <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-27"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-28"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-29"></a>                    <span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-30"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-31"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Absolute path to the file to read&quot;</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-32"></a>                    <span class="p">},</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-33"></a>                    <span class="s2">&quot;max_size&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-34"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-35"></a>                        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">1048576</span><span class="p">,</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-36"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Maximum file size in bytes (default 1MB)&quot;</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-37"></a>                    <span class="p">},</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-38"></a>                    <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-39"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-40"></a>                        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-41"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;File encoding&quot;</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-42"></a>                    <span class="p">}</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-43"></a>                <span class="p">},</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-44"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;filepath&quot;</span><span class="p">]</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-45"></a>            <span class="p">}</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-46"></a>        <span class="p">),</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-47"></a>        <span class="n">Tool</span><span class="p">(</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-48"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;query_database&quot;</span><span class="p">,</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-49"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Execute SELECT queries on SQLite database&quot;</span><span class="p">,</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-50"></a>            <span class="n">inputSchema</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-51"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-52"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-53"></a>                    <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-54"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-55"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT SQL query to execute&quot;</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-56"></a>                    <span class="p">},</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-57"></a>                    <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-58"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-59"></a>                        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s2">&quot;data.db&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-60"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Database file path&quot;</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-61"></a>                    <span class="p">}</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-62"></a>                <span class="p">},</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-63"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-64"></a>            <span class="p">}</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-65"></a>        <span class="p">)</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-lab07-mcp-ollama-step04-register-tools-__codelineno-0-66"></a>    <span class="p">]</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step05-tool-handlers" heading-number="3.16"><h1 id="resources-lab07-mcp-ollama-step05-tool-handlers-step-05-tool-handlers">Step 05: Tool Handlers<a class="headerlink" href="#resources-lab07-mcp-ollama-step05-tool-handlers-step-05-tool-handlers" title="Permanent link">&para;</a></h1>
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">call_tool</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TextContent</span><span class="p">]:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-3"></a>    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;country_info&quot;</span><span class="p">:</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-4"></a>        <span class="n">country</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-5"></a>        <span class="n">info_types</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;info_types&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-7"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">country</span><span class="p">:</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-8"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Country name is required&quot;</span><span class="p">)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-10"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">info_types</span><span class="p">:</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-11"></a>            <span class="n">info_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;capital&quot;</span><span class="p">,</span> <span class="s2">&quot;population&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;foundation_year&quot;</span><span class="p">]</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-13"></a>        <span class="n">retrieved_info</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-14"></a>        <span class="k">for</span> <span class="n">info_type</span> <span class="ow">in</span> <span class="n">info_types</span><span class="p">:</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-15"></a>            <span class="c1"># Safe access to nested dictionary</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-16"></a>            <span class="n">type_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">info_type</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-17"></a>            <span class="k">if</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">type_data</span><span class="p">:</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-18"></a>                <span class="n">retrieved_info</span><span class="p">[</span><span class="n">info_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_data</span><span class="p">[</span><span class="n">country</span><span class="p">]</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-19"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-20"></a>                <span class="n">retrieved_info</span><span class="p">[</span><span class="n">info_type</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Information not available (Data loaded: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> records)&quot;</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-22"></a>        <span class="c1"># Use Ollama to generate a formatted response</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-23"></a>        <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Format the following information about </span><span class="si">{</span><span class="n">country</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> into a nice, readable response: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">retrieved_info</span><span class="p">,</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-24"></a>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-25"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-26"></a>            <span class="c1"># Use llama3.2 as detected on your system</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-27"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ollama_client</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-28"></a>                <span class="n">model</span><span class="o">=</span><span class="s1">&#39;llama3.2&#39;</span><span class="p">,</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-29"></a>                <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-30"></a>                <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;temperature&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;max_tokens&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">}</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-31"></a>            <span class="p">)</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-33"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-34"></a>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-35"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-36"></a>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-37"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-38"></a>            <span class="c1"># Fallback if Ollama fails</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-39"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error getting AI response: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Raw Data: </span><span class="si">{</span><span class="n">retrieved_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-40"></a>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-41"></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;read_file&quot;</span><span class="p">:</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-42"></a>        <span class="n">filepath</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filepath&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-43"></a>        <span class="n">max_size</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_size&quot;</span><span class="p">,</span> <span class="mi">1048576</span><span class="p">)</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-44"></a>        <span class="n">encoding</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-45"></a>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-46"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="p">:</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-47"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;File path is required&quot;</span><span class="p">)</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-48"></a>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-49"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-50"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-51"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-52"></a>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-53"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-54"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path is not a file: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-55"></a>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-56"></a>        <span class="n">file_size</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-57"></a>        <span class="k">if</span> <span class="n">file_size</span> <span class="o">&gt;</span> <span class="n">max_size</span><span class="p">:</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-58"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File too large: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}</span><span class="s2"> bytes (max: </span><span class="si">{</span><span class="n">max_size</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-59"></a>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-60"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-61"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-62"></a>                <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-63"></a>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-64"></a>            <span class="n">metadata</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">Size: </span><span class="si">{</span><span class="n">file_size</span><span class="si">}</span><span class="s2"> bytes</span><span class="se">\n</span><span class="s2">Encoding: </span><span class="si">{</span><span class="n">encoding</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-65"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">metadata</span> <span class="o">+</span> <span class="s2">&quot;Content:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">content</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-66"></a>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-67"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-68"></a>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-69"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-70"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error reading file: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-71"></a>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-72"></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;query_database&quot;</span><span class="p">:</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-73"></a>        <span class="n">query</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;query&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-74"></a>        <span class="n">database</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-75"></a>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-76"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="p">:</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-77"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Query is required&quot;</span><span class="p">)</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-78"></a>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-79"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;SELECT&quot;</span><span class="p">):</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-80"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only SELECT queries are allowed&quot;</span><span class="p">)</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-81"></a>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-82"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-83"></a>            <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-84"></a>            <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-85"></a>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-86"></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-87"></a>            <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-88"></a>            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-89"></a>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-90"></a>            <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-91"></a>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-92"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-93"></a>                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;No results found.&quot;</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-94"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-95"></a>                <span class="c1"># Format as table</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-96"></a>                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;| &quot;</span> <span class="o">+</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; |</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-97"></a>                <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;---&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;|</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-98"></a>                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-99"></a>                    <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;| &quot;</span> <span class="o">+</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; |</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-100"></a>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-101"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">result</span><span class="p">)]</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-102"></a>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-103"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-104"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Database error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-105"></a>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#resources-lab07-mcp-ollama-step05-tool-handlers-__codelineno-0-107"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown tool: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step06-register-resources" heading-number="3.17"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_resources</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-3"></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-4"></a>        <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-5"></a>            <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://server-info&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-6"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Server Information&quot;</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-7"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Basic information about this MCP server&quot;</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-8"></a>            <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-9"></a>        <span class="p">),</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-10"></a>        <span class="n">Resource</span><span class="p">(</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-11"></a>            <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;resource://ollama-models&quot;</span><span class="p">,</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-12"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Available Ollama Models&quot;</span><span class="p">,</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-13"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;List of available Ollama models&quot;</span><span class="p">,</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-14"></a>            <span class="n">mimeType</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-15"></a>        <span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab07-mcp-ollama-step06-register-resources-__codelineno-0-16"></a>    <span class="p">]</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step07-resource-handlers" heading-number="3.18"><h1 id="resources-lab07-mcp-ollama-step07-resource-handlers-step-07-resource-handlers">Step 07: Resource Handlers<a class="headerlink" href="#resources-lab07-mcp-ollama-step07-resource-handlers-step-07-resource-handlers" title="Permanent link">&para;</a></h1>
<h3 id="resources-lab07-mcp-ollama-step07-resource-handlers-method-register_resource_handlers">Method <code>register_resource_handlers</code><a class="headerlink" href="#resources-lab07-mcp-ollama-step07-resource-handlers-method-register_resource_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Implements resource reading logic</li>
<li>Handles resource requests and returns content</li>
</ul>
<p><strong>Why This Runs Fifth:</strong></p>
<ul>
<li>Connects resource URIs to actual content</li>
<li>Makes resources accessible to clients</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">read_resource</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-3"></a>    <span class="n">uri_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-5"></a>    <span class="c1"># Debug log to help diagnose the mismatch</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DEBUG: Requesting URI: &#39;</span><span class="si">{</span><span class="n">uri_str</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-8"></a>    <span class="c1"># Allow exact match or match without scheme to be robust</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-9"></a>    <span class="k">if</span> <span class="n">uri_str</span> <span class="o">==</span> <span class="s2">&quot;resource://server-info&quot;</span> <span class="ow">or</span> <span class="n">uri_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;server-info&quot;</span><span class="p">):</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-10"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-11"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Complete Ollama MCP Server&quot;</span><span class="p">,</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-12"></a>            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-13"></a>            <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tools&quot;</span><span class="p">,</span> <span class="s2">&quot;resources&quot;</span><span class="p">,</span> <span class="s2">&quot;ollama-integration&quot;</span><span class="p">],</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-14"></a>            <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;country_info&quot;</span><span class="p">,</span> <span class="s2">&quot;read_file&quot;</span><span class="p">,</span> <span class="s2">&quot;query_database&quot;</span><span class="p">],</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-15"></a>            <span class="s2">&quot;country_database&quot;</span><span class="p">:</span> <span class="s2">&quot;193 UN member states with capitals, populations, topographic heights, and foundation years&quot;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-16"></a>        <span class="p">}</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-17"></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-19"></a>    <span class="k">elif</span> <span class="n">uri_str</span> <span class="o">==</span> <span class="s2">&quot;resource://ollama-models&quot;</span> <span class="ow">or</span> <span class="n">uri_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;ollama-models&quot;</span><span class="p">):</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-20"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-21"></a>            <span class="n">models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ollama_client</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-22"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-23"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-24"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)},</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-26"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-lab07-mcp-ollama-step07-resource-handlers-__codelineno-0-27"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown resource: </span><span class="si">{</span><span class="n">uri_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step08-register-prompts" heading-number="3.19"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">list_prompts</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_prompts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Prompt</span><span class="p">]:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-3"></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-4"></a>        <span class="n">Prompt</span><span class="p">(</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-5"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analyze-country-data&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-6"></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze country data and provide insights&quot;</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-7"></a>            <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-8"></a>                <span class="p">{</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-9"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-10"></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Country to analyze&quot;</span><span class="p">,</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-11"></a>                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-12"></a>                <span class="p">}</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-13"></a>            <span class="p">]</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-14"></a>        <span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step08-register-prompts-__codelineno-0-15"></a>    <span class="p">]</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step09-prompt-handlers" heading-number="3.20"><h1 id="resources-lab07-mcp-ollama-step09-prompt-handlers-step-09-prompt-handlers">Step 09: Prompt Handlers<a class="headerlink" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-step-09-prompt-handlers" title="Permanent link">&para;</a></h1>
<h3 id="resources-lab07-mcp-ollama-step09-prompt-handlers-method-register_prompt_handlers">Method <code>register_prompt_handlers</code><a class="headerlink" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-method-register_prompt_handlers" title="Permanent link">&para;</a></h3>
<p><strong>Capabilities:</strong></p>
<ul>
<li>Generates prompt content.</li>
<li>Handles prompt requests and returns structured messages.</li>
</ul>
<p><strong>Why This Runs Seventh:</strong></p>
<ul>
<li>Connects prompt templates to actual content.</li>
<li>Makes prompts usable by clients.</li>
</ul>
<hr />
<p>Add this method to your class:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-1"></a><span class="nd">@self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">get_prompt</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prompt</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">GetPromptResult</span><span class="p">:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-3"></a>    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;analyze-country-data&quot;</span><span class="p">:</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-4"></a>        <span class="n">country</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown Country&quot;</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-5"></a>        <span class="n">prompt_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Analyze the data for </span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2"> and provide insights:</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-7"></a><span class="s2">1. Use the country_info tool to get information about the country&#39;s capital, population, topographic height, and foundation year</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-8"></a><span class="s2">2. Analyze the retrieved information and provide interesting facts</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-9"></a><span class="s2">3. Consider historical context and geographical significance</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-10"></a><span class="s2">4. Provide recommendations or interesting trivia based on the data</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-12"></a><span class="s2">Please provide a comprehensive country analysis.&quot;&quot;&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-14"></a>        <span class="k">return</span> <span class="n">GetPromptResult</span><span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-15"></a>            <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Country analysis prompt for </span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-16"></a>            <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-17"></a>                <span class="p">{</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-18"></a>                    <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-19"></a>                    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-20"></a>                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-21"></a>                        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">prompt_text</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-22"></a>                    <span class="p">}</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-23"></a>                <span class="p">}</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-24"></a>            <span class="p">]</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-25"></a>        <span class="p">)</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-26"></a>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-27"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#resources-lab07-mcp-ollama-step09-prompt-handlers-__codelineno-0-28"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown prompt: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step10-setup-handlers" heading-number="3.21"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step10-setup-handlers-__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">_setup_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step10-setup-handlers-__codelineno-0-2"></a>    <span class="c1"># Handlers are registered automatically via decorators</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step10-setup-handlers-__codelineno-0-3"></a>    <span class="k">pass</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step11-run-server" heading-number="3.22"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step11-run-server-__codelineno-0-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step11-run-server-__codelineno-0-2"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">stdio_server</span><span class="p">()</span> <span class="k">as</span> <span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">):</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step11-run-server-__codelineno-0-3"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">create_initialization_options</span><span class="p">())</span>
</span></code></pre></div></section><section class="print-page" id="resources-lab07-mcp-ollama-step12-main-entry-point" heading-number="3.23"><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#resources-lab07-mcp-ollama-step12-main-entry-point-__codelineno-0-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#resources-lab07-mcp-ollama-step12-main-entry-point-__codelineno-0-2"></a>    <span class="n">server</span> <span class="o">=</span> <span class="n">CompleteOllamaMCPServer</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#resources-lab07-mcp-ollama-step12-main-entry-point-__codelineno-0-3"></a>    <span class="k">await</span> <span class="n">server</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#resources-lab07-mcp-ollama-step12-main-entry-point-__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#resources-lab07-mcp-ollama-step12-main-entry-point-__codelineno-0-5"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#resources-lab07-mcp-ollama-step12-main-entry-point-__codelineno-0-6"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></code></pre></div></section></section></div><style>.print-site-enumerate-headings #welcome > h1:before { content: '1 ' }

                .print-site-enumerate-headings #welcome h2:before { content: '1.' counter(counter-welcome-2) ' ' }
                .print-site-enumerate-headings #welcome h2 {  counter-reset: counter-welcome-3 ;  counter-increment: counter-welcome-2 }
            
                .print-site-enumerate-headings #welcome h3:before { content: '1.' counter(counter-welcome-2) '.' counter(counter-welcome-3) ' ' }
                .print-site-enumerate-headings #welcome h3 {  counter-increment: counter-welcome-3 }
            
.print-site-enumerate-headings #section-2 > h1:before { content: '2 ' }
.print-site-enumerate-headings #labs > h1:before { content: '2.1 ' }

                .print-site-enumerate-headings #labs h2:before { content: '2.1.' counter(counter-labs-2) ' ' }
                .print-site-enumerate-headings #labs h2 {  counter-increment: counter-labs-2 }
            
.print-site-enumerate-headings #lab00-setup-lab > h1:before { content: '2.2 ' }

                .print-site-enumerate-headings #lab00-setup-lab h2:before { content: '2.2.' counter(counter-lab00-setup-lab-2) ' ' }
                .print-site-enumerate-headings #lab00-setup-lab h2 {  counter-increment: counter-lab00-setup-lab-2 }
            
.print-site-enumerate-headings #lab01-mcp-fundamentals-lab > h1:before { content: '2.3 ' }

                .print-site-enumerate-headings #lab01-mcp-fundamentals-lab h2:before { content: '2.3.' counter(counter-lab01-mcp-fundamentals-lab-2) ' ' }
                .print-site-enumerate-headings #lab01-mcp-fundamentals-lab h2 {  counter-increment: counter-lab01-mcp-fundamentals-lab-2 }
            
.print-site-enumerate-headings #lab02-first-mcp-server-lab > h1:before { content: '2.4 ' }

                .print-site-enumerate-headings #lab02-first-mcp-server-lab h2:before { content: '2.4.' counter(counter-lab02-first-mcp-server-lab-2) ' ' }
                .print-site-enumerate-headings #lab02-first-mcp-server-lab h2 {  counter-increment: counter-lab02-first-mcp-server-lab-2 }
            
.print-site-enumerate-headings #lab03-mcp-tools-lab > h1:before { content: '2.5 ' }

                .print-site-enumerate-headings #lab03-mcp-tools-lab h2:before { content: '2.5.' counter(counter-lab03-mcp-tools-lab-2) ' ' }
                .print-site-enumerate-headings #lab03-mcp-tools-lab h2 {  counter-increment: counter-lab03-mcp-tools-lab-2 }
            
.print-site-enumerate-headings #lab04-mcp-resources-lab > h1:before { content: '2.6 ' }

                .print-site-enumerate-headings #lab04-mcp-resources-lab h2:before { content: '2.6.' counter(counter-lab04-mcp-resources-lab-2) ' ' }
                .print-site-enumerate-headings #lab04-mcp-resources-lab h2 {  counter-increment: counter-lab04-mcp-resources-lab-2 }
            
.print-site-enumerate-headings #lab05-mcp-prompts-lab > h1:before { content: '2.7 ' }

                .print-site-enumerate-headings #lab05-mcp-prompts-lab h2:before { content: '2.7.' counter(counter-lab05-mcp-prompts-lab-2) ' ' }
                .print-site-enumerate-headings #lab05-mcp-prompts-lab h2 {  counter-increment: counter-lab05-mcp-prompts-lab-2 }
            
.print-site-enumerate-headings #lab06-mcp-workflow-lab > h1:before { content: '2.8 ' }

                .print-site-enumerate-headings #lab06-mcp-workflow-lab h2:before { content: '2.8.' counter(counter-lab06-mcp-workflow-lab-2) ' ' }
                .print-site-enumerate-headings #lab06-mcp-workflow-lab h2 {  counter-increment: counter-lab06-mcp-workflow-lab-2 }
            
.print-site-enumerate-headings #lab07-mcp-ollama-lab > h1:before { content: '2.9 ' }

                .print-site-enumerate-headings #lab07-mcp-ollama-lab h2:before { content: '2.9.' counter(counter-lab07-mcp-ollama-lab-2) ' ' }
                .print-site-enumerate-headings #lab07-mcp-ollama-lab h2 {  counter-increment: counter-lab07-mcp-ollama-lab-2 }
            
.print-site-enumerate-headings #lab08-kagent-lab > h1:before { content: '2.10 ' }

                .print-site-enumerate-headings #lab08-kagent-lab h2:before { content: '2.10.' counter(counter-lab08-kagent-lab-2) ' ' }
                .print-site-enumerate-headings #lab08-kagent-lab h2 {  counter-increment: counter-lab08-kagent-lab-2 }
            
.print-site-enumerate-headings #section-3 > h1:before { content: '3 ' }
.print-site-enumerate-headings #index > h1:before { content: '3.1 ' }

                .print-site-enumerate-headings #index h2:before { content: '3.1.' counter(counter-index-2) ' ' }
                .print-site-enumerate-headings #index h2 {  counter-increment: counter-index-2 }
            
.print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step01-install-kagent > h1:before { content: '3.2 ' }

                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step01-install-kagent h2:before { content: '3.2.' counter(counter-resources-lab09-k8s-event-monitor-step01-install-kagent-2) ' ' }
                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step01-install-kagent h2 {  counter-increment: counter-resources-lab09-k8s-event-monitor-step01-install-kagent-2 }
            
.print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step02-create-mcp-server > h1:before { content: '3.3 ' }

                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step02-create-mcp-server h2:before { content: '3.3.' counter(counter-resources-lab09-k8s-event-monitor-step02-create-mcp-server-2) ' ' }
                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step02-create-mcp-server h2 {  counter-increment: counter-resources-lab09-k8s-event-monitor-step02-create-mcp-server-2 }
            
.print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step03-kmcp-build > h1:before { content: '3.4 ' }

                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step03-kmcp-build h2:before { content: '3.4.' counter(counter-resources-lab09-k8s-event-monitor-step03-kmcp-build-2) ' ' }
                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step03-kmcp-build h2 {  counter-increment: counter-resources-lab09-k8s-event-monitor-step03-kmcp-build-2 }
            
.print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step04-verify-registration > h1:before { content: '3.5 ' }

                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step04-verify-registration h2:before { content: '3.5.' counter(counter-resources-lab09-k8s-event-monitor-step04-verify-registration-2) ' ' }
                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step04-verify-registration h2 {  counter-increment: counter-resources-lab09-k8s-event-monitor-step04-verify-registration-2 }
            
.print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step05-create-agent > h1:before { content: '3.6 ' }

                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step05-create-agent h2:before { content: '3.6.' counter(counter-resources-lab09-k8s-event-monitor-step05-create-agent-2) ' ' }
                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step05-create-agent h2 {  counter-increment: counter-resources-lab09-k8s-event-monitor-step05-create-agent-2 }
            
.print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step06-install-ingress > h1:before { content: '3.7 ' }

                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step06-install-ingress h2:before { content: '3.7.' counter(counter-resources-lab09-k8s-event-monitor-step06-install-ingress-2) ' ' }
                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step06-install-ingress h2 {  counter-increment: counter-resources-lab09-k8s-event-monitor-step06-install-ingress-2 }
            
.print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana > h1:before { content: '3.8 ' }

                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana h2:before { content: '3.8.' counter(counter-resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-2) ' ' }
                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana h2 {  counter-increment: counter-resources-lab09-k8s-event-monitor-step07-deploy-prometheus-grafana-2 }
            
.print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step08-expose-ingress > h1:before { content: '3.9 ' }

                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step08-expose-ingress h2:before { content: '3.9.' counter(counter-resources-lab09-k8s-event-monitor-step08-expose-ingress-2) ' ' }
                .print-site-enumerate-headings #resources-lab09-k8s-event-monitor-step08-expose-ingress h2 {  counter-increment: counter-resources-lab09-k8s-event-monitor-step08-expose-ingress-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step00-getting-started > h1:before { content: '3.11 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step00-getting-started h2:before { content: '3.11.' counter(counter-resources-lab07-mcp-ollama-step00-getting-started-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step00-getting-started h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step00-getting-started-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step01-imports > h1:before { content: '3.12 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step01-imports h2:before { content: '3.12.' counter(counter-resources-lab07-mcp-ollama-step01-imports-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step01-imports h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step01-imports-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step02-skeleton-code > h1:before { content: '3.13 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step02-skeleton-code h2:before { content: '3.13.' counter(counter-resources-lab07-mcp-ollama-step02-skeleton-code-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step02-skeleton-code h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step02-skeleton-code-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step03-constructor > h1:before { content: '3.14 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step03-constructor h2:before { content: '3.14.' counter(counter-resources-lab07-mcp-ollama-step03-constructor-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step03-constructor h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step03-constructor-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step04-register-tools > h1:before { content: '3.15 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step04-register-tools h2:before { content: '3.15.' counter(counter-resources-lab07-mcp-ollama-step04-register-tools-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step04-register-tools h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step04-register-tools-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step05-tool-handlers > h1:before { content: '3.16 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step05-tool-handlers h2:before { content: '3.16.' counter(counter-resources-lab07-mcp-ollama-step05-tool-handlers-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step05-tool-handlers h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step05-tool-handlers-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step06-register-resources > h1:before { content: '3.17 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step06-register-resources h2:before { content: '3.17.' counter(counter-resources-lab07-mcp-ollama-step06-register-resources-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step06-register-resources h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step06-register-resources-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step07-resource-handlers > h1:before { content: '3.18 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step07-resource-handlers h2:before { content: '3.18.' counter(counter-resources-lab07-mcp-ollama-step07-resource-handlers-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step07-resource-handlers h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step07-resource-handlers-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step08-register-prompts > h1:before { content: '3.19 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step08-register-prompts h2:before { content: '3.19.' counter(counter-resources-lab07-mcp-ollama-step08-register-prompts-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step08-register-prompts h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step08-register-prompts-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step09-prompt-handlers > h1:before { content: '3.20 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step09-prompt-handlers h2:before { content: '3.20.' counter(counter-resources-lab07-mcp-ollama-step09-prompt-handlers-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step09-prompt-handlers h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step09-prompt-handlers-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step10-setup-handlers > h1:before { content: '3.21 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step10-setup-handlers h2:before { content: '3.21.' counter(counter-resources-lab07-mcp-ollama-step10-setup-handlers-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step10-setup-handlers h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step10-setup-handlers-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step11-run-server > h1:before { content: '3.22 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step11-run-server h2:before { content: '3.22.' counter(counter-resources-lab07-mcp-ollama-step11-run-server-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step11-run-server h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step11-run-server-2 }
            
.print-site-enumerate-headings #resources-lab07-mcp-ollama-step12-main-entry-point > h1:before { content: '3.23 ' }

                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step12-main-entry-point h2:before { content: '3.23.' counter(counter-resources-lab07-mcp-ollama-step12-main-entry-point-2) ' ' }
                .print-site-enumerate-headings #resources-lab07-mcp-ollama-step12-main-entry-point h2 {  counter-increment: counter-resources-lab07-mcp-ollama-step12-main-entry-point-2 }
            </style>
<!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Render date of last update -->


<!-- Render date of creation -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render authors -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render committers from GitHub -->


<!-- Render committers from GitLab -->


<!-- Render committers -->


<!-- ---------------------------------------------------------------------- -->

<!-- Determine date of last update -->


<!-- Source file information -->





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Footer -->
<footer class="md-footer">
  <div class="logo1"></div>
  <div class="logo2"></div>

  <!-- Link to previous and/or next page -->
  
    
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ©2021-2025 Nir Geier<br/><a href="https://visitor-badge.laobi.icu/badge?page_id=nirgeier" target="_blank" rel="noopener"><img src="https://visitor-badge.laobi.icu/badge?page_id=nirgeier" alt="Visitor Badge"></a>
    </div>
  
  
</div>

      <!-- Social links -->
      
        
<div class="md-social">
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP" target="_blank" rel="noopener" title="View on GitHub"
        class="md-social__link social-class__github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP/network/members" target="_blank" rel="noopener" title="Fork this repo"
        class="md-social__link social-class__fork">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0M5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0m6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5m-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0"/></svg>
    </a>
    
    
    
    
    
    <a href="https://github.com/nirgeier/AI-K8S-MCP/stargazers" target="_blank" rel="noopener" title="Star this repo"
        class="md-social__link social-class__star">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25m0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://www.linkedin.com/in/nirgeier/" target="_blank" rel="noopener" title="Connect on LinkedIn"
        class="md-social__link social-class__linkedin">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://discord.gg/U6xW23Ss" target="_blank" rel="noopener" title="Follow me on Discord"
        class="md-social__link social-class__discord">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
    
    
    
    
    
    <a href="https://stackoverflow.com/users/1755598/codewizard" target="_blank" rel="noopener" title="Follow me on Stack Overflow"
        class="md-social__link social-class__stackoverflow">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M291 311 95.3 269.7 87.1 309l195.7 41zm51-87L188.5 95.7 163 126.5l153.5 128.3zm-31.2 39.7L129.5 179l-16.7 36.5L294 300zM262.3 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H43V320H3v160h359.5V320h-40z"/></svg>
    </a>
    
    
    
    
    
    <a href="https://wa.me/972548122310" target="_blank" rel="noopener" title="Follow me on WhatsApp"
        class="md-social__link social-class__whatsapp">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157m-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1s56.2 81.2 56.1 130.5c0 101.8-84.9 184.6-186.6 184.6m101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7s-12.5-30.1-17.1-41.2c-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3s19.9 53.7 22.6 57.4c2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4s4.6-24.1 3.2-26.4c-1.3-2.5-5-3.9-10.5-6.6"/></svg>
    </a>
    
    
    
    
    
    <a href="mailto:nirg@codewizard.co.il" target="_blank" rel="noopener" title="Email me"
        class="md-social__link social-class__email">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg>
    </a>
    
</div>
      
    </div>
  </div>
</footer>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "/AI-K8S-MCP/", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "content.footer.last-updated", "content.footer.contributors", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", {"navigation.top": true}, "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate", "toc.sticky", "mermaid"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="https://buttons.github.io/buttons.js?v=1766553928"></script>
      
    
  </body>
</html>