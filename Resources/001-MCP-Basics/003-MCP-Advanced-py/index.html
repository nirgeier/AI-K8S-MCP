<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Hands-on labs for the K-Agent framework - Kubernetes-native MCP server" name="description"/><meta content="CodeWizard-IL" name="author"/><link href="https://nirgeier.github.io/AI-K8S-MCP/Resources/001-MCP-Basics/003-MCP-Advanced-py/" rel="canonical"/><link href="../002-MCP-Basics-ts/" rel="prev"/><link href="../../../assets/favicon.png" rel="icon"/><meta content="mkdocs-1.6.1, mkdocs-material-9.6.16" name="generator"/><title>003 - MCP Advanced (PY) - K-Agent Labs</title><link href="../../../assets/stylesheets/main.7e37652d.min.css" rel="stylesheet"/><link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%202a7%207%200%200%200-7%207c0%202.38%201.19%204.47%203%205.74V17a1%201%200%200%200%201%201h6a1%201%200%200%200%201-1v-2.26c1.81-1.27%203-3.36%203-5.74a7%207%200%200%200-7-7M9%2021a1%201%200%200%200%201%201h4a1%201%200%200%200%201-1v-1H9z%22/%3E%3C/svg%3E');}</style><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Mulish:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Mulish";--md-code-font:"JetBrains Mono"}</style><link href="../../../css/print-site.css" rel="stylesheet"/><link href="../../../css/print-site-material.css" rel="stylesheet"/><link href="../../../assets/stylesheets/codewizard.css?v=1766553928" rel="stylesheet"/><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="slate" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#resource-to-return-the-source-code-of-this-server"> Skip to content </a> </div> <div data-md-component="announce"> </div> <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Determine classes --> <!-- Header --> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <!-- Link to home --> <a aria-label="K-Agent Labs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="K-Agent Labs"> <svg viewbox="0 0 89 89" xmlns="http://www.w3.org/2000/svg"> <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z"></path> <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5"></path> <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z"></path> <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25"></path> </svg> </a> <!-- Button to open drawer --> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <!-- Header title --> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> K-Agent Labs </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> 003 - MCP Advanced (PY) </span> </div> </div> </div> <div class="m-social__top"> <!-- Social links --> <div class="md-social"> <a class="md-social__link social-class__github" href="https://github.com/nirgeier/AI-K8S-MCP" rel="noopener" target="_blank" title="View on GitHub"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__fork" href="https://github.com/nirgeier/AI-K8S-MCP/network/members" rel="noopener" target="_blank" title="Fork this repo"> <svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0M5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0m6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5m-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0"></path></svg> </a> <a class="md-social__link social-class__star" href="https://github.com/nirgeier/AI-K8S-MCP/stargazers" rel="noopener" target="_blank" title="Star this repo"> <svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25m0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41z"></path></svg> </a> <a class="md-social__link social-class__linkedin" href="https://www.linkedin.com/in/nirgeier/" rel="noopener" target="_blank" title="Connect on LinkedIn"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__discord" href="https://discord.gg/U6xW23Ss" rel="noopener" target="_blank" title="Follow me on Discord"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__stackoverflow" href="https://stackoverflow.com/users/1755598/codewizard" rel="noopener" target="_blank" title="Follow me on Stack Overflow"> <svg viewbox="0 0 384 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M291 311 95.3 269.7 87.1 309l195.7 41zm51-87L188.5 95.7 163 126.5l153.5 128.3zm-31.2 39.7L129.5 179l-16.7 36.5L294 300zM262.3 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H43V320H3v160h359.5V320h-40z" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__whatsapp" href="https://wa.me/972548122310" rel="noopener" target="_blank" title="Follow me on WhatsApp"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157m-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1s56.2 81.2 56.1 130.5c0 101.8-84.9 184.6-186.6 184.6m101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7s-12.5-30.1-17.1-41.2c-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3s19.9 53.7 22.6 57.4c2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4s4.6-24.1 3.2-26.4c-1.3-2.5-5-3.9-10.5-6.6" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__email" href="mailto:nirg@codewizard.co.il" rel="noopener" target="_blank" title="Email me"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z" fill="currentColor"></path></svg> </a> </div> </div> <!-- Color palette toggle --> <form class="md-header__option" data-md-component="palette"> <input aria-hidden="true" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/> </form> <!-- User preference: color palette --> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <!-- Site language selector --> <!-- Button to open search modal --> <!-- Check if search is actually enabled - see https://t.ly/DT_0V --> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <!-- Search interface --> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0"> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <!-- Repository information --> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/nirgeier/AI-K8S-MCP.git" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg> </div> <div class="md-source__repository"> nirgeier/AI-K8S-MCP </div> </a> </div> </nav> <!-- Navigation tabs (sticky) --> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../../welcome/"> Welcome </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../../Lab00-Setup/"> Setup </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../../labs/"> Labs </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../../Tasks/"> Tasks </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a class="md-tabs__link" href="../001-MCP-Basics-tp.md"> Resources </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="K-Agent Labs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="K-Agent Labs"> <svg viewbox="0 0 89 89" xmlns="http://www.w3.org/2000/svg"> <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z"></path> <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5"></path> <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z"></path> <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25"></path> </svg> </a> K-Agent Labs </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/nirgeier/AI-K8S-MCP.git" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg> </div> <div class="md-source__repository"> nirgeier/AI-K8S-MCP </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../welcome/"> <span class="md-ellipsis"> Welcome </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../Lab00-Setup/"> <span class="md-ellipsis"> Setup </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../labs/"> <span class="md-ellipsis"> Labs </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../Tasks/"> <span class="md-ellipsis"> Tasks </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex=""> <span class="md-ellipsis"> Resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../001-MCP-Basics-tp.md"> <span class="md-ellipsis"> 001 - MCP Basics (TS) </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../002-MCP-Basics-ts/"> <span class="md-ellipsis"> 002 - MCP Basics (PY) </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> 003 - MCP Advanced (PY) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h3 id="mcp-basics-with-python">MCP Basics with Python<a class="headerlink" href="#mcp-basics-with-python" title="Permanent link">Â¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">starlette.responses</span><span class="w"> </span><span class="kn">import</span> <span class="n">Response</span><span class="p">,</span> <span class="n">JSONResponse</span><span class="p">,</span> <span class="n">StreamingResponse</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">starlette.requests</span><span class="w"> </span><span class="kn">import</span> <span class="n">Request</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">types</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">httpx</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-0-9"><a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
</span><span id="__span-0-10"><a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>
</span><span id="__span-0-11"><a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a>
</span><span id="__span-0-12"><a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="c1"># Ollama configuration</span>
</span><span id="__span-0-13"><a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="n">OLLAMA_BASE_URL</span> <span class="o">=</span> <span class="s2">"http://localhost:11434"</span>
</span><span id="__span-0-14"><a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="n">DEFAULT_MODEL</span> <span class="o">=</span> <span class="s2">"codestral:latest"</span>
</span><span id="__span-0-15"><a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a>
</span><span id="__span-0-16"><a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="c1"># Tool execution tracking</span>
</span><span id="__span-0-17"><a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="n">TOOL_EXECUTIONS</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-18"><a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="n">EXECUTION_COUNTER</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-19"><a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a>
</span><span id="__span-0-20"><a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">"kagent-mcp-server"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8889</span><span class="p">)</span>
</span><span id="__span-0-21"><a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a>
</span><span id="__span-0-22"><a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="c1"># Backwards-compat shim: some inspector tooling (fastmcp helpers)</span>
</span><span id="__span-0-23"><a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="c1"># expect a `_list_tools_mcp` coroutine on the server instance. Provide</span>
</span><span id="__span-0-24"><a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="c1"># a thin wrapper that forwards to the FastMCP `list_tools` implementation.</span>
</span><span id="__span-0-25"><a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_list_tools_mcp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-26"><a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
</span><span id="__span-0-27"><a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a>
</span><span id="__span-0-28"><a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="c1"># Bind the method to the instance</span>
</span><span id="__span-0-29"><a href="#__codelineno-0-29" id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="c1"># MCP need to access it as an instance method later</span>
</span><span id="__span-0-30"><a href="#__codelineno-0-30" id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="c1"># This will return list of ToolMetadata objects</span>
</span><span id="__span-0-31"><a href="#__codelineno-0-31" id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="n">mcp</span><span class="o">.</span><span class="n">_list_tools_mcp</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">_list_tools_mcp</span><span class="p">,</span> <span class="n">mcp</span><span class="p">)</span>
</span><span id="__span-0-32"><a href="#__codelineno-0-32" id="__codelineno-0-32" name="__codelineno-0-32"></a>
</span><span id="__span-0-33"><a href="#__codelineno-0-33" id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="c1"># Common CORS headers used by the inspector (browser-based)</span>
</span><span id="__span-0-34"><a href="#__codelineno-0-34" id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="n">HEADERS</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-35"><a href="#__codelineno-0-35" id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="s2">"Access-Control-Allow-Origin"</span><span class="p">:</span> <span class="s2">"*"</span><span class="p">,</span>
</span><span id="__span-0-36"><a href="#__codelineno-0-36" id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="s2">"Access-Control-Allow-Methods"</span><span class="p">:</span> <span class="s2">"GET,POST,OPTIONS"</span><span class="p">,</span>
</span><span id="__span-0-37"><a href="#__codelineno-0-37" id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="s2">"Access-Control-Allow-Headers"</span><span class="p">:</span> <span class="s2">"Content-Type,Authorization,X-Proxy-Token"</span><span class="p">,</span>
</span><span id="__span-0-38"><a href="#__codelineno-0-38" id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="p">}</span>
</span><span id="__span-0-39"><a href="#__codelineno-0-39" id="__codelineno-0-39" name="__codelineno-0-39"></a>
</span><span id="__span-0-40"><a href="#__codelineno-0-40" id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="c1"># Helper functions for tool execution</span>
</span><span id="__span-0-41"><a href="#__codelineno-0-41" id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_tool_function</span><span class="p">(</span><span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-0-42"><a href="#__codelineno-0-42" id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">    </span><span class="sd">"""Get the actual function for a tool by name"""</span>
</span><span id="__span-0-43"><a href="#__codelineno-0-43" id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="c1"># Build a mapping of tool names to functions</span>
</span><span id="__span-0-44"><a href="#__codelineno-0-44" id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">tool_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-45"><a href="#__codelineno-0-45" id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="s1">'hello'</span><span class="p">:</span> <span class="n">hello</span><span class="p">,</span>
</span><span id="__span-0-46"><a href="#__codelineno-0-46" id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="s1">'add'</span><span class="p">:</span> <span class="n">add</span><span class="p">,</span>
</span><span id="__span-0-47"><a href="#__codelineno-0-47" id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="s1">'ollama_generate'</span><span class="p">:</span> <span class="n">ollama_generate</span><span class="p">,</span>
</span><span id="__span-0-48"><a href="#__codelineno-0-48" id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="s1">'ollama_chat'</span><span class="p">:</span> <span class="n">ollama_chat</span><span class="p">,</span>
</span><span id="__span-0-49"><a href="#__codelineno-0-49" id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="s1">'ollama_list_models'</span><span class="p">:</span> <span class="n">ollama_list_models</span><span class="p">,</span>
</span><span id="__span-0-50"><a href="#__codelineno-0-50" id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="s1">'code_review_prompt'</span><span class="p">:</span> <span class="n">code_review_prompt</span><span class="p">,</span>
</span><span id="__span-0-51"><a href="#__codelineno-0-51" id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="s1">'debug_prompt'</span><span class="p">:</span> <span class="n">debug_prompt</span><span class="p">,</span>
</span><span id="__span-0-52"><a href="#__codelineno-0-52" id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="p">}</span>
</span><span id="__span-0-53"><a href="#__codelineno-0-53" id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">return</span> <span class="n">tool_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
</span><span id="__span-0-54"><a href="#__codelineno-0-54" id="__codelineno-0-54" name="__codelineno-0-54"></a>
</span><span id="__span-0-55"><a href="#__codelineno-0-55" id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_tool_arguments</span><span class="p">(</span><span class="n">tool_func</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-0-56"><a href="#__codelineno-0-56" id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="sd">"""Validate arguments against function signature"""</span>
</span><span id="__span-0-57"><a href="#__codelineno-0-57" id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-58"><a href="#__codelineno-0-58" id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">tool_func</span><span class="p">)</span>
</span><span id="__span-0-59"><a href="#__codelineno-0-59" id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">params</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span>
</span><span id="__span-0-60"><a href="#__codelineno-0-60" id="__codelineno-0-60" name="__codelineno-0-60"></a>
</span><span id="__span-0-61"><a href="#__codelineno-0-61" id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="c1"># Check required arguments</span>
</span><span id="__span-0-62"><a href="#__codelineno-0-62" id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="k">for</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-63"><a href="#__codelineno-0-63" id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span> <span class="o">==</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="n">param_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
</span><span id="__span-0-64"><a href="#__codelineno-0-64" id="__codelineno-0-64" name="__codelineno-0-64"></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Missing required argument: </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-65"><a href="#__codelineno-0-65" id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a href="#__codelineno-0-66" id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="c1"># Check for unexpected arguments</span>
</span><span id="__span-0-67"><a href="#__codelineno-0-67" id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">for</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
</span><span id="__span-0-68"><a href="#__codelineno-0-68" id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="k">if</span> <span class="n">arg_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
</span><span id="__span-0-69"><a href="#__codelineno-0-69" id="__codelineno-0-69" name="__codelineno-0-69"></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Unexpected argument: </span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-70"><a href="#__codelineno-0-70" id="__codelineno-0-70" name="__codelineno-0-70"></a>
</span><span id="__span-0-71"><a href="#__codelineno-0-71" id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">"Valid"</span>
</span><span id="__span-0-72"><a href="#__codelineno-0-72" id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-73"><a href="#__codelineno-0-73" id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Validation error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-74"><a href="#__codelineno-0-74" id="__codelineno-0-74" name="__codelineno-0-74"></a>
</span><span id="__span-0-75"><a href="#__codelineno-0-75" id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_tool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="__span-0-76"><a href="#__codelineno-0-76" id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="sd">"""Execute a tool and return the result"""</span>
</span><span id="__span-0-77"><a href="#__codelineno-0-77" id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">global</span> <span class="n">EXECUTION_COUNTER</span>
</span><span id="__span-0-78"><a href="#__codelineno-0-78" id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">execution_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"exec_</span><span class="si">{</span><span class="n">EXECUTION_COUNTER</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-79"><a href="#__codelineno-0-79" id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">EXECUTION_COUNTER</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-80"><a href="#__codelineno-0-80" id="__codelineno-0-80" name="__codelineno-0-80"></a>
</span><span id="__span-0-81"><a href="#__codelineno-0-81" id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-0-82"><a href="#__codelineno-0-82" id="__codelineno-0-82" name="__codelineno-0-82"></a>
</span><span id="__span-0-83"><a href="#__codelineno-0-83" id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-84"><a href="#__codelineno-0-84" id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">tool_func</span> <span class="o">=</span> <span class="n">get_tool_function</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
</span><span id="__span-0-85"><a href="#__codelineno-0-85" id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">tool_func</span><span class="p">:</span>
</span><span id="__span-0-86"><a href="#__codelineno-0-86" id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-0-87"><a href="#__codelineno-0-87" id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="s2">"execution_id"</span><span class="p">:</span> <span class="n">execution_id</span><span class="p">,</span>
</span><span id="__span-0-88"><a href="#__codelineno-0-88" id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="s2">"tool"</span><span class="p">:</span> <span class="n">tool_name</span><span class="p">,</span>
</span><span id="__span-0-89"><a href="#__codelineno-0-89" id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="s2">"success"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-90"><a href="#__codelineno-0-90" id="__codelineno-0-90" name="__codelineno-0-90"></a>                <span class="s2">"error"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Tool '</span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">' not found"</span><span class="p">,</span>
</span><span id="__span-0-91"><a href="#__codelineno-0-91" id="__codelineno-0-91" name="__codelineno-0-91"></a>                <span class="s2">"duration_ms"</span><span class="p">:</span> <span class="mi">0</span>
</span><span id="__span-0-92"><a href="#__codelineno-0-92" id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="p">}</span>
</span><span id="__span-0-93"><a href="#__codelineno-0-93" id="__codelineno-0-93" name="__codelineno-0-93"></a>
</span><span id="__span-0-94"><a href="#__codelineno-0-94" id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="c1"># Validate arguments</span>
</span><span id="__span-0-95"><a href="#__codelineno-0-95" id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">valid</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">validate_tool_arguments</span><span class="p">(</span><span class="n">tool_func</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
</span><span id="__span-0-96"><a href="#__codelineno-0-96" id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid</span><span class="p">:</span>
</span><span id="__span-0-97"><a href="#__codelineno-0-97" id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-0-98"><a href="#__codelineno-0-98" id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="s2">"execution_id"</span><span class="p">:</span> <span class="n">execution_id</span><span class="p">,</span>
</span><span id="__span-0-99"><a href="#__codelineno-0-99" id="__codelineno-0-99" name="__codelineno-0-99"></a>                <span class="s2">"tool"</span><span class="p">:</span> <span class="n">tool_name</span><span class="p">,</span>
</span><span id="__span-0-100"><a href="#__codelineno-0-100" id="__codelineno-0-100" name="__codelineno-0-100"></a>                <span class="s2">"success"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-101"><a href="#__codelineno-0-101" id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="s2">"error"</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
</span><span id="__span-0-102"><a href="#__codelineno-0-102" id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="s2">"duration_ms"</span><span class="p">:</span> <span class="mi">0</span>
</span><span id="__span-0-103"><a href="#__codelineno-0-103" id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="p">}</span>
</span><span id="__span-0-104"><a href="#__codelineno-0-104" id="__codelineno-0-104" name="__codelineno-0-104"></a>
</span><span id="__span-0-105"><a href="#__codelineno-0-105" id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="c1"># Execute the tool</span>
</span><span id="__span-0-106"><a href="#__codelineno-0-106" id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">tool_func</span><span class="p">):</span>
</span><span id="__span-0-107"><a href="#__codelineno-0-107" id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">tool_func</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="__span-0-108"><a href="#__codelineno-0-108" id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-109"><a href="#__codelineno-0-109" id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">tool_func</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="__span-0-110"><a href="#__codelineno-0-110" id="__codelineno-0-110" name="__codelineno-0-110"></a>
</span><span id="__span-0-111"><a href="#__codelineno-0-111" id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">duration_ms</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>
</span><span id="__span-0-112"><a href="#__codelineno-0-112" id="__codelineno-0-112" name="__codelineno-0-112"></a>
</span><span id="__span-0-113"><a href="#__codelineno-0-113" id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">execution_record</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-114"><a href="#__codelineno-0-114" id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="s2">"execution_id"</span><span class="p">:</span> <span class="n">execution_id</span><span class="p">,</span>
</span><span id="__span-0-115"><a href="#__codelineno-0-115" id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="s2">"tool"</span><span class="p">:</span> <span class="n">tool_name</span><span class="p">,</span>
</span><span id="__span-0-116"><a href="#__codelineno-0-116" id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="s2">"arguments"</span><span class="p">:</span> <span class="n">arguments</span><span class="p">,</span>
</span><span id="__span-0-117"><a href="#__codelineno-0-117" id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="s2">"success"</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-118"><a href="#__codelineno-0-118" id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="s2">"result"</span><span class="p">:</span> <span class="n">result</span><span class="p">,</span>
</span><span id="__span-0-119"><a href="#__codelineno-0-119" id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="s2">"duration_ms"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">duration_ms</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="__span-0-120"><a href="#__codelineno-0-120" id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="s2">"timestamp"</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-0-121"><a href="#__codelineno-0-121" id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="p">}</span>
</span><span id="__span-0-122"><a href="#__codelineno-0-122" id="__codelineno-0-122" name="__codelineno-0-122"></a>
</span><span id="__span-0-123"><a href="#__codelineno-0-123" id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">TOOL_EXECUTIONS</span><span class="p">[</span><span class="n">execution_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">execution_record</span>
</span><span id="__span-0-124"><a href="#__codelineno-0-124" id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="k">return</span> <span class="n">execution_record</span>
</span><span id="__span-0-125"><a href="#__codelineno-0-125" id="__codelineno-0-125" name="__codelineno-0-125"></a>
</span><span id="__span-0-126"><a href="#__codelineno-0-126" id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-127"><a href="#__codelineno-0-127" id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">duration_ms</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>
</span><span id="__span-0-128"><a href="#__codelineno-0-128" id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">execution_record</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-129"><a href="#__codelineno-0-129" id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="s2">"execution_id"</span><span class="p">:</span> <span class="n">execution_id</span><span class="p">,</span>
</span><span id="__span-0-130"><a href="#__codelineno-0-130" id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="s2">"tool"</span><span class="p">:</span> <span class="n">tool_name</span><span class="p">,</span>
</span><span id="__span-0-131"><a href="#__codelineno-0-131" id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="s2">"arguments"</span><span class="p">:</span> <span class="n">arguments</span><span class="p">,</span>
</span><span id="__span-0-132"><a href="#__codelineno-0-132" id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="s2">"success"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-133"><a href="#__codelineno-0-133" id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="s2">"error"</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
</span><span id="__span-0-134"><a href="#__codelineno-0-134" id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="s2">"duration_ms"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">duration_ms</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="__span-0-135"><a href="#__codelineno-0-135" id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="s2">"timestamp"</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-0-136"><a href="#__codelineno-0-136" id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="p">}</span>
</span><span id="__span-0-137"><a href="#__codelineno-0-137" id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">TOOL_EXECUTIONS</span><span class="p">[</span><span class="n">execution_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">execution_record</span>
</span><span id="__span-0-138"><a href="#__codelineno-0-138" id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">return</span> <span class="n">execution_record</span>
</span><span id="__span-0-139"><a href="#__codelineno-0-139" id="__codelineno-0-139" name="__codelineno-0-139"></a>
</span><span id="__span-0-140"><a href="#__codelineno-0-140" id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="c1"># Example tool definitions</span>
</span><span id="__span-0-141"><a href="#__codelineno-0-141" id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="c1"># These will be automatically registered with the MCP server</span>
</span><span id="__span-0-142"><a href="#__codelineno-0-142" id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-0-143"><a href="#__codelineno-0-143" id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="k">def</span><span class="w"> </span><span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-144"><a href="#__codelineno-0-144" id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="w">    </span><span class="sd">"""Returns a friendly greeting message"""</span>
</span><span id="__span-0-145"><a href="#__codelineno-0-145" id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">"Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">! Welcome to K-Agent Labs."</span>
</span><span id="__span-0-146"><a href="#__codelineno-0-146" id="__codelineno-0-146" name="__codelineno-0-146"></a>
</span><span id="__span-0-147"><a href="#__codelineno-0-147" id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="c1"># Example tool that adds two numbers</span>
</span><span id="__span-0-148"><a href="#__codelineno-0-148" id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="c1"># Demonstrates handling of numeric inputs and outputs</span>
</span><span id="__span-0-149"><a href="#__codelineno-0-149" id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="c1"># This will become MCP tool available at /tools</span>
</span><span id="__span-0-150"><a href="#__codelineno-0-150" id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-0-151"><a href="#__codelineno-0-151" id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-152"><a href="#__codelineno-0-152" id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="w">    </span><span class="sd">"""Adds two numbers together"""</span>
</span><span id="__span-0-153"><a href="#__codelineno-0-153" id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-0-154"><a href="#__codelineno-0-154" id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">"The sum of </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-155"><a href="#__codelineno-0-155" id="__codelineno-0-155" name="__codelineno-0-155"></a>
</span><span id="__span-0-156"><a href="#__codelineno-0-156" id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="c1"># Ollama integration tools</span>
</span><span id="__span-0-157"><a href="#__codelineno-0-157" id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-0-158"><a href="#__codelineno-0-158" id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="k">def</span><span class="w"> </span><span class="nf">ollama_generate</span><span class="p">(</span><span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_MODEL</span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-159"><a href="#__codelineno-0-159" id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="w">    </span><span class="sd">"""Generate text using Ollama LLM"""</span>
</span><span id="__span-0-160"><a href="#__codelineno-0-160" id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-161"><a href="#__codelineno-0-161" id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-0-162"><a href="#__codelineno-0-162" id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-0-163"><a href="#__codelineno-0-163" id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">OLLAMA_BASE_URL</span><span class="si">}</span><span class="s2">/api/generate"</span><span class="p">,</span>
</span><span id="__span-0-164"><a href="#__codelineno-0-164" id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">json</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-165"><a href="#__codelineno-0-165" id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="s2">"model"</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
</span><span id="__span-0-166"><a href="#__codelineno-0-166" id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="s2">"prompt"</span><span class="p">:</span> <span class="n">prompt</span><span class="p">,</span>
</span><span id="__span-0-167"><a href="#__codelineno-0-167" id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="s2">"stream"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-168"><a href="#__codelineno-0-168" id="__codelineno-0-168" name="__codelineno-0-168"></a>                <span class="s2">"options"</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-169"><a href="#__codelineno-0-169" id="__codelineno-0-169" name="__codelineno-0-169"></a>                    <span class="s2">"num_predict"</span><span class="p">:</span> <span class="n">max_tokens</span>
</span><span id="__span-0-170"><a href="#__codelineno-0-170" id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="p">}</span>
</span><span id="__span-0-171"><a href="#__codelineno-0-171" id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="p">},</span>
</span><span id="__span-0-172"><a href="#__codelineno-0-172" id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span>
</span><span id="__span-0-173"><a href="#__codelineno-0-173" id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="p">)</span>
</span><span id="__span-0-174"><a href="#__codelineno-0-174" id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-0-175"><a href="#__codelineno-0-175" id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-0-176"><a href="#__codelineno-0-176" id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"response"</span><span class="p">,</span> <span class="s2">"No response from model"</span><span class="p">)</span>
</span><span id="__span-0-177"><a href="#__codelineno-0-177" id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-178"><a href="#__codelineno-0-178" id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">"Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-179"><a href="#__codelineno-0-179" id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-180"><a href="#__codelineno-0-180" id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">"Error calling Ollama: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-181"><a href="#__codelineno-0-181" id="__codelineno-0-181" name="__codelineno-0-181"></a>
</span><span id="__span-0-182"><a href="#__codelineno-0-182" id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-0-183"><a href="#__codelineno-0-183" id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="k">def</span><span class="w"> </span><span class="nf">ollama_chat</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_MODEL</span><span class="p">,</span> <span class="n">system</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-184"><a href="#__codelineno-0-184" id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">    </span><span class="sd">"""Chat with Ollama LLM using chat API"""</span>
</span><span id="__span-0-185"><a href="#__codelineno-0-185" id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-186"><a href="#__codelineno-0-186" id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-0-187"><a href="#__codelineno-0-187" id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-188"><a href="#__codelineno-0-188" id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="k">if</span> <span class="n">system</span><span class="p">:</span>
</span><span id="__span-0-189"><a href="#__codelineno-0-189" id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">"role"</span><span class="p">:</span> <span class="s2">"system"</span><span class="p">,</span> <span class="s2">"content"</span><span class="p">:</span> <span class="n">system</span><span class="p">})</span>
</span><span id="__span-0-190"><a href="#__codelineno-0-190" id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">"role"</span><span class="p">:</span> <span class="s2">"user"</span><span class="p">,</span> <span class="s2">"content"</span><span class="p">:</span> <span class="n">message</span><span class="p">})</span>
</span><span id="__span-0-191"><a href="#__codelineno-0-191" id="__codelineno-0-191" name="__codelineno-0-191"></a>
</span><span id="__span-0-192"><a href="#__codelineno-0-192" id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-0-193"><a href="#__codelineno-0-193" id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">OLLAMA_BASE_URL</span><span class="si">}</span><span class="s2">/api/chat"</span><span class="p">,</span>
</span><span id="__span-0-194"><a href="#__codelineno-0-194" id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="n">json</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-195"><a href="#__codelineno-0-195" id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="s2">"model"</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
</span><span id="__span-0-196"><a href="#__codelineno-0-196" id="__codelineno-0-196" name="__codelineno-0-196"></a>                <span class="s2">"messages"</span><span class="p">:</span> <span class="n">messages</span><span class="p">,</span>
</span><span id="__span-0-197"><a href="#__codelineno-0-197" id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="s2">"stream"</span><span class="p">:</span> <span class="kc">False</span>
</span><span id="__span-0-198"><a href="#__codelineno-0-198" id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="p">},</span>
</span><span id="__span-0-199"><a href="#__codelineno-0-199" id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span>
</span><span id="__span-0-200"><a href="#__codelineno-0-200" id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="p">)</span>
</span><span id="__span-0-201"><a href="#__codelineno-0-201" id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-0-202"><a href="#__codelineno-0-202" id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-0-203"><a href="#__codelineno-0-203" id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"message"</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"content"</span><span class="p">,</span> <span class="s2">"No response"</span><span class="p">)</span>
</span><span id="__span-0-204"><a href="#__codelineno-0-204" id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-205"><a href="#__codelineno-0-205" id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">"Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-206"><a href="#__codelineno-0-206" id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-207"><a href="#__codelineno-0-207" id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">"Error calling Ollama: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-208"><a href="#__codelineno-0-208" id="__codelineno-0-208" name="__codelineno-0-208"></a>
</span><span id="__span-0-209"><a href="#__codelineno-0-209" id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
</span><span id="__span-0-210"><a href="#__codelineno-0-210" id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="k">def</span><span class="w"> </span><span class="nf">ollama_list_models</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-211"><a href="#__codelineno-0-211" id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="w">    </span><span class="sd">"""List available Ollama models"""</span>
</span><span id="__span-0-212"><a href="#__codelineno-0-212" id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-213"><a href="#__codelineno-0-213" id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-0-214"><a href="#__codelineno-0-214" id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">OLLAMA_BASE_URL</span><span class="si">}</span><span class="s2">/api/tags"</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-0-215"><a href="#__codelineno-0-215" id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-0-216"><a href="#__codelineno-0-216" id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-0-217"><a href="#__codelineno-0-217" id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="n">models</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"models"</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-0-218"><a href="#__codelineno-0-218" id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">models</span><span class="p">:</span>
</span><span id="__span-0-219"><a href="#__codelineno-0-219" id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="k">return</span> <span class="s2">"No models available"</span>
</span><span id="__span-0-220"><a href="#__codelineno-0-220" id="__codelineno-0-220" name="__codelineno-0-220"></a>
</span><span id="__span-0-221"><a href="#__codelineno-0-221" id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">result</span> <span class="o">=</span> <span class="s2">"Available Ollama models:</span><span class="se">\n</span><span class="s2">"</span>
</span><span id="__span-0-222"><a href="#__codelineno-0-222" id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
</span><span id="__span-0-223"><a href="#__codelineno-0-223" id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="s2">"unknown"</span><span class="p">)</span>
</span><span id="__span-0-224"><a href="#__codelineno-0-224" id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="n">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"size"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Convert to GB</span>
</span><span id="__span-0-225"><a href="#__codelineno-0-225" id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">"- </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">GB)</span><span class="se">\n</span><span class="s2">"</span>
</span><span id="__span-0-226"><a href="#__codelineno-0-226" id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-0-227"><a href="#__codelineno-0-227" id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-228"><a href="#__codelineno-0-228" id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">"Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-229"><a href="#__codelineno-0-229" id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-230"><a href="#__codelineno-0-230" id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">"Error listing models: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
</span><span id="__span-0-231"><a href="#__codelineno-0-231" id="__codelineno-0-231" name="__codelineno-0-231"></a>
</span><span id="__span-0-232"><a href="#__codelineno-0-232" id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="c1"># Prompts - Reusable prompt templates</span>
</span><span id="__span-0-233"><a href="#__codelineno-0-233" id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">prompt</span><span class="p">()</span>
</span><span id="__span-0-234"><a href="#__codelineno-0-234" id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="k">def</span><span class="w"> </span><span class="nf">code_review_prompt</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"python"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-235"><a href="#__codelineno-0-235" id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">    </span><span class="sd">"""Generate a code review prompt for the given code"""</span>
</span><span id="__span-0-236"><a href="#__codelineno-0-236" id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">"""Please review this </span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2"> code and provide feedback:</span>
</span><span id="__span-0-237"><a href="#__codelineno-0-237" id="__codelineno-0-237" name="__codelineno-0-237"></a>
</span><span id="__span-0-238"><a href="#__codelineno-0-238" id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="s2">```</span><span class="si">{</span><span class="n">language</span><span class="si">}</span>
</span><span id="__span-0-239"><a href="#__codelineno-0-239" id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="si">{</span><span class="n">code</span><span class="si">}</span>
</span></code></pre></div> <p>Focus on: - Code quality and best practices - Potential bugs or issues - Performance improvements - Security concerns âââ</p> <p>@mcp.prompt() def debug_prompt(error_message: str, code_context: str = ââ) -&gt; str: âââGenerate a debugging promptâââ prompt = fâââHelp me debug this error:</p> <p>Error: {error_message} âââ if code_context: prompt += fâ\n\nCode context:\n<code>\n{code_context}\n</code>â return prompt</p> <h1 id="resource-to-return-the-source-code-of-this-server">Resource to return the source code of this server<a class="headerlink" href="#resource-to-return-the-source-code-of-this-server" title="Permanent link">Â¶</a></h1> <h1 id="useful-for-inspection-and-learning-purposes">Useful for inspection and learning purposes<a class="headerlink" href="#useful-for-inspection-and-learning-purposes" title="Permanent link">Â¶</a></h1> <p>@mcp.resource(âmcp://codeâ) def get_code() -&gt; str: âââReturns the source code of this serverâââ with open(<strong>file</strong>, ârâ) as f: return f.read()</p> <p>@mcp.resource(âmcp://server-infoâ) def get_server_info() -&gt; str: âââReturns information about this MCP serverâââ return âââK-Agent MCP Server</p> <p>Version: 0.1.0 Capabilities: - Tools: hello, add - Prompts: code_review_prompt, debug_prompt - Resources: code, server-info - Sampling: LLM sampling support - Roots: File system access âââ</p> <p>@mcp.custom_route(â/â, methods=[âGETâ, âOPTIONSâ]) async def root_health_check(request: Request) -&gt; Response: return Response(âMCP Server Runningâ, status_code=200, headers=HEADERS)</p> <h1 id="health-check-endpoints">Health check endpoints<a class="headerlink" href="#health-check-endpoints" title="Permanent link">Â¶</a></h1> <h1 id="mcp-manifest-endpoint-negotiation-and-tools-listing">MCP manifest endpoint, negotiation, and tools listing<a class="headerlink" href="#mcp-manifest-endpoint-negotiation-and-tools-listing" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/healthâ, methods=[âGETâ, âOPTIONSâ]) async def health_check(request: Request) -&gt; Response: return Response(âMCP Server Runningâ, status_code=200, headers=HEADERS)</p> <h1 id="mcp-manifest-endpoint-as-per-mcp-specification">MCP Manifest endpoint as per MCP specification<a class="headerlink" href="#mcp-manifest-endpoint-as-per-mcp-specification" title="Permanent link">Â¶</a></h1> <h1 id="provides-metadata-about-the-mcp-server">Provides metadata about the MCP server<a class="headerlink" href="#provides-metadata-about-the-mcp-server" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/.well-known/mcpâ, methods=[âGETâ, âOPTIONSâ]) async def mcp_manifest(request: Request) -&gt; JSONResponse: host = request.headers.get(âhostâ, âlocalhost:8889â) scheme = request.url.scheme or âhttpâ base = fâ{scheme}://{host}â manifest = { ânameâ: âkagent-mcp-serverâ, âversionâ: â0.1.0â, âbase_urlâ: base, âtransportâ: âstreamable-httpâ, âcapabilitiesâ: { âtoolsâ: True, âpromptsâ: True, âresourcesâ: True, âsamplingâ: True, ârootsâ: True, âloggingâ: True }, âendpointsâ: { âmanifestâ: â/.well-known/mcpâ, âhealthâ: â/healthâ, âpingâ: â/pingâ, ârootâ: â/â, ânegotiateâ: â/negotiateâ, âmetadataâ: â/metadataâ, âeventsâ: â/mcpâ, âtoolsâ: â/toolsâ, âtools_executeâ: â/tools/executeâ, âtools_batchâ: â/tools/batchâ, âtools_streamâ: â/tools/streamâ, âtools_historyâ: â/tools/historyâ, âpromptsâ: â/promptsâ, âresourcesâ: â/resourcesâ, âsamplingâ: â/samplingâ, ârootsâ: â/rootsâ, âollama_statusâ: â/ollama/statusâ, }, } return JSONResponse(manifest, headers=HEADERS)</p> <h1 id="mcp-negotiation-endpoint">MCP Negotiation endpoint<a class="headerlink" href="#mcp-negotiation-endpoint" title="Permanent link">Â¶</a></h1> <h1 id="clients-use-this-to-negotiate-connection-parameters">Clients use this to negotiate connection parameters<a class="headerlink" href="#clients-use-this-to-negotiate-connection-parameters" title="Permanent link">Â¶</a></h1> <h1 id="supports-token-based-authentication">Supports token-based authentication<a class="headerlink" href="#supports-token-based-authentication" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/negotiateâ, methods=[âGETâ, âPOSTâ, âOPTIONSâ]) async def negotiate(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="ss">host</span> <span class="o">=</span> request<span class="o">.</span>headers<span class="o">.</span>get<span class="p">(</span><span class="s2">"host"</span><span class="p">,</span> <span class="s2">"localhost:8889"</span><span class="p">)</span>
<span class="ss">scheme</span> <span class="o">=</span> request<span class="o">.</span>url<span class="o">.</span>scheme <span class="ow">or</span> <span class="s2">"http"</span>
<span class="ss">mcp_url</span> <span class="o">=</span> f<span class="s2">"{scheme}://{host}/mcp"</span>

<span class="c1"># Accept proxy token from query param, X-Proxy-Token header, or Authorization bearer</span>
<span class="ss">token</span> <span class="o">=</span> request<span class="o">.</span>query_params<span class="o">.</span>get<span class="p">(</span><span class="s2">"token"</span><span class="p">)</span> <span class="ow">or</span> request<span class="o">.</span>headers<span class="o">.</span>get<span class="p">(</span><span class="s2">"x-proxy-token"</span><span class="p">)</span> <span class="ow">or</span> request<span class="o">.</span>headers<span class="o">.</span>get<span class="p">(</span><span class="s2">"X-Proxy-Token"</span><span class="p">)</span>
<span class="ss">auth</span> <span class="o">=</span> request<span class="o">.</span>headers<span class="o">.</span>get<span class="p">(</span><span class="s2">"authorization"</span><span class="p">)</span> <span class="ow">or</span> request<span class="o">.</span>headers<span class="o">.</span>get<span class="p">(</span><span class="s2">"Authorization"</span><span class="p">)</span>
<span class="k">if</span> not token <span class="ow">and</span> auth <span class="ow">and</span> auth<span class="o">.</span>lower<span class="p">()</span><span class="o">.</span>startswith<span class="p">(</span><span class="s2">"bearer "</span><span class="p">):</span>
    <span class="ss">token</span> <span class="o">=</span> auth<span class="o">.</span>split<span class="p">(</span>None<span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="ss">response</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"transport"</span><span class="p">:</span> <span class="s2">"streamable-http"</span><span class="p">,</span>
    <span class="s2">"url"</span><span class="p">:</span> mcp_url<span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Include token in response if provided</span>
<span class="k">if</span> token<span class="p">:</span>
    response<span class="p">[</span><span class="s2">"proxy_token"</span><span class="p">]</span> <span class="o">=</span> token
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># When no token is provided, explicitly indicate no auth is required</span>
    <span class="c1"># This helps the Inspector understand it can connect without authentication</span>
    response<span class="p">[</span><span class="s2">"requiresAuth"</span><span class="p">]</span> <span class="o">=</span> False

return JSONResponse<span class="p">(</span>response<span class="p">,</span> <span class="ss">headers</span><span class="o">=</span>HEADERS<span class="p">)</span>
</code></pre></div> <h1 id="tools-listing-endpoint">Tools listing endpoint<a class="headerlink" href="#tools-listing-endpoint" title="Permanent link">Â¶</a></h1> <h1 id="returns-metadata-about-all-registered-tools">Returns metadata about all registered tools<a class="headerlink" href="#returns-metadata-about-all-registered-tools" title="Permanent link">Â¶</a></h1> <h1 id="used-by-inspectors-to-discover-available-tools">Used by inspectors to discover available tools<a class="headerlink" href="#used-by-inspectors-to-discover-available-tools" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/toolsâ, methods=[âPOSTâ, âGETâ, âOPTIONSâ]) async def tools_list(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="c1"># Use the server's list_tools implementation so the inspector sees</span>
<span class="c1"># the canonical, generated tool metadata instead of a hand-written list.</span>
<span class="n">tools</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">mcp</span><span class="o">.</span><span class="n">_list_tools_mcp</span><span class="p">()</span>

<span class="n">serializable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tools</span><span class="p">:</span>
<span class="w">    </span><span class="n">try</span><span class="p">:</span>
<span class="w">        </span><span class="n">serializable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
<span class="w">    </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="p">:</span>
<span class="w">        </span><span class="n">try</span><span class="p">:</span>
<span class="w">            </span><span class="n">serializable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">dict</span><span class="p">())</span>
<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="p">:</span>
<span class="w">            </span><span class="n">serializable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="p">({</span><span class="s2">"tools"</span><span class="p">:</span><span class="w"> </span><span class="n">serializable</span><span class="p">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>
</code></pre></div> <h1 id="tool-execution-endpoint-execute-a-single-tool">Tool execution endpoint - Execute a single tool<a class="headerlink" href="#tool-execution-endpoint-execute-a-single-tool" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/tools/executeâ, methods=[âPOSTâ, âOPTIONSâ]) async def tool_execute(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="na">json</span><span class="o">()</span>
<span class="w">    </span><span class="n">tool_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"tool"</span><span class="o">)</span>
<span class="w">    </span><span class="k">arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"arguments"</span><span class="o">,</span><span class="w"> </span><span class="o">{})</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">tool_name</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">            </span><span class="s2">"success"</span><span class="o">:</span><span class="w"> </span><span class="n">False</span><span class="o">,</span>
<span class="w">            </span><span class="s2">"error"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Missing 'tool' field"</span>
<span class="w">        </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">,</span><span class="w"> </span><span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="o">)</span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">execute_tool</span><span class="o">(</span><span class="n">tool_name</span><span class="o">,</span><span class="w"> </span><span class="k">arguments</span><span class="o">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">(</span><span class="n">result</span><span class="o">,</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">)</span>

<span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">        </span><span class="s2">"success"</span><span class="o">:</span><span class="w"> </span><span class="n">False</span><span class="o">,</span>
<span class="w">        </span><span class="s2">"error"</span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="s2">"Execution failed: {str(e)}"</span>
<span class="w">    </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">,</span><span class="w"> </span><span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="o">)</span>
</code></pre></div> <h1 id="batch-tool-execution-endpoint">Batch tool execution endpoint<a class="headerlink" href="#batch-tool-execution-endpoint" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/tools/batchâ, methods=[âPOSTâ, âOPTIONSâ]) async def tool_batch_execute(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="na">json</span><span class="o">()</span>
<span class="w">    </span><span class="n">calls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"calls"</span><span class="o">,</span><span class="w"> </span><span class="o">[])</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">calls</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">            </span><span class="s2">"success"</span><span class="o">:</span><span class="w"> </span><span class="n">False</span><span class="o">,</span>
<span class="w">            </span><span class="s2">"error"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Missing 'calls' array"</span>
<span class="w">        </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">,</span><span class="w"> </span><span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="o">)</span>

<span class="w">    </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">calls</span><span class="o">:</span>
<span class="w">        </span><span class="n">tool_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"tool"</span><span class="o">)</span>
<span class="w">        </span><span class="k">arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"arguments"</span><span class="o">,</span><span class="w"> </span><span class="o">{})</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">tool_name</span><span class="o">:</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">execute_tool</span><span class="o">(</span><span class="n">tool_name</span><span class="o">,</span><span class="w"> </span><span class="k">arguments</span><span class="o">)</span>
<span class="w">            </span><span class="n">results</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">result</span><span class="o">)</span>
<span class="w">        </span><span class="k">else</span><span class="o">:</span>
<span class="w">            </span><span class="n">results</span><span class="o">.</span><span class="na">append</span><span class="o">({</span>
<span class="w">                </span><span class="s2">"success"</span><span class="o">:</span><span class="w"> </span><span class="n">False</span><span class="o">,</span>
<span class="w">                </span><span class="s2">"error"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Missing tool name in call"</span>
<span class="w">            </span><span class="o">})</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">        </span><span class="s2">"success"</span><span class="o">:</span><span class="w"> </span><span class="n">True</span><span class="o">,</span>
<span class="w">        </span><span class="s2">"results"</span><span class="o">:</span><span class="w"> </span><span class="n">results</span><span class="o">,</span>
<span class="w">        </span><span class="s2">"total"</span><span class="o">:</span><span class="w"> </span><span class="n">len</span><span class="o">(</span><span class="n">results</span><span class="o">)</span>
<span class="w">    </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">)</span>

<span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">        </span><span class="s2">"success"</span><span class="o">:</span><span class="w"> </span><span class="n">False</span><span class="o">,</span>
<span class="w">        </span><span class="s2">"error"</span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="s2">"Batch execution failed: {str(e)}"</span>
<span class="w">    </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">,</span><span class="w"> </span><span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="o">)</span>
</code></pre></div> <h1 id="tool-execution-history-endpoint">Tool execution history endpoint<a class="headerlink" href="#tool-execution-history-endpoint" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/tools/historyâ, methods=[âGETâ, âOPTIONSâ]) async def tool_history(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code>limit = int(request.query_params.get("limit", 10))

<span class="gh">#</span> Get recent executions
executions = list(TOOL_EXECUTIONS.values())
executions.sort(key=lambda x: x.get("timestamp", 0), reverse=True)

return JSONResponse({
    "executions": executions[:limit],
    "total": len(executions)
}, headers=HEADERS)
</code></pre></div> <h1 id="get-specific-execution-details">Get specific execution details<a class="headerlink" href="#get-specific-execution-details" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/tools/execution/{execution_id}â, methods=[âGETâ, âOPTIONSâ]) async def tool_execution_detail(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="n">execution_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="n">path_params</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">"execution_id"</span><span class="p">)</span>

<span class="k">if</span><span class="w"> </span><span class="n">execution_id</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">TOOL_EXECUTIONS</span><span class="p">:</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="p">(</span><span class="n">TOOL_EXECUTIONS</span><span class="o">[</span><span class="n">execution_id</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>
<span class="k">else</span><span class="err">:</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="p">(</span><span class="err">{</span>
<span class="w">        </span><span class="ss">"error"</span><span class="err">:</span><span class="w"> </span><span class="n">f</span><span class="ss">"Execution '{execution_id}' not found"</span>
<span class="w">    </span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span><span class="w"> </span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
</code></pre></div> <h1 id="streaming-tool-execution">Streaming tool execution<a class="headerlink" href="#streaming-tool-execution" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/tools/streamâ, methods=[âPOSTâ, âOPTIONSâ]) async def tool_stream_execute(request: Request): # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="na">json</span><span class="o">()</span>
<span class="w">    </span><span class="n">tool_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"tool"</span><span class="o">)</span>
<span class="w">    </span><span class="k">arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"arguments"</span><span class="o">,</span><span class="w"> </span><span class="o">{})</span>

<span class="w">    </span><span class="n">async</span><span class="w"> </span><span class="n">def</span><span class="w"> </span><span class="n">generate_stream</span><span class="o">():</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">event</span>
<span class="w">        </span><span class="n">yield</span><span class="w"> </span><span class="n">json</span><span class="o">.</span><span class="na">dumps</span><span class="o">({</span>
<span class="w">            </span><span class="s2">"event"</span><span class="o">:</span><span class="w"> </span><span class="s2">"start"</span><span class="o">,</span>
<span class="w">            </span><span class="s2">"tool"</span><span class="o">:</span><span class="w"> </span><span class="n">tool_name</span><span class="o">,</span>
<span class="w">            </span><span class="s2">"timestamp"</span><span class="o">:</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="na">time</span><span class="o">()</span>
<span class="w">        </span><span class="o">})</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"\n"</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Execute</span><span class="w"> </span><span class="n">tool</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">execute_tool</span><span class="o">(</span><span class="n">tool_name</span><span class="o">,</span><span class="w"> </span><span class="k">arguments</span><span class="o">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">event</span>
<span class="w">        </span><span class="n">yield</span><span class="w"> </span><span class="n">json</span><span class="o">.</span><span class="na">dumps</span><span class="o">({</span>
<span class="w">            </span><span class="s2">"event"</span><span class="o">:</span><span class="w"> </span><span class="s2">"result"</span><span class="o">,</span>
<span class="w">            </span><span class="s2">"data"</span><span class="o">:</span><span class="w"> </span><span class="n">result</span>
<span class="w">        </span><span class="o">})</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"\n"</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="n">event</span>
<span class="w">        </span><span class="n">yield</span><span class="w"> </span><span class="n">json</span><span class="o">.</span><span class="na">dumps</span><span class="o">({</span>
<span class="w">            </span><span class="s2">"event"</span><span class="o">:</span><span class="w"> </span><span class="s2">"end"</span><span class="o">,</span>
<span class="w">            </span><span class="s2">"timestamp"</span><span class="o">:</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="na">time</span><span class="o">()</span>
<span class="w">        </span><span class="o">})</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"\n"</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">StreamingResponse</span><span class="o">(</span>
<span class="w">        </span><span class="n">generate_stream</span><span class="o">(),</span>
<span class="w">        </span><span class="n">media_type</span><span class="o">=</span><span class="s2">"application/x-ndjson"</span><span class="o">,</span>
<span class="w">        </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span>
<span class="w">    </span><span class="o">)</span>

<span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">        </span><span class="s2">"success"</span><span class="o">:</span><span class="w"> </span><span class="n">False</span><span class="o">,</span>
<span class="w">        </span><span class="s2">"error"</span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="s2">"Stream execution failed: {str(e)}"</span>
<span class="w">    </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">,</span><span class="w"> </span><span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="o">)</span>
</code></pre></div> <h1 id="prompts-listing-endpoint">Prompts listing endpoint<a class="headerlink" href="#prompts-listing-endpoint" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/promptsâ, methods=[âPOSTâ, âGETâ, âOPTIONSâ]) async def prompts_list(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code>prompts = [
    {
        "name": "code_review_prompt",
        "description": "Generate a code review prompt for the given code",
        "arguments": [
            {"name": "code", "description": "The code to review", "required": True},
            {"name": "language", "description": "Programming language", "required": False}
        ]
    },
    {
        "name": "debug_prompt",
        "description": "Generate a debugging prompt",
        "arguments": [
            {"name": "error_message", "description": "The error message", "required": True},
            {"name": "code_context", "description": "Relevant code context", "required": False}
        ]
    }
]

return JSONResponse({"prompts": prompts}, headers=HEADERS)
</code></pre></div> <h1 id="resources-listing-endpoint">Resources listing endpoint<a class="headerlink" href="#resources-listing-endpoint" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/resourcesâ, methods=[âPOSTâ, âGETâ, âOPTIONSâ]) async def resources_list(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="nv">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[
<span class="w">    </span>{
<span class="w">        </span><span class="s2">"uri"</span>:<span class="w"> </span><span class="s2">"mcp://code"</span>,
<span class="w">        </span><span class="s2">"name"</span>:<span class="w"> </span><span class="s2">"Server Source Code"</span>,
<span class="w">        </span><span class="s2">"description"</span>:<span class="w"> </span><span class="s2">"Returns the source code of this server"</span>,
<span class="w">        </span><span class="s2">"mimeType"</span>:<span class="w"> </span><span class="s2">"text/plain"</span>
<span class="w">    </span>},
<span class="w">    </span>{
<span class="w">        </span><span class="s2">"uri"</span>:<span class="w"> </span><span class="s2">"mcp://server-info"</span>,
<span class="w">        </span><span class="s2">"name"</span>:<span class="w"> </span><span class="s2">"Server Information"</span>,
<span class="w">        </span><span class="s2">"description"</span>:<span class="w"> </span><span class="s2">"Returns information about this MCP server"</span>,
<span class="w">        </span><span class="s2">"mimeType"</span>:<span class="w"> </span><span class="s2">"text/plain"</span>
<span class="w">    </span>}
]

<span class="k">return</span><span class="w"> </span><span class="nv">JSONResponse</span><span class="ss">(</span>{<span class="s2">"resources"</span>:<span class="w"> </span><span class="nv">resources</span>},<span class="w"> </span><span class="nv">headers</span><span class="o">=</span><span class="nv">HEADERS</span><span class="ss">)</span>
</code></pre></div> <h1 id="ping-endpoint-for-connection-health-checks">Ping endpoint for connection health checks<a class="headerlink" href="#ping-endpoint-for-connection-health-checks" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/pingâ, methods=[âPOSTâ, âGETâ, âOPTIONSâ]) async def ping(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code>return JSONResponse({
    "status": "ok",
    "timestamp": __import__('time').time(),
    "server": "kagent-mcp-server"
}, headers=HEADERS)
</code></pre></div> <h1 id="sampling-endpoint-llm-sampling-capability-using-ollama">Sampling endpoint - LLM sampling capability using Ollama<a class="headerlink" href="#sampling-endpoint-llm-sampling-capability-using-ollama" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/samplingâ, methods=[âPOSTâ, âOPTIONSâ]) async def sampling(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code>body = await request.json() if request.method == "POST" else {}
prompt = body.get("prompt", "")
max_tokens = body.get("maxTokens", 100)
model = body.get("model", DEFAULT_MODEL)

try:
    async with httpx.AsyncClient(timeout=60.0) as client:
        response = await client.post(
            f"{OLLAMA_BASE_URL}/api/generate",
            json={
                "model": model,
                "prompt": prompt,
                "stream": False,
                "options": {
                    "num_predict": max_tokens
                }
            }
        )

        if response.status_code == 200:
            result = response.json()
            return JSONResponse({
                "completion": result.get("response", ""),
                "stopReason": "endTurn" if result.get("done") else "length",
                "model": model,
                "context": result.get("context", [])
            }, headers=HEADERS)
        else:
            return JSONResponse({
                "error": f"Ollama error: {response.status_code}",
                "completion": "",
                "stopReason": "error",
                "model": model
            }, headers=HEADERS, status_code=500)
except Exception as e:
    return JSONResponse({
        "error": f"Failed to connect to Ollama: {str(e)}",
        "completion": "",
        "stopReason": "error",
        "model": model
    }, headers=HEADERS, status_code=500)
</code></pre></div> <h1 id="roots-endpoint-file-system-roots">Roots endpoint - File system roots<a class="headerlink" href="#roots-endpoint-file-system-roots" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/rootsâ, methods=[âPOSTâ, âGETâ, âOPTIONSâ]) async def roots_list(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">roots</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">"uri"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"file://</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Current Directory"</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="k">return</span> <span class="n">JSONResponse</span><span class="p">({</span><span class="s2">"roots"</span><span class="p">:</span> <span class="n">roots</span><span class="p">},</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>
</code></pre></div> <h1 id="ollama-status-endpoint">Ollama status endpoint<a class="headerlink" href="#ollama-status-endpoint" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/ollama/statusâ, methods=[âGETâ, âOPTIONSâ]) async def ollama_status(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">async</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">httpx</span><span class="o">.</span><span class="na">AsyncClient</span><span class="o">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="o">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">client</span><span class="o">:</span>
<span class="w">        </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">f</span><span class="s2">"{OLLAMA_BASE_URL}/api/tags"</span><span class="o">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">response</span><span class="o">.</span><span class="na">status_code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">200</span><span class="o">:</span>
<span class="w">            </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="o">.</span><span class="na">json</span><span class="o">()</span>
<span class="w">            </span><span class="n">models</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"models"</span><span class="o">,</span><span class="w"> </span><span class="o">[])</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">                </span><span class="s2">"status"</span><span class="o">:</span><span class="w"> </span><span class="s2">"connected"</span><span class="o">,</span>
<span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="n">OLLAMA_BASE_URL</span><span class="o">,</span>
<span class="w">                </span><span class="s2">"models_count"</span><span class="o">:</span><span class="w"> </span><span class="n">len</span><span class="o">(</span><span class="n">models</span><span class="o">),</span>
<span class="w">                </span><span class="s2">"models"</span><span class="o">:</span><span class="w"> </span><span class="o">[{</span>
<span class="w">                    </span><span class="s2">"name"</span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"name"</span><span class="o">),</span>
<span class="w">                    </span><span class="s2">"size"</span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"size"</span><span class="o">),</span>
<span class="w">                    </span><span class="s2">"modified"</span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s2">"modified_at"</span><span class="o">)</span>
<span class="w">                </span><span class="o">}</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">models</span><span class="o">],</span>
<span class="w">                </span><span class="s2">"default_model"</span><span class="o">:</span><span class="w"> </span><span class="n">DEFAULT_MODEL</span>
<span class="w">            </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">)</span>
<span class="w">        </span><span class="k">else</span><span class="o">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">                </span><span class="s2">"status"</span><span class="o">:</span><span class="w"> </span><span class="s2">"error"</span><span class="o">,</span>
<span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="n">OLLAMA_BASE_URL</span><span class="o">,</span>
<span class="w">                </span><span class="s2">"error"</span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="s2">"HTTP {response.status_code}"</span>
<span class="w">            </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">)</span>
<span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="o">({</span>
<span class="w">        </span><span class="s2">"status"</span><span class="o">:</span><span class="w"> </span><span class="s2">"disconnected"</span><span class="o">,</span>
<span class="w">        </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="n">OLLAMA_BASE_URL</span><span class="o">,</span>
<span class="w">        </span><span class="s2">"error"</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="o">(</span><span class="n">e</span><span class="o">)</span>
<span class="w">    </span><span class="o">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="o">)</span>
</code></pre></div> <h1 id="server-metadata-endpoint">Server metadata endpoint<a class="headerlink" href="#server-metadata-endpoint" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/metadataâ, methods=[âGETâ, âOPTIONSâ]) async def metadata(request: Request) -&gt; JSONResponse: # Handle OPTIONS preflight if request.method == âOPTIONSâ: return JSONResponse({}, headers=HEADERS)</p> <div class="codehilite"><pre><span></span><code><span class="k">return</span><span class="w"> </span><span class="n">JSONResponse</span><span class="p">({</span>
<span class="w">    </span><span class="s2">"serverInfo"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kagent-mcp-server"</span><span class="p">,</span>
<span class="w">        </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.1.0"</span><span class="p">,</span>
<span class="w">        </span><span class="s2">"protocolVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-11-05"</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">"capabilities"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">"tools"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"listChanged"</span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="p">},</span>
<span class="w">        </span><span class="s2">"prompts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"listChanged"</span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="p">},</span>
<span class="w">        </span><span class="s2">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"subscribe"</span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="p">,</span><span class="w"> </span><span class="s2">"listChanged"</span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="p">},</span>
<span class="w">        </span><span class="s2">"logging"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">        </span><span class="s2">"sampling"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">        </span><span class="s2">"roots"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"listChanged"</span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">},</span><span class="w"> </span><span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>
</code></pre></div> <h1 id="add-cors-middleware-to-handle-preflight-requests-for-all-endpoints">Add CORS middleware to handle preflight requests for all endpoints<a class="headerlink" href="#add-cors-middleware-to-handle-preflight-requests-for-all-endpoints" title="Permanent link">Â¶</a></h1> <p>@mcp.custom_route(â/mcpâ, methods=[âOPTIONSâ]) async def mcp_options(request: Request) -&gt; Response: âââHandle CORS preflight for the MCP endpointâââ return Response(status_code=200, headers=HEADERS)</p> <h1 id="main-entry-point-to-run-the-mcp-server">Main entry point to run the MCP server<a class="headerlink" href="#main-entry-point-to-run-the-mcp-server" title="Permanent link">Â¶</a></h1> <p>def main(): # Start the MCP server with streamable-http transport # Mounted at /mcp path # This will listen on port 8889 as configured above mcp.run(transport=âstreamable-httpâ, mount_path=â/mcpâ)</p> <p>if <strong>name</strong> == â<strong>main</strong>â: main()</p> <p>```</p> <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Render date of last update --> <!-- Render date of creation --> <!-- ---------------------------------------------------------------------- --> <!-- Render authors --> <!-- ---------------------------------------------------------------------- --> <!-- Render committers from GitHub --> <!-- Render committers from GitLab --> <!-- Render committers --> <!-- ---------------------------------------------------------------------- --> <!-- Determine date of last update --> <!-- Determine date of creation --> <!-- Source file information --> <aside class="md-source-file"> <!-- Date of last update --> <span class="md-source-file__fact"> <span class="md-icon" title="Last update"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="January 11, 2026 05:42:20 UTC">January 11, 2026</span> </span> <!-- Authors (git-authors plugin) --> <!-- Authors (git-committers plugin) --> <!-- Fallback: Manual GitHub avatar for repository owner --> <span class="md-source-file__fact"> <nav> <a class="md-author" href="https://github.com/nirgeier" title="@nirgeier"> <img alt="Nir Geier" src="https://avatars.githubusercontent.com/u/555154?size=256"/> </a> </nav> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Footer --> <footer class="md-footer"> <div class="logo1"></div> <div class="logo2"></div> <!-- Link to previous and/or next page --> <nav aria-label="Footer" class="md-footer__inner md-grid"> <!-- Link to previous page --> <a aria-label="Previous: 002 - MCP Basics (PY)" class="md-footer__link md-footer__link--prev" href="../002-MCP-Basics-ts/"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> 002 - MCP Basics (PY) </div> </div> </a> <!-- <ul class="social-badges">
          <li><a href="https://visitor-badge.laobi.icu/badge?page_id=nirgeier" target="_blank" rel="noopener"><img src="https://visitor-badge.laobi.icu/badge?page_id=nirgeier" alt="Visitor Badge"></a></li>
          <li><a href="https://www.linkedin.com/in/nirgeier/" target="_blank" rel="noopener"><i class="fab fa-linkedin" aria-hidden="true"></i><span class="sr-only">LinkedIn profile</span></a></li>
          <li><a href="mailto:nirgeier@gmail.com"><img src="https://img.shields.io/badge/-nirgeier@gmail.com-fcc624?style=flat&logo=Gmail&logoColor=red" alt="Gmail Badge"></a></li>
          <li><a href="mailto:nirg@codewizard.co.il"><img src="https://img.shields.io/badge/-nirg@codewizard.co.il-fcc624?style=flat&logo=microsoftoutlook&logoColor=blue" alt="Outlook Badge"></a></li>
        </ul> --> <!-- Link to next page --> </nav> <!-- Further information --> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Â©2021-2025 Nir Geier<br/><a href="https://visitor-badge.laobi.icu/badge?page_id=nirgeier" rel="noopener" target="_blank"><img alt="Visitor Badge" src="https://visitor-badge.laobi.icu/badge?page_id=nirgeier"/></a> </div> </div> <!-- Social links --> <div class="md-social"> <a class="md-social__link social-class__github" href="https://github.com/nirgeier/AI-K8S-MCP" rel="noopener" target="_blank" title="View on GitHub"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__fork" href="https://github.com/nirgeier/AI-K8S-MCP/network/members" rel="noopener" target="_blank" title="Fork this repo"> <svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0M5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0m6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5m-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0"></path></svg> </a> <a class="md-social__link social-class__star" href="https://github.com/nirgeier/AI-K8S-MCP/stargazers" rel="noopener" target="_blank" title="Star this repo"> <svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25m0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41z"></path></svg> </a> <a class="md-social__link social-class__linkedin" href="https://www.linkedin.com/in/nirgeier/" rel="noopener" target="_blank" title="Connect on LinkedIn"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__discord" href="https://discord.gg/U6xW23Ss" rel="noopener" target="_blank" title="Follow me on Discord"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__stackoverflow" href="https://stackoverflow.com/users/1755598/codewizard" rel="noopener" target="_blank" title="Follow me on Stack Overflow"> <svg viewbox="0 0 384 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M291 311 95.3 269.7 87.1 309l195.7 41zm51-87L188.5 95.7 163 126.5l153.5 128.3zm-31.2 39.7L129.5 179l-16.7 36.5L294 300zM262.3 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H43V320H3v160h359.5V320h-40z" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__whatsapp" href="https://wa.me/972548122310" rel="noopener" target="_blank" title="Follow me on WhatsApp"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157m-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1s56.2 81.2 56.1 130.5c0 101.8-84.9 184.6-186.6 184.6m101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7s-12.5-30.1-17.1-41.2c-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3s19.9 53.7 22.6 57.4c2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4s4.6-24.1 3.2-26.4c-1.3-2.5-5-3.9-10.5-6.6" fill="currentColor"></path></svg> </a> <a class="md-social__link social-class__email" href="mailto:nirg@codewizard.co.il" rel="noopener" target="_blank" title="Email me"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z" fill="currentColor"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-progress" data-md-component="progress" role="progressbar"></div> <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "content.footer.last-updated", "content.footer.contributors", {"navigation.expand": false}, "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", {"navigation.top": true}, "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate", "toc.sticky", "mermaid"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src="../../../assets/javascripts/bundle.50899def.min.js"></script> <script src="../../../js/print-site.js"></script> <script src="https://buttons.github.io/buttons.js?v=1766553928"></script> </body> </html>